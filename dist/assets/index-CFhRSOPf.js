var cO=Object.defineProperty;var nS=n=>{throw TypeError(n)};var hO=(n,e,t)=>e in n?cO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ae=(n,e,t)=>hO(n,typeof e!="symbol"?e+"":e,t),o1=(n,e,t)=>e.has(n)||nS("Cannot "+t);var c=(n,e,t)=>(o1(n,e,"read from private field"),t?t.call(n):e.get(n)),N=(n,e,t)=>e.has(n)?nS("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),T=(n,e,t,i)=>(o1(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),I=(n,e,t)=>(o1(n,e,"access private method"),t);var _i=(n,e,t,i)=>({set _(r){T(n,e,r,t)},get _(){return c(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var Cr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function po(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var lT={exports:{}},Xb={},uT={exports:{}},zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xv=Symbol.for("react.element"),dO=Symbol.for("react.portal"),fO=Symbol.for("react.fragment"),pO=Symbol.for("react.strict_mode"),mO=Symbol.for("react.profiler"),gO=Symbol.for("react.provider"),vO=Symbol.for("react.context"),yO=Symbol.for("react.forward_ref"),bO=Symbol.for("react.suspense"),wO=Symbol.for("react.memo"),_O=Symbol.for("react.lazy"),iS=Symbol.iterator;function EO(n){return n===null||typeof n!="object"?null:(n=iS&&n[iS]||n["@@iterator"],typeof n=="function"?n:null)}var cT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hT=Object.assign,dT={};function tp(n,e,t){this.props=n,this.context=e,this.refs=dT,this.updater=t||cT}tp.prototype.isReactComponent={};tp.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};tp.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function fT(){}fT.prototype=tp.prototype;function WE(n,e,t){this.props=n,this.context=e,this.refs=dT,this.updater=t||cT}var VE=WE.prototype=new fT;VE.constructor=WE;hT(VE,tp.prototype);VE.isPureReactComponent=!0;var rS=Array.isArray,pT=Object.prototype.hasOwnProperty,GE={current:null},mT={key:!0,ref:!0,__self:!0,__source:!0};function gT(n,e,t){var i,r={},s=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)pT.call(e,i)&&!mT.hasOwnProperty(i)&&(r[i]=e[i]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in o=n.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return{$$typeof:xv,type:n,key:s,ref:a,props:r,_owner:GE.current}}function AO(n,e){return{$$typeof:xv,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function KE(n){return typeof n=="object"&&n!==null&&n.$$typeof===xv}function xO(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var sS=/\/+/g;function l1(n,e){return typeof n=="object"&&n!==null&&n.key!=null?xO(""+n.key):e.toString(36)}function Ny(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case xv:case dO:a=!0}}if(a)return a=n,r=r(a),n=i===""?"."+l1(a,0):i,rS(r)?(t="",n!=null&&(t=n.replace(sS,"$&/")+"/"),Ny(r,e,t,"",function(u){return u})):r!=null&&(KE(r)&&(r=AO(r,t+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(sS,"$&/")+"/")+n)),e.push(r)),1;if(a=0,i=i===""?".":i+":",rS(n))for(var o=0;o<n.length;o++){s=n[o];var l=i+l1(s,o);a+=Ny(s,e,t,l,r)}else if(l=EO(n),typeof l=="function")for(n=l.call(n),o=0;!(s=n.next()).done;)s=s.value,l=i+l1(s,o++),a+=Ny(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function sy(n,e,t){if(n==null)return n;var i=[],r=0;return Ny(n,i,"","",function(s){return e.call(t,s,r++)}),i}function SO(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Pr={current:null},Iy={transition:null},CO={ReactCurrentDispatcher:Pr,ReactCurrentBatchConfig:Iy,ReactCurrentOwner:GE};function vT(){throw Error("act(...) is not supported in production builds of React.")}zt.Children={map:sy,forEach:function(n,e,t){sy(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return sy(n,function(){e++}),e},toArray:function(n){return sy(n,function(e){return e})||[]},only:function(n){if(!KE(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};zt.Component=tp;zt.Fragment=fO;zt.Profiler=mO;zt.PureComponent=WE;zt.StrictMode=pO;zt.Suspense=bO;zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CO;zt.act=vT;zt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=hT({},n.props),r=n.key,s=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=GE.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)pT.call(e,l)&&!mT.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];i.children=o}return{$$typeof:xv,type:n.type,key:r,ref:s,props:i,_owner:a}};zt.createContext=function(n){return n={$$typeof:vO,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:gO,_context:n},n.Consumer=n};zt.createElement=gT;zt.createFactory=function(n){var e=gT.bind(null,n);return e.type=n,e};zt.createRef=function(){return{current:null}};zt.forwardRef=function(n){return{$$typeof:yO,render:n}};zt.isValidElement=KE;zt.lazy=function(n){return{$$typeof:_O,_payload:{_status:-1,_result:n},_init:SO}};zt.memo=function(n,e){return{$$typeof:wO,type:n,compare:e===void 0?null:e}};zt.startTransition=function(n){var e=Iy.transition;Iy.transition={};try{n()}finally{Iy.transition=e}};zt.unstable_act=vT;zt.useCallback=function(n,e){return Pr.current.useCallback(n,e)};zt.useContext=function(n){return Pr.current.useContext(n)};zt.useDebugValue=function(){};zt.useDeferredValue=function(n){return Pr.current.useDeferredValue(n)};zt.useEffect=function(n,e){return Pr.current.useEffect(n,e)};zt.useId=function(){return Pr.current.useId()};zt.useImperativeHandle=function(n,e,t){return Pr.current.useImperativeHandle(n,e,t)};zt.useInsertionEffect=function(n,e){return Pr.current.useInsertionEffect(n,e)};zt.useLayoutEffect=function(n,e){return Pr.current.useLayoutEffect(n,e)};zt.useMemo=function(n,e){return Pr.current.useMemo(n,e)};zt.useReducer=function(n,e,t){return Pr.current.useReducer(n,e,t)};zt.useRef=function(n){return Pr.current.useRef(n)};zt.useState=function(n){return Pr.current.useState(n)};zt.useSyncExternalStore=function(n,e,t){return Pr.current.useSyncExternalStore(n,e,t)};zt.useTransition=function(){return Pr.current.useTransition()};zt.version="18.3.1";uT.exports=zt;var kt=uT.exports;const gm=po(kt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kO=kt,TO=Symbol.for("react.element"),DO=Symbol.for("react.fragment"),RO=Object.prototype.hasOwnProperty,PO=kO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NO={key:!0,ref:!0,__self:!0,__source:!0};function yT(n,e,t){var i,r={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)RO.call(e,i)&&!NO.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:TO,type:n,key:s,ref:a,props:r,_owner:PO.current}}Xb.Fragment=DO;Xb.jsx=yT;Xb.jsxs=yT;lT.exports=Xb;var Q=lT.exports,bT={exports:{}},As={},wT={exports:{}},_T={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(he,ie){var ae=he.length;he.push(ie);e:for(;0<ae;){var me=ae-1>>>1,_e=he[me];if(0<r(_e,ie))he[me]=ie,he[ae]=_e,ae=me;else break e}}function t(he){return he.length===0?null:he[0]}function i(he){if(he.length===0)return null;var ie=he[0],ae=he.pop();if(ae!==ie){he[0]=ae;e:for(var me=0,_e=he.length,pe=_e>>>1;me<pe;){var De=2*(me+1)-1,it=he[De],Xe=De+1,We=he[Xe];if(0>r(it,ae))Xe<_e&&0>r(We,it)?(he[me]=We,he[Xe]=ae,me=Xe):(he[me]=it,he[De]=ae,me=De);else if(Xe<_e&&0>r(We,ae))he[me]=We,he[Xe]=ae,me=Xe;else break e}}return ie}function r(he,ie){var ae=he.sortIndex-ie.sortIndex;return ae!==0?ae:he.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,d=null,f=3,m=!1,b=!1,_=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(he){for(var ie=t(u);ie!==null;){if(ie.callback===null)i(u);else if(ie.startTime<=he)i(u),ie.sortIndex=ie.expirationTime,e(l,ie);else break;ie=t(u)}}function k(he){if(_=!1,E(he),!b)if(t(l)!==null)b=!0,ve(S);else{var ie=t(u);ie!==null&&xe(k,ie.startTime-he)}}function S(he,ie){b=!1,_&&(_=!1,v(F),F=-1),m=!0;var ae=f;try{for(E(ie),d=t(l);d!==null&&(!(d.expirationTime>ie)||he&&!te());){var me=d.callback;if(typeof me=="function"){d.callback=null,f=d.priorityLevel;var _e=me(d.expirationTime<=ie);ie=n.unstable_now(),typeof _e=="function"?d.callback=_e:d===t(l)&&i(l),E(ie)}else i(l);d=t(l)}if(d!==null)var pe=!0;else{var De=t(u);De!==null&&xe(k,De.startTime-ie),pe=!1}return pe}finally{d=null,f=ae,m=!1}}var D=!1,P=null,F=-1,H=5,z=-1;function te(){return!(n.unstable_now()-z<H)}function de(){if(P!==null){var he=n.unstable_now();z=he;var ie=!0;try{ie=P(!0,he)}finally{ie?ke():(D=!1,P=null)}}else D=!1}var ke;if(typeof y=="function")ke=function(){y(de)};else if(typeof MessageChannel<"u"){var Me=new MessageChannel,ze=Me.port2;Me.port1.onmessage=de,ke=function(){ze.postMessage(null)}}else ke=function(){w(de,0)};function ve(he){P=he,D||(D=!0,ke())}function xe(he,ie){F=w(function(){he(n.unstable_now())},ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(he){he.callback=null},n.unstable_continueExecution=function(){b||m||(b=!0,ve(S))},n.unstable_forceFrameRate=function(he){0>he||125<he?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<he?Math.floor(1e3/he):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(he){switch(f){case 1:case 2:case 3:var ie=3;break;default:ie=f}var ae=f;f=ie;try{return he()}finally{f=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(he,ie){switch(he){case 1:case 2:case 3:case 4:case 5:break;default:he=3}var ae=f;f=he;try{return ie()}finally{f=ae}},n.unstable_scheduleCallback=function(he,ie,ae){var me=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?me+ae:me):ae=me,he){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=ae+_e,he={id:h++,callback:ie,priorityLevel:he,startTime:ae,expirationTime:_e,sortIndex:-1},ae>me?(he.sortIndex=ae,e(u,he),t(l)===null&&he===t(u)&&(_?(v(F),F=-1):_=!0,xe(k,ae-me))):(he.sortIndex=_e,e(l,he),b||m||(b=!0,ve(S))),he},n.unstable_shouldYield=te,n.unstable_wrapCallback=function(he){var ie=f;return function(){var ae=f;f=ie;try{return he.apply(this,arguments)}finally{f=ae}}}})(_T);wT.exports=_T;var IO=wT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LO=kt,Es=IO;function je(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ET=new Set,vm={};function Nh(n,e){Uf(n,e),Uf(n+"Capture",e)}function Uf(n,e){for(vm[n]=e,n=0;n<e.length;n++)ET.add(e[n])}var ll=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c_=Object.prototype.hasOwnProperty,OO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,aS={},oS={};function MO(n){return c_.call(oS,n)?!0:c_.call(aS,n)?!1:OO.test(n)?oS[n]=!0:(aS[n]=!0,!1)}function FO(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function BO(n,e,t,i){if(e===null||typeof e>"u"||FO(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nr(n,e,t,i,r,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Wi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Wi[n]=new Nr(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Wi[e]=new Nr(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Wi[n]=new Nr(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Wi[n]=new Nr(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Wi[n]=new Nr(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Wi[n]=new Nr(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Wi[n]=new Nr(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Wi[n]=new Nr(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Wi[n]=new Nr(n,5,!1,n.toLowerCase(),null,!1,!1)});var XE=/[\-:]([a-z])/g;function YE(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(XE,YE);Wi[e]=new Nr(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(XE,YE);Wi[e]=new Nr(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(XE,YE);Wi[e]=new Nr(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Wi[n]=new Nr(n,1,!1,n.toLowerCase(),null,!1,!1)});Wi.xlinkHref=new Nr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Wi[n]=new Nr(n,1,!1,n.toLowerCase(),null,!0,!0)});function QE(n,e,t,i){var r=Wi.hasOwnProperty(e)?Wi[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(BO(e,t,r,i)&&(t=null),i||r===null?MO(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var bl=LO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ay=Symbol.for("react.element"),id=Symbol.for("react.portal"),rd=Symbol.for("react.fragment"),ZE=Symbol.for("react.strict_mode"),h_=Symbol.for("react.profiler"),AT=Symbol.for("react.provider"),xT=Symbol.for("react.context"),JE=Symbol.for("react.forward_ref"),d_=Symbol.for("react.suspense"),f_=Symbol.for("react.suspense_list"),eA=Symbol.for("react.memo"),Rl=Symbol.for("react.lazy"),ST=Symbol.for("react.offscreen"),lS=Symbol.iterator;function mp(n){return n===null||typeof n!="object"?null:(n=lS&&n[lS]||n["@@iterator"],typeof n=="function"?n:null)}var jn=Object.assign,u1;function Op(n){if(u1===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);u1=e&&e[1]||""}return`
`+u1+n}var c1=!1;function h1(n,e){if(!n||c1)return"";c1=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==s[o]){var l=`
`+r[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{c1=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Op(n):""}function jO(n){switch(n.tag){case 5:return Op(n.type);case 16:return Op("Lazy");case 13:return Op("Suspense");case 19:return Op("SuspenseList");case 0:case 2:case 15:return n=h1(n.type,!1),n;case 11:return n=h1(n.type.render,!1),n;case 1:return n=h1(n.type,!0),n;default:return""}}function p_(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case rd:return"Fragment";case id:return"Portal";case h_:return"Profiler";case ZE:return"StrictMode";case d_:return"Suspense";case f_:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case xT:return(n.displayName||"Context")+".Consumer";case AT:return(n._context.displayName||"Context")+".Provider";case JE:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case eA:return e=n.displayName||null,e!==null?e:p_(n.type)||"Memo";case Rl:e=n._payload,n=n._init;try{return p_(n(e))}catch{}}return null}function zO(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return p_(e);case 8:return e===ZE?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pu(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function CT(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function UO(n){var e=CT(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function oy(n){n._valueTracker||(n._valueTracker=UO(n))}function kT(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=CT(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function P0(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function m_(n,e){var t=e.checked;return jn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function uS(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Pu(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function TT(n,e){e=e.checked,e!=null&&QE(n,"checked",e,!1)}function g_(n,e){TT(n,e);var t=Pu(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?v_(n,e.type,t):e.hasOwnProperty("defaultValue")&&v_(n,e.type,Pu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function cS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function v_(n,e,t){(e!=="number"||P0(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Mp=Array.isArray;function yd(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Pu(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function y_(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(je(91));return jn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function hS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(je(92));if(Mp(t)){if(1<t.length)throw Error(je(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Pu(t)}}function DT(n,e){var t=Pu(e.value),i=Pu(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function dS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function RT(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function b_(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?RT(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var ly,PT=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(ly=ly||document.createElement("div"),ly.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ly.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function ym(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var tm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$O=["Webkit","ms","Moz","O"];Object.keys(tm).forEach(function(n){$O.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),tm[e]=tm[n]})});function NT(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||tm.hasOwnProperty(n)&&tm[n]?(""+e).trim():e+"px"}function IT(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=NT(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var HO=jn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function w_(n,e){if(e){if(HO[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(je(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(je(62))}}function __(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var E_=null;function tA(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var A_=null,bd=null,wd=null;function fS(n){if(n=kv(n)){if(typeof A_!="function")throw Error(je(280));var e=n.stateNode;e&&(e=ew(e),A_(n.stateNode,n.type,e))}}function LT(n){bd?wd?wd.push(n):wd=[n]:bd=n}function OT(){if(bd){var n=bd,e=wd;if(wd=bd=null,fS(n),e)for(n=0;n<e.length;n++)fS(e[n])}}function MT(n,e){return n(e)}function FT(){}var d1=!1;function BT(n,e,t){if(d1)return n(e,t);d1=!0;try{return MT(n,e,t)}finally{d1=!1,(bd!==null||wd!==null)&&(FT(),OT())}}function bm(n,e){var t=n.stateNode;if(t===null)return null;var i=ew(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(je(231,e,typeof t));return t}var x_=!1;if(ll)try{var gp={};Object.defineProperty(gp,"passive",{get:function(){x_=!0}}),window.addEventListener("test",gp,gp),window.removeEventListener("test",gp,gp)}catch{x_=!1}function qO(n,e,t,i,r,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var nm=!1,N0=null,I0=!1,S_=null,WO={onError:function(n){nm=!0,N0=n}};function VO(n,e,t,i,r,s,a,o,l){nm=!1,N0=null,qO.apply(WO,arguments)}function GO(n,e,t,i,r,s,a,o,l){if(VO.apply(this,arguments),nm){if(nm){var u=N0;nm=!1,N0=null}else throw Error(je(198));I0||(I0=!0,S_=u)}}function Ih(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function jT(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function pS(n){if(Ih(n)!==n)throw Error(je(188))}function KO(n){var e=n.alternate;if(!e){if(e=Ih(n),e===null)throw Error(je(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return pS(r),n;if(s===i)return pS(r),e;s=s.sibling}throw Error(je(188))}if(t.return!==i.return)t=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===t){a=!0,t=r,i=s;break}if(o===i){a=!0,i=r,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,i=r;break}if(o===i){a=!0,i=s,t=r;break}o=o.sibling}if(!a)throw Error(je(189))}}if(t.alternate!==i)throw Error(je(190))}if(t.tag!==3)throw Error(je(188));return t.stateNode.current===t?n:e}function zT(n){return n=KO(n),n!==null?UT(n):null}function UT(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=UT(n);if(e!==null)return e;n=n.sibling}return null}var $T=Es.unstable_scheduleCallback,mS=Es.unstable_cancelCallback,XO=Es.unstable_shouldYield,YO=Es.unstable_requestPaint,Qn=Es.unstable_now,QO=Es.unstable_getCurrentPriorityLevel,nA=Es.unstable_ImmediatePriority,HT=Es.unstable_UserBlockingPriority,L0=Es.unstable_NormalPriority,ZO=Es.unstable_LowPriority,qT=Es.unstable_IdlePriority,Yb=null,oo=null;function JO(n){if(oo&&typeof oo.onCommitFiberRoot=="function")try{oo.onCommitFiberRoot(Yb,n,void 0,(n.current.flags&128)===128)}catch{}}var _a=Math.clz32?Math.clz32:nM,eM=Math.log,tM=Math.LN2;function nM(n){return n>>>=0,n===0?32:31-(eM(n)/tM|0)|0}var uy=64,cy=4194304;function Fp(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function O0(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~r;o!==0?i=Fp(o):(s&=a,s!==0&&(i=Fp(s)))}else a=t&~r,a!==0?i=Fp(a):s!==0&&(i=Fp(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-_a(e),r=1<<t,i|=n[t],e&=~r;return i}function iM(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rM(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var a=31-_a(s),o=1<<a,l=r[a];l===-1?(!(o&t)||o&i)&&(r[a]=iM(o,e)):l<=e&&(n.expiredLanes|=o),s&=~o}}function C_(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function WT(){var n=uy;return uy<<=1,!(uy&4194240)&&(uy=64),n}function f1(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Sv(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-_a(e),n[e]=t}function sM(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-_a(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function iA(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-_a(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var an=0;function VT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var GT,rA,KT,XT,YT,k_=!1,hy=[],Eu=null,Au=null,xu=null,wm=new Map,_m=new Map,Nl=[],aM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gS(n,e){switch(n){case"focusin":case"focusout":Eu=null;break;case"dragenter":case"dragleave":Au=null;break;case"mouseover":case"mouseout":xu=null;break;case"pointerover":case"pointerout":wm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_m.delete(e.pointerId)}}function vp(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=kv(e),e!==null&&rA(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function oM(n,e,t,i,r){switch(e){case"focusin":return Eu=vp(Eu,n,e,t,i,r),!0;case"dragenter":return Au=vp(Au,n,e,t,i,r),!0;case"mouseover":return xu=vp(xu,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return wm.set(s,vp(wm.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,_m.set(s,vp(_m.get(s)||null,n,e,t,i,r)),!0}return!1}function QT(n){var e=nc(n.target);if(e!==null){var t=Ih(e);if(t!==null){if(e=t.tag,e===13){if(e=jT(t),e!==null){n.blockedOn=e,YT(n.priority,function(){KT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ly(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=T_(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);E_=i,t.target.dispatchEvent(i),E_=null}else return e=kv(t),e!==null&&rA(e),n.blockedOn=t,!1;e.shift()}return!0}function vS(n,e,t){Ly(n)&&t.delete(e)}function lM(){k_=!1,Eu!==null&&Ly(Eu)&&(Eu=null),Au!==null&&Ly(Au)&&(Au=null),xu!==null&&Ly(xu)&&(xu=null),wm.forEach(vS),_m.forEach(vS)}function yp(n,e){n.blockedOn===e&&(n.blockedOn=null,k_||(k_=!0,Es.unstable_scheduleCallback(Es.unstable_NormalPriority,lM)))}function Em(n){function e(r){return yp(r,n)}if(0<hy.length){yp(hy[0],n);for(var t=1;t<hy.length;t++){var i=hy[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Eu!==null&&yp(Eu,n),Au!==null&&yp(Au,n),xu!==null&&yp(xu,n),wm.forEach(e),_m.forEach(e),t=0;t<Nl.length;t++)i=Nl[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Nl.length&&(t=Nl[0],t.blockedOn===null);)QT(t),t.blockedOn===null&&Nl.shift()}var _d=bl.ReactCurrentBatchConfig,M0=!0;function uM(n,e,t,i){var r=an,s=_d.transition;_d.transition=null;try{an=1,sA(n,e,t,i)}finally{an=r,_d.transition=s}}function cM(n,e,t,i){var r=an,s=_d.transition;_d.transition=null;try{an=4,sA(n,e,t,i)}finally{an=r,_d.transition=s}}function sA(n,e,t,i){if(M0){var r=T_(n,e,t,i);if(r===null)A1(n,e,i,F0,t),gS(n,i);else if(oM(r,n,e,t,i))i.stopPropagation();else if(gS(n,i),e&4&&-1<aM.indexOf(n)){for(;r!==null;){var s=kv(r);if(s!==null&&GT(s),s=T_(n,e,t,i),s===null&&A1(n,e,i,F0,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else A1(n,e,i,null,t)}}var F0=null;function T_(n,e,t,i){if(F0=null,n=tA(i),n=nc(n),n!==null)if(e=Ih(n),e===null)n=null;else if(t=e.tag,t===13){if(n=jT(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return F0=n,null}function ZT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(QO()){case nA:return 1;case HT:return 4;case L0:case ZO:return 16;case qT:return 536870912;default:return 16}default:return 16}}var yu=null,aA=null,Oy=null;function JT(){if(Oy)return Oy;var n,e=aA,t=e.length,i,r="value"in yu?yu.value:yu.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var a=t-n;for(i=1;i<=a&&e[t-i]===r[s-i];i++);return Oy=r.slice(n,1<i?1-i:void 0)}function My(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function dy(){return!0}function yS(){return!1}function xs(n){function e(t,i,r,s,a){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?dy:yS,this.isPropagationStopped=yS,this}return jn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=dy)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=dy)},persist:function(){},isPersistent:dy}),e}var np={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oA=xs(np),Cv=jn({},np,{view:0,detail:0}),hM=xs(Cv),p1,m1,bp,Qb=jn({},Cv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lA,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==bp&&(bp&&n.type==="mousemove"?(p1=n.screenX-bp.screenX,m1=n.screenY-bp.screenY):m1=p1=0,bp=n),p1)},movementY:function(n){return"movementY"in n?n.movementY:m1}}),bS=xs(Qb),dM=jn({},Qb,{dataTransfer:0}),fM=xs(dM),pM=jn({},Cv,{relatedTarget:0}),g1=xs(pM),mM=jn({},np,{animationName:0,elapsedTime:0,pseudoElement:0}),gM=xs(mM),vM=jn({},np,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),yM=xs(vM),bM=jn({},np,{data:0}),wS=xs(bM),wM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_M={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},EM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function AM(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=EM[n])?!!e[n]:!1}function lA(){return AM}var xM=jn({},Cv,{key:function(n){if(n.key){var e=wM[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=My(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?_M[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lA,charCode:function(n){return n.type==="keypress"?My(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?My(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),SM=xs(xM),CM=jn({},Qb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_S=xs(CM),kM=jn({},Cv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lA}),TM=xs(kM),DM=jn({},np,{propertyName:0,elapsedTime:0,pseudoElement:0}),RM=xs(DM),PM=jn({},Qb,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),NM=xs(PM),IM=[9,13,27,32],uA=ll&&"CompositionEvent"in window,im=null;ll&&"documentMode"in document&&(im=document.documentMode);var LM=ll&&"TextEvent"in window&&!im,eD=ll&&(!uA||im&&8<im&&11>=im),ES=" ",AS=!1;function tD(n,e){switch(n){case"keyup":return IM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nD(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var sd=!1;function OM(n,e){switch(n){case"compositionend":return nD(e);case"keypress":return e.which!==32?null:(AS=!0,ES);case"textInput":return n=e.data,n===ES&&AS?null:n;default:return null}}function MM(n,e){if(sd)return n==="compositionend"||!uA&&tD(n,e)?(n=JT(),Oy=aA=yu=null,sd=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eD&&e.locale!=="ko"?null:e.data;default:return null}}var FM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xS(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!FM[n.type]:e==="textarea"}function iD(n,e,t,i){LT(i),e=B0(e,"onChange"),0<e.length&&(t=new oA("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var rm=null,Am=null;function BM(n){pD(n,0)}function Zb(n){var e=ld(n);if(kT(e))return n}function jM(n,e){if(n==="change")return e}var rD=!1;if(ll){var v1;if(ll){var y1="oninput"in document;if(!y1){var SS=document.createElement("div");SS.setAttribute("oninput","return;"),y1=typeof SS.oninput=="function"}v1=y1}else v1=!1;rD=v1&&(!document.documentMode||9<document.documentMode)}function CS(){rm&&(rm.detachEvent("onpropertychange",sD),Am=rm=null)}function sD(n){if(n.propertyName==="value"&&Zb(Am)){var e=[];iD(e,Am,n,tA(n)),BT(BM,e)}}function zM(n,e,t){n==="focusin"?(CS(),rm=e,Am=t,rm.attachEvent("onpropertychange",sD)):n==="focusout"&&CS()}function UM(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Zb(Am)}function $M(n,e){if(n==="click")return Zb(e)}function HM(n,e){if(n==="input"||n==="change")return Zb(e)}function qM(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var xa=typeof Object.is=="function"?Object.is:qM;function xm(n,e){if(xa(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!c_.call(e,r)||!xa(n[r],e[r]))return!1}return!0}function kS(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function TS(n,e){var t=kS(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=kS(t)}}function aD(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?aD(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function oD(){for(var n=window,e=P0();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=P0(n.document)}return e}function cA(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function WM(n){var e=oD(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&aD(t.ownerDocument.documentElement,t)){if(i!==null&&cA(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=TS(t,s);var a=TS(t,i);r&&a&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var VM=ll&&"documentMode"in document&&11>=document.documentMode,ad=null,D_=null,sm=null,R_=!1;function DS(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;R_||ad==null||ad!==P0(i)||(i=ad,"selectionStart"in i&&cA(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),sm&&xm(sm,i)||(sm=i,i=B0(D_,"onSelect"),0<i.length&&(e=new oA("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=ad)))}function fy(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var od={animationend:fy("Animation","AnimationEnd"),animationiteration:fy("Animation","AnimationIteration"),animationstart:fy("Animation","AnimationStart"),transitionend:fy("Transition","TransitionEnd")},b1={},lD={};ll&&(lD=document.createElement("div").style,"AnimationEvent"in window||(delete od.animationend.animation,delete od.animationiteration.animation,delete od.animationstart.animation),"TransitionEvent"in window||delete od.transitionend.transition);function Jb(n){if(b1[n])return b1[n];if(!od[n])return n;var e=od[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in lD)return b1[n]=e[t];return n}var uD=Jb("animationend"),cD=Jb("animationiteration"),hD=Jb("animationstart"),dD=Jb("transitionend"),fD=new Map,RS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fu(n,e){fD.set(n,e),Nh(e,[n])}for(var w1=0;w1<RS.length;w1++){var _1=RS[w1],GM=_1.toLowerCase(),KM=_1[0].toUpperCase()+_1.slice(1);Fu(GM,"on"+KM)}Fu(uD,"onAnimationEnd");Fu(cD,"onAnimationIteration");Fu(hD,"onAnimationStart");Fu("dblclick","onDoubleClick");Fu("focusin","onFocus");Fu("focusout","onBlur");Fu(dD,"onTransitionEnd");Uf("onMouseEnter",["mouseout","mouseover"]);Uf("onMouseLeave",["mouseout","mouseover"]);Uf("onPointerEnter",["pointerout","pointerover"]);Uf("onPointerLeave",["pointerout","pointerover"]);Nh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),XM=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bp));function PS(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,GO(i,e,void 0,n),n.currentTarget=null}function pD(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;PS(r,o,u),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;PS(r,o,u),s=l}}}if(I0)throw n=S_,I0=!1,S_=null,n}function yn(n,e){var t=e[O_];t===void 0&&(t=e[O_]=new Set);var i=n+"__bubble";t.has(i)||(mD(e,n,2,!1),t.add(i))}function E1(n,e,t){var i=0;e&&(i|=4),mD(t,n,i,e)}var py="_reactListening"+Math.random().toString(36).slice(2);function Sm(n){if(!n[py]){n[py]=!0,ET.forEach(function(t){t!=="selectionchange"&&(XM.has(t)||E1(t,!1,n),E1(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[py]||(e[py]=!0,E1("selectionchange",!1,e))}}function mD(n,e,t,i){switch(ZT(e)){case 1:var r=uM;break;case 4:r=cM;break;default:r=sA}t=r.bind(null,e,t,n),r=void 0,!x_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function A1(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=nc(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}BT(function(){var u=s,h=tA(t),d=[];e:{var f=fD.get(n);if(f!==void 0){var m=oA,b=n;switch(n){case"keypress":if(My(t)===0)break e;case"keydown":case"keyup":m=SM;break;case"focusin":b="focus",m=g1;break;case"focusout":b="blur",m=g1;break;case"beforeblur":case"afterblur":m=g1;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=bS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=fM;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=TM;break;case uD:case cD:case hD:m=gM;break;case dD:m=RM;break;case"scroll":m=hM;break;case"wheel":m=NM;break;case"copy":case"cut":case"paste":m=yM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=_S}var _=(e&4)!==0,w=!_&&n==="scroll",v=_?f!==null?f+"Capture":null:f;_=[];for(var y=u,E;y!==null;){E=y;var k=E.stateNode;if(E.tag===5&&k!==null&&(E=k,v!==null&&(k=bm(y,v),k!=null&&_.push(Cm(y,k,E)))),w)break;y=y.return}0<_.length&&(f=new m(f,b,null,t,h),d.push({event:f,listeners:_}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",f&&t!==E_&&(b=t.relatedTarget||t.fromElement)&&(nc(b)||b[ul]))break e;if((m||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,m?(b=t.relatedTarget||t.toElement,m=u,b=b?nc(b):null,b!==null&&(w=Ih(b),b!==w||b.tag!==5&&b.tag!==6)&&(b=null)):(m=null,b=u),m!==b)){if(_=bS,k="onMouseLeave",v="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(_=_S,k="onPointerLeave",v="onPointerEnter",y="pointer"),w=m==null?f:ld(m),E=b==null?f:ld(b),f=new _(k,y+"leave",m,t,h),f.target=w,f.relatedTarget=E,k=null,nc(h)===u&&(_=new _(v,y+"enter",b,t,h),_.target=E,_.relatedTarget=w,k=_),w=k,m&&b)t:{for(_=m,v=b,y=0,E=_;E;E=Uh(E))y++;for(E=0,k=v;k;k=Uh(k))E++;for(;0<y-E;)_=Uh(_),y--;for(;0<E-y;)v=Uh(v),E--;for(;y--;){if(_===v||v!==null&&_===v.alternate)break t;_=Uh(_),v=Uh(v)}_=null}else _=null;m!==null&&NS(d,f,m,_,!1),b!==null&&w!==null&&NS(d,w,b,_,!0)}}e:{if(f=u?ld(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var S=jM;else if(xS(f))if(rD)S=HM;else{S=UM;var D=zM}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=$M);if(S&&(S=S(n,u))){iD(d,S,t,h);break e}D&&D(n,f,u),n==="focusout"&&(D=f._wrapperState)&&D.controlled&&f.type==="number"&&v_(f,"number",f.value)}switch(D=u?ld(u):window,n){case"focusin":(xS(D)||D.contentEditable==="true")&&(ad=D,D_=u,sm=null);break;case"focusout":sm=D_=ad=null;break;case"mousedown":R_=!0;break;case"contextmenu":case"mouseup":case"dragend":R_=!1,DS(d,t,h);break;case"selectionchange":if(VM)break;case"keydown":case"keyup":DS(d,t,h)}var P;if(uA)e:{switch(n){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else sd?tD(n,t)&&(F="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(F="onCompositionStart");F&&(eD&&t.locale!=="ko"&&(sd||F!=="onCompositionStart"?F==="onCompositionEnd"&&sd&&(P=JT()):(yu=h,aA="value"in yu?yu.value:yu.textContent,sd=!0)),D=B0(u,F),0<D.length&&(F=new wS(F,n,null,t,h),d.push({event:F,listeners:D}),P?F.data=P:(P=nD(t),P!==null&&(F.data=P)))),(P=LM?OM(n,t):MM(n,t))&&(u=B0(u,"onBeforeInput"),0<u.length&&(h=new wS("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=P))}pD(d,e)})}function Cm(n,e,t){return{instance:n,listener:e,currentTarget:t}}function B0(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=bm(n,t),s!=null&&i.unshift(Cm(n,s,r)),s=bm(n,e),s!=null&&i.push(Cm(n,s,r))),n=n.return}return i}function Uh(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function NS(n,e,t,i,r){for(var s=e._reactName,a=[];t!==null&&t!==i;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&u!==null&&(o=u,r?(l=bm(t,s),l!=null&&a.unshift(Cm(t,l,o))):r||(l=bm(t,s),l!=null&&a.push(Cm(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var YM=/\r\n?/g,QM=/\u0000|\uFFFD/g;function IS(n){return(typeof n=="string"?n:""+n).replace(YM,`
`).replace(QM,"")}function my(n,e,t){if(e=IS(e),IS(n)!==e&&t)throw Error(je(425))}function j0(){}var P_=null,N_=null;function I_(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var L_=typeof setTimeout=="function"?setTimeout:void 0,ZM=typeof clearTimeout=="function"?clearTimeout:void 0,LS=typeof Promise=="function"?Promise:void 0,JM=typeof queueMicrotask=="function"?queueMicrotask:typeof LS<"u"?function(n){return LS.resolve(null).then(n).catch(eF)}:L_;function eF(n){setTimeout(function(){throw n})}function x1(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),Em(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);Em(e)}function Su(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function OS(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var ip=Math.random().toString(36).slice(2),so="__reactFiber$"+ip,km="__reactProps$"+ip,ul="__reactContainer$"+ip,O_="__reactEvents$"+ip,tF="__reactListeners$"+ip,nF="__reactHandles$"+ip;function nc(n){var e=n[so];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ul]||t[so]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=OS(n);n!==null;){if(t=n[so])return t;n=OS(n)}return e}n=t,t=n.parentNode}return null}function kv(n){return n=n[so]||n[ul],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function ld(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(je(33))}function ew(n){return n[km]||null}var M_=[],ud=-1;function Bu(n){return{current:n}}function _n(n){0>ud||(n.current=M_[ud],M_[ud]=null,ud--)}function gn(n,e){ud++,M_[ud]=n.current,n.current=e}var Nu={},hr=Bu(Nu),Vr=Bu(!1),_h=Nu;function $f(n,e){var t=n.type.contextTypes;if(!t)return Nu;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Gr(n){return n=n.childContextTypes,n!=null}function z0(){_n(Vr),_n(hr)}function MS(n,e,t){if(hr.current!==Nu)throw Error(je(168));gn(hr,e),gn(Vr,t)}function gD(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(je(108,zO(n)||"Unknown",r));return jn({},t,i)}function U0(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Nu,_h=hr.current,gn(hr,n),gn(Vr,Vr.current),!0}function FS(n,e,t){var i=n.stateNode;if(!i)throw Error(je(169));t?(n=gD(n,e,_h),i.__reactInternalMemoizedMergedChildContext=n,_n(Vr),_n(hr),gn(hr,n)):_n(Vr),gn(Vr,t)}var So=null,tw=!1,S1=!1;function vD(n){So===null?So=[n]:So.push(n)}function iF(n){tw=!0,vD(n)}function ju(){if(!S1&&So!==null){S1=!0;var n=0,e=an;try{var t=So;for(an=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}So=null,tw=!1}catch(r){throw So!==null&&(So=So.slice(n+1)),$T(nA,ju),r}finally{an=e,S1=!1}}return null}var cd=[],hd=0,$0=null,H0=0,Fs=[],Bs=0,Eh=null,Jo=1,el="";function Xu(n,e){cd[hd++]=H0,cd[hd++]=$0,$0=n,H0=e}function yD(n,e,t){Fs[Bs++]=Jo,Fs[Bs++]=el,Fs[Bs++]=Eh,Eh=n;var i=Jo;n=el;var r=32-_a(i)-1;i&=~(1<<r),t+=1;var s=32-_a(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Jo=1<<32-_a(e)+r|t<<r|i,el=s+n}else Jo=1<<s|t<<r|i,el=n}function hA(n){n.return!==null&&(Xu(n,1),yD(n,1,0))}function dA(n){for(;n===$0;)$0=cd[--hd],cd[hd]=null,H0=cd[--hd],cd[hd]=null;for(;n===Eh;)Eh=Fs[--Bs],Fs[Bs]=null,el=Fs[--Bs],Fs[Bs]=null,Jo=Fs[--Bs],Fs[Bs]=null}var ws=null,bs=null,Tn=!1,ba=null;function bD(n,e){var t=Us(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function BS(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ws=n,bs=Su(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ws=n,bs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Eh!==null?{id:Jo,overflow:el}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Us(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,ws=n,bs=null,!0):!1;default:return!1}}function F_(n){return(n.mode&1)!==0&&(n.flags&128)===0}function B_(n){if(Tn){var e=bs;if(e){var t=e;if(!BS(n,e)){if(F_(n))throw Error(je(418));e=Su(t.nextSibling);var i=ws;e&&BS(n,e)?bD(i,t):(n.flags=n.flags&-4097|2,Tn=!1,ws=n)}}else{if(F_(n))throw Error(je(418));n.flags=n.flags&-4097|2,Tn=!1,ws=n}}}function jS(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ws=n}function gy(n){if(n!==ws)return!1;if(!Tn)return jS(n),Tn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!I_(n.type,n.memoizedProps)),e&&(e=bs)){if(F_(n))throw wD(),Error(je(418));for(;e;)bD(n,e),e=Su(e.nextSibling)}if(jS(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(je(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){bs=Su(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}bs=null}}else bs=ws?Su(n.stateNode.nextSibling):null;return!0}function wD(){for(var n=bs;n;)n=Su(n.nextSibling)}function Hf(){bs=ws=null,Tn=!1}function fA(n){ba===null?ba=[n]:ba.push(n)}var rF=bl.ReactCurrentBatchConfig;function wp(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(je(309));var i=t.stateNode}if(!i)throw Error(je(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=r.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof n!="string")throw Error(je(284));if(!t._owner)throw Error(je(290,n))}return n}function vy(n,e){throw n=Object.prototype.toString.call(e),Error(je(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function zS(n){var e=n._init;return e(n._payload)}function _D(n){function e(v,y){if(n){var E=v.deletions;E===null?(v.deletions=[y],v.flags|=16):E.push(y)}}function t(v,y){if(!n)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function i(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function r(v,y){return v=Du(v,y),v.index=0,v.sibling=null,v}function s(v,y,E){return v.index=E,n?(E=v.alternate,E!==null?(E=E.index,E<y?(v.flags|=2,y):E):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,y,E,k){return y===null||y.tag!==6?(y=N1(E,v.mode,k),y.return=v,y):(y=r(y,E),y.return=v,y)}function l(v,y,E,k){var S=E.type;return S===rd?h(v,y,E.props.children,k,E.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Rl&&zS(S)===y.type)?(k=r(y,E.props),k.ref=wp(v,y,E),k.return=v,k):(k=Hy(E.type,E.key,E.props,null,v.mode,k),k.ref=wp(v,y,E),k.return=v,k)}function u(v,y,E,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==E.containerInfo||y.stateNode.implementation!==E.implementation?(y=I1(E,v.mode,k),y.return=v,y):(y=r(y,E.children||[]),y.return=v,y)}function h(v,y,E,k,S){return y===null||y.tag!==7?(y=bh(E,v.mode,k,S),y.return=v,y):(y=r(y,E),y.return=v,y)}function d(v,y,E){if(typeof y=="string"&&y!==""||typeof y=="number")return y=N1(""+y,v.mode,E),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ay:return E=Hy(y.type,y.key,y.props,null,v.mode,E),E.ref=wp(v,null,y),E.return=v,E;case id:return y=I1(y,v.mode,E),y.return=v,y;case Rl:var k=y._init;return d(v,k(y._payload),E)}if(Mp(y)||mp(y))return y=bh(y,v.mode,E,null),y.return=v,y;vy(v,y)}return null}function f(v,y,E,k){var S=y!==null?y.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return S!==null?null:o(v,y,""+E,k);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ay:return E.key===S?l(v,y,E,k):null;case id:return E.key===S?u(v,y,E,k):null;case Rl:return S=E._init,f(v,y,S(E._payload),k)}if(Mp(E)||mp(E))return S!==null?null:h(v,y,E,k,null);vy(v,E)}return null}function m(v,y,E,k,S){if(typeof k=="string"&&k!==""||typeof k=="number")return v=v.get(E)||null,o(y,v,""+k,S);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ay:return v=v.get(k.key===null?E:k.key)||null,l(y,v,k,S);case id:return v=v.get(k.key===null?E:k.key)||null,u(y,v,k,S);case Rl:var D=k._init;return m(v,y,E,D(k._payload),S)}if(Mp(k)||mp(k))return v=v.get(E)||null,h(y,v,k,S,null);vy(y,k)}return null}function b(v,y,E,k){for(var S=null,D=null,P=y,F=y=0,H=null;P!==null&&F<E.length;F++){P.index>F?(H=P,P=null):H=P.sibling;var z=f(v,P,E[F],k);if(z===null){P===null&&(P=H);break}n&&P&&z.alternate===null&&e(v,P),y=s(z,y,F),D===null?S=z:D.sibling=z,D=z,P=H}if(F===E.length)return t(v,P),Tn&&Xu(v,F),S;if(P===null){for(;F<E.length;F++)P=d(v,E[F],k),P!==null&&(y=s(P,y,F),D===null?S=P:D.sibling=P,D=P);return Tn&&Xu(v,F),S}for(P=i(v,P);F<E.length;F++)H=m(P,v,F,E[F],k),H!==null&&(n&&H.alternate!==null&&P.delete(H.key===null?F:H.key),y=s(H,y,F),D===null?S=H:D.sibling=H,D=H);return n&&P.forEach(function(te){return e(v,te)}),Tn&&Xu(v,F),S}function _(v,y,E,k){var S=mp(E);if(typeof S!="function")throw Error(je(150));if(E=S.call(E),E==null)throw Error(je(151));for(var D=S=null,P=y,F=y=0,H=null,z=E.next();P!==null&&!z.done;F++,z=E.next()){P.index>F?(H=P,P=null):H=P.sibling;var te=f(v,P,z.value,k);if(te===null){P===null&&(P=H);break}n&&P&&te.alternate===null&&e(v,P),y=s(te,y,F),D===null?S=te:D.sibling=te,D=te,P=H}if(z.done)return t(v,P),Tn&&Xu(v,F),S;if(P===null){for(;!z.done;F++,z=E.next())z=d(v,z.value,k),z!==null&&(y=s(z,y,F),D===null?S=z:D.sibling=z,D=z);return Tn&&Xu(v,F),S}for(P=i(v,P);!z.done;F++,z=E.next())z=m(P,v,F,z.value,k),z!==null&&(n&&z.alternate!==null&&P.delete(z.key===null?F:z.key),y=s(z,y,F),D===null?S=z:D.sibling=z,D=z);return n&&P.forEach(function(de){return e(v,de)}),Tn&&Xu(v,F),S}function w(v,y,E,k){if(typeof E=="object"&&E!==null&&E.type===rd&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case ay:e:{for(var S=E.key,D=y;D!==null;){if(D.key===S){if(S=E.type,S===rd){if(D.tag===7){t(v,D.sibling),y=r(D,E.props.children),y.return=v,v=y;break e}}else if(D.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Rl&&zS(S)===D.type){t(v,D.sibling),y=r(D,E.props),y.ref=wp(v,D,E),y.return=v,v=y;break e}t(v,D);break}else e(v,D);D=D.sibling}E.type===rd?(y=bh(E.props.children,v.mode,k,E.key),y.return=v,v=y):(k=Hy(E.type,E.key,E.props,null,v.mode,k),k.ref=wp(v,y,E),k.return=v,v=k)}return a(v);case id:e:{for(D=E.key;y!==null;){if(y.key===D)if(y.tag===4&&y.stateNode.containerInfo===E.containerInfo&&y.stateNode.implementation===E.implementation){t(v,y.sibling),y=r(y,E.children||[]),y.return=v,v=y;break e}else{t(v,y);break}else e(v,y);y=y.sibling}y=I1(E,v.mode,k),y.return=v,v=y}return a(v);case Rl:return D=E._init,w(v,y,D(E._payload),k)}if(Mp(E))return b(v,y,E,k);if(mp(E))return _(v,y,E,k);vy(v,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,y!==null&&y.tag===6?(t(v,y.sibling),y=r(y,E),y.return=v,v=y):(t(v,y),y=N1(E,v.mode,k),y.return=v,v=y),a(v)):t(v,y)}return w}var qf=_D(!0),ED=_D(!1),q0=Bu(null),W0=null,dd=null,pA=null;function mA(){pA=dd=W0=null}function gA(n){var e=q0.current;_n(q0),n._currentValue=e}function j_(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Ed(n,e){W0=n,pA=dd=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Wr=!0),n.firstContext=null)}function qs(n){var e=n._currentValue;if(pA!==n)if(n={context:n,memoizedValue:e,next:null},dd===null){if(W0===null)throw Error(je(308));dd=n,W0.dependencies={lanes:0,firstContext:n}}else dd=dd.next=n;return e}var ic=null;function vA(n){ic===null?ic=[n]:ic.push(n)}function AD(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,vA(e)):(t.next=r.next,r.next=t),e.interleaved=t,cl(n,i)}function cl(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Pl=!1;function yA(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xD(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function rl(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Cu(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Gt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,cl(n,t)}return r=i.interleaved,r===null?(e.next=e,vA(i)):(e.next=r.next,r.next=e),i.interleaved=e,cl(n,t)}function Fy(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,iA(n,t)}}function US(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function V0(n,e,t,i){var r=n.updateQueue;Pl=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;a=0,h=u=l=null,o=s;do{var f=o.lane,m=o.eventTime;if((i&f)===f){h!==null&&(h=h.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var b=n,_=o;switch(f=e,m=t,_.tag){case 1:if(b=_.payload,typeof b=="function"){d=b.call(m,d,f);break e}d=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=_.payload,f=typeof b=="function"?b.call(m,d,f):b,f==null)break e;d=jn({},d,f);break e;case 2:Pl=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,f=r.effects,f===null?r.effects=[o]:f.push(o))}else m={eventTime:m,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=m,l=d):h=h.next=m,a|=f;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;f=o,o=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(h===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);xh|=a,n.lanes=a,n.memoizedState=d}}function $S(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(je(191,r));r.call(i)}}}var Tv={},lo=Bu(Tv),Tm=Bu(Tv),Dm=Bu(Tv);function rc(n){if(n===Tv)throw Error(je(174));return n}function bA(n,e){switch(gn(Dm,e),gn(Tm,n),gn(lo,Tv),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:b_(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=b_(e,n)}_n(lo),gn(lo,e)}function Wf(){_n(lo),_n(Tm),_n(Dm)}function SD(n){rc(Dm.current);var e=rc(lo.current),t=b_(e,n.type);e!==t&&(gn(Tm,n),gn(lo,t))}function wA(n){Tm.current===n&&(_n(lo),_n(Tm))}var Mn=Bu(0);function G0(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var C1=[];function _A(){for(var n=0;n<C1.length;n++)C1[n]._workInProgressVersionPrimary=null;C1.length=0}var By=bl.ReactCurrentDispatcher,k1=bl.ReactCurrentBatchConfig,Ah=0,Bn=null,pi=null,Ri=null,K0=!1,am=!1,Rm=0,sF=0;function Qi(){throw Error(je(321))}function EA(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!xa(n[t],e[t]))return!1;return!0}function AA(n,e,t,i,r,s){if(Ah=s,Bn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,By.current=n===null||n.memoizedState===null?uF:cF,n=t(i,r),am){s=0;do{if(am=!1,Rm=0,25<=s)throw Error(je(301));s+=1,Ri=pi=null,e.updateQueue=null,By.current=hF,n=t(i,r)}while(am)}if(By.current=X0,e=pi!==null&&pi.next!==null,Ah=0,Ri=pi=Bn=null,K0=!1,e)throw Error(je(300));return n}function xA(){var n=Rm!==0;return Rm=0,n}function Fa(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ri===null?Bn.memoizedState=Ri=n:Ri=Ri.next=n,Ri}function Ws(){if(pi===null){var n=Bn.alternate;n=n!==null?n.memoizedState:null}else n=pi.next;var e=Ri===null?Bn.memoizedState:Ri.next;if(e!==null)Ri=e,pi=n;else{if(n===null)throw Error(je(310));pi=n,n={memoizedState:pi.memoizedState,baseState:pi.baseState,baseQueue:pi.baseQueue,queue:pi.queue,next:null},Ri===null?Bn.memoizedState=Ri=n:Ri=Ri.next=n}return Ri}function Pm(n,e){return typeof e=="function"?e(n):e}function T1(n){var e=Ws(),t=e.queue;if(t===null)throw Error(je(311));t.lastRenderedReducer=n;var i=pi,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var o=a=null,l=null,u=s;do{var h=u.lane;if((Ah&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,a=i):l=l.next=d,Bn.lanes|=h,xh|=h}u=u.next}while(u!==null&&u!==s);l===null?a=i:l.next=o,xa(i,e.memoizedState)||(Wr=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,Bn.lanes|=s,xh|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function D1(n){var e=Ws(),t=e.queue;if(t===null)throw Error(je(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var a=r=r.next;do s=n(s,a.action),a=a.next;while(a!==r);xa(s,e.memoizedState)||(Wr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function CD(){}function kD(n,e){var t=Bn,i=Ws(),r=e(),s=!xa(i.memoizedState,r);if(s&&(i.memoizedState=r,Wr=!0),i=i.queue,SA(RD.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Ri!==null&&Ri.memoizedState.tag&1){if(t.flags|=2048,Nm(9,DD.bind(null,t,i,r,e),void 0,null),Pi===null)throw Error(je(349));Ah&30||TD(t,e,r)}return r}function TD(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Bn.updateQueue,e===null?(e={lastEffect:null,stores:null},Bn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function DD(n,e,t,i){e.value=t,e.getSnapshot=i,PD(e)&&ND(n)}function RD(n,e,t){return t(function(){PD(e)&&ND(n)})}function PD(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!xa(n,t)}catch{return!0}}function ND(n){var e=cl(n,1);e!==null&&Ea(e,n,1,-1)}function HS(n){var e=Fa();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pm,lastRenderedState:n},e.queue=n,n=n.dispatch=lF.bind(null,Bn,n),[e.memoizedState,n]}function Nm(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Bn.updateQueue,e===null?(e={lastEffect:null,stores:null},Bn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function ID(){return Ws().memoizedState}function jy(n,e,t,i){var r=Fa();Bn.flags|=n,r.memoizedState=Nm(1|e,t,void 0,i===void 0?null:i)}function nw(n,e,t,i){var r=Ws();i=i===void 0?null:i;var s=void 0;if(pi!==null){var a=pi.memoizedState;if(s=a.destroy,i!==null&&EA(i,a.deps)){r.memoizedState=Nm(e,t,s,i);return}}Bn.flags|=n,r.memoizedState=Nm(1|e,t,s,i)}function qS(n,e){return jy(8390656,8,n,e)}function SA(n,e){return nw(2048,8,n,e)}function LD(n,e){return nw(4,2,n,e)}function OD(n,e){return nw(4,4,n,e)}function MD(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function FD(n,e,t){return t=t!=null?t.concat([n]):null,nw(4,4,MD.bind(null,e,n),t)}function CA(){}function BD(n,e){var t=Ws();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&EA(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function jD(n,e){var t=Ws();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&EA(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function zD(n,e,t){return Ah&21?(xa(t,e)||(t=WT(),Bn.lanes|=t,xh|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Wr=!0),n.memoizedState=t)}function aF(n,e){var t=an;an=t!==0&&4>t?t:4,n(!0);var i=k1.transition;k1.transition={};try{n(!1),e()}finally{an=t,k1.transition=i}}function UD(){return Ws().memoizedState}function oF(n,e,t){var i=Tu(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},$D(n))HD(e,t);else if(t=AD(n,e,t,i),t!==null){var r=kr();Ea(t,n,i,r),qD(t,e,i)}}function lF(n,e,t){var i=Tu(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if($D(n))HD(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(r.hasEagerState=!0,r.eagerState=o,xa(o,a)){var l=e.interleaved;l===null?(r.next=r,vA(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=AD(n,e,r,i),t!==null&&(r=kr(),Ea(t,n,i,r),qD(t,e,i))}}function $D(n){var e=n.alternate;return n===Bn||e!==null&&e===Bn}function HD(n,e){am=K0=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function qD(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,iA(n,t)}}var X0={readContext:qs,useCallback:Qi,useContext:Qi,useEffect:Qi,useImperativeHandle:Qi,useInsertionEffect:Qi,useLayoutEffect:Qi,useMemo:Qi,useReducer:Qi,useRef:Qi,useState:Qi,useDebugValue:Qi,useDeferredValue:Qi,useTransition:Qi,useMutableSource:Qi,useSyncExternalStore:Qi,useId:Qi,unstable_isNewReconciler:!1},uF={readContext:qs,useCallback:function(n,e){return Fa().memoizedState=[n,e===void 0?null:e],n},useContext:qs,useEffect:qS,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,jy(4194308,4,MD.bind(null,e,n),t)},useLayoutEffect:function(n,e){return jy(4194308,4,n,e)},useInsertionEffect:function(n,e){return jy(4,2,n,e)},useMemo:function(n,e){var t=Fa();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Fa();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=oF.bind(null,Bn,n),[i.memoizedState,n]},useRef:function(n){var e=Fa();return n={current:n},e.memoizedState=n},useState:HS,useDebugValue:CA,useDeferredValue:function(n){return Fa().memoizedState=n},useTransition:function(){var n=HS(!1),e=n[0];return n=aF.bind(null,n[1]),Fa().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Bn,r=Fa();if(Tn){if(t===void 0)throw Error(je(407));t=t()}else{if(t=e(),Pi===null)throw Error(je(349));Ah&30||TD(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,qS(RD.bind(null,i,s,n),[n]),i.flags|=2048,Nm(9,DD.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=Fa(),e=Pi.identifierPrefix;if(Tn){var t=el,i=Jo;t=(i&~(1<<32-_a(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Rm++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=sF++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},cF={readContext:qs,useCallback:BD,useContext:qs,useEffect:SA,useImperativeHandle:FD,useInsertionEffect:LD,useLayoutEffect:OD,useMemo:jD,useReducer:T1,useRef:ID,useState:function(){return T1(Pm)},useDebugValue:CA,useDeferredValue:function(n){var e=Ws();return zD(e,pi.memoizedState,n)},useTransition:function(){var n=T1(Pm)[0],e=Ws().memoizedState;return[n,e]},useMutableSource:CD,useSyncExternalStore:kD,useId:UD,unstable_isNewReconciler:!1},hF={readContext:qs,useCallback:BD,useContext:qs,useEffect:SA,useImperativeHandle:FD,useInsertionEffect:LD,useLayoutEffect:OD,useMemo:jD,useReducer:D1,useRef:ID,useState:function(){return D1(Pm)},useDebugValue:CA,useDeferredValue:function(n){var e=Ws();return pi===null?e.memoizedState=n:zD(e,pi.memoizedState,n)},useTransition:function(){var n=D1(Pm)[0],e=Ws().memoizedState;return[n,e]},useMutableSource:CD,useSyncExternalStore:kD,useId:UD,unstable_isNewReconciler:!1};function Js(n,e){if(n&&n.defaultProps){e=jn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function z_(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:jn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var iw={isMounted:function(n){return(n=n._reactInternals)?Ih(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=kr(),r=Tu(n),s=rl(i,r);s.payload=e,t!=null&&(s.callback=t),e=Cu(n,s,r),e!==null&&(Ea(e,n,r,i),Fy(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=kr(),r=Tu(n),s=rl(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Cu(n,s,r),e!==null&&(Ea(e,n,r,i),Fy(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=kr(),i=Tu(n),r=rl(t,i);r.tag=2,e!=null&&(r.callback=e),e=Cu(n,r,i),e!==null&&(Ea(e,n,i,t),Fy(e,n,i))}};function WS(n,e,t,i,r,s,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!xm(t,i)||!xm(r,s):!0}function WD(n,e,t){var i=!1,r=Nu,s=e.contextType;return typeof s=="object"&&s!==null?s=qs(s):(r=Gr(e)?_h:hr.current,i=e.contextTypes,s=(i=i!=null)?$f(n,r):Nu),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=iw,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function VS(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&iw.enqueueReplaceState(e,e.state,null)}function U_(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},yA(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=qs(s):(s=Gr(e)?_h:hr.current,r.context=$f(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(z_(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&iw.enqueueReplaceState(r,r.state,null),V0(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function Vf(n,e){try{var t="",i=e;do t+=jO(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function R1(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function $_(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var dF=typeof WeakMap=="function"?WeakMap:Map;function VD(n,e,t){t=rl(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Q0||(Q0=!0,Z_=i),$_(n,e)},t}function GD(n,e,t){t=rl(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){$_(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){$_(n,e),typeof i!="function"&&(ku===null?ku=new Set([this]):ku.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function GS(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new dF;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=CF.bind(null,n,e,t),e.then(n,n))}function KS(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function XS(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=rl(-1,1),e.tag=2,Cu(t,e,1))),t.lanes|=1),n)}var fF=bl.ReactCurrentOwner,Wr=!1;function xr(n,e,t,i){e.child=n===null?ED(e,null,t,i):qf(e,n.child,t,i)}function YS(n,e,t,i,r){t=t.render;var s=e.ref;return Ed(e,r),i=AA(n,e,t,i,s,r),t=xA(),n!==null&&!Wr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,hl(n,e,r)):(Tn&&t&&hA(e),e.flags|=1,xr(n,e,i,r),e.child)}function QS(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!LA(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,KD(n,e,s,i,r)):(n=Hy(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:xm,t(a,i)&&n.ref===e.ref)return hl(n,e,r)}return e.flags|=1,n=Du(s,i),n.ref=e.ref,n.return=e,e.child=n}function KD(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(xm(s,i)&&n.ref===e.ref)if(Wr=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(Wr=!0);else return e.lanes=n.lanes,hl(n,e,r)}return H_(n,e,t,i,r)}function XD(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},gn(pd,gs),gs|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,gn(pd,gs),gs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,gn(pd,gs),gs|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,gn(pd,gs),gs|=i;return xr(n,e,r,t),e.child}function YD(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function H_(n,e,t,i,r){var s=Gr(t)?_h:hr.current;return s=$f(e,s),Ed(e,r),t=AA(n,e,t,i,s,r),i=xA(),n!==null&&!Wr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,hl(n,e,r)):(Tn&&i&&hA(e),e.flags|=1,xr(n,e,t,r),e.child)}function ZS(n,e,t,i,r){if(Gr(t)){var s=!0;U0(e)}else s=!1;if(Ed(e,r),e.stateNode===null)zy(n,e),WD(e,t,i),U_(e,t,i,r),i=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=qs(u):(u=Gr(t)?_h:hr.current,u=$f(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==u)&&VS(e,a,i,u),Pl=!1;var f=e.memoizedState;a.state=f,V0(e,i,a,r),l=e.memoizedState,o!==i||f!==l||Vr.current||Pl?(typeof h=="function"&&(z_(e,t,h,i),l=e.memoizedState),(o=Pl||WS(e,t,o,i,f,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=u,i=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,xD(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:Js(e.type,o),a.props=u,d=e.pendingProps,f=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=qs(l):(l=Gr(t)?_h:hr.current,l=$f(e,l));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==l)&&VS(e,a,i,l),Pl=!1,f=e.memoizedState,a.state=f,V0(e,i,a,r);var b=e.memoizedState;o!==d||f!==b||Vr.current||Pl?(typeof m=="function"&&(z_(e,t,m,i),b=e.memoizedState),(u=Pl||WS(e,t,u,i,f,b,l)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,b,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,b,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=b),a.props=i,a.state=b,a.context=l,i=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),i=!1)}return q_(n,e,t,i,s,r)}function q_(n,e,t,i,r,s){YD(n,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&FS(e,t,!1),hl(n,e,s);i=e.stateNode,fF.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&a?(e.child=qf(e,n.child,null,s),e.child=qf(e,null,o,s)):xr(n,e,o,s),e.memoizedState=i.state,r&&FS(e,t,!0),e.child}function QD(n){var e=n.stateNode;e.pendingContext?MS(n,e.pendingContext,e.pendingContext!==e.context):e.context&&MS(n,e.context,!1),bA(n,e.containerInfo)}function JS(n,e,t,i,r){return Hf(),fA(r),e.flags|=256,xr(n,e,t,i),e.child}var W_={dehydrated:null,treeContext:null,retryLane:0};function V_(n){return{baseLanes:n,cachePool:null,transitions:null}}function ZD(n,e,t){var i=e.pendingProps,r=Mn.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(r&2)!==0),o?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),gn(Mn,r&1),n===null)return B_(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,n=i.fallback,s?(i=e.mode,s=e.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=aw(a,i,0,null),n=bh(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=V_(t),e.memoizedState=W_,n):kA(e,a));if(r=n.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return pF(n,e,a,i,o,r,t);if(s){s=i.fallback,a=e.mode,r=n.child,o=r.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Du(r,l),i.subtreeFlags=r.subtreeFlags&14680064),o!==null?s=Du(o,s):(s=bh(s,a,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,a=n.child.memoizedState,a=a===null?V_(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=n.childLanes&~t,e.memoizedState=W_,i}return s=n.child,n=s.sibling,i=Du(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function kA(n,e){return e=aw({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function yy(n,e,t,i){return i!==null&&fA(i),qf(e,n.child,null,t),n=kA(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function pF(n,e,t,i,r,s,a){if(t)return e.flags&256?(e.flags&=-257,i=R1(Error(je(422))),yy(n,e,a,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=aw({mode:"visible",children:i.children},r,0,null),s=bh(s,r,a,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&qf(e,n.child,null,a),e.child.memoizedState=V_(a),e.memoizedState=W_,s);if(!(e.mode&1))return yy(n,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(je(419)),i=R1(s,i,void 0),yy(n,e,a,i)}if(o=(a&n.childLanes)!==0,Wr||o){if(i=Pi,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,cl(n,r),Ea(i,n,r,-1))}return IA(),i=R1(Error(je(421))),yy(n,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=kF.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,bs=Su(r.nextSibling),ws=e,Tn=!0,ba=null,n!==null&&(Fs[Bs++]=Jo,Fs[Bs++]=el,Fs[Bs++]=Eh,Jo=n.id,el=n.overflow,Eh=e),e=kA(e,i.children),e.flags|=4096,e)}function eC(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),j_(n.return,e,t)}function P1(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function JD(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(xr(n,e,i.children,t),i=Mn.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&eC(n,t,e);else if(n.tag===19)eC(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(gn(Mn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&G0(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),P1(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&G0(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}P1(e,!0,t,null,s);break;case"together":P1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function zy(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function hl(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),xh|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(je(153));if(e.child!==null){for(n=e.child,t=Du(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Du(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function mF(n,e,t){switch(e.tag){case 3:QD(e),Hf();break;case 5:SD(e);break;case 1:Gr(e.type)&&U0(e);break;case 4:bA(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;gn(q0,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(gn(Mn,Mn.current&1),e.flags|=128,null):t&e.child.childLanes?ZD(n,e,t):(gn(Mn,Mn.current&1),n=hl(n,e,t),n!==null?n.sibling:null);gn(Mn,Mn.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return JD(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),gn(Mn,Mn.current),i)break;return null;case 22:case 23:return e.lanes=0,XD(n,e,t)}return hl(n,e,t)}var eR,G_,tR,nR;eR=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};G_=function(){};tR=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,rc(lo.current);var s=null;switch(t){case"input":r=m_(n,r),i=m_(n,i),s=[];break;case"select":r=jn({},r,{value:void 0}),i=jn({},i,{value:void 0}),s=[];break;case"textarea":r=y_(n,r),i=y_(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=j0)}w_(t,i);var a;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var o=r[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vm.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(o=r?.[u],i.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vm.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&yn("scroll",n),s||o===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};nR=function(n,e,t,i){t!==i&&(e.flags|=4)};function _p(n,e){if(!Tn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Zi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function gF(n,e,t){var i=e.pendingProps;switch(dA(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zi(e),null;case 1:return Gr(e.type)&&z0(),Zi(e),null;case 3:return i=e.stateNode,Wf(),_n(Vr),_n(hr),_A(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(gy(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ba!==null&&(t2(ba),ba=null))),G_(n,e),Zi(e),null;case 5:wA(e);var r=rc(Dm.current);if(t=e.type,n!==null&&e.stateNode!=null)tR(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(je(166));return Zi(e),null}if(n=rc(lo.current),gy(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[so]=e,i[km]=s,n=(e.mode&1)!==0,t){case"dialog":yn("cancel",i),yn("close",i);break;case"iframe":case"object":case"embed":yn("load",i);break;case"video":case"audio":for(r=0;r<Bp.length;r++)yn(Bp[r],i);break;case"source":yn("error",i);break;case"img":case"image":case"link":yn("error",i),yn("load",i);break;case"details":yn("toggle",i);break;case"input":uS(i,s),yn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},yn("invalid",i);break;case"textarea":hS(i,s),yn("invalid",i)}w_(t,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&my(i.textContent,o,n),r=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&my(i.textContent,o,n),r=["children",""+o]):vm.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&yn("scroll",i)}switch(t){case"input":oy(i),cS(i,s,!0);break;case"textarea":oy(i),dS(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=j0)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=RT(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=a.createElement(t,{is:i.is}):(n=a.createElement(t),t==="select"&&(a=n,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):n=a.createElementNS(n,t),n[so]=e,n[km]=i,eR(n,e,!1,!1),e.stateNode=n;e:{switch(a=__(t,i),t){case"dialog":yn("cancel",n),yn("close",n),r=i;break;case"iframe":case"object":case"embed":yn("load",n),r=i;break;case"video":case"audio":for(r=0;r<Bp.length;r++)yn(Bp[r],n);r=i;break;case"source":yn("error",n),r=i;break;case"img":case"image":case"link":yn("error",n),yn("load",n),r=i;break;case"details":yn("toggle",n),r=i;break;case"input":uS(n,i),r=m_(n,i),yn("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=jn({},i,{value:void 0}),yn("invalid",n);break;case"textarea":hS(n,i),r=y_(n,i),yn("invalid",n);break;default:r=i}w_(t,r),o=r;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?IT(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&PT(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&ym(n,l):typeof l=="number"&&ym(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(vm.hasOwnProperty(s)?l!=null&&s==="onScroll"&&yn("scroll",n):l!=null&&QE(n,s,l,a))}switch(t){case"input":oy(n),cS(n,i,!1);break;case"textarea":oy(n),dS(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Pu(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?yd(n,!!i.multiple,s,!1):i.defaultValue!=null&&yd(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=j0)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zi(e),null;case 6:if(n&&e.stateNode!=null)nR(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(je(166));if(t=rc(Dm.current),rc(lo.current),gy(e)){if(i=e.stateNode,t=e.memoizedProps,i[so]=e,(s=i.nodeValue!==t)&&(n=ws,n!==null))switch(n.tag){case 3:my(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&my(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[so]=e,e.stateNode=i}return Zi(e),null;case 13:if(_n(Mn),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Tn&&bs!==null&&e.mode&1&&!(e.flags&128))wD(),Hf(),e.flags|=98560,s=!1;else if(s=gy(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(je(317));s[so]=e}else Hf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zi(e),s=!1}else ba!==null&&(t2(ba),ba=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Mn.current&1?mi===0&&(mi=3):IA())),e.updateQueue!==null&&(e.flags|=4),Zi(e),null);case 4:return Wf(),G_(n,e),n===null&&Sm(e.stateNode.containerInfo),Zi(e),null;case 10:return gA(e.type._context),Zi(e),null;case 17:return Gr(e.type)&&z0(),Zi(e),null;case 19:if(_n(Mn),s=e.memoizedState,s===null)return Zi(e),null;if(i=(e.flags&128)!==0,a=s.rendering,a===null)if(i)_p(s,!1);else{if(mi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=G0(n),a!==null){for(e.flags|=128,_p(s,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,n=a.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return gn(Mn,Mn.current&1|2),e.child}n=n.sibling}s.tail!==null&&Qn()>Gf&&(e.flags|=128,i=!0,_p(s,!1),e.lanes=4194304)}else{if(!i)if(n=G0(a),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),_p(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Tn)return Zi(e),null}else 2*Qn()-s.renderingStartTime>Gf&&t!==1073741824&&(e.flags|=128,i=!0,_p(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Qn(),e.sibling=null,t=Mn.current,gn(Mn,i?t&1|2:t&1),e):(Zi(e),null);case 22:case 23:return NA(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?gs&1073741824&&(Zi(e),e.subtreeFlags&6&&(e.flags|=8192)):Zi(e),null;case 24:return null;case 25:return null}throw Error(je(156,e.tag))}function vF(n,e){switch(dA(e),e.tag){case 1:return Gr(e.type)&&z0(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Wf(),_n(Vr),_n(hr),_A(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return wA(e),null;case 13:if(_n(Mn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(je(340));Hf()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return _n(Mn),null;case 4:return Wf(),null;case 10:return gA(e.type._context),null;case 22:case 23:return NA(),null;case 24:return null;default:return null}}var by=!1,lr=!1,yF=typeof WeakSet=="function"?WeakSet:Set,ot=null;function fd(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Hn(n,e,i)}else t.current=null}function K_(n,e,t){try{t()}catch(i){Hn(n,e,i)}}var tC=!1;function bF(n,e){if(P_=M0,n=oD(),cA(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var m;d!==t||r!==0&&d.nodeType!==3||(o=a+r),d!==s||i!==0&&d.nodeType!==3||(l=a+i),d.nodeType===3&&(a+=d.nodeValue.length),(m=d.firstChild)!==null;)f=d,d=m;for(;;){if(d===n)break t;if(f===t&&++u===r&&(o=a),f===s&&++h===i&&(l=a),(m=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=m}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(N_={focusedElem:n,selectionRange:t},M0=!1,ot=e;ot!==null;)if(e=ot,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ot=n;else for(;ot!==null;){e=ot;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var _=b.memoizedProps,w=b.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?_:Js(e.type,_),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(je(163))}}catch(k){Hn(e,e.return,k)}if(n=e.sibling,n!==null){n.return=e.return,ot=n;break}ot=e.return}return b=tC,tC=!1,b}function om(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&K_(e,t,s)}r=r.next}while(r!==i)}}function rw(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function X_(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function iR(n){var e=n.alternate;e!==null&&(n.alternate=null,iR(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[so],delete e[km],delete e[O_],delete e[tF],delete e[nF])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function rR(n){return n.tag===5||n.tag===3||n.tag===4}function nC(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||rR(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Y_(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=j0));else if(i!==4&&(n=n.child,n!==null))for(Y_(n,e,t),n=n.sibling;n!==null;)Y_(n,e,t),n=n.sibling}function Q_(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Q_(n,e,t),n=n.sibling;n!==null;)Q_(n,e,t),n=n.sibling}var zi=null,va=!1;function Cl(n,e,t){for(t=t.child;t!==null;)sR(n,e,t),t=t.sibling}function sR(n,e,t){if(oo&&typeof oo.onCommitFiberUnmount=="function")try{oo.onCommitFiberUnmount(Yb,t)}catch{}switch(t.tag){case 5:lr||fd(t,e);case 6:var i=zi,r=va;zi=null,Cl(n,e,t),zi=i,va=r,zi!==null&&(va?(n=zi,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):zi.removeChild(t.stateNode));break;case 18:zi!==null&&(va?(n=zi,t=t.stateNode,n.nodeType===8?x1(n.parentNode,t):n.nodeType===1&&x1(n,t),Em(n)):x1(zi,t.stateNode));break;case 4:i=zi,r=va,zi=t.stateNode.containerInfo,va=!0,Cl(n,e,t),zi=i,va=r;break;case 0:case 11:case 14:case 15:if(!lr&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&K_(t,e,a),r=r.next}while(r!==i)}Cl(n,e,t);break;case 1:if(!lr&&(fd(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(o){Hn(t,e,o)}Cl(n,e,t);break;case 21:Cl(n,e,t);break;case 22:t.mode&1?(lr=(i=lr)||t.memoizedState!==null,Cl(n,e,t),lr=i):Cl(n,e,t);break;default:Cl(n,e,t)}}function iC(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new yF),e.forEach(function(i){var r=TF.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Ks(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:zi=o.stateNode,va=!1;break e;case 3:zi=o.stateNode.containerInfo,va=!0;break e;case 4:zi=o.stateNode.containerInfo,va=!0;break e}o=o.return}if(zi===null)throw Error(je(160));sR(s,a,r),zi=null,va=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Hn(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)aR(e,n),e=e.sibling}function aR(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ks(e,n),Pa(n),i&4){try{om(3,n,n.return),rw(3,n)}catch(_){Hn(n,n.return,_)}try{om(5,n,n.return)}catch(_){Hn(n,n.return,_)}}break;case 1:Ks(e,n),Pa(n),i&512&&t!==null&&fd(t,t.return);break;case 5:if(Ks(e,n),Pa(n),i&512&&t!==null&&fd(t,t.return),n.flags&32){var r=n.stateNode;try{ym(r,"")}catch(_){Hn(n,n.return,_)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,a=t!==null?t.memoizedProps:s,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&TT(r,s),__(o,a);var u=__(o,s);for(a=0;a<l.length;a+=2){var h=l[a],d=l[a+1];h==="style"?IT(r,d):h==="dangerouslySetInnerHTML"?PT(r,d):h==="children"?ym(r,d):QE(r,h,d,u)}switch(o){case"input":g_(r,s);break;case"textarea":DT(r,s);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?yd(r,!!s.multiple,m,!1):f!==!!s.multiple&&(s.defaultValue!=null?yd(r,!!s.multiple,s.defaultValue,!0):yd(r,!!s.multiple,s.multiple?[]:"",!1))}r[km]=s}catch(_){Hn(n,n.return,_)}}break;case 6:if(Ks(e,n),Pa(n),i&4){if(n.stateNode===null)throw Error(je(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(_){Hn(n,n.return,_)}}break;case 3:if(Ks(e,n),Pa(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Em(e.containerInfo)}catch(_){Hn(n,n.return,_)}break;case 4:Ks(e,n),Pa(n);break;case 13:Ks(e,n),Pa(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(RA=Qn())),i&4&&iC(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(lr=(u=lr)||h,Ks(e,n),lr=u):Ks(e,n),Pa(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(ot=n,h=n.child;h!==null;){for(d=ot=h;ot!==null;){switch(f=ot,m=f.child,f.tag){case 0:case 11:case 14:case 15:om(4,f,f.return);break;case 1:fd(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){i=f,t=f.return;try{e=i,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(_){Hn(i,t,_)}}break;case 5:fd(f,f.return);break;case 22:if(f.memoizedState!==null){sC(d);continue}}m!==null?(m.return=f,ot=m):sC(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{r=d.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=NT("display",a))}catch(_){Hn(n,n.return,_)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(_){Hn(n,n.return,_)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ks(e,n),Pa(n),i&4&&iC(n);break;case 21:break;default:Ks(e,n),Pa(n)}}function Pa(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(rR(t)){var i=t;break e}t=t.return}throw Error(je(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(ym(r,""),i.flags&=-33);var s=nC(n);Q_(n,s,r);break;case 3:case 4:var a=i.stateNode.containerInfo,o=nC(n);Y_(n,o,a);break;default:throw Error(je(161))}}catch(l){Hn(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function wF(n,e,t){ot=n,oR(n)}function oR(n,e,t){for(var i=(n.mode&1)!==0;ot!==null;){var r=ot,s=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||by;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||lr;o=by;var u=lr;if(by=a,(lr=l)&&!u)for(ot=r;ot!==null;)a=ot,l=a.child,a.tag===22&&a.memoizedState!==null?aC(r):l!==null?(l.return=a,ot=l):aC(r);for(;s!==null;)ot=s,oR(s),s=s.sibling;ot=r,by=o,lr=u}rC(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,ot=s):rC(n)}}function rC(n){for(;ot!==null;){var e=ot;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:lr||rw(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!lr)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Js(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&$S(e,s,i);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}$S(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Em(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(je(163))}lr||e.flags&512&&X_(e)}catch(f){Hn(e,e.return,f)}}if(e===n){ot=null;break}if(t=e.sibling,t!==null){t.return=e.return,ot=t;break}ot=e.return}}function sC(n){for(;ot!==null;){var e=ot;if(e===n){ot=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ot=t;break}ot=e.return}}function aC(n){for(;ot!==null;){var e=ot;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{rw(4,e)}catch(l){Hn(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Hn(e,r,l)}}var s=e.return;try{X_(e)}catch(l){Hn(e,s,l)}break;case 5:var a=e.return;try{X_(e)}catch(l){Hn(e,a,l)}}}catch(l){Hn(e,e.return,l)}if(e===n){ot=null;break}var o=e.sibling;if(o!==null){o.return=e.return,ot=o;break}ot=e.return}}var _F=Math.ceil,Y0=bl.ReactCurrentDispatcher,TA=bl.ReactCurrentOwner,$s=bl.ReactCurrentBatchConfig,Gt=0,Pi=null,ii=null,Hi=0,gs=0,pd=Bu(0),mi=0,Im=null,xh=0,sw=0,DA=0,lm=null,Hr=null,RA=0,Gf=1/0,Eo=null,Q0=!1,Z_=null,ku=null,wy=!1,bu=null,Z0=0,um=0,J_=null,Uy=-1,$y=0;function kr(){return Gt&6?Qn():Uy!==-1?Uy:Uy=Qn()}function Tu(n){return n.mode&1?Gt&2&&Hi!==0?Hi&-Hi:rF.transition!==null?($y===0&&($y=WT()),$y):(n=an,n!==0||(n=window.event,n=n===void 0?16:ZT(n.type)),n):1}function Ea(n,e,t,i){if(50<um)throw um=0,J_=null,Error(je(185));Sv(n,t,i),(!(Gt&2)||n!==Pi)&&(n===Pi&&(!(Gt&2)&&(sw|=t),mi===4&&Il(n,Hi)),Kr(n,i),t===1&&Gt===0&&!(e.mode&1)&&(Gf=Qn()+500,tw&&ju()))}function Kr(n,e){var t=n.callbackNode;rM(n,e);var i=O0(n,n===Pi?Hi:0);if(i===0)t!==null&&mS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&mS(t),e===1)n.tag===0?iF(oC.bind(null,n)):vD(oC.bind(null,n)),JM(function(){!(Gt&6)&&ju()}),t=null;else{switch(VT(i)){case 1:t=nA;break;case 4:t=HT;break;case 16:t=L0;break;case 536870912:t=qT;break;default:t=L0}t=mR(t,lR.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function lR(n,e){if(Uy=-1,$y=0,Gt&6)throw Error(je(327));var t=n.callbackNode;if(Ad()&&n.callbackNode!==t)return null;var i=O0(n,n===Pi?Hi:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=J0(n,i);else{e=i;var r=Gt;Gt|=2;var s=cR();(Pi!==n||Hi!==e)&&(Eo=null,Gf=Qn()+500,yh(n,e));do try{xF();break}catch(o){uR(n,o)}while(!0);mA(),Y0.current=s,Gt=r,ii!==null?e=0:(Pi=null,Hi=0,e=mi)}if(e!==0){if(e===2&&(r=C_(n),r!==0&&(i=r,e=e2(n,r))),e===1)throw t=Im,yh(n,0),Il(n,i),Kr(n,Qn()),t;if(e===6)Il(n,i);else{if(r=n.current.alternate,!(i&30)&&!EF(r)&&(e=J0(n,i),e===2&&(s=C_(n),s!==0&&(i=s,e=e2(n,s))),e===1))throw t=Im,yh(n,0),Il(n,i),Kr(n,Qn()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(je(345));case 2:Yu(n,Hr,Eo);break;case 3:if(Il(n,i),(i&130023424)===i&&(e=RA+500-Qn(),10<e)){if(O0(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){kr(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=L_(Yu.bind(null,n,Hr,Eo),e);break}Yu(n,Hr,Eo);break;case 4:if(Il(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var a=31-_a(i);s=1<<a,a=e[a],a>r&&(r=a),i&=~s}if(i=r,i=Qn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*_F(i/1960))-i,10<i){n.timeoutHandle=L_(Yu.bind(null,n,Hr,Eo),i);break}Yu(n,Hr,Eo);break;case 5:Yu(n,Hr,Eo);break;default:throw Error(je(329))}}}return Kr(n,Qn()),n.callbackNode===t?lR.bind(null,n):null}function e2(n,e){var t=lm;return n.current.memoizedState.isDehydrated&&(yh(n,e).flags|=256),n=J0(n,e),n!==2&&(e=Hr,Hr=t,e!==null&&t2(e)),n}function t2(n){Hr===null?Hr=n:Hr.push.apply(Hr,n)}function EF(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!xa(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Il(n,e){for(e&=~DA,e&=~sw,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-_a(e),i=1<<t;n[t]=-1,e&=~i}}function oC(n){if(Gt&6)throw Error(je(327));Ad();var e=O0(n,0);if(!(e&1))return Kr(n,Qn()),null;var t=J0(n,e);if(n.tag!==0&&t===2){var i=C_(n);i!==0&&(e=i,t=e2(n,i))}if(t===1)throw t=Im,yh(n,0),Il(n,e),Kr(n,Qn()),t;if(t===6)throw Error(je(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Yu(n,Hr,Eo),Kr(n,Qn()),null}function PA(n,e){var t=Gt;Gt|=1;try{return n(e)}finally{Gt=t,Gt===0&&(Gf=Qn()+500,tw&&ju())}}function Sh(n){bu!==null&&bu.tag===0&&!(Gt&6)&&Ad();var e=Gt;Gt|=1;var t=$s.transition,i=an;try{if($s.transition=null,an=1,n)return n()}finally{an=i,$s.transition=t,Gt=e,!(Gt&6)&&ju()}}function NA(){gs=pd.current,_n(pd)}function yh(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,ZM(t)),ii!==null)for(t=ii.return;t!==null;){var i=t;switch(dA(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&z0();break;case 3:Wf(),_n(Vr),_n(hr),_A();break;case 5:wA(i);break;case 4:Wf();break;case 13:_n(Mn);break;case 19:_n(Mn);break;case 10:gA(i.type._context);break;case 22:case 23:NA()}t=t.return}if(Pi=n,ii=n=Du(n.current,null),Hi=gs=e,mi=0,Im=null,DA=sw=xh=0,Hr=lm=null,ic!==null){for(e=0;e<ic.length;e++)if(t=ic[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var a=s.next;s.next=r,i.next=a}t.pending=i}ic=null}return n}function uR(n,e){do{var t=ii;try{if(mA(),By.current=X0,K0){for(var i=Bn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}K0=!1}if(Ah=0,Ri=pi=Bn=null,am=!1,Rm=0,TA.current=null,t===null||t.return===null){mi=1,Im=e,ii=null;break}e:{var s=n,a=t.return,o=t,l=e;if(e=Hi,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=KS(a);if(m!==null){m.flags&=-257,XS(m,a,o,s,e),m.mode&1&&GS(s,u,e),e=m,l=u;var b=e.updateQueue;if(b===null){var _=new Set;_.add(l),e.updateQueue=_}else b.add(l);break e}else{if(!(e&1)){GS(s,u,e),IA();break e}l=Error(je(426))}}else if(Tn&&o.mode&1){var w=KS(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),XS(w,a,o,s,e),fA(Vf(l,o));break e}}s=l=Vf(l,o),mi!==4&&(mi=2),lm===null?lm=[s]:lm.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=VD(s,l,e);US(s,v);break e;case 1:o=l;var y=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(ku===null||!ku.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=GD(s,o,e);US(s,k);break e}}s=s.return}while(s!==null)}dR(t)}catch(S){e=S,ii===t&&t!==null&&(ii=t=t.return);continue}break}while(!0)}function cR(){var n=Y0.current;return Y0.current=X0,n===null?X0:n}function IA(){(mi===0||mi===3||mi===2)&&(mi=4),Pi===null||!(xh&268435455)&&!(sw&268435455)||Il(Pi,Hi)}function J0(n,e){var t=Gt;Gt|=2;var i=cR();(Pi!==n||Hi!==e)&&(Eo=null,yh(n,e));do try{AF();break}catch(r){uR(n,r)}while(!0);if(mA(),Gt=t,Y0.current=i,ii!==null)throw Error(je(261));return Pi=null,Hi=0,mi}function AF(){for(;ii!==null;)hR(ii)}function xF(){for(;ii!==null&&!XO();)hR(ii)}function hR(n){var e=pR(n.alternate,n,gs);n.memoizedProps=n.pendingProps,e===null?dR(n):ii=e,TA.current=null}function dR(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=vF(t,e),t!==null){t.flags&=32767,ii=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{mi=6,ii=null;return}}else if(t=gF(t,e,gs),t!==null){ii=t;return}if(e=e.sibling,e!==null){ii=e;return}ii=e=n}while(e!==null);mi===0&&(mi=5)}function Yu(n,e,t){var i=an,r=$s.transition;try{$s.transition=null,an=1,SF(n,e,t,i)}finally{$s.transition=r,an=i}return null}function SF(n,e,t,i){do Ad();while(bu!==null);if(Gt&6)throw Error(je(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(je(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(sM(n,s),n===Pi&&(ii=Pi=null,Hi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||wy||(wy=!0,mR(L0,function(){return Ad(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=$s.transition,$s.transition=null;var a=an;an=1;var o=Gt;Gt|=4,TA.current=null,bF(n,t),aR(t,n),WM(N_),M0=!!P_,N_=P_=null,n.current=t,wF(t),YO(),Gt=o,an=a,$s.transition=s}else n.current=t;if(wy&&(wy=!1,bu=n,Z0=r),s=n.pendingLanes,s===0&&(ku=null),JO(t.stateNode),Kr(n,Qn()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Q0)throw Q0=!1,n=Z_,Z_=null,n;return Z0&1&&n.tag!==0&&Ad(),s=n.pendingLanes,s&1?n===J_?um++:(um=0,J_=n):um=0,ju(),null}function Ad(){if(bu!==null){var n=VT(Z0),e=$s.transition,t=an;try{if($s.transition=null,an=16>n?16:n,bu===null)var i=!1;else{if(n=bu,bu=null,Z0=0,Gt&6)throw Error(je(331));var r=Gt;for(Gt|=4,ot=n.current;ot!==null;){var s=ot,a=s.child;if(ot.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ot=u;ot!==null;){var h=ot;switch(h.tag){case 0:case 11:case 15:om(8,h,s)}var d=h.child;if(d!==null)d.return=h,ot=d;else for(;ot!==null;){h=ot;var f=h.sibling,m=h.return;if(iR(h),h===u){ot=null;break}if(f!==null){f.return=m,ot=f;break}ot=m}}}var b=s.alternate;if(b!==null){var _=b.child;if(_!==null){b.child=null;do{var w=_.sibling;_.sibling=null,_=w}while(_!==null)}}ot=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ot=a;else e:for(;ot!==null;){if(s=ot,s.flags&2048)switch(s.tag){case 0:case 11:case 15:om(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,ot=v;break e}ot=s.return}}var y=n.current;for(ot=y;ot!==null;){a=ot;var E=a.child;if(a.subtreeFlags&2064&&E!==null)E.return=a,ot=E;else e:for(a=y;ot!==null;){if(o=ot,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rw(9,o)}}catch(S){Hn(o,o.return,S)}if(o===a){ot=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,ot=k;break e}ot=o.return}}if(Gt=r,ju(),oo&&typeof oo.onPostCommitFiberRoot=="function")try{oo.onPostCommitFiberRoot(Yb,n)}catch{}i=!0}return i}finally{an=t,$s.transition=e}}return!1}function lC(n,e,t){e=Vf(t,e),e=VD(n,e,1),n=Cu(n,e,1),e=kr(),n!==null&&(Sv(n,1,e),Kr(n,e))}function Hn(n,e,t){if(n.tag===3)lC(n,n,t);else for(;e!==null;){if(e.tag===3){lC(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ku===null||!ku.has(i))){n=Vf(t,n),n=GD(e,n,1),e=Cu(e,n,1),n=kr(),e!==null&&(Sv(e,1,n),Kr(e,n));break}}e=e.return}}function CF(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=kr(),n.pingedLanes|=n.suspendedLanes&t,Pi===n&&(Hi&t)===t&&(mi===4||mi===3&&(Hi&130023424)===Hi&&500>Qn()-RA?yh(n,0):DA|=t),Kr(n,e)}function fR(n,e){e===0&&(n.mode&1?(e=cy,cy<<=1,!(cy&130023424)&&(cy=4194304)):e=1);var t=kr();n=cl(n,e),n!==null&&(Sv(n,e,t),Kr(n,t))}function kF(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),fR(n,t)}function TF(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(je(314))}i!==null&&i.delete(e),fR(n,t)}var pR;pR=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Vr.current)Wr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Wr=!1,mF(n,e,t);Wr=!!(n.flags&131072)}else Wr=!1,Tn&&e.flags&1048576&&yD(e,H0,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;zy(n,e),n=e.pendingProps;var r=$f(e,hr.current);Ed(e,t),r=AA(null,e,i,n,r,t);var s=xA();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gr(i)?(s=!0,U0(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,yA(e),r.updater=iw,e.stateNode=r,r._reactInternals=e,U_(e,i,n,t),e=q_(null,e,i,!0,s,t)):(e.tag=0,Tn&&s&&hA(e),xr(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(zy(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=RF(i),n=Js(i,n),r){case 0:e=H_(null,e,i,n,t);break e;case 1:e=ZS(null,e,i,n,t);break e;case 11:e=YS(null,e,i,n,t);break e;case 14:e=QS(null,e,i,Js(i.type,n),t);break e}throw Error(je(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Js(i,r),H_(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Js(i,r),ZS(n,e,i,r,t);case 3:e:{if(QD(e),n===null)throw Error(je(387));i=e.pendingProps,s=e.memoizedState,r=s.element,xD(n,e),V0(e,i,null,t);var a=e.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Vf(Error(je(423)),e),e=JS(n,e,i,t,r);break e}else if(i!==r){r=Vf(Error(je(424)),e),e=JS(n,e,i,t,r);break e}else for(bs=Su(e.stateNode.containerInfo.firstChild),ws=e,Tn=!0,ba=null,t=ED(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Hf(),i===r){e=hl(n,e,t);break e}xr(n,e,i,t)}e=e.child}return e;case 5:return SD(e),n===null&&B_(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,a=r.children,I_(i,r)?a=null:s!==null&&I_(i,s)&&(e.flags|=32),YD(n,e),xr(n,e,a,t),e.child;case 6:return n===null&&B_(e),null;case 13:return ZD(n,e,t);case 4:return bA(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=qf(e,null,i,t):xr(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Js(i,r),YS(n,e,i,r,t);case 7:return xr(n,e,e.pendingProps,t),e.child;case 8:return xr(n,e,e.pendingProps.children,t),e.child;case 12:return xr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,gn(q0,i._currentValue),i._currentValue=a,s!==null)if(xa(s.value,a)){if(s.children===r.children&&!Vr.current){e=hl(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=rl(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),j_(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(je(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),j_(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}xr(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Ed(e,t),r=qs(r),i=i(r),e.flags|=1,xr(n,e,i,t),e.child;case 14:return i=e.type,r=Js(i,e.pendingProps),r=Js(i.type,r),QS(n,e,i,r,t);case 15:return KD(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Js(i,r),zy(n,e),e.tag=1,Gr(i)?(n=!0,U0(e)):n=!1,Ed(e,t),WD(e,i,r),U_(e,i,r,t),q_(null,e,i,!0,n,t);case 19:return JD(n,e,t);case 22:return XD(n,e,t)}throw Error(je(156,e.tag))};function mR(n,e){return $T(n,e)}function DF(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Us(n,e,t,i){return new DF(n,e,t,i)}function LA(n){return n=n.prototype,!(!n||!n.isReactComponent)}function RF(n){if(typeof n=="function")return LA(n)?1:0;if(n!=null){if(n=n.$$typeof,n===JE)return 11;if(n===eA)return 14}return 2}function Du(n,e){var t=n.alternate;return t===null?(t=Us(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Hy(n,e,t,i,r,s){var a=2;if(i=n,typeof n=="function")LA(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case rd:return bh(t.children,r,s,e);case ZE:a=8,r|=8;break;case h_:return n=Us(12,t,e,r|2),n.elementType=h_,n.lanes=s,n;case d_:return n=Us(13,t,e,r),n.elementType=d_,n.lanes=s,n;case f_:return n=Us(19,t,e,r),n.elementType=f_,n.lanes=s,n;case ST:return aw(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case AT:a=10;break e;case xT:a=9;break e;case JE:a=11;break e;case eA:a=14;break e;case Rl:a=16,i=null;break e}throw Error(je(130,n==null?n:typeof n,""))}return e=Us(a,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function bh(n,e,t,i){return n=Us(7,n,i,e),n.lanes=t,n}function aw(n,e,t,i){return n=Us(22,n,i,e),n.elementType=ST,n.lanes=t,n.stateNode={isHidden:!1},n}function N1(n,e,t){return n=Us(6,n,null,e),n.lanes=t,n}function I1(n,e,t){return e=Us(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function PF(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=f1(0),this.expirationTimes=f1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=f1(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function OA(n,e,t,i,r,s,a,o,l){return n=new PF(n,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Us(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},yA(s),n}function NF(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:id,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function gR(n){if(!n)return Nu;n=n._reactInternals;e:{if(Ih(n)!==n||n.tag!==1)throw Error(je(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(je(171))}if(n.tag===1){var t=n.type;if(Gr(t))return gD(n,t,e)}return e}function vR(n,e,t,i,r,s,a,o,l){return n=OA(t,i,!0,n,r,s,a,o,l),n.context=gR(null),t=n.current,i=kr(),r=Tu(t),s=rl(i,r),s.callback=e??null,Cu(t,s,r),n.current.lanes=r,Sv(n,r,i),Kr(n,i),n}function ow(n,e,t,i){var r=e.current,s=kr(),a=Tu(r);return t=gR(t),e.context===null?e.context=t:e.pendingContext=t,e=rl(s,a),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Cu(r,e,a),n!==null&&(Ea(n,r,a,s),Fy(n,r,a)),a}function eb(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function uC(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function MA(n,e){uC(n,e),(n=n.alternate)&&uC(n,e)}function IF(){return null}var yR=typeof reportError=="function"?reportError:function(n){console.error(n)};function FA(n){this._internalRoot=n}lw.prototype.render=FA.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(je(409));ow(n,e,null,null)};lw.prototype.unmount=FA.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Sh(function(){ow(null,n,null,null)}),e[ul]=null}};function lw(n){this._internalRoot=n}lw.prototype.unstable_scheduleHydration=function(n){if(n){var e=XT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Nl.length&&e!==0&&e<Nl[t].priority;t++);Nl.splice(t,0,n),t===0&&QT(n)}};function BA(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function uw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function cC(){}function LF(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=eb(a);s.call(u)}}var a=vR(e,i,n,0,null,!1,!1,"",cC);return n._reactRootContainer=a,n[ul]=a.current,Sm(n.nodeType===8?n.parentNode:n),Sh(),a}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var o=i;i=function(){var u=eb(l);o.call(u)}}var l=OA(n,0,!1,null,null,!1,!1,"",cC);return n._reactRootContainer=l,n[ul]=l.current,Sm(n.nodeType===8?n.parentNode:n),Sh(function(){ow(e,l,t,i)}),l}function cw(n,e,t,i,r){var s=t._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var o=r;r=function(){var l=eb(a);o.call(l)}}ow(e,a,n,r)}else a=LF(t,e,n,r,i);return eb(a)}GT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Fp(e.pendingLanes);t!==0&&(iA(e,t|1),Kr(e,Qn()),!(Gt&6)&&(Gf=Qn()+500,ju()))}break;case 13:Sh(function(){var i=cl(n,1);if(i!==null){var r=kr();Ea(i,n,1,r)}}),MA(n,1)}};rA=function(n){if(n.tag===13){var e=cl(n,134217728);if(e!==null){var t=kr();Ea(e,n,134217728,t)}MA(n,134217728)}};KT=function(n){if(n.tag===13){var e=Tu(n),t=cl(n,e);if(t!==null){var i=kr();Ea(t,n,e,i)}MA(n,e)}};XT=function(){return an};YT=function(n,e){var t=an;try{return an=n,e()}finally{an=t}};A_=function(n,e,t){switch(e){case"input":if(g_(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=ew(i);if(!r)throw Error(je(90));kT(i),g_(i,r)}}}break;case"textarea":DT(n,t);break;case"select":e=t.value,e!=null&&yd(n,!!t.multiple,e,!1)}};MT=PA;FT=Sh;var OF={usingClientEntryPoint:!1,Events:[kv,ld,ew,LT,OT,PA]},Ep={findFiberByHostInstance:nc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MF={bundleType:Ep.bundleType,version:Ep.version,rendererPackageName:Ep.rendererPackageName,rendererConfig:Ep.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bl.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=zT(n),n===null?null:n.stateNode},findFiberByHostInstance:Ep.findFiberByHostInstance||IF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _y=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_y.isDisabled&&_y.supportsFiber)try{Yb=_y.inject(MF),oo=_y}catch{}}As.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OF;As.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!BA(e))throw Error(je(200));return NF(n,e,null,t)};As.createRoot=function(n,e){if(!BA(n))throw Error(je(299));var t=!1,i="",r=yR;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=OA(n,1,!1,null,null,t,!1,i,r),n[ul]=e.current,Sm(n.nodeType===8?n.parentNode:n),new FA(e)};As.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(je(188)):(n=Object.keys(n).join(","),Error(je(268,n)));return n=zT(e),n=n===null?null:n.stateNode,n};As.flushSync=function(n){return Sh(n)};As.hydrate=function(n,e,t){if(!uw(e))throw Error(je(200));return cw(null,n,e,!0,t)};As.hydrateRoot=function(n,e,t){if(!BA(n))throw Error(je(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",a=yR;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=vR(e,null,n,1,t??null,r,!1,s,a),n[ul]=e.current,Sm(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new lw(e)};As.render=function(n,e,t){if(!uw(e))throw Error(je(200));return cw(null,n,e,!1,t)};As.unmountComponentAtNode=function(n){if(!uw(n))throw Error(je(40));return n._reactRootContainer?(Sh(function(){cw(null,null,n,!1,function(){n._reactRootContainer=null,n[ul]=null})}),!0):!1};As.unstable_batchedUpdates=PA;As.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!uw(t))throw Error(je(200));if(n==null||n._reactInternals===void 0)throw Error(je(38));return cw(n,e,t,!1,i)};As.version="18.3.1-next-f1338f8080-20240426";function bR(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bR)}catch(n){console.error(n)}}bR(),bT.exports=As;var FF=bT.exports,wR,hC=FF;wR=hC.createRoot,hC.hydrateRoot;var hw=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(n){return this.listeners.add(n),this.onSubscribe(),()=>{this.listeners.delete(n),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},BF={setTimeout:(n,e)=>setTimeout(n,e),clearTimeout:n=>clearTimeout(n),setInterval:(n,e)=>setInterval(n,e),clearInterval:n=>clearInterval(n)},Ml,qE,Jk,jF=(Jk=class{constructor(){N(this,Ml,BF);N(this,qE,!1)}setTimeoutProvider(n){T(this,Ml,n)}setTimeout(n,e){return c(this,Ml).setTimeout(n,e)}clearTimeout(n){c(this,Ml).clearTimeout(n)}setInterval(n,e){return c(this,Ml).setInterval(n,e)}clearInterval(n){c(this,Ml).clearInterval(n)}},Ml=new WeakMap,qE=new WeakMap,Jk),n2=new jF;function zF(n){setTimeout(n,0)}var dw=typeof window>"u"||"Deno"in globalThis;function ea(){}function UF(n,e){return typeof n=="function"?n(e):n}function $F(n){return typeof n=="number"&&n>=0&&n!==1/0}function HF(n,e){return Math.max(n+(e||0)-Date.now(),0)}function i2(n,e){return typeof n=="function"?n(e):n}function qF(n,e){return typeof n=="function"?n(e):n}function dC(n,e){const{type:t="all",exact:i,fetchStatus:r,predicate:s,queryKey:a,stale:o}=n;if(a){if(i){if(e.queryHash!==jA(a,e.options))return!1}else if(!Om(e.queryKey,a))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||r&&r!==e.state.fetchStatus||s&&!s(e))}function fC(n,e){const{exact:t,status:i,predicate:r,mutationKey:s}=n;if(s){if(!e.options.mutationKey)return!1;if(t){if(Lm(e.options.mutationKey)!==Lm(s))return!1}else if(!Om(e.options.mutationKey,s))return!1}return!(i&&e.state.status!==i||r&&!r(e))}function jA(n,e){return(e?.queryKeyHashFn||Lm)(n)}function Lm(n){return JSON.stringify(n,(e,t)=>r2(t)?Object.keys(t).sort().reduce((i,r)=>(i[r]=t[r],i),{}):t)}function Om(n,e){return n===e?!0:typeof n!=typeof e?!1:n&&e&&typeof n=="object"&&typeof e=="object"?Object.keys(e).every(t=>Om(n[t],e[t])):!1}var WF=Object.prototype.hasOwnProperty;function _R(n,e){if(n===e)return n;const t=pC(n)&&pC(e);if(!t&&!(r2(n)&&r2(e)))return e;const r=(t?n:Object.keys(n)).length,s=t?e:Object.keys(e),a=s.length,o=t?new Array(a):{};let l=0;for(let u=0;u<a;u++){const h=t?u:s[u],d=n[h],f=e[h];if(d===f){o[h]=d,(t?u<r:WF.call(n,h))&&l++;continue}if(d===null||f===null||typeof d!="object"||typeof f!="object"){o[h]=f;continue}const m=_R(d,f);o[h]=m,m===d&&l++}return r===a&&l===r?n:o}function pC(n){return Array.isArray(n)&&n.length===Object.keys(n).length}function r2(n){if(!mC(n))return!1;const e=n.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!mC(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(n)!==Object.prototype)}function mC(n){return Object.prototype.toString.call(n)==="[object Object]"}function VF(n){return new Promise(e=>{n2.setTimeout(e,n)})}function GF(n,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(n,e):t.structuralSharing!==!1?_R(n,e):e}function KF(n,e,t=0){const i=[...n,e];return t&&i.length>t?i.slice(1):i}function XF(n,e,t=0){const i=[e,...n];return t&&i.length>t?i.slice(0,-1):i}var zA=Symbol();function ER(n,e){return!n.queryFn&&e?.initialPromise?()=>e.initialPromise:!n.queryFn||n.queryFn===zA?()=>Promise.reject(new Error(`Missing queryFn: '${n.queryHash}'`)):n.queryFn}var lc,Fl,kd,eT,YF=(eT=class extends hw{constructor(){super();N(this,lc);N(this,Fl);N(this,kd);T(this,kd,e=>{if(!dw&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){c(this,Fl)||this.setEventListener(c(this,kd))}onUnsubscribe(){var e;this.hasListeners()||((e=c(this,Fl))==null||e.call(this),T(this,Fl,void 0))}setEventListener(e){var t;T(this,kd,e),(t=c(this,Fl))==null||t.call(this),T(this,Fl,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){c(this,lc)!==e&&(T(this,lc,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof c(this,lc)=="boolean"?c(this,lc):globalThis.document?.visibilityState!=="hidden"}},lc=new WeakMap,Fl=new WeakMap,kd=new WeakMap,eT),AR=new YF;function QF(){let n,e;const t=new Promise((r,s)=>{n=r,e=s});t.status="pending",t.catch(()=>{});function i(r){Object.assign(t,r),delete t.resolve,delete t.reject}return t.resolve=r=>{i({status:"fulfilled",value:r}),n(r)},t.reject=r=>{i({status:"rejected",reason:r}),e(r)},t}var ZF=zF;function JF(){let n=[],e=0,t=o=>{o()},i=o=>{o()},r=ZF;const s=o=>{e?n.push(o):r(()=>{t(o)})},a=()=>{const o=n;n=[],o.length&&r(()=>{i(()=>{o.forEach(l=>{t(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{t=o},setBatchNotifyFunction:o=>{i=o},setScheduler:o=>{r=o}}}var Sr=JF(),Td,Bl,Dd,tT,e3=(tT=class extends hw{constructor(){super();N(this,Td,!0);N(this,Bl);N(this,Dd);T(this,Dd,e=>{if(!dw&&window.addEventListener){const t=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",i)}}})}onSubscribe(){c(this,Bl)||this.setEventListener(c(this,Dd))}onUnsubscribe(){var e;this.hasListeners()||((e=c(this,Bl))==null||e.call(this),T(this,Bl,void 0))}setEventListener(e){var t;T(this,Dd,e),(t=c(this,Bl))==null||t.call(this),T(this,Bl,e(this.setOnline.bind(this)))}setOnline(e){c(this,Td)!==e&&(T(this,Td,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return c(this,Td)}},Td=new WeakMap,Bl=new WeakMap,Dd=new WeakMap,tT),tb=new e3;function t3(n){return Math.min(1e3*2**n,3e4)}function xR(n){return(n??"online")==="online"?tb.isOnline():!0}var s2=class extends Error{constructor(n){super("CancelledError"),this.revert=n?.revert,this.silent=n?.silent}};function SR(n){let e=!1,t=0,i;const r=QF(),s=()=>r.status!=="pending",a=_=>{if(!s()){const w=new s2(_);f(w),n.onCancel?.(w)}},o=()=>{e=!0},l=()=>{e=!1},u=()=>AR.isFocused()&&(n.networkMode==="always"||tb.isOnline())&&n.canRun(),h=()=>xR(n.networkMode)&&n.canRun(),d=_=>{s()||(i?.(),r.resolve(_))},f=_=>{s()||(i?.(),r.reject(_))},m=()=>new Promise(_=>{i=w=>{(s()||u())&&_(w)},n.onPause?.()}).then(()=>{i=void 0,s()||n.onContinue?.()}),b=()=>{if(s())return;let _;const w=t===0?n.initialPromise:void 0;try{_=w??n.fn()}catch(v){_=Promise.reject(v)}Promise.resolve(_).then(d).catch(v=>{if(s())return;const y=n.retry??(dw?0:3),E=n.retryDelay??t3,k=typeof E=="function"?E(t,v):E,S=y===!0||typeof y=="number"&&t<y||typeof y=="function"&&y(t,v);if(e||!S){f(v);return}t++,n.onFail?.(t,v),VF(k).then(()=>u()?void 0:m()).then(()=>{e?f(v):b()})})};return{promise:r,status:()=>r.status,cancel:a,continue:()=>(i?.(),r),cancelRetry:o,continueRetry:l,canStart:h,start:()=>(h()?b():m().then(b),r)}}var uc,nT,CR=(nT=class{constructor(){N(this,uc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),$F(this.gcTime)&&T(this,uc,n2.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(n){this.gcTime=Math.max(this.gcTime||0,n??(dw?1/0:5*60*1e3))}clearGcTimeout(){c(this,uc)&&(n2.clearTimeout(c(this,uc)),T(this,uc,void 0))}},uc=new WeakMap,nT),cc,Rd,Ds,hc,Ei,Ym,dc,ia,yo,iT,n3=(iT=class extends CR{constructor(e){super();N(this,ia);N(this,cc);N(this,Rd);N(this,Ds);N(this,hc);N(this,Ei);N(this,Ym);N(this,dc);T(this,dc,!1),T(this,Ym,e.defaultOptions),this.setOptions(e.options),this.observers=[],T(this,hc,e.client),T(this,Ds,c(this,hc).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,T(this,cc,gC(this.options)),this.state=e.state??c(this,cc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return c(this,Ei)?.promise}setOptions(e){if(this.options={...c(this,Ym),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=gC(this.options);t.data!==void 0&&(this.setData(t.data,{updatedAt:t.dataUpdatedAt,manual:!0}),T(this,cc,t))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&c(this,Ds).remove(this)}setData(e,t){const i=GF(this.state.data,e,this.options);return I(this,ia,yo).call(this,{data:i,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),i}setState(e,t){I(this,ia,yo).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){const t=c(this,Ei)?.promise;return c(this,Ei)?.cancel(e),t?t.then(ea).catch(ea):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(c(this,cc))}isActive(){return this.observers.some(e=>qF(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===zA||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>i2(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!HF(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),c(this,Ei)?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),c(this,Ei)?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),c(this,Ds).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(c(this,Ei)&&(c(this,dc)?c(this,Ei).cancel({revert:!0}):c(this,Ei).cancelRetry()),this.scheduleGc()),c(this,Ds).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||I(this,ia,yo).call(this,{type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&c(this,Ei)?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(c(this,Ei))return c(this,Ei).continueRetry(),c(this,Ei).promise}if(e&&this.setOptions(e),!this.options.queryFn){const l=this.observers.find(u=>u.options.queryFn);l&&this.setOptions(l.options)}const i=new AbortController,r=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(T(this,dc,!0),i.signal)})},s=()=>{const l=ER(this.options,t),h=(()=>{const d={client:c(this,hc),queryKey:this.queryKey,meta:this.meta};return r(d),d})();return T(this,dc,!1),this.options.persister?this.options.persister(l,h,this):l(h)},o=(()=>{const l={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:c(this,hc),state:this.state,fetchFn:s};return r(l),l})();this.options.behavior?.onFetch(o,this),T(this,Rd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&I(this,ia,yo).call(this,{type:"fetch",meta:o.fetchOptions?.meta}),T(this,Ei,SR({initialPromise:t?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof s2&&l.revert&&this.setState({...c(this,Rd),fetchStatus:"idle"}),i.abort()},onFail:(l,u)=>{I(this,ia,yo).call(this,{type:"failed",failureCount:l,error:u})},onPause:()=>{I(this,ia,yo).call(this,{type:"pause"})},onContinue:()=>{I(this,ia,yo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const l=await c(this,Ei).start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),c(this,Ds).config.onSuccess?.(l,this),c(this,Ds).config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof s2){if(l.silent)return c(this,Ei).promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw I(this,ia,yo).call(this,{type:"error",error:l}),c(this,Ds).config.onError?.(l,this),c(this,Ds).config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}},cc=new WeakMap,Rd=new WeakMap,Ds=new WeakMap,hc=new WeakMap,Ei=new WeakMap,Ym=new WeakMap,dc=new WeakMap,ia=new WeakSet,yo=function(e){const t=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...i3(i.data,this.options),fetchMeta:e.meta??null};case"success":const r={...i,data:e.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return T(this,Rd,e.manual?r:void 0),r;case"error":const s=e.error;return{...i,error:s,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=t(this.state),Sr.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),c(this,Ds).notify({query:this,type:"updated",action:e})})},iT);function i3(n,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:xR(e.networkMode)?"fetching":"paused",...n===void 0&&{error:null,status:"pending"}}}function gC(n){const e=typeof n.initialData=="function"?n.initialData():n.initialData,t=e!==void 0,i=t?typeof n.initialDataUpdatedAt=="function"?n.initialDataUpdatedAt():n.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}function vC(n){return{onFetch:(e,t)=>{const i=e.options,r=e.fetchOptions?.meta?.fetchMore?.direction,s=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let h=!1;const d=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?h=!0:e.signal.addEventListener("abort",()=>{h=!0}),e.signal)})},f=ER(e.options,e.fetchOptions),m=async(b,_,w)=>{if(h)return Promise.reject();if(_==null&&b.pages.length)return Promise.resolve(b);const y=(()=>{const D={client:e.client,queryKey:e.queryKey,pageParam:_,direction:w?"backward":"forward",meta:e.options.meta};return d(D),D})(),E=await f(y),{maxPages:k}=e.options,S=w?XF:KF;return{pages:S(b.pages,E,k),pageParams:S(b.pageParams,_,k)}};if(r&&s.length){const b=r==="backward",_=b?r3:yC,w={pages:s,pageParams:a},v=_(i,w);o=await m(w,v,b)}else{const b=n??s.length;do{const _=l===0?a[0]??i.initialPageParam:yC(i,o);if(l>0&&_==null)break;o=await m(o,_),l++}while(l<b)}return o};e.options.persister?e.fetchFn=()=>e.options.persister?.(u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=u}}}function yC(n,{pages:e,pageParams:t}){const i=e.length-1;return e.length>0?n.getNextPageParam(e[i],e,t[i],t):void 0}function r3(n,{pages:e,pageParams:t}){return e.length>0?n.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var Qm,ja,wr,fc,za,Tl,rT,s3=(rT=class extends CR{constructor(e){super();N(this,za);N(this,Qm);N(this,ja);N(this,wr);N(this,fc);T(this,Qm,e.client),this.mutationId=e.mutationId,T(this,wr,e.mutationCache),T(this,ja,[]),this.state=e.state||a3(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){c(this,ja).includes(e)||(c(this,ja).push(e),this.clearGcTimeout(),c(this,wr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){T(this,ja,c(this,ja).filter(t=>t!==e)),this.scheduleGc(),c(this,wr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){c(this,ja).length||(this.state.status==="pending"?this.scheduleGc():c(this,wr).remove(this))}continue(){return c(this,fc)?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{I(this,za,Tl).call(this,{type:"continue"})},i={client:c(this,Qm),meta:this.options.meta,mutationKey:this.options.mutationKey};T(this,fc,SR({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(a,o)=>{I(this,za,Tl).call(this,{type:"failed",failureCount:a,error:o})},onPause:()=>{I(this,za,Tl).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>c(this,wr).canRun(this)}));const r=this.state.status==="pending",s=!c(this,fc).canStart();try{if(r)t();else{I(this,za,Tl).call(this,{type:"pending",variables:e,isPaused:s}),await c(this,wr).config.onMutate?.(e,this,i);const o=await this.options.onMutate?.(e,i);o!==this.state.context&&I(this,za,Tl).call(this,{type:"pending",context:o,variables:e,isPaused:s})}const a=await c(this,fc).start();return await c(this,wr).config.onSuccess?.(a,e,this.state.context,this,i),await this.options.onSuccess?.(a,e,this.state.context,i),await c(this,wr).config.onSettled?.(a,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(a,null,e,this.state.context,i),I(this,za,Tl).call(this,{type:"success",data:a}),a}catch(a){try{throw await c(this,wr).config.onError?.(a,e,this.state.context,this,i),await this.options.onError?.(a,e,this.state.context,i),await c(this,wr).config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,a,e,this.state.context,i),a}finally{I(this,za,Tl).call(this,{type:"error",error:a})}}finally{c(this,wr).runNext(this)}}},Qm=new WeakMap,ja=new WeakMap,wr=new WeakMap,fc=new WeakMap,za=new WeakSet,Tl=function(e){const t=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Sr.batch(()=>{c(this,ja).forEach(i=>{i.onMutationUpdate(e)}),c(this,wr).notify({mutation:this,type:"updated",action:e})})},rT);function a3(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Co,ra,Zm,sT,o3=(sT=class extends hw{constructor(e={}){super();N(this,Co);N(this,ra);N(this,Zm);this.config=e,T(this,Co,new Set),T(this,ra,new Map),T(this,Zm,0)}build(e,t,i){const r=new s3({client:e,mutationCache:this,mutationId:++_i(this,Zm)._,options:e.defaultMutationOptions(t),state:i});return this.add(r),r}add(e){c(this,Co).add(e);const t=Ey(e);if(typeof t=="string"){const i=c(this,ra).get(t);i?i.push(e):c(this,ra).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(c(this,Co).delete(e)){const t=Ey(e);if(typeof t=="string"){const i=c(this,ra).get(t);if(i)if(i.length>1){const r=i.indexOf(e);r!==-1&&i.splice(r,1)}else i[0]===e&&c(this,ra).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Ey(e);if(typeof t=="string"){const r=c(this,ra).get(t)?.find(s=>s.state.status==="pending");return!r||r===e}else return!0}runNext(e){const t=Ey(e);return typeof t=="string"?c(this,ra).get(t)?.find(r=>r!==e&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Sr.batch(()=>{c(this,Co).forEach(e=>{this.notify({type:"removed",mutation:e})}),c(this,Co).clear(),c(this,ra).clear()})}getAll(){return Array.from(c(this,Co))}find(e){const t={exact:!0,...e};return this.getAll().find(i=>fC(t,i))}findAll(e={}){return this.getAll().filter(t=>fC(e,t))}notify(e){Sr.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Sr.batch(()=>Promise.all(e.map(t=>t.continue().catch(ea))))}},Co=new WeakMap,ra=new WeakMap,Zm=new WeakMap,sT);function Ey(n){return n.options.scope?.id}var Ua,aT,l3=(aT=class extends hw{constructor(e={}){super();N(this,Ua);this.config=e,T(this,Ua,new Map)}build(e,t,i){const r=t.queryKey,s=t.queryHash??jA(r,t);let a=this.get(s);return a||(a=new n3({client:e,queryKey:r,queryHash:s,options:e.defaultQueryOptions(t),state:i,defaultOptions:e.getQueryDefaults(r)}),this.add(a)),a}add(e){c(this,Ua).has(e.queryHash)||(c(this,Ua).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=c(this,Ua).get(e.queryHash);t&&(e.destroy(),t===e&&c(this,Ua).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Sr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return c(this,Ua).get(e)}getAll(){return[...c(this,Ua).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(i=>dC(t,i))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(i=>dC(e,i)):t}notify(e){Sr.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Sr.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Sr.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ua=new WeakMap,aT),Un,jl,zl,Pd,Nd,Ul,Id,Ld,oT,kR=(oT=class{constructor(n={}){N(this,Un);N(this,jl);N(this,zl);N(this,Pd);N(this,Nd);N(this,Ul);N(this,Id);N(this,Ld);T(this,Un,n.queryCache||new l3),T(this,jl,n.mutationCache||new o3),T(this,zl,n.defaultOptions||{}),T(this,Pd,new Map),T(this,Nd,new Map),T(this,Ul,0)}mount(){_i(this,Ul)._++,c(this,Ul)===1&&(T(this,Id,AR.subscribe(async n=>{n&&(await this.resumePausedMutations(),c(this,Un).onFocus())})),T(this,Ld,tb.subscribe(async n=>{n&&(await this.resumePausedMutations(),c(this,Un).onOnline())})))}unmount(){var n,e;_i(this,Ul)._--,c(this,Ul)===0&&((n=c(this,Id))==null||n.call(this),T(this,Id,void 0),(e=c(this,Ld))==null||e.call(this),T(this,Ld,void 0))}isFetching(n){return c(this,Un).findAll({...n,fetchStatus:"fetching"}).length}isMutating(n){return c(this,jl).findAll({...n,status:"pending"}).length}getQueryData(n){const e=this.defaultQueryOptions({queryKey:n});return c(this,Un).get(e.queryHash)?.state.data}ensureQueryData(n){const e=this.defaultQueryOptions(n),t=c(this,Un).build(this,e),i=t.state.data;return i===void 0?this.fetchQuery(n):(n.revalidateIfStale&&t.isStaleByTime(i2(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(n){return c(this,Un).findAll(n).map(({queryKey:e,state:t})=>{const i=t.data;return[e,i]})}setQueryData(n,e,t){const i=this.defaultQueryOptions({queryKey:n}),s=c(this,Un).get(i.queryHash)?.state.data,a=UF(e,s);if(a!==void 0)return c(this,Un).build(this,i).setData(a,{...t,manual:!0})}setQueriesData(n,e,t){return Sr.batch(()=>c(this,Un).findAll(n).map(({queryKey:i})=>[i,this.setQueryData(i,e,t)]))}getQueryState(n){const e=this.defaultQueryOptions({queryKey:n});return c(this,Un).get(e.queryHash)?.state}removeQueries(n){const e=c(this,Un);Sr.batch(()=>{e.findAll(n).forEach(t=>{e.remove(t)})})}resetQueries(n,e){const t=c(this,Un);return Sr.batch(()=>(t.findAll(n).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...n},e)))}cancelQueries(n,e={}){const t={revert:!0,...e},i=Sr.batch(()=>c(this,Un).findAll(n).map(r=>r.cancel(t)));return Promise.all(i).then(ea).catch(ea)}invalidateQueries(n,e={}){return Sr.batch(()=>(c(this,Un).findAll(n).forEach(t=>{t.invalidate()}),n?.refetchType==="none"?Promise.resolve():this.refetchQueries({...n,type:n?.refetchType??n?.type??"active"},e)))}refetchQueries(n,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},i=Sr.batch(()=>c(this,Un).findAll(n).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let s=r.fetch(void 0,t);return t.throwOnError||(s=s.catch(ea)),r.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(i).then(ea)}fetchQuery(n){const e=this.defaultQueryOptions(n);e.retry===void 0&&(e.retry=!1);const t=c(this,Un).build(this,e);return t.isStaleByTime(i2(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(n){return this.fetchQuery(n).then(ea).catch(ea)}fetchInfiniteQuery(n){return n.behavior=vC(n.pages),this.fetchQuery(n)}prefetchInfiniteQuery(n){return this.fetchInfiniteQuery(n).then(ea).catch(ea)}ensureInfiniteQueryData(n){return n.behavior=vC(n.pages),this.ensureQueryData(n)}resumePausedMutations(){return tb.isOnline()?c(this,jl).resumePausedMutations():Promise.resolve()}getQueryCache(){return c(this,Un)}getMutationCache(){return c(this,jl)}getDefaultOptions(){return c(this,zl)}setDefaultOptions(n){T(this,zl,n)}setQueryDefaults(n,e){c(this,Pd).set(Lm(n),{queryKey:n,defaultOptions:e})}getQueryDefaults(n){const e=[...c(this,Pd).values()],t={};return e.forEach(i=>{Om(n,i.queryKey)&&Object.assign(t,i.defaultOptions)}),t}setMutationDefaults(n,e){c(this,Nd).set(Lm(n),{mutationKey:n,defaultOptions:e})}getMutationDefaults(n){const e=[...c(this,Nd).values()],t={};return e.forEach(i=>{Om(n,i.mutationKey)&&Object.assign(t,i.defaultOptions)}),t}defaultQueryOptions(n){if(n._defaulted)return n;const e={...c(this,zl).queries,...this.getQueryDefaults(n.queryKey),...n,_defaulted:!0};return e.queryHash||(e.queryHash=jA(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===zA&&(e.enabled=!1),e}defaultMutationOptions(n){return n?._defaulted?n:{...c(this,zl).mutations,...n?.mutationKey&&this.getMutationDefaults(n.mutationKey),...n,_defaulted:!0}}clear(){c(this,Un).clear(),c(this,jl).clear()}},Un=new WeakMap,jl=new WeakMap,zl=new WeakMap,Pd=new WeakMap,Nd=new WeakMap,Ul=new WeakMap,Id=new WeakMap,Ld=new WeakMap,oT),u3=kt.createContext(void 0),TR=({client:n,children:e})=>(kt.useEffect(()=>(n.mount(),()=>{n.unmount()}),[n]),Q.jsx(u3.Provider,{value:n,children:e})),a2={exports:{}},DR={exports:{}},c3=void 0,RR=function(n){return n!==c3&&n!==null},h3=RR,d3={object:!0,function:!0,undefined:!0},f3=function(n){return h3(n)?hasOwnProperty.call(d3,typeof n):!1},p3=f3,m3=function(n){if(!p3(n))return!1;try{return n.constructor?n.constructor.prototype===n:!1}catch{return!1}},g3=m3,v3=function(n){if(typeof n!="function"||!hasOwnProperty.call(n,"length"))return!1;try{if(typeof n.length!="number"||typeof n.call!="function"||typeof n.apply!="function")return!1}catch{return!1}return!g3(n)},y3=v3,b3=/^\s*class[\s{/}]/,w3=Function.prototype.toString,_3=function(n){return!(!y3(n)||b3.test(w3.call(n)))},E3=function(){var n=Object.assign,e;return typeof n!="function"?!1:(e={foo:"raz"},n(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},L1,bC;function A3(){return bC||(bC=1,L1=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),L1}var x3=function(){},S3=x3(),UA=function(n){return n!==S3&&n!==null},O1,wC;function C3(){if(wC)return O1;wC=1;var n=UA,e=Object.keys;return O1=function(t){return e(n(t)?Object(t):t)},O1}var M1,_C;function k3(){return _C||(_C=1,M1=A3()()?Object.keys:C3()),M1}var F1,EC;function T3(){if(EC)return F1;EC=1;var n=UA;return F1=function(e){if(!n(e))throw new TypeError("Cannot use null or undefined");return e},F1}var B1,AC;function D3(){if(AC)return B1;AC=1;var n=k3(),e=T3(),t=Math.max;return B1=function(i,r){var s,a,o=t(arguments.length,2),l;for(i=Object(e(i)),l=function(u){try{i[u]=r[u]}catch(h){s||(s=h)}},a=1;a<o;++a)r=arguments[a],n(r).forEach(l);if(s!==void 0)throw s;return i},B1}var R3=E3()?Object.assign:D3(),P3=UA,N3=Array.prototype.forEach,I3=Object.create,L3=function(n,e){var t;for(t in n)e[t]=n[t]},O3=function(n){var e=I3(null);return N3.call(arguments,function(t){P3(t)&&L3(Object(t),e)}),e},j1="razdwatrzy",M3=function(){return typeof j1.contains!="function"?!1:j1.contains("dwa")===!0&&j1.contains("foo")===!1},z1,xC;function F3(){if(xC)return z1;xC=1;var n=String.prototype.indexOf;return z1=function(e){return n.call(this,e,arguments[1])>-1},z1}var B3=M3()?String.prototype.contains:F3(),qy=RR,SC=_3,PR=R3,NR=O3,cm=B3,j3=DR.exports=function(n,e){var t,i,r,s,a;return arguments.length<2||typeof n!="string"?(s=e,e=n,n=null):s=arguments[2],qy(n)?(t=cm.call(n,"c"),i=cm.call(n,"e"),r=cm.call(n,"w")):(t=r=!0,i=!1),a={value:e,configurable:t,enumerable:i,writable:r},s?PR(NR(s),a):a};j3.gs=function(n,e,t){var i,r,s,a;return typeof n!="string"?(s=t,t=e,e=n,n=null):s=arguments[3],qy(e)?SC(e)?qy(t)?SC(t)||(s=t,t=void 0):t=void 0:(s=e,e=t=void 0):e=void 0,qy(n)?(i=cm.call(n,"c"),r=cm.call(n,"e")):(i=!0,r=!1),a={get:e,set:t,configurable:i,enumerable:r},s?PR(NR(s),a):a};var z3=DR.exports,U3=function(n){if(typeof n!="function")throw new TypeError(n+" is not a function");return n};(function(n,e){var t=z3,i=U3,r=Function.prototype.apply,s=Function.prototype.call,a=Object.create,o=Object.defineProperty,l=Object.defineProperties,u=Object.prototype.hasOwnProperty,h={configurable:!0,enumerable:!1,writable:!0},d,f,m,b,_,w,v;d=function(y,E){var k;return i(E),u.call(this,"__ee__")?k=this.__ee__:(k=h.value=a(null),o(this,"__ee__",h),h.value=null),k[y]?typeof k[y]=="object"?k[y].push(E):k[y]=[k[y],E]:k[y]=E,this},f=function(y,E){var k,S;return i(E),S=this,d.call(this,y,k=function(){m.call(S,y,k),r.call(E,this,arguments)}),k.__eeOnceListener__=E,this},m=function(y,E){var k,S,D,P;if(i(E),!u.call(this,"__ee__"))return this;if(k=this.__ee__,!k[y])return this;if(S=k[y],typeof S=="object")for(P=0;D=S[P];++P)(D===E||D.__eeOnceListener__===E)&&(S.length===2?k[y]=S[P?0:1]:S.splice(P,1));else(S===E||S.__eeOnceListener__===E)&&delete k[y];return this},b=function(y){var E,k,S,D,P;if(u.call(this,"__ee__")&&(D=this.__ee__[y],!!D))if(typeof D=="object"){for(k=arguments.length,P=new Array(k-1),E=1;E<k;++E)P[E-1]=arguments[E];for(D=D.slice(),E=0;S=D[E];++E)r.call(S,this,P)}else switch(arguments.length){case 1:s.call(D,this);break;case 2:s.call(D,this,arguments[1]);break;case 3:s.call(D,this,arguments[1],arguments[2]);break;default:for(k=arguments.length,P=new Array(k-1),E=1;E<k;++E)P[E-1]=arguments[E];r.call(D,this,P)}},_={on:d,once:f,off:m,emit:b},w={on:t(d),once:t(f),off:t(m),emit:t(b)},v=l({},w),n.exports=e=function(y){return y==null?a(v):l(Object(y),w)},e.methods=_})(a2,a2.exports);var $3=a2.exports;const mo=po($3);var zu={},Uu={};function H3(n,e,t){if(t===void 0&&(t=Array.prototype),n&&typeof t.find=="function")return t.find.call(n,e);for(var i=0;i<n.length;i++)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];if(e.call(void 0,r,i,n))return r}}function $A(n,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(n):n}var IR=$A({HTML:"text/html",isHTML:function(n){return n===IR.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),LR=$A({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===LR.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Uu.find=H3;Uu.freeze=$A;Uu.MIME_TYPE=IR;Uu.NAMESPACE=LR;var OR=Uu,uo=OR.find,Mm=OR.NAMESPACE;function q3(n){return n!==""}function W3(n){return n?n.split(/[\t\n\f\r ]+/).filter(q3):[]}function V3(n,e){return n.hasOwnProperty(e)||(n[e]=!0),n}function CC(n){if(!n)return[];var e=W3(n);return Object.keys(e.reduce(V3,{}))}function G3(n){return function(e){return n&&n.indexOf(e)!==-1}}function Dv(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function Qr(n,e){var t=n.prototype;if(!(t instanceof e)){let i=function(){};i.prototype=e.prototype,i=new i,Dv(t,i),n.prototype=t=i}t.constructor!=n&&(typeof n!="function"&&console.error("unknown Class:"+n),t.constructor=n)}var Zr={},Aa=Zr.ELEMENT_NODE=1,Kf=Zr.ATTRIBUTE_NODE=2,nb=Zr.TEXT_NODE=3,MR=Zr.CDATA_SECTION_NODE=4,FR=Zr.ENTITY_REFERENCE_NODE=5,K3=Zr.ENTITY_NODE=6,BR=Zr.PROCESSING_INSTRUCTION_NODE=7,jR=Zr.COMMENT_NODE=8,zR=Zr.DOCUMENT_NODE=9,UR=Zr.DOCUMENT_TYPE_NODE=10,dl=Zr.DOCUMENT_FRAGMENT_NODE=11,X3=Zr.NOTATION_NODE=12,dr={},Ni={};dr.INDEX_SIZE_ERR=(Ni[1]="Index size error",1);dr.DOMSTRING_SIZE_ERR=(Ni[2]="DOMString size error",2);var qr=dr.HIERARCHY_REQUEST_ERR=(Ni[3]="Hierarchy request error",3);dr.WRONG_DOCUMENT_ERR=(Ni[4]="Wrong document",4);dr.INVALID_CHARACTER_ERR=(Ni[5]="Invalid character",5);dr.NO_DATA_ALLOWED_ERR=(Ni[6]="No data allowed",6);dr.NO_MODIFICATION_ALLOWED_ERR=(Ni[7]="No modification allowed",7);var $R=dr.NOT_FOUND_ERR=(Ni[8]="Not found",8);dr.NOT_SUPPORTED_ERR=(Ni[9]="Not supported",9);var kC=dr.INUSE_ATTRIBUTE_ERR=(Ni[10]="Attribute in use",10);dr.INVALID_STATE_ERR=(Ni[11]="Invalid state",11);dr.SYNTAX_ERR=(Ni[12]="Syntax error",12);dr.INVALID_MODIFICATION_ERR=(Ni[13]="Invalid modification",13);dr.NAMESPACE_ERR=(Ni[14]="Invalid namespace",14);dr.INVALID_ACCESS_ERR=(Ni[15]="Invalid access",15);function Zn(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,Ni[n]),this.message=Ni[n],Error.captureStackTrace&&Error.captureStackTrace(this,Zn);return t.code=n,e&&(this.message=this.message+": "+e),t}Zn.prototype=Error.prototype;Dv(dr,Zn);function sl(){}sl.prototype={length:0,item:function(n){return n>=0&&n<this.length?this[n]:null},toString:function(n,e){for(var t=[],i=0;i<this.length;i++)md(this[i],t,n,e);return t.join("")},filter:function(n){return Array.prototype.filter.call(this,n)},indexOf:function(n){return Array.prototype.indexOf.call(this,n)}};function Xf(n,e){this._node=n,this._refresh=e,HA(this)}function HA(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!==e){var t=n._refresh(n._node);if(eP(n,"length",t.length),!n.$$length||t.length<n.$$length)for(var i=t.length;i in n;i++)Object.prototype.hasOwnProperty.call(n,i)&&delete n[i];Dv(t,n),n._inc=e}}Xf.prototype.item=function(n){return HA(this),this[n]||null};Qr(Xf,sl);function ib(){}function HR(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function TC(n,e,t,i){if(i?e[HR(e,i)]=t:e[e.length++]=t,n){t.ownerElement=n;var r=n.ownerDocument;r&&(i&&VR(r,n,i),Y3(r,n,t))}}function DC(n,e,t){var i=HR(e,t);if(i>=0){for(var r=e.length-1;i<r;)e[i]=e[++i];if(e.length=r,n){var s=n.ownerDocument;s&&(VR(s,n,t),t.ownerElement=null)}}else throw new Zn($R,new Error(n.tagName+"@"+t))}ib.prototype={length:0,item:sl.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new Zn(kC);var t=this.getNamedItem(n.nodeName);return TC(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new Zn(kC);return t=this.getNamedItemNS(n.namespaceURI,n.localName),TC(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return DC(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return DC(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var i=this[t];if(i.localName==e&&i.namespaceURI==n)return i}return null}};function qR(){}qR.prototype={hasFeature:function(n,e){return!0},createDocument:function(n,e,t){var i=new Rv;if(i.implementation=this,i.childNodes=new sl,i.doctype=t||null,t&&i.appendChild(t),e){var r=i.createElementNS(n,e);i.appendChild(r)}return i},createDocumentType:function(n,e,t){var i=new fw;return i.name=n,i.nodeName=n,i.publicId=e||"",i.systemId=t||"",i}};function on(){}on.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return rb(this,n,e)},replaceChild:function(n,e){rb(this,n,e,KR),e&&this.removeChild(e)},removeChild:function(n){return GR(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return o2(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==nb&&n.nodeType==nb?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&t[i]===n)return i}e=e.nodeType==Kf?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t&&Object.prototype.hasOwnProperty.call(t,n))return t[n];e=e.nodeType==Kf?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function WR(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}Dv(Zr,on);Dv(Zr,on.prototype);function Fm(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Fm(n,e))return!0;while(n=n.nextSibling)}function Rv(){this.ownerDocument=this}function Y3(n,e,t){n&&n._inc++;var i=t.namespaceURI;i===Mm.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function VR(n,e,t,i){n&&n._inc++;var r=t.namespaceURI;r===Mm.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function qA(n,e,t){if(n&&n._inc){n._inc++;var i=e.childNodes;if(t)i[i.length++]=t;else{for(var r=e.firstChild,s=0;r;)i[s++]=r,r=r.nextSibling;i.length=s,delete i[i.length]}}}function GR(n,e){var t=e.previousSibling,i=e.nextSibling;return t?t.nextSibling=i:n.firstChild=i,i?i.previousSibling=t:n.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,qA(n.ownerDocument,n),e}function Q3(n){return n&&(n.nodeType===on.DOCUMENT_NODE||n.nodeType===on.DOCUMENT_FRAGMENT_NODE||n.nodeType===on.ELEMENT_NODE)}function Z3(n){return n&&(co(n)||WA(n)||fl(n)||n.nodeType===on.DOCUMENT_FRAGMENT_NODE||n.nodeType===on.COMMENT_NODE||n.nodeType===on.PROCESSING_INSTRUCTION_NODE)}function fl(n){return n&&n.nodeType===on.DOCUMENT_TYPE_NODE}function co(n){return n&&n.nodeType===on.ELEMENT_NODE}function WA(n){return n&&n.nodeType===on.TEXT_NODE}function RC(n,e){var t=n.childNodes||[];if(uo(t,co)||fl(e))return!1;var i=uo(t,fl);return!(e&&i&&t.indexOf(i)>t.indexOf(e))}function PC(n,e){var t=n.childNodes||[];function i(s){return co(s)&&s!==e}if(uo(t,i))return!1;var r=uo(t,fl);return!(e&&r&&t.indexOf(r)>t.indexOf(e))}function J3(n,e,t){if(!Q3(n))throw new Zn(qr,"Unexpected parent node type "+n.nodeType);if(t&&t.parentNode!==n)throw new Zn($R,"child not in parent");if(!Z3(e)||fl(e)&&n.nodeType!==on.DOCUMENT_NODE)throw new Zn(qr,"Unexpected node type "+e.nodeType+" for parent node type "+n.nodeType)}function eB(n,e,t){var i=n.childNodes||[],r=e.childNodes||[];if(e.nodeType===on.DOCUMENT_FRAGMENT_NODE){var s=r.filter(co);if(s.length>1||uo(r,WA))throw new Zn(qr,"More than one element or text in fragment");if(s.length===1&&!RC(n,t))throw new Zn(qr,"Element in fragment can not be inserted before doctype")}if(co(e)&&!RC(n,t))throw new Zn(qr,"Only one element can be added and only after doctype");if(fl(e)){if(uo(i,fl))throw new Zn(qr,"Only one doctype is allowed");var a=uo(i,co);if(t&&i.indexOf(a)<i.indexOf(t))throw new Zn(qr,"Doctype can only be inserted before an element");if(!t&&a)throw new Zn(qr,"Doctype can not be appended since element is present")}}function KR(n,e,t){var i=n.childNodes||[],r=e.childNodes||[];if(e.nodeType===on.DOCUMENT_FRAGMENT_NODE){var s=r.filter(co);if(s.length>1||uo(r,WA))throw new Zn(qr,"More than one element or text in fragment");if(s.length===1&&!PC(n,t))throw new Zn(qr,"Element in fragment can not be inserted before doctype")}if(co(e)&&!PC(n,t))throw new Zn(qr,"Only one element can be added and only after doctype");if(fl(e)){if(uo(i,function(l){return fl(l)&&l!==t}))throw new Zn(qr,"Only one doctype is allowed");var a=uo(i,co);if(t&&i.indexOf(a)<i.indexOf(t))throw new Zn(qr,"Doctype can only be inserted before an element")}}function rb(n,e,t,i){J3(n,e,t),n.nodeType===on.DOCUMENT_NODE&&(i||eB)(n,e,t);var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===dl){var s=e.firstChild;if(s==null)return e;var a=e.lastChild}else s=a=e;var o=t?t.previousSibling:n.lastChild;s.previousSibling=o,a.nextSibling=t,o?o.nextSibling=s:n.firstChild=s,t==null?n.lastChild=a:t.previousSibling=a;do s.parentNode=n;while(s!==a&&(s=s.nextSibling));return qA(n.ownerDocument||n,n),e.nodeType==dl&&(e.firstChild=e.lastChild=null),e}function tB(n,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=n,e.previousSibling=n.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:n.firstChild=e,n.lastChild=e,qA(n.ownerDocument,n,e),e}Rv.prototype={nodeName:"#document",nodeType:zR,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==dl){for(var t=n.firstChild;t;){var i=t.nextSibling;this.insertBefore(t,e),t=i}return n}return rb(this,n,e),n.ownerDocument=this,this.documentElement===null&&n.nodeType===Aa&&(this.documentElement=n),n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),GR(this,n)},replaceChild:function(n,e){rb(this,n,e,KR),n.ownerDocument=this,e&&this.removeChild(e),co(n)&&(this.documentElement=n)},importNode:function(n,e){return JR(this,n,e)},getElementById:function(n){var e=null;return Fm(this.documentElement,function(t){if(t.nodeType==Aa&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=CC(n);return new Xf(this,function(t){var i=[];return e.length>0&&Fm(t.documentElement,function(r){if(r!==t&&r.nodeType===Aa){var s=r.getAttribute("class");if(s){var a=n===s;if(!a){var o=CC(s);a=e.every(G3(o))}a&&i.push(r)}}}),i})},createElement:function(n){var e=new Ch;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.localName=n,e.childNodes=new sl;var t=e.attributes=new ib;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new pw;return n.ownerDocument=this,n.childNodes=new sl,n},createTextNode:function(n){var e=new VA;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new GA;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new KA;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new YA;return t.ownerDocument=this,t.tagName=t.nodeName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new sb;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new XA;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new Ch,i=e.split(":"),r=t.attributes=new ib;return t.childNodes=new sl,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=e,r._ownerElement=t,t},createAttributeNS:function(n,e){var t=new sb,i=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=e,t}};Qr(Rv,on);function Ch(){this._nsMap={}}Ch.prototype={nodeType:Aa,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===dl?this.insertBefore(n,null):tB(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var i=this.ownerDocument.createAttributeNS(n,e);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new Xf(this,function(e){var t=[];return Fm(e,function(i){i!==e&&i.nodeType==Aa&&(n==="*"||i.tagName==n)&&t.push(i)}),t})},getElementsByTagNameNS:function(n,e){return new Xf(this,function(t){var i=[];return Fm(t,function(r){r!==t&&r.nodeType===Aa&&(n==="*"||r.namespaceURI===n)&&(e==="*"||r.localName==e)&&i.push(r)}),i})}};Rv.prototype.getElementsByTagName=Ch.prototype.getElementsByTagName;Rv.prototype.getElementsByTagNameNS=Ch.prototype.getElementsByTagNameNS;Qr(Ch,on);function sb(){}sb.prototype.nodeType=Kf;Qr(sb,on);function Pv(){}Pv.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(Ni[qr])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var i=this.data.substring(0,n),r=this.data.substring(n+e);t=i+t+r,this.nodeValue=this.data=t,this.length=t.length}};Qr(Pv,on);function VA(){}VA.prototype={nodeName:"#text",nodeType:nb,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var i=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};Qr(VA,Pv);function GA(){}GA.prototype={nodeName:"#comment",nodeType:jR};Qr(GA,Pv);function KA(){}KA.prototype={nodeName:"#cdata-section",nodeType:MR};Qr(KA,Pv);function fw(){}fw.prototype.nodeType=UR;Qr(fw,on);function XR(){}XR.prototype.nodeType=X3;Qr(XR,on);function YR(){}YR.prototype.nodeType=K3;Qr(YR,on);function XA(){}XA.prototype.nodeType=FR;Qr(XA,on);function pw(){}pw.prototype.nodeName="#document-fragment";pw.prototype.nodeType=dl;Qr(pw,on);function YA(){}YA.prototype.nodeType=BR;Qr(YA,on);function QR(){}QR.prototype.serializeToString=function(n,e,t){return ZR.call(n,e,t)};on.prototype.toString=ZR;function ZR(n,e){var t=[],i=this.nodeType==9&&this.documentElement||this,r=i.prefix,s=i.namespaceURI;if(s&&r==null){var r=i.lookupPrefix(s);if(r==null)var a=[{namespace:s,prefix:null}]}return md(this,t,n,e,a),t.join("")}function NC(n,e,t){var i=n.prefix||"",r=n.namespaceURI;if(!r||i==="xml"&&r===Mm.XML||r===Mm.XMLNS)return!1;for(var s=t.length;s--;){var a=t[s];if(a.prefix===i)return a.namespace!==r}return!0}function U1(n,e,t){n.push(" ",e,'="',t.replace(/[<&"]/g,WR),'"')}function md(n,e,t,i,r){if(r||(r=[]),i)if(n=i(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case Aa:var s=n.attributes,a=s.length,v=n.firstChild,o=n.tagName;t=Mm.isHTML(n.namespaceURI)||t;var l=o;if(!t&&!n.prefix&&n.namespaceURI){for(var u,h=0;h<s.length;h++)if(s.item(h).name==="xmlns"){u=s.item(h).value;break}if(!u)for(var d=r.length-1;d>=0;d--){var f=r[d];if(f.prefix===""&&f.namespace===n.namespaceURI){u=f.namespace;break}}if(u!==n.namespaceURI)for(var d=r.length-1;d>=0;d--){var f=r[d];if(f.namespace===n.namespaceURI){f.prefix&&(l=f.prefix+":"+o);break}}}e.push("<",l);for(var m=0;m<a;m++){var b=s.item(m);b.prefix=="xmlns"?r.push({prefix:b.localName,namespace:b.value}):b.nodeName=="xmlns"&&r.push({prefix:"",namespace:b.value})}for(var m=0;m<a;m++){var b=s.item(m);if(NC(b,t,r)){var _=b.prefix||"",w=b.namespaceURI;U1(e,_?"xmlns:"+_:"xmlns",w),r.push({prefix:_,namespace:w})}md(b,e,t,i,r)}if(o===l&&NC(n,t,r)){var _=n.prefix||"",w=n.namespaceURI;U1(e,_?"xmlns:"+_:"xmlns",w),r.push({prefix:_,namespace:w})}if(v||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(o)){if(e.push(">"),t&&/^script$/i.test(o))for(;v;)v.data?e.push(v.data):md(v,e,t,i,r.slice()),v=v.nextSibling;else for(;v;)md(v,e,t,i,r.slice()),v=v.nextSibling;e.push("</",l,">")}else e.push("/>");return;case zR:case dl:for(var v=n.firstChild;v;)md(v,e,t,i,r.slice()),v=v.nextSibling;return;case Kf:return U1(e,n.name,n.value);case nb:return e.push(n.data.replace(/[<&]/g,WR).replace(/]]>/g,"]]&gt;"));case MR:return e.push("<![CDATA[",n.data,"]]>");case jR:return e.push("<!--",n.data,"-->");case UR:var y=n.publicId,E=n.systemId;if(e.push("<!DOCTYPE ",n.name),y)e.push(" PUBLIC ",y),E&&E!="."&&e.push(" ",E),e.push(">");else if(E&&E!=".")e.push(" SYSTEM ",E,">");else{var k=n.internalSubset;k&&e.push(" [",k,"]"),e.push(">")}return;case BR:return e.push("<?",n.target," ",n.data,"?>");case FR:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function JR(n,e,t){var i;switch(e.nodeType){case Aa:i=e.cloneNode(!1),i.ownerDocument=n;case dl:break;case Kf:t=!0;break}if(i||(i=e.cloneNode(!1)),i.ownerDocument=n,i.parentNode=null,t)for(var r=e.firstChild;r;)i.appendChild(JR(n,r,t)),r=r.nextSibling;return i}function o2(n,e,t){var i=new e.constructor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var s=e[r];typeof s!="object"&&s!=i[r]&&(i[r]=s)}switch(e.childNodes&&(i.childNodes=new sl),i.ownerDocument=n,i.nodeType){case Aa:var a=e.attributes,o=i.attributes=new ib,l=a.length;o._ownerElement=i;for(var u=0;u<l;u++)i.setAttributeNode(o2(n,a.item(u),!0));break;case Kf:t=!0}if(t)for(var h=e.firstChild;h;)i.appendChild(o2(n,h,t)),h=h.nextSibling;return i}function eP(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case Aa:case dl:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};Object.defineProperty(Xf.prototype,"length",{get:function(){return HA(this),this.$$length}}),Object.defineProperty(on.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case Aa:case dl:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),eP=function(e,t,i){e["$$"+t]=i}}}catch{}zu.DocumentType=fw;zu.DOMException=Zn;zu.DOMImplementation=qR;zu.Element=Ch;zu.Node=on;zu.NodeList=sl;zu.XMLSerializer=QR;var Nv={},tP={};(function(n){var e=Uu.freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),n.entityMap=n.HTML_ENTITIES})(tP);var QA={},Bm=Uu.NAMESPACE,l2=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,IC=new RegExp("[\\-\\.0-9"+l2.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),LC=new RegExp("^"+l2.source+IC.source+"*(?::"+l2.source+IC.source+"*)?$"),Ap=0,kl=1,$h=2,xp=3,Hh=4,qh=5,Sp=6,Ay=7;function Yf(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Yf)}Yf.prototype=new Error;Yf.prototype.name=Yf.name;function nP(){}nP.prototype={parse:function(n,e,t){var i=this.domBuilder;i.startDocument(),iP(e,e={}),nB(n,e,t,i,this.errorHandler),i.endDocument()}};function nB(n,e,t,i,r){function s(ve){if(ve>65535){ve-=65536;var xe=55296+(ve>>10),he=56320+(ve&1023);return String.fromCharCode(xe,he)}else return String.fromCharCode(ve)}function a(ve){var xe=ve.slice(1,-1);return xe in t?t[xe]:xe.charAt(0)==="#"?s(parseInt(xe.substr(1).replace("x","0x"))):(r.error("entity not found:"+ve),ve)}function o(ve){if(ve>_){var xe=n.substring(_,ve).replace(/&#?\w+;/g,a);f&&l(_),i.characters(xe,0,ve-_),_=ve}}function l(ve,xe){for(;ve>=h&&(xe=d.exec(n));)u=xe.index,h=u+xe[0].length,f.lineNumber++;f.columnNumber=ve-u+1}for(var u=0,h=0,d=/.*(?:\r\n?|\n)|.*$/g,f=i.locator,m=[{currentNSMap:e}],b={},_=0;;){try{var w=n.indexOf("<",_);if(w<0){if(!n.substr(_).match(/^\s*$/)){var v=i.doc,y=v.createTextNode(n.substr(_));v.appendChild(y),i.currentElement=y}return}switch(w>_&&o(w),n.charAt(w+1)){case"/":var te=n.indexOf(">",w+3),E=n.substring(w+2,te).replace(/[ \t\n\r]+$/g,""),k=m.pop();te<0?(E=n.substring(w+2).replace(/[\s<].*/,""),r.error("end tag name: "+E+" is not complete:"+k.tagName),te=w+1+E.length):E.match(/\s</)&&(E=E.replace(/[\s<].*/,""),r.error("end tag name: "+E+" maybe not complete"),te=w+1+E.length);var S=k.localNSMap,D=k.tagName==E,P=D||k.tagName&&k.tagName.toLowerCase()==E.toLowerCase();if(P){if(i.endElement(k.uri,k.localName,E),S)for(var F in S)Object.prototype.hasOwnProperty.call(S,F)&&i.endPrefixMapping(F);D||r.fatalError("end tag name: "+E+" is not match the current start tagName:"+k.tagName)}else m.push(k);te++;break;case"?":f&&l(w),te=oB(n,w,i);break;case"!":f&&l(w),te=aB(n,w,i,r);break;default:f&&l(w);var H=new rP,z=m[m.length-1].currentNSMap,te=iB(n,w,H,z,a,r),de=H.length;if(!H.closed&&sB(n,te,H.tagName,b)&&(H.closed=!0,t.nbsp||r.warning("unclosed xml attribute")),f&&de){for(var ke=OC(f,{}),Me=0;Me<de;Me++){var ze=H[Me];l(ze.offset),ze.locator=OC(f,{})}i.locator=ke,MC(H,i,z)&&m.push(H),i.locator=f}else MC(H,i,z)&&m.push(H);Bm.isHTML(H.uri)&&!H.closed?te=rB(n,te,H.tagName,a,i):te++}}catch(ve){if(ve instanceof Yf)throw ve;r.error("element parse error: "+ve),te=-1}te>_?_=te:o(Math.max(w,_)+1)}}function OC(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function iB(n,e,t,i,r,s){function a(f,m,b){t.attributeNames.hasOwnProperty(f)&&s.fatalError("Attribute "+f+" redefined"),t.addValue(f,m,b)}for(var o,l,u=++e,h=Ap;;){var d=n.charAt(u);switch(d){case"=":if(h===kl)o=n.slice(e,u),h=xp;else if(h===$h)h=xp;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(h===xp||h===kl)if(h===kl&&(s.warning('attribute value must after "="'),o=n.slice(e,u)),e=u+1,u=n.indexOf(d,e),u>0)l=n.slice(e,u).replace(/&#?\w+;/g,r),a(o,l,e-1),h=qh;else throw new Error("attribute value no end '"+d+"' match");else if(h==Hh)l=n.slice(e,u).replace(/&#?\w+;/g,r),a(o,l,e),s.warning('attribute "'+o+'" missed start quot('+d+")!!"),e=u+1,h=qh;else throw new Error('attribute value must after "="');break;case"/":switch(h){case Ap:t.setTagName(n.slice(e,u));case qh:case Sp:case Ay:h=Ay,t.closed=!0;case Hh:case kl:break;case $h:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),h==Ap&&t.setTagName(n.slice(e,u)),u;case">":switch(h){case Ap:t.setTagName(n.slice(e,u));case qh:case Sp:case Ay:break;case Hh:case kl:l=n.slice(e,u),l.slice(-1)==="/"&&(t.closed=!0,l=l.slice(0,-1));case $h:h===$h&&(l=o),h==Hh?(s.warning('attribute "'+l+'" missed quot(")!'),a(o,l.replace(/&#?\w+;/g,r),e)):((!Bm.isHTML(i[""])||!l.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),a(l,l,e));break;case xp:throw new Error("attribute value missed!!")}return u;case"":d=" ";default:if(d<=" ")switch(h){case Ap:t.setTagName(n.slice(e,u)),h=Sp;break;case kl:o=n.slice(e,u),h=$h;break;case Hh:var l=n.slice(e,u).replace(/&#?\w+;/g,r);s.warning('attribute "'+l+'" missed quot(")!!'),a(o,l,e);case qh:h=Sp;break}else switch(h){case $h:t.tagName,(!Bm.isHTML(i[""])||!o.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),a(o,o,e),e=u,h=kl;break;case qh:s.warning('attribute space is required"'+o+'"!!');case Sp:h=kl,e=u;break;case xp:h=Hh,e=u;break;case Ay:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function MC(n,e,t){for(var i=n.tagName,r=null,d=n.length;d--;){var s=n[d],a=s.qName,o=s.value,f=a.indexOf(":");if(f>0)var l=s.prefix=a.slice(0,f),u=a.slice(f+1),h=l==="xmlns"&&u;else u=a,l=null,h=a==="xmlns"&&"";s.localName=u,h!==!1&&(r==null&&(r={},iP(t,t={})),t[h]=r[h]=o,s.uri=Bm.XMLNS,e.startPrefixMapping(h,o))}for(var d=n.length;d--;){s=n[d];var l=s.prefix;l&&(l==="xml"&&(s.uri=Bm.XML),l!=="xmlns"&&(s.uri=t[l||""]))}var f=i.indexOf(":");f>0?(l=n.prefix=i.slice(0,f),u=n.localName=i.slice(f+1)):(l=null,u=n.localName=i);var m=n.uri=t[l||""];if(e.startElement(m,u,i,n),n.closed){if(e.endElement(m,u,i),r)for(l in r)Object.prototype.hasOwnProperty.call(r,l)&&e.endPrefixMapping(l)}else return n.currentNSMap=t,n.localNSMap=r,!0}function rB(n,e,t,i,r){if(/^(?:script|textarea)$/i.test(t)){var s=n.indexOf("</"+t+">",e),a=n.substring(e+1,s);if(/[&<]/.test(a))return/^script$/i.test(t)?(r.characters(a,0,a.length),s):(a=a.replace(/&#?\w+;/g,i),r.characters(a,0,a.length),s)}return e+1}function sB(n,e,t,i){var r=i[t];return r==null&&(r=n.lastIndexOf("</"+t+">"),r<e&&(r=n.lastIndexOf("</"+t)),i[t]=r),r<e}function iP(n,e){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}function aB(n,e,t,i){var r=n.charAt(e+2);switch(r){case"-":if(n.charAt(e+3)==="-"){var s=n.indexOf("-->",e+4);return s>e?(t.comment(n,e+4,s-e-4),s+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var s=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,s-e-9),t.endCDATA(),s+3}var a=lB(n,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var l=a[1][0],u=!1,h=!1;o>3&&(/^public$/i.test(a[2][0])?(u=a[3][0],h=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(h=a[3][0]));var d=a[o-1];return t.startDTD(l,u,h),t.endDTD(),d.index+d[0].length}}return-1}function oB(n,e,t){var i=n.indexOf("?>",e);if(i){var r=n.substring(e,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return r?(r[0].length,t.processingInstruction(r[1],r[2]),i+2):-1}return-1}function rP(){this.attributeNames={}}rP.prototype={setTagName:function(n){if(!LC.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!LC.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function lB(n,e){var t,i=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=e,r.exec(n);t=r.exec(n);)if(i.push(t),t[1])return i}QA.XMLReader=nP;QA.ParseError=Yf;var uB=Uu,ZA=zu,FC=tP,sP=QA,cB=ZA.DOMImplementation,BC=uB.NAMESPACE,hB=sP.ParseError,dB=sP.XMLReader;function aP(n){this.options=n||{locator:{}}}aP.prototype.parseFromString=function(n,e){var t=this.options,i=new dB,r=t.domBuilder||new Iv,s=t.errorHandler,a=t.locator,o=t.xmlns||{},l=/\/x?html?$/.test(e),u=l?FC.HTML_ENTITIES:FC.XML_ENTITIES;return a&&r.setDocumentLocator(a),i.errorHandler=fB(s,r,a),i.domBuilder=t.domBuilder||r,l&&(o[""]=BC.HTML),o.xml=o.xml||BC.XML,n&&typeof n=="string"?i.parse(n,o,u):i.errorHandler.error("invalid doc source"),r.doc};function fB(n,e,t){if(!n){if(e instanceof Iv)return e;n=e}var i={},r=n instanceof Function;t=t||{};function s(a){var o=n[a];!o&&r&&(o=n.length==2?function(l){n(a,l)}:n),i[a]=o&&function(l){o("[xmldom "+a+"]	"+l+u2(t))}||function(){}}return s("warning"),s("error"),s("fatalError"),i}function Iv(){this.cdata=!1}function Wh(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}Iv.prototype={startDocument:function(){this.doc=new cB().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,i){var r=this.doc,s=r.createElementNS(n,t||e),a=i.length;xy(this,s),this.currentElement=s,this.locator&&Wh(this.locator,s);for(var o=0;o<a;o++){var n=i.getURI(o),l=i.getValue(o),t=i.getQName(o),u=r.createAttributeNS(n,t);this.locator&&Wh(i.getLocator(o),u),u.value=u.nodeValue=l,s.setAttributeNode(u)}},endElement:function(n,e,t){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&Wh(this.locator,t),xy(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=jC.apply(this,arguments),n){if(this.cdata)var i=this.doc.createCDATASection(n);else var i=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(n)&&this.doc.appendChild(i),this.locator&&Wh(this.locator,i)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=jC.apply(this,arguments);var i=this.doc.createComment(n);this.locator&&Wh(this.locator,i),xy(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var i=this.doc.implementation;if(i&&i.createDocumentType){var r=i.createDocumentType(n,e,t);this.locator&&Wh(this.locator,r),xy(this,r),this.doc.doctype=r}},warning:function(n){console.warn("[xmldom warning]	"+n,u2(this.locator))},error:function(n){console.error("[xmldom error]	"+n,u2(this.locator))},fatalError:function(n){throw new hB(n,this.locator)}};function u2(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function jC(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){Iv.prototype[n]=function(){return null}});function xy(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}Nv.__DOMHandler=Iv;Nv.DOMParser=aP;Nv.DOMImplementation=ZA.DOMImplementation;Nv.XMLSerializer=ZA.XMLSerializer;var oP=Nv.DOMParser;const JA=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,pB=1,mB=3,lP=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function mw(){var n=new Date().getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)});return e}function gB(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function uP(n){return!!(n&&n.nodeType==1)}function qn(n){return!isNaN(parseFloat(n))&&isFinite(n)}function cP(n){let e=parseFloat(n);return qn(n)===!1?!1:typeof n=="string"&&n.indexOf(".")>-1?!0:Math.floor(e)!==e}function Gh(n){var e=["Webkit","webkit","Moz","O","ms"],t=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=n.toLowerCase(),r=e.length;if(typeof document>"u"||typeof document.body.style[i]<"u")return n;for(var s=0;s<r;s++)if(typeof document.body.style[t[s]+i]<"u")return t[s]+i;return n}function hP(n){for(var e=1,t=arguments.length;e<t;e++){var i=arguments[e];for(var r in i)n[r]===void 0&&(n[r]=i[r])}return n}function qi(n){var e=[].slice.call(arguments,1);return e.forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}),n}function vB(n,e,t){var i=Qf(n,e,t);return e.splice(i,0,n),i}function Qf(n,e,t,i,r){var s=i||0,a=r||e.length,o=parseInt(s+(a-s)/2),l;return t||(t=function(u,h){if(u>h)return 1;if(u<h)return-1;if(u==h)return 0}),a-s<=0?o:(l=t(e[o],n),a-s===1?l>=0?o:o+1:l===0?o:l===-1?Qf(n,e,t,o,a):Qf(n,e,t,s,o))}function ab(n,e,t,i,r){var s=i||0,a=r||e.length,o=parseInt(s+(a-s)/2),l;return t||(t=function(u,h){if(u>h)return 1;if(u<h)return-1;if(u==h)return 0}),a-s<=0?-1:(l=t(e[o],n),a-s===1?l===0?o:-1:l===0?o:l===-1?ab(n,e,t,o,a):ab(n,e,t,s,o))}function Wy(n){var e=window.getComputedStyle(n),t=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],r=0,s=0;return t.forEach(function(a){r+=parseFloat(e[a])||0}),i.forEach(function(a){s+=parseFloat(e[a])||0}),{height:s,width:r}}function ob(n){var e=window.getComputedStyle(n),t=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],r=0,s=0;return t.forEach(function(a){r+=parseFloat(e[a])||0}),i.forEach(function(a){s+=parseFloat(e[a])||0}),{height:s,width:r}}function c2(n){let e,t=n.ownerDocument;if(n.nodeType==Node.TEXT_NODE){let i=t.createRange();i.selectNodeContents(n),e=i.getBoundingClientRect()}else e=n.getBoundingClientRect();return e}function lb(){var n=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:n,bottom:e,width:n,height:e}}function ex(n,e){for(var t=n.parentNode,i=t.childNodes,r,s=-1,a=0;a<i.length&&(r=i[a],r.nodeType===e&&s++,r!=n);a++);return s}function yB(n){return ex(n,mB)}function dP(n){return ex(n,pB)}function jm(n){return["xml","opf","ncx"].indexOf(n)>-1}function fP(n,e){return new Blob([n],{type:e})}function ub(n,e){var t,i=fP(n,e);return t=lP.createObjectURL(i),t}function pP(n){return lP.revokeObjectURL(n)}function h2(n,e){var t,i;if(typeof n=="string")return t=btoa(n),i="data:"+e+";base64,"+t,i}function mP(n){return Object.prototype.toString.call(n).slice(8,-1)}function ho(n,e,t){var i,r;return typeof DOMParser>"u"||t?r=oP:r=DOMParser,n.charCodeAt(0)===65279&&(n=n.slice(1)),i=new r().parseFromString(n,e),i}function fn(n,e){var t;if(!n)throw new Error("No Element Provided");if(typeof n.querySelector<"u")return n.querySelector(e);if(t=n.getElementsByTagName(e),t.length)return t[0]}function pl(n,e){return typeof n.querySelector<"u"?n.querySelectorAll(e):n.getElementsByTagName(e)}function Kh(n,e,t){var i,r;if(typeof n.querySelector<"u"){e+="[";for(var s in t)e+=s+"~='"+t[s]+"'";return e+="]",n.querySelector(e)}else if(i=n.getElementsByTagName(e),r=Array.prototype.slice.call(i,0).filter(function(a){for(var o in t)if(a.getAttribute(o)===t[o])return!0;return!1}),r)return r[0]}function cb(n,e){var t=n.ownerDocument||n;typeof t.createTreeWalker<"u"?gP(n,e,NodeFilter.SHOW_TEXT):tx(n,function(i){i&&i.nodeType===3&&e(i)})}function gP(n,e,t){var i=document.createTreeWalker(n,t,null,!1);let r;for(;r=i.nextNode();)e(r)}function tx(n,e){if(e(n))return!0;if(n=n.firstChild,n)do{if(tx(n,e))return!0;n=n.nextSibling}while(n)}function vP(n){return new Promise(function(e,t){var i=new FileReader;i.readAsDataURL(n),i.onloadend=function(){e(i.result)}})}function Ht(){this.resolve=null,this.reject=null,this.id=mw(),this.promise=new Promise((n,e)=>{this.resolve=n,this.reject=e}),Object.freeze(this)}function hb(n,e,t){var i;if(typeof n.querySelector<"u"&&(i=n.querySelector(`${e}[*|type="${t}"]`)),!i||i.length===0){i=pl(n,e);for(var r=0;r<i.length;r++)if(i[r].getAttributeNS("http://www.idpf.org/2007/ops","type")===t||i[r].getAttribute("epub:type")===t)return i[r]}else return i}function d2(n){for(var e=[],t=n.childNodes,i=0;i<t.length;i++){let r=t[i];r.nodeType===1&&e.push(r)}return e}function f2(n){for(var e=[n];n;n=n.parentNode)e.unshift(n);return e}function Xh(n,e,t){for(var i=[],r=n.childNodes,s=0;s<r.length;s++){let a=r[s];if(a.nodeType===1&&a.nodeName.toLowerCase()===e){if(t)return a;i.push(a)}}if(!t)return i}function bB(n,e){let t;if(!(n===null||e===""))for(t=n.parentNode;t.nodeType===1;){if(t.tagName.toLowerCase()===e)return t;t=t.parentNode}}class yP{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,i=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,i),this.setEnd(t,i+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var i=f2(e||this.startContainer),r=f2(t||this.endContainer);if(i[0]==r[0]){for(var s=0;s<i.length;s++)if(i[s]!=r[s])return i[s-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const wB=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:yP,blob2base64:vP,borders:ob,bounds:Wy,createBase64Url:h2,createBlob:fP,createBlobUrl:ub,defaults:hP,defer:Ht,documentHeight:gB,extend:qi,filterChildren:Xh,findChildren:d2,getParentByTagName:bB,indexOfElementNode:dP,indexOfNode:ex,indexOfSorted:ab,indexOfTextNode:yB,insert:vB,isElement:uP,isFloat:cP,isNumber:qn,isXml:jm,locationOf:Qf,nodeBounds:c2,parents:f2,parse:ho,prefixed:Gh,qs:fn,qsa:pl,qsp:Kh,querySelectorByType:hb,requestAnimationFrame:JA,revokeBlobUrl:pP,sprint:cb,treeWalker:gP,type:mP,uuid:mw,walk:tx,windowBounds:lb},Symbol.toStringTag,{value:"Module"}));if(!bP)var bP={cwd:function(){return"/"}};function Na(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+n)}function zC(n,e){for(var t="",i=-1,r=0,s,a=0;a<=n.length;++a){if(a<n.length)s=n.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||r===1))if(i!==a-1&&r===2){if(t.length<2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){for(var o=t.length-1,l=o;l>=0&&t.charCodeAt(l)!==47;--l);if(l!==o){l===-1?t="":t=t.slice(0,l),i=a,r=0;continue}}else if(t.length===2||t.length===1){t="",i=a,r=0;continue}}e&&(t.length>0?t+="/..":t="..")}else t.length>0?t+="/"+n.slice(i+1,a):t=n.slice(i+1,a);i=a,r=0}else s===46&&r!==-1?++r:r=-1}return t}function _B(n,e){var t=e.dir||e.root,i=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+i:t+n+i:i}var Vy={resolve:function(){for(var e="",t=!1,i,r=arguments.length-1;r>=-1&&!t;r--){var s;r>=0?s=arguments[r]:(i===void 0&&(i=bP.cwd()),s=i),Na(s),s.length!==0&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=zC(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Na(e),e.length===0)return".";var t=e.charCodeAt(0)===47,i=e.charCodeAt(e.length-1)===47;return e=zC(e,!t),e.length===0&&!t&&(e="."),e.length>0&&i&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Na(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var i=arguments[t];Na(i),i.length>0&&(e===void 0?e=i:e+="/"+i)}return e===void 0?".":Vy.normalize(e)},relative:function(e,t){if(Na(e),Na(t),e===t||(e=Vy.resolve(e),t=Vy.resolve(t),e===t))return"";for(var i=1;i<e.length&&e.charCodeAt(i)===47;++i);for(var r=e.length,s=r-i,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var o=t.length,l=o-a,u=s<l?s:l,h=-1,d=0;d<=u;++d){if(d===u){if(l>u){if(t.charCodeAt(a+d)===47)return t.slice(a+d+1);if(d===0)return t.slice(a+d)}else s>u&&(e.charCodeAt(i+d)===47?h=d:d===0&&(h=0));break}var f=e.charCodeAt(i+d),m=t.charCodeAt(a+d);if(f!==m)break;f===47&&(h=d)}var b="";for(d=i+h+1;d<=r;++d)(d===r||e.charCodeAt(d)===47)&&(b.length===0?b+="..":b+="/..");return b.length>0?b+t.slice(a+h):(a+=h,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(Na(e),e.length===0)return".";for(var t=e.charCodeAt(0),i=t===47,r=-1,s=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!s){r=a;break}}else s=!1;return r===-1?i?"/":".":i&&r===1?"//":e.slice(0,r)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Na(e);var i=0,r=-1,s=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,l=-1;for(a=e.length-1;a>=0;--a){var u=e.charCodeAt(a);if(u===47){if(!s){i=a+1;break}}else l===-1&&(s=!1,l=a+1),o>=0&&(u===t.charCodeAt(o)?--o===-1&&(r=a):(o=-1,r=l))}return i===r?r=l:r===-1&&(r=e.length),e.slice(i,r)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!s){i=a+1;break}}else r===-1&&(s=!1,r=a+1);return r===-1?"":e.slice(i,r)}},extname:function(e){Na(e);for(var t=-1,i=0,r=-1,s=!0,a=0,o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!s){i=o+1;break}continue}r===-1&&(s=!1,r=o+1),l===46?t===-1?t=o:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||r===-1||a===0||a===1&&t===r-1&&t===i+1?"":e.slice(t,r)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof e);return _B("/",e)},parse:function(e){Na(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var i=e.charCodeAt(0),r=i===47,s;r?(t.root="/",s=1):s=0;for(var a=-1,o=0,l=-1,u=!0,h=e.length-1,d=0;h>=s;--h){if(i=e.charCodeAt(h),i===47){if(!u){o=h+1;break}continue}l===-1&&(u=!1,l=h+1),i===46?a===-1?a=h:d!==1&&(d=1):a!==-1&&(d=-1)}return a===-1||l===-1||d===0||d===1&&a===l-1&&a===o+1?l!==-1&&(o===0&&r?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(o,l)):(o===0&&r?(t.name=e.slice(1,a),t.base=e.slice(1,l)):(t.name=e.slice(o,a),t.base=e.slice(o,l)),t.ext=e.slice(a,l)),o>0?t.dir=e.slice(0,o-1):r&&(t.dir="/"),t},sep:"/",delimiter:":",posix:null},EB=Vy;const wu=po(EB);class ml{constructor(e){var t,i;t=e.indexOf("://"),t>-1&&(e=new URL(e).pathname),i=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(e){return wu.parse(e)}isAbsolute(e){return wu.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)==="/"}resolve(e){return wu.resolve(this.directory,e)}relative(e){var t=e&&e.indexOf("://")>-1;return t?e:wu.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}}class ta{constructor(e,t){var i=e.indexOf("://")>-1,r=e,s;if(this.Url=void 0,this.href=e,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=t,!i&&t!==!1&&typeof t!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,r=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(s=new ml(this.base),r=s.resolve(r))}this.Path=new ml(r),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf("://")>-1,i;return t?e:(i=wu.resolve(this.directory,e),this.origin+i)}relative(e){return wu.relative(e,this.directory)}toString(){return this.href}}const Vh=1,ks=3,AB=9;class qt{constructor(e,t,i){var r;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof qt))return new qt(e,t,i);if(typeof t=="string"?this.base=this.parseComponent(t):typeof t=="object"&&t.steps&&(this.base=t),r=this.checkType(e),r==="string")return this.str=e,qi(this,this.parse(e));if(r==="range")return qi(this,this.fromRange(e,this.base,i));if(r==="node")return qi(this,this.fromNode(e,this.base,i));if(r==="EpubCFI"&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(e){return this.isCfiString(e)?"string":e&&typeof e=="object"&&(mP(e)==="Range"||typeof e.startContainer<"u")?"range":e&&typeof e=="object"&&typeof e.nodeType<"u"?"node":e&&typeof e=="object"&&e instanceof qt?"EpubCFI":!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,r,s;return typeof e!="string"?{spinePos:-1}:(e.indexOf("epubcfi(")===0&&e[e.length-1]===")"&&(e=e.slice(8,e.length-1)),i=this.getChapterComponent(e),i?(t.base=this.parseComponent(i),r=this.getPathComponent(e),t.path=this.parseComponent(r),s=this.getRange(e),s&&(t.range=!0,t.start=this.parseComponent(s[0]),t.end=this.parseComponent(s[1])),t.spinePos=t.base.steps[1].index,t):{spinePos:-1})}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},i=e.split(":"),r=i[0].split("/"),s;return i.length>1&&(s=i[1],t.terminal=this.parseTerminal(s)),r[0]===""&&r.shift(),t.steps=r.map(function(a){return this.parseStep(a)}.bind(this)),t}parseStep(e){var t,i,r,s,a;if(s=e.match(/\[(.*)\]/),s&&s[1]&&(a=s[1]),i=parseInt(e),!isNaN(i))return i%2===0?(t="element",r=i/2-1):(t="text",r=(i-1)/2),{type:t,index:r,id:a||null}}parseTerminal(e){var t,i,r=e.match(/\[(.*)\]/);return r&&r[1]?(t=parseInt(e.split("[")[0]),i=r[1]):t=parseInt(e),qn(t)||(t=null),{offset:t,assertion:i}}getChapterComponent(e){var t=e.split("!");return t[0]}getPathComponent(e){var t=e.split("!");if(t[1])return t[1].split(",")[0]}getRange(e){var t=e.split(",");return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){var t=e.split(":");return t[1]||""}joinSteps(e){return e?e.map(function(t){var i="";return t.type==="element"&&(i+=(t.index+1)*2),t.type==="text"&&(i+=1+2*t.index),t.id&&(i+="["+t.id+"]"),i}).join("/"):""}segmentString(e){var t="/";return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=":"+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+="["+e.terminal.assertion+"]"),t}toString(){var e="epubcfi(";return e+=this.segmentString(this.base),e+="!",e+=this.segmentString(this.path),this.range&&this.start&&(e+=",",e+=this.segmentString(this.start)),this.range&&this.end&&(e+=",",e+=this.segmentString(this.end)),e+=")",e}compare(e,t){var i,r,s,a;if(typeof e=="string"&&(e=new qt(e)),typeof t=="string"&&(t=new qt(t)),e.spinePos>t.spinePos)return 1;if(e.spinePos<t.spinePos)return-1;e.range?(i=e.path.steps.concat(e.start.steps),s=e.start.terminal):(i=e.path.steps,s=e.path.terminal),t.range?(r=t.path.steps.concat(t.start.steps),a=t.start.terminal):(r=t.path.steps,a=t.path.terminal);for(var o=0;o<i.length;o++){if(!i[o])return-1;if(!r[o]||i[o].index>r[o].index)return 1;if(i[o].index<r[o].index)return-1}return i.length<r.length?-1:s.offset>a.offset?1:s.offset<a.offset?-1:0}step(e){var t=e.nodeType===ks?"text":"element";return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var i=this.filter(e,t),r;if(i)return r=i.nodeType===ks?"text":"element",{id:i.id,tagName:i.tagName,type:r,index:this.filteredPosition(i,t)}}pathTo(e,t,i){for(var r={steps:[],terminal:{offset:null,assertion:null}},s=e,a;s&&s.parentNode&&s.parentNode.nodeType!=AB;)i?a=this.filteredStep(s,i):a=this.step(s),a&&r.steps.unshift(a),s=s.parentNode;return t!=null&&t>=0&&(r.terminal.offset=t,r.steps[r.steps.length-1].type!="text"&&r.steps.push({type:"text",index:0})),r}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,i){var r={range:!1,base:{},path:{},start:null,end:null},s=e.startContainer,a=e.endContainer,o=e.startOffset,l=e.endOffset,u=!1;if(i&&(u=s.ownerDocument.querySelector("."+i)!=null),typeof t=="string"?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):typeof t=="object"&&(r.base=t),e.collapsed)u&&(o=this.patchOffset(s,o,i)),r.path=this.pathTo(s,o,i);else{r.range=!0,u&&(o=this.patchOffset(s,o,i)),r.start=this.pathTo(s,o,i),u&&(l=this.patchOffset(a,l,i)),r.end=this.pathTo(a,l,i),r.path={steps:[],terminal:null};var h=r.start.steps.length,d;for(d=0;d<h&&this.equalStep(r.start.steps[d],r.end.steps[d]);d++)d===h-1?r.start.terminal===r.end.terminal&&(r.path.steps.push(r.start.steps[d]),r.range=!1):r.path.steps.push(r.start.steps[d]);r.start.steps=r.start.steps.slice(r.path.steps.length),r.end.steps=r.end.steps.slice(r.path.steps.length)}return r}fromNode(e,t,i){var r={range:!1,base:{},path:{},start:null,end:null};return typeof t=="string"?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):typeof t=="object"&&(r.base=t),r.path=this.pathTo(e,null,i),r}filter(e,t){var i,r,s,a,o,l=!1;return e.nodeType===ks?(l=!0,s=e.parentNode,i=e.parentNode.classList.contains(t)):(l=!1,i=e.classList.contains(t)),i&&l?(a=s.previousSibling,o=s.nextSibling,a&&a.nodeType===ks?r=a:o&&o.nodeType===ks&&(r=o),r||e):i&&!l?!1:e}patchOffset(e,t,i){if(e.nodeType!=ks)throw new Error("Anchor must be a text node");var r=e,s=t;for(e.parentNode.classList.contains(i)&&(r=e.parentNode);r.previousSibling;){if(r.previousSibling.nodeType===Vh)if(r.previousSibling.classList.contains(i))s+=r.previousSibling.textContent.length;else break;else s+=r.previousSibling.textContent.length;r=r.previousSibling}return s}normalizedMap(e,t,i){var r={},s=-1,a,o=e.length,l,u;for(a=0;a<o;a++)l=e[a].nodeType,l===Vh&&e[a].classList.contains(i)&&(l=ks),a>0&&l===ks&&u===ks?r[a]=s:t===l&&(s=s+1,r[a]=s),u=l;return r}position(e){var t,i;return e.nodeType===Vh?(t=e.parentNode.children,t||(t=d2(e.parentNode)),i=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),i=t.indexOf(e)),i}filteredPosition(e,t){var i,r,s;return e.nodeType===Vh?(i=e.parentNode.children,s=this.normalizedMap(i,Vh,t)):(i=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,i=e.parentNode.childNodes),s=this.normalizedMap(i,ks,t)),r=Array.prototype.indexOf.call(i,e),s[r]}stepsToXpath(e){var t=[".","*"];return e.forEach(function(i){var r=i.index+1;i.id?t.push("*[position()="+r+" and @id='"+i.id+"']"):i.type==="text"?t.push("text()["+r+"]"):t.push("*["+r+"]")}),t.join("/")}stepsToQuerySelector(e){var t=["html"];return e.forEach(function(i){var r=i.index+1;i.id?t.push("#"+i.id):i.type==="text"||t.push("*:nth-child("+r+")")}),t.join(">")}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(i){return i.nodeType===ks?!0:!!(t&&i.classList.contains(t))})}walkToNode(e,t,i){var r=t||document,s=r.documentElement,a,o,l=e.length,u;for(u=0;u<l&&(o=e[u],o.type==="element"?o.id?s=r.getElementById(o.id):(a=s.children||d2(s),s=a[o.index]):o.type==="text"&&(s=this.textNodes(s,i)[o.index]),!!s);u++);return s}findNode(e,t,i){var r=t||document,s,a;return!i&&typeof r.evaluate<"u"?(a=this.stepsToXpath(e),s=r.evaluate(a,r,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?s=this.walkToNode(e,r,i):s=this.walkToNode(e,r),s}fixMiss(e,t,i,r){var s=this.findNode(e.slice(0,-1),i,r),a=s.childNodes,o=this.normalizedMap(a,ks,r),l,u,h=e[e.length-1].index;for(let d in o){if(!o.hasOwnProperty(d))return;if(o[d]===h)if(l=a[d],u=l.textContent.length,t>u)t=t-u;else{l.nodeType===Vh?s=l.childNodes[0]:s=l;break}}return{container:s,offset:t}}toRange(e,t){var i=e||document,r,s,a,o,l,u=this,h,d,f=t?i.querySelector("."+t)!=null:!1,m;if(typeof i.createRange<"u"?r=i.createRange():r=new yP,u.range?(s=u.start,h=u.path.steps.concat(s.steps),o=this.findNode(h,i,f?t:null),a=u.end,d=u.path.steps.concat(a.steps),l=this.findNode(d,i,f?t:null)):(s=u.path,h=u.path.steps,o=this.findNode(u.path.steps,i,f?t:null)),o)try{s.terminal.offset!=null?r.setStart(o,s.terminal.offset):r.setStart(o,0)}catch{m=this.fixMiss(h,s.terminal.offset,i,f?t:null),r.setStart(m.container,m.offset)}else return console.log("No startContainer found for",this.toString()),null;if(l)try{a.terminal.offset!=null?r.setEnd(l,a.terminal.offset):r.setEnd(l,0)}catch{m=this.fixMiss(d,u.end.terminal.offset,i,f?t:null),r.setEnd(m.container,m.offset)}return r}isCfiString(e){return typeof e=="string"&&e.indexOf("epubcfi(")===0&&e[e.length-1]===")"}generateChapterComponent(e,t,i){var r=parseInt(t),s=(e+1)*2,a="/"+s+"/";return a+=(r+1)*2,i&&(a+="["+i+"]"),a}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class ya{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]=="function")this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let i=0;i<this.hooks.length;i++)if(t=this.hooks[i],t===e){this.hooks.splice(i,1);break}}trigger(){var e=arguments,t=this.context,i=[];return this.hooks.forEach(function(r){try{var s=r.apply(t,e)}catch(a){console.log(a)}s&&typeof s.then=="function"&&i.push(s)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}function wP(n,e){var t,i,r=e.url,s=r.indexOf("://")>-1;n&&(i=fn(n,"head"),t=fn(i,"base"),t||(t=n.createElement("base"),i.insertBefore(t,i.firstChild)),!s&&window&&window.location&&(r=window.location.origin+r),t.setAttribute("href",r))}function xB(n,e){var t,i,r=e.canonical;n&&(t=fn(n,"head"),i=fn(t,"link[rel='canonical']"),i?i.setAttribute("href",r):(i=n.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",r),t.appendChild(i)))}function SB(n,e){var t,i,r=e.idref;n&&(t=fn(n,"head"),i=fn(t,"link[property='dc.identifier']"),i?i.setAttribute("content",r):(i=n.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",r),t.appendChild(i)))}function CB(n,e){var t=n.querySelectorAll("a[href]");if(t.length)for(var i=fn(n.ownerDocument,"base"),r=i?i.getAttribute("href"):void 0,s=function(o){var l=o.getAttribute("href");if(l.indexOf("mailto:")!==0){var u=l.indexOf("://")>-1;if(u)o.setAttribute("target","_blank");else{var h;try{h=new ta(l,r)}catch{}o.onclick=function(){return h&&h.hash?e(h.Path.path+h.hash):e(h?h.Path.path:l),!1}}}}.bind(this),a=0;a<t.length;a++)s(t[a])}function UC(n,e,t){return e.forEach(function(i,r){i&&t[r]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=n.replace(new RegExp(i,"g"),t[r]))}),n}function zm(n,e,t,i){var r=typeof window<"u"?window.URL:!1,s=r?"blob":"arraybuffer",a=new Ht,o=new XMLHttpRequest,l=XMLHttpRequest.prototype,u;"overrideMimeType"in l||Object.defineProperty(l,"overrideMimeType",{value:function(){}}),t&&(o.withCredentials=!0),o.onreadystatechange=d,o.onerror=h,o.open("GET",n,!0);for(u in i)o.setRequestHeader(u,i[u]);e=="json"&&o.setRequestHeader("Accept","application/json"),e||(e=new ml(n).extension),e=="blob"&&(o.responseType=s),jm(e)&&o.overrideMimeType("text/xml"),e=="binary"&&(o.responseType="arraybuffer"),o.send();function h(f){a.reject(f)}function d(){if(this.readyState===XMLHttpRequest.DONE){var f=!1;if((this.responseType===""||this.responseType==="document")&&(f=this.responseXML),this.status===200||this.status===0||f){var m;if(!this.response&&!f)return a.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),a.promise;if(this.status===403)return a.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),a.promise;f?m=this.responseXML:jm(e)?m=ho(this.response,"text/xml"):e=="xhtml"?m=ho(this.response,"application/xhtml+xml"):e=="html"||e=="htm"?m=ho(this.response,"text/html"):e=="json"?m=JSON.parse(this.response):e=="blob"?r?m=this.response:m=new Blob([this.response]):m=this.response,a.resolve(m)}else a.reject({status:this.status,message:this.response,stack:new Error().stack})}}return a.promise}class kB{constructor(e,t){this.idref=e.idref,this.linear=e.linear==="yes",this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new ya(this),this.hooks.content=new ya(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||zm,i=new Ht,r=i.promise;return this.contents?i.resolve(this.contents):t(this.url).then(function(s){return this.document=s,this.contents=s.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){i.resolve(this.contents)}.bind(this)).catch(function(s){i.reject(s)}),r}base(){return wP(this.document,this)}render(e){var t=new Ht,i=t.promise;return this.output,this.load(e).then(function(r){var s=typeof navigator<"u"&&navigator.userAgent||"",a=s.indexOf("Trident")>=0,o;typeof XMLSerializer>"u"||a?o=oP:o=XMLSerializer;var l=new o;return this.output=l.serializeToString(r),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){t.resolve(this.output)}.bind(this)).catch(function(r){t.reject(r)}),i}find(e){var t=this,i=[],r=e.toLowerCase(),s=function(a){for(var o=a.textContent.toLowerCase(),l=t.document.createRange(),u,h,d=-1,f,m=150;h!=-1;)h=o.indexOf(r,d+1),h!=-1&&(l=t.document.createRange(),l.setStart(a,h),l.setEnd(a,h+r.length),u=t.cfiFromRange(l),a.textContent.length<m?f=a.textContent:(f=a.textContent.substring(h-m/2,h+m/2),f="..."+f+"..."),i.push({cfi:u,excerpt:f})),d=h};return cb(t.document,function(a){s(a)}),i}search(e,t=5){if(typeof document.createTreeWalker>"u")return this.find(e);let i=[];const r=150,s=this,a=e.toLowerCase(),o=function(d){const b=d.reduce((_,w)=>_+w.textContent,"").toLowerCase().indexOf(a);if(b!=-1){const w=b+a.length;let v=0,y=0;if(b<d[0].length){let E;for(;v<d.length-1&&(y+=d[v].length,!(w<=y));)v+=1;let k=d[0],S=d[v],D=s.document.createRange();D.setStart(k,b);let P=d.slice(0,v).reduce((H,z)=>H+z.textContent.length,0);D.setEnd(S,P>w?w:w-P),E=s.cfiFromRange(D);let F=d.slice(0,v+1).reduce((H,z)=>H+z.textContent,"");F.length>r&&(F=F.substring(b-r/2,b+r/2),F="..."+F+"..."),i.push({cfi:E,excerpt:F})}}},l=document.createTreeWalker(s.document,NodeFilter.SHOW_TEXT,null,!1);let u,h=[];for(;u=l.nextNode();)h.push(u),h.length==t&&(o(h.slice(0,t)),h=h.slice(1,t));return h.length>0&&o(h),i}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(i){var r=i.replace("rendition:",""),s=r.indexOf("-"),a,o;s!=-1&&(a=r.slice(0,s),o=r.slice(s+1),t[a]=o)}),t}cfiFromRange(e){return new qt(e,this.cfiBase).toString()}cfiFromElement(e){return new qt(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class TB{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new ya,this.hooks.content=new ya,this.hooks.content.register(wP),this.hooks.content.register(xB),this.hooks.content.register(SB),this.epubcfi=new qt,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,i){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||"",this.length=this.items.length,this.items.forEach((r,s)=>{var a=this.manifest[r.idref],o;r.index=s,r.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,r.index,r.id),r.href&&(r.url=t(r.href,!0),r.canonical=i(r.href)),a&&(r.href=a.href,r.url=t(r.href,!0),r.canonical=i(r.href),a.properties.length&&r.properties.push.apply(r.properties,a.properties)),r.linear==="yes"?(r.prev=function(){let l=r.index;for(;l>0;){let u=this.get(l-1);if(u&&u.linear)return u;l-=1}}.bind(this),r.next=function(){let l=r.index;for(;l<this.spineItems.length-1;){let u=this.get(l+1);if(u&&u.linear)return u;l+=1}}.bind(this)):(r.prev=function(){},r.next=function(){}),o=new kB(r,this.hooks),this.append(o)}),this.loaded=!0}get(e){var t=0;if(typeof e>"u")for(;t<this.spineItems.length;){let i=this.spineItems[t];if(i&&i.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new qt(e).spinePos:typeof e=="number"||isNaN(e)===!1?t=e:typeof e=="string"&&e.indexOf("#")===0?t=this.spineById[e.substring(1)]:typeof e=="string"&&(e=e.split("#")[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(t,i){t.index=i}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;e-=1}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class nx{constructor(e){this._q=[],this.context=e,this.tick=JA,this.running=!1,this.paused=!1}enqueue(){var e,t,i,r=[].shift.call(arguments),s=arguments;if(!r)throw new Error("No Task Provided");return typeof r=="function"?(e=new Ht,t=e.promise,i={task:r,args:s,deferred:e,promise:t}):i={promise:r},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var e,t,i;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return i=t.apply(this.context,e.args),i&&typeof i.then=="function"?i.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,i),e.promise);if(e.promise)return e.promise}else return e=new Ht,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Ht),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const gw="0.3",Gy=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],et={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class _P{constructor(e,t,i){this.spine=e,this.request=t,this.pause=i||100,this.q=new nx(this),this.epubcfi=new qt,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(t){t.linear&&this.q.enqueue(this.process.bind(this),t)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(t){var i=new Ht,r=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(r),e.unload(),this.processingTimeout=setTimeout(()=>i.resolve(r),this.pause),i.promise}.bind(this))}parse(e,t,i){var r=[],s,a=e.ownerDocument,o=fn(a,"body"),l=0,u,h=i||this.break,d=function(f){var m=f.length,b,_=0;if(f.textContent.trim().length===0)return!1;for(l==0&&(s=this.createRange(),s.startContainer=f,s.startOffset=0),b=h-l,b>m&&(l+=m,_=m);_<m;)if(b=h-l,l===0&&(_+=1,s=this.createRange(),s.startContainer=f,s.startOffset=_),_+b>=m)l+=m-_,_=m;else{_+=b,s.endContainer=f,s.endOffset=_;let w=new qt(s,t).toString();r.push(w),l=0}u=f};if(cb(o,d.bind(this)),s&&s.startContainer&&u){s.endContainer=u,s.endOffset=u.length;let f=new qt(s,t).toString();r.push(f),l=0}return r}generateFromWords(e,t,i){var r=e?new qt(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(s){s.linear&&(r?s.index>=r.spinePos&&this.q.enqueue(this.processWords.bind(this),s,t,r,i):this.q.enqueue(this.processWords.bind(this),s,t,r,i))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,t,i,r){return r&&this._locationsWords.length>=r?Promise.resolve():e.load(this.request).then(function(s){var a=new Ht,o=this.parseWords(s,e,t,i),l=r-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=r?o.slice(0,l):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,""),e=e.replace(/[ ]{2,}/gi," "),e=e.replace(/\n /,`
`),e.split(" ").length}parseWords(e,t,i,r){var s=t.cfiBase,a=[],o=e.ownerDocument,l=fn(o,"body"),u=i,h=r?r.spinePos!==t.index:!0,d;r&&t.index===r.spinePos&&(d=r.findNode(r.range?r.path.steps.concat(r.start.steps):r.path.steps,e.ownerDocument));var f=function(m){if(!h)if(m===d)h=!0;else return!1;if(m.textContent.length<10&&m.textContent.trim().length===0)return!1;var b=this.countWords(m.textContent),_,w=0;if(b===0)return!1;for(_=u-this._wordCounter,_>b&&(this._wordCounter+=b,w=b);w<b;)if(_=u-this._wordCounter,w+_>=b)this._wordCounter+=b-w,w=b;else{w+=_;let v=new qt(m,s);a.push({cfi:v.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return cb(l,f.bind(this)),a}locationFromCfi(e){let t;return qt.prototype.isCfiString(e)&&(e=new qt(e)),this._locations.length===0?-1:(t=Qf(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!="number"&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),e>=1){let i=new qt(this._locations[this.total]);return i.collapse(),i.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e=="string"?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e=="string")this._currentCfi=e;else if(typeof e=="number")this._current=e;else return;this._locations.length!==0&&(typeof e=="string"?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit(et.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}mo(_P.prototype);class DB{constructor(e){this.packagePath="",this.directory="",this.encoding="",e&&this.parse(e)}parse(e){var t;if(!e)throw new Error("Container File Not Found");if(t=fn(e,"rootfile"),!t)throw new Error("No RootFile Found");this.packagePath=t.getAttribute("full-path"),this.directory=wu.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class $C{constructor(e){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,i,r;if(!e)throw new Error("Package File Not Found");if(t=fn(e,"metadata"),!t)throw new Error("No Metadata Found");if(i=fn(e,"manifest"),!i)throw new Error("No Manifest Found");if(r=fn(e,"spine"),!r)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,r),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=dP(r),this.spine=this.parseSpine(r,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=r.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,"title"),t.creator=this.getElementText(e,"creator"),t.description=this.getElementText(e,"description"),t.pubdate=this.getElementText(e,"date"),t.publisher=this.getElementText(e,"publisher"),t.identifier=this.getElementText(e,"identifier"),t.language=this.getElementText(e,"language"),t.rights=this.getElementText(e,"rights"),t.modified_date=this.getPropertyText(e,"dcterms:modified"),t.layout=this.getPropertyText(e,"rendition:layout"),t.orientation=this.getPropertyText(e,"rendition:orientation"),t.flow=this.getPropertyText(e,"rendition:flow"),t.viewport=this.getPropertyText(e,"rendition:viewport"),t.media_active_class=this.getPropertyText(e,"media:active-class"),t.spread=this.getPropertyText(e,"rendition:spread"),t}parseManifest(e){var t={},i=pl(e,"item"),r=Array.prototype.slice.call(i);return r.forEach(function(s){var a=s.getAttribute("id"),o=s.getAttribute("href")||"",l=s.getAttribute("media-type")||"",u=s.getAttribute("media-overlay")||"",h=s.getAttribute("properties")||"";t[a]={href:o,type:l,overlay:u,properties:h.length?h.split(" "):[]}}),t}parseSpine(e,t){var i=[],r=pl(e,"itemref"),s=Array.prototype.slice.call(r);return s.forEach(function(a,o){var l=a.getAttribute("idref"),u=a.getAttribute("properties")||"",h=u.length?u.split(" "):[],d={id:a.getAttribute("id"),idref:l,linear:a.getAttribute("linear")||"yes",properties:h,index:o};i.push(d)}),i}findUniqueIdentifier(e){var t=e.documentElement.getAttribute("unique-identifier");if(!t)return"";var i=e.getElementById(t);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(e){var t=Kh(e,"item",{properties:"nav"});return t?t.getAttribute("href"):!1}findNcxPath(e,t){var i=Kh(e,"item",{"media-type":"application/x-dtbncx+xml"}),r;return i||(r=t.getAttribute("toc"),r&&(i=e.querySelector(`#${r}`))),i?i.getAttribute("href"):!1}findCoverPath(e){var t=fn(e,"package");t.getAttribute("version");var i=Kh(e,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var r=Kh(e,"meta",{name:"cover"});if(r){var s=r.getAttribute("content"),a=e.getElementById(s);return a?a.getAttribute("href"):""}else return!1}getElementText(e,t){var i=e.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",t),r;return!i||i.length===0?"":(r=i[0],r.childNodes.length?r.childNodes[0].nodeValue:"")}getPropertyText(e,t){var i=Kh(e,"meta",{property:t});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(e){this.metadata=e.metadata;let t=e.readingOrder||e.spine;return this.spine=t.map((i,r)=>(i.index=r,i.linear=i.linear||"yes",i)),e.resources.forEach((i,r)=>{this.manifest[r]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((i,r)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class $1{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,i,r;t&&(i=fn(e,"html"),r=fn(e,"ncx")),t?i?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):r&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,i=0;i<e.length;i++)t=e[i],t.href&&(this.tocByHref[t.href]=i),t.id&&(this.tocById[t.id]=i),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf("#")===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,i){if(i.length===0)return;const r=i[t];if(r&&(e===r.id||e===r.href))return r;{let s;for(let a=0;a<i.length&&(s=this.getByIndex(e,t,i[a].subitems),!s);++a);return s}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=hb(e,"nav","toc"),i=[];if(!t)return i;let r=Xh(t,"ol",!0);return r&&(i=this.parseNavList(r)),i}parseNavList(e,t){const i=[];if(!e||!e.children)return i;for(let r=0;r<e.children.length;r++){const s=this.navItem(e.children[r],t);s&&i.push(s)}return i}navItem(e,t){let i=e.getAttribute("id")||void 0,r=Xh(e,"a",!0)||Xh(e,"span",!0);if(!r)return;let s=r.getAttribute("href")||"";i||(i=s);let a=r.textContent||"",o=[],l=Xh(e,"ol",!0);return l&&(o=this.parseNavList(l,i)),{id:i,href:s,label:a,subitems:o,parent:t}}parseLandmarks(e){var t=hb(e,"nav","landmarks"),i=t?pl(t,"li"):[],r=i.length,s,a=[],o;if(!i||r===0)return a;for(s=0;s<r;++s)o=this.landmarkItem(i[s]),o&&(a.push(o),this.landmarksByType[o.type]=s);return a}landmarkItem(e){let t=Xh(e,"a",!0);if(!t)return;let i=t.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,r=t.getAttribute("href")||"",s=t.textContent||"";return{href:r,label:s,type:i}}parseNcx(e){var t=pl(e,"navPoint"),i=t.length,r,s={},a=[],o,l;if(!t||i===0)return a;for(r=0;r<i;++r)o=this.ncxItem(t[r]),s[o.id]=o,o.parent?(l=s[o.parent],l.subitems.push(o)):a.push(o);return a}ncxItem(e){var t=e.getAttribute("id")||!1,i=fn(e,"content"),r=i.getAttribute("src"),s=fn(e,"navLabel"),a=s.textContent?s.textContent:"",o=[],l=e.parentNode,u;return l&&(l.nodeName==="navPoint"||l.nodeName.split(":").slice(-1)[0]==="navPoint")&&(u=l.getAttribute("id")),{id:t,href:r,label:a,subitems:o,parent:u}}load(e){return e.map(t=>(t.label=t.title,t.subitems=t.children?this.load(t.children):[],t))}forEach(e){return this.toc.forEach(e)}}var Cp={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},RB=function(){var n,e,t,i,r={};for(n in Cp)if(Cp.hasOwnProperty(n)){for(e in Cp[n])if(Cp[n].hasOwnProperty(e))if(t=Cp[n][e],typeof t=="string")r[t]=n+"/"+e;else for(i=0;i<t.length;i++)r[t[i]]=n+"/"+e}return r}(),PB="text/plain";function NB(n){return n&&RB[n.split(".").pop().toLowerCase()]||PB}const xd={lookup:NB};class IB{constructor(e,t){this.settings={replacements:t&&t.replacements||"base64",archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type==="application/xhtml+xml"||e.type==="text/html")return!0}),this.assets=this.resources.filter(function(e){if(e.type!=="application/xhtml+xml"&&e.type!=="text/html")return!0}),this.css=this.resources.filter(function(e){if(e.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new ta(e),i=xd.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(e,"blob").then(r=>vP(r)).then(r=>h2(r,i)):this.settings.request(e,"blob").then(r=>ub(r,i))}replacements(){if(this.settings.replacements==="none")return new Promise(function(t){t(this.urls)}.bind(this));var e=this.urls.map(t=>{var i=this.settings.resolver(t);return this.createUrl(i).catch(r=>(console.error(r),null))});return Promise.all(e).then(t=>(this.replacementUrls=t.filter(i=>typeof i=="string"),t))}replaceCss(e,t){var i=[];return e=e||this.settings.archive,t=t||this.settings.resolver,this.cssUrls.forEach(function(r){var s=this.createCssFile(r,e,t).then(function(a){var o=this.urls.indexOf(r);o>-1&&(this.replacementUrls[o]=a)}.bind(this));i.push(s)}.bind(this)),Promise.all(i)}createCssFile(e){var t;if(wu.isAbsolute(e))return new Promise(function(a){a()});var i=this.settings.resolver(e),r;this.settings.archive?r=this.settings.archive.getText(i):r=this.settings.request(i,"text");var s=this.urls.map(a=>{var o=this.settings.resolver(a),l=new ml(i).relative(o);return l});return r?r.then(a=>(a=UC(a,s,this.replacementUrls),this.settings.replacements==="base64"?t=h2(a,"text/css"):t=ub(a,"text/css"),t),a=>new Promise(function(o){o()})):new Promise(function(a){a()})}relativeTo(e,t){return t=t||this.settings.resolver,this.urls.map(function(i){var r=t(i),s=new ml(e).relative(r);return s}.bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise(function(i,r){i(this.replacementUrls[t])}.bind(this)):this.createUrl(e)}substitute(e,t){var i;return t?i=this.relativeTo(t):i=this.urls,UC(e,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class H1{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new qt,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=fn(e,"html"),i=fn(e,"ncx");if(t)return this.parseNav(e);if(i)return this.parseNcx(e)}parseNav(e){var t=hb(e,"nav","page-list"),i=t?pl(t,"li"):[],r=i.length,s,a=[],o;if(!i||r===0)return a;for(s=0;s<r;++s)o=this.item(i[s]),a.push(o);return a}parseNcx(e){var t=[],i=0,r,s,a,o=0;if(s=fn(e,"pageList"),!s||(a=pl(s,"pageTarget"),o=a.length,!a||a.length===0))return t;for(i=0;i<o;++i)r=this.ncxItem(a[i]),t.push(r);return t}ncxItem(e){var t=fn(e,"navLabel"),i=fn(t,"text"),r=i.textContent,s=fn(e,"content"),a=s.getAttribute("src"),o=parseInt(r,10);return{href:a,page:o}}item(e){var t=fn(e,"a"),i=t.getAttribute("href")||"",r=t.textContent||"",s=parseInt(r),a=i.indexOf("epubcfi"),o,l,u;return a!=-1?(o=i.split("#"),l=o[0],u=o.length>1?o[1]:!1,{cfi:u,href:i,packageUrl:l,page:s}):{href:i,page:s}}process(e){e.forEach(function(t){this.pages.push(t.page),t.cfi&&this.locations.push(t.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var i=ab(e,this.locations,this.epubcfi.compare);return i!=-1?t=this.pages[i]:(i=Qf(e,this.locations,this.epubcfi.compare),t=i-1>=0?this.pages[i-1]:this.pages[0],t!==void 0||(t=-1)),t}cfiFromPage(e){var t=-1;typeof e!="number"&&(e=parseInt(e));var i=this.pages.indexOf(e);return i!=-1&&(t=this.locations[i]),t}pageFromPercentage(e){var t=Math.round(this.totalPages*e);return t}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e),i=this.percentageFromPage(t);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}let EP=class{constructor(e){this.settings=e,this.name=e.layout||"reflowable",this._spread=e.spread!=="none",this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow==="scrolled"||e.flow==="scrolled-continuous"||e.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return typeof e<"u"&&(e==="scrolled"||e==="scrolled-continuous"||e==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!=="none",this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,i){var r=1,s=i||0,a=e,o=t,l=Math.floor(a/12),u,h,d,f;this._spread&&a>=this._minSpreadWidth?r=2:r=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(s=l%2===0?l:l-1),this.name==="pre-paginated"&&(s=0),r>1?(u=a/r-s,d=u+s):(u=a,d=a),this.name==="pre-paginated"&&r>1&&(a=u),h=u*r+s,f=a,this.width=a,this.height=o,this.spreadWidth=h,this.pageWidth=d,this.delta=f,this.columnWidth=u,this.gap=s,this.divisor=r,this.update({width:a,height:o,spreadWidth:h,pageWidth:d,delta:f,columnWidth:u,gap:s,divisor:r})}format(e,t,i){var r;return this.name==="pre-paginated"?r=e.fit(this.columnWidth,this.height,t):this._flow==="paginated"?r=e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?r=e.size(null,this.height):r=e.size(this.width,null),r}count(e,t){let i,r;return this.name==="pre-paginated"?(i=1,r=1):this._flow==="paginated"?(t=t||this.delta,i=Math.ceil(e/t),r=i*this.divisor):(t=t||this.height,i=Math.ceil(e/t),r=i),{spreads:i,pages:r}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=qi(this.props,e);this.emit(et.LAYOUT.UPDATED,t,e)}}};mo(EP.prototype);class LB{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e=="string")return this.registerUrl("default",e);if(typeof e=="object")return this.registerRules("default",e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]=="string"?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e=="default")&&this.update(e)}registerUrl(e,t){var i=new ta(t);this._themes[e]={url:i.toString()},(this._injected[e]||e=="default")&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e=="default")&&this.update(e)}select(e){var t=this._current,i;this._current=e,this.update(e),i=this.rendition.getContents(),i.forEach(r=>{r.removeClass(t),r.addClass(e)})}update(e){var t=this.rendition.getContents();t.forEach(i=>{this.add(e,i)})}inject(e){var t=[],i=this._themes,r;for(var s in i)i.hasOwnProperty(s)&&(s===this._current||s==="default")&&(r=i[s],(r.rules&&Object.keys(r.rules).length>0||r.url&&t.indexOf(r.url)===-1)&&this.add(s,e),this._injected.push(s));this._current!="default"&&e.addClass(this._current)}add(e,t){var i=this._themes[e];!i||!t||(i.url?t.addStylesheet(i.url):i.serialized?(t.addStylesheetCss(i.serialized,e),i.injected=!0):i.rules&&(t.addStylesheetRules(i.rules,e),i.injected=!0))}override(e,t,i){var r=this.rendition.getContents();this._overrides[e]={value:t,priority:i===!0},r.forEach(s=>{s.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(i=>{i.css(e)})}overrides(e){var t=this._overrides;for(var i in t)t.hasOwnProperty(i)&&e.css(i,t[i].value,t[i].priority)}fontSize(e){this.override("font-size",e)}font(e){this.override("font-family",e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class db{constructor(e,t,i,r=!1){this.layout=e,this.horizontal=i==="horizontal",this.direction=t||"ltr",this._dev=r}section(e){var t=this.findRanges(e),i=this.rangeListToCfiList(e.section.cfiBase,t);return i}page(e,t,i,r){var s=e&&e.document?e.document.body:!1,a;if(s){if(a=this.rangePairToCfiPair(t,{start:this.findStart(s,i,r),end:this.findEnd(s,i,r)}),this._dev===!0){let o=e.document,l=new qt(a.start).toRange(o),u=new qt(a.end).toRange(o),h=o.defaultView.getSelection(),d=o.createRange();h.removeAllRanges(),d.setStart(l.startContainer,l.startOffset),d.setEnd(u.endContainer,u.endOffset),h.addRange(d)}return a}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(l){return l.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},r=i.acceptNode;r.acceptNode=i.acceptNode;for(var s=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,r,!1),a,o;(a=s.nextNode())&&(o=t(a),!o););return o}}findRanges(e){for(var t=[],i=e.contents.scrollWidth(),r=Math.ceil(i/this.layout.spreadWidth),s=r*this.layout.divisor,a=this.layout.columnWidth,o=this.layout.gap,l,u,h=0;h<s.pages;h++)l=(a+o)*h,u=a*(h+1)+o*h,t.push({start:this.findStart(e.document.body,l,u),end:this.findEnd(e.document.body,l,u)});return t}findStart(e,t,i){for(var r=[e],s,a,o=e;r.length;)if(s=r.shift(),a=this.walk(s,l=>{var u,h,d,f,m;if(m=c2(l),this.horizontal&&this.direction==="ltr"){if(u=this.horizontal?m.left:m.top,h=this.horizontal?m.right:m.bottom,u>=t&&u<=i)return l;if(h>t)return l;o=l,r.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=m.left,h=m.right,h<=i&&h>=t)return l;if(u<i)return l;o=l,r.push(l)}else{if(d=m.top,f=m.bottom,d>=t&&d<=i)return l;if(f>t)return l;o=l,r.push(l)}}),a)return this.findTextStartRange(a,t,i);return this.findTextStartRange(o,t,i)}findEnd(e,t,i){for(var r=[e],s,a=e,o;r.length;)if(s=r.shift(),o=this.walk(s,l=>{var u,h,d,f,m;if(m=c2(l),this.horizontal&&this.direction==="ltr"){if(u=Math.round(m.left),h=Math.round(m.right),u>i&&a)return a;if(h>i)return l;a=l,r.push(l)}else if(this.horizontal&&this.direction==="rtl"){if(u=Math.round(this.horizontal?m.left:m.top),h=Math.round(this.horizontal?m.right:m.bottom),h<t&&a)return a;if(u<t)return l;a=l,r.push(l)}else{if(d=Math.round(m.top),f=Math.round(m.bottom),d>i&&a)return a;if(f>i)return l;a=l,r.push(l)}}),o)return this.findTextEndRange(o,t,i);return this.findTextEndRange(a,t,i)}findTextStartRange(e,t,i){for(var r=this.splitTextNodeIntoRanges(e),s,a,o,l,u,h=0;h<r.length;h++)if(s=r[h],a=s.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(o=a.left,o>=t)return s}else if(this.horizontal&&this.direction==="rtl"){if(u=a.right,u<=i)return s}else if(l=a.top,l>=t)return s;return r[0]}findTextEndRange(e,t,i){for(var r=this.splitTextNodeIntoRanges(e),s,a,o,l,u,h,d,f=0;f<r.length;f++){if(a=r[f],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(l=o.left,u=o.right,l>i&&s)return s;if(u>i)return a}else if(this.horizontal&&this.direction==="rtl"){if(l=o.left,u=o.right,u<t&&s)return s;if(l<t)return a}else{if(h=o.top,d=o.bottom,h>i&&s)return s;if(d>i)return a}s=a}return r[r.length-1]}splitTextNodeIntoRanges(e,t){var i=[],r=e.textContent||"",s=r.trim(),a,o=e.ownerDocument,l=t||" ",u=s.indexOf(l);if(u===-1||e.nodeType!=Node.TEXT_NODE)return a=o.createRange(),a.selectNodeContents(e),[a];for(a=o.createRange(),a.setStart(e,0),a.setEnd(e,u),i.push(a),a=!1;u!=-1;)u=s.indexOf(l,u+1),u>0&&(a&&(a.setEnd(e,u),i.push(a)),a=o.createRange(),a.setStart(e,u+1));return a&&(a.setEnd(e,s.length),i.push(a)),i}rangePairToCfiPair(e,t){var i=t.start,r=t.end;i.collapse(!0),r.collapse(!1);let s=new qt(i,e).toString(),a=new qt(r,e).toString();return{start:s,end:a}}rangeListToCfiList(e,t){for(var i=[],r,s=0;s<t.length;s++)r=this.rangePairToCfiPair(e,t[s]),i.push(r);return i}axis(e){return e&&(this.horizontal=e==="horizontal"),this.horizontal}}const AP=typeof navigator<"u",OB=AP&&/Chrome/.test(navigator.userAgent),HC=AP&&!OB&&/AppleWebKit/.test(navigator.userAgent),MB=1;class ix{constructor(e,t,i,r){this.epubcfi=new qt,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=r||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",gw),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Gy}width(e){var t=this.content;return e&&qn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&qn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&qn(e)&&(e=e+"px"),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&qn(e)&&(e=e+"px"),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,i=this.document.createRange(),r=this.content||this.document.body,s=ob(r);return i.selectNodeContents(r),e=i.getBoundingClientRect(),t=e.width,s&&s.width&&(t+=s.width),Math.round(t)}textHeight(){let e,t,i=this.document.createRange(),r=this.content||this.document.body;return i.selectNodeContents(r),e=i.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){var e=this.documentElement.scrollWidth;return e}scrollHeight(){var e=this.documentElement.scrollHeight;return e}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,i){var r=this.content||this.document.body;return t?r.style.setProperty(e,t,i?"important":""):r.style.removeProperty(e),this.window.getComputedStyle(r)[e]}viewport(e){var t=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},r=[],s={};if(t&&t.hasAttribute("content")){let a=t.getAttribute("content"),o=a.match(/width\s*=\s*([^,]*)/),l=a.match(/height\s*=\s*([^,]*)/),u=a.match(/initial-scale\s*=\s*([^,]*)/),h=a.match(/minimum-scale\s*=\s*([^,]*)/),d=a.match(/maximum-scale\s*=\s*([^,]*)/),f=a.match(/user-scalable\s*=\s*([^,]*)/);o&&o.length&&typeof o[1]<"u"&&(i.width=o[1]),l&&l.length&&typeof l[1]<"u"&&(i.height=l[1]),u&&u.length&&typeof u[1]<"u"&&(i.scale=u[1]),h&&h.length&&typeof h[1]<"u"&&(i.minimum=h[1]),d&&d.length&&typeof d[1]<"u"&&(i.maximum=d[1]),f&&f.length&&typeof f[1]<"u"&&(i.scalable=f[1])}return s=hP(e||{},i),e&&(s.width&&r.push("width="+s.width),s.height&&r.push("height="+s.height),s.scale&&r.push("initial-scale="+s.scale),s.scalable==="no"?(r.push("minimum-scale="+s.scale),r.push("maximum-scale="+s.scale),r.push("user-scalable="+s.scalable)):(s.scalable&&r.push("user-scalable="+s.scalable),s.minimum&&r.push("minimum-scale="+s.minimum),s.maximum&&r.push("minimum-scale="+s.maximum)),t||(t=this.document.createElement("meta"),t.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(t)),t.setAttribute("content",r.join(", ")),this.window.scrollTo(0,0)),s}expand(){this.emit(et.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit(et.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",e.style.transitionDuration="0.001ms",e.style.transitionTimingFunction="linear",e.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=function(o){o.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),i=0;i<e.length;i+=1){var r;try{r=e[i].cssRules}catch{return}if(!r)return;for(var s=0;s<r.length;s+=1)if(r[s].media){var a=this.window.matchMedia(r[s].media.mediaText);a.addListener(t)}}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(t=>{this.resizeCheck()});let e={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,e)}imageLoadListeners(){for(var e=this.document.querySelectorAll("img"),t,i=0;i<e.length;i++)t=e[i],typeof t.naturalWidth<"u"&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var i,r={left:0,top:0};if(!this.document)return r;if(this.epubcfi.isCfiString(e)){let s=new qt(e).toRange(this.document,t);if(s){try{if(!s.endContainer||s.startContainer==s.endContainer&&s.startOffset==s.endOffset){let a=s.startContainer.textContent.indexOf(" ",s.startOffset);a==-1&&(a=s.startContainer.textContent.length),s.setEnd(s.startContainer,a)}}catch(a){console.error("setting end offset to start container length failed",a)}if(s.startContainer.nodeType===Node.ELEMENT_NODE)i=s.startContainer.getBoundingClientRect(),r.left=i.left,r.top=i.top;else if(HC){let a=s.startContainer,o=new Range;try{a.nodeType===MB?i=a.getBoundingClientRect():s.startOffset+2<a.length?(o.setStart(a,s.startOffset),o.setEnd(a,s.startOffset+2),i=o.getBoundingClientRect()):s.startOffset-2>0?(o.setStart(a,s.startOffset-2),o.setEnd(a,s.startOffset),i=o.getBoundingClientRect()):i=a.parentNode.getBoundingClientRect()}catch(l){console.error(l,l.stack)}}else i=s.getBoundingClientRect()}}else if(typeof e=="string"&&e.indexOf("#")>-1){let s=e.substring(e.indexOf("#")+1),a=this.document.getElementById(s);if(a)if(HC){let o=new Range;o.selectNode(a),i=o.getBoundingClientRect()}else i=a.getBoundingClientRect()}return i&&(r.left=i.left,r.top=i.top),r}addStylesheet(e){return new Promise(function(t,i){var r,s=!1;if(!this.document){t(!1);return}if(r=this.document.querySelector("link[href='"+e+"']"),r){t(!0);return}r=this.document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=e,r.onload=r.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(r)}.bind(this))}_getStylesheetNode(e){var t;return e="epubjs-inserted-css-"+(e||""),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement("style"),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var i;return i=this._getStylesheetNode(t),i.innerHTML=e,!0}addStylesheetRules(e,t){var i;if(!(!this.document||!e||e.length===0))if(i=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)==="[object Array]")for(var r=0,s=e.length;r<s;r++){var a=1,o=e[r],l=e[r][0],u="";Object.prototype.toString.call(o[1][0])==="[object Array]"&&(o=o[1],a=0);for(var h=o.length;a<h;a++){var d=o[a];u+=d[0]+":"+d[1]+(d[2]?" !important":"")+`;
`}i.insertRule(l+"{"+u+"}",i.cssRules.length)}else Object.keys(e).forEach(m=>{const b=e[m];if(Array.isArray(b))b.forEach(_=>{const v=Object.keys(_).map(y=>`${y}:${_[y]}`).join(";");i.insertRule(`${m}{${v}}`,i.cssRules.length)});else{const w=Object.keys(b).map(v=>`${v}:${b[v]}`).join(";");i.insertRule(`${m}{${w}}`,i.cssRules.length)}})}addScript(e){return new Promise(function(t,i){var r,s=!1;if(!this.document){t(!1);return}r=this.document.createElement("script"),r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="complete")&&(s=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(r)}.bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),Gy.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(Gy.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var t=this.window.getSelection();this.triggerSelectedEvent(t)}.bind(this),250)}triggerSelectedEvent(e){var t,i;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(i=new qt(t,this.cfiBase).toString(),this.emit(et.CONTENTS.SELECTED,i),this.emit(et.CONTENTS.SELECTED_RANGE,t)))}range(e,t){var i=new qt(e);return i.toRange(this.document,t)}cfiFromRange(e,t){return new qt(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new qt(e,this.cfiBase,t).toString()}map(e){var t=new db(e);return t.section()}size(e,t){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),e>=0&&(this.width(e),i.width=e,this.css("padding","0 "+e/12+"px")),t>=0&&(this.height(t),i.height=t),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(e,t,i,r,s){let a=Gh("column-axis"),o=Gh("column-gap"),l=Gh("column-width"),u=Gh("column-fill"),d=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),s==="rtl"&&d==="horizontal"&&this.direction(s),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),d==="vertical"?(this.css("padding-top",r/2+"px",!0),this.css("padding-bottom",r/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(a,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",r/2+"px",!0),this.css("padding-right",r/2+"px",!0),this.css(a,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(u,"auto"),this.css(o,r+"px"),this.css(l,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(e,t,i){var r="scale("+e+")",s="";this.css("transform-origin","top left"),(t>=0||i>=0)&&(s=" translate("+(t||0)+"px, "+(i||0)+"px )"),this.css("transform",r+s)}fit(e,t,i){var r=this.viewport(),s=parseInt(r.width),a=parseInt(r.height),o=e/s,l=t/a,u=o<l?o:l;if(this.layoutStyle("paginated"),this.width(s),this.height(a),this.overflow("hidden"),this.scaler(u,0,0),this.css("background-size",s*u+"px "+a*u+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var h=e-s*u;this.css("margin-left",h+"px")}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,i,r,s){var a=new db(t,s);return a.page(this,e,i,r)}linksHandler(){CB(this.content,e=>{this.emit(et.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=Gh("writing-mode");return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||""}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}mo(ix.prototype);class FB{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,i,r,s,a){let o=encodeURI(t+e),u=new qt(t).spinePos,h=new xP({type:e,cfiRange:t,data:i,sectionIndex:u,cb:r,className:s,styles:a});return this._annotations[o]=h,u in this._annotationsBySectionIndex?this._annotationsBySectionIndex[u].push(o):this._annotationsBySectionIndex[u]=[o],this.rendition.views().forEach(f=>{h.sectionIndex===f.index&&h.attach(f)}),h}remove(e,t){let i=encodeURI(e+t);if(i in this._annotations){let r=this._annotations[i];if(t&&r.type!==t)return;this.rendition.views().forEach(a=>{this._removeFromAnnotationBySectionIndex(r.sectionIndex,i),r.sectionIndex===a.index&&r.detach(a)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(i=>i!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,i,r,s){return this.add("highlight",e,t,i,r,s)}underline(e,t,i,r,s){return this.add("underline",e,t,i,r,s)}mark(e,t,i){return this.add("mark",e,t,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(r=>{this._annotations[r].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(r=>{this._annotations[r].detach(e)})}show(){}hide(){}}class xP{constructor({type:e,cfiRange:t,data:i,sectionIndex:r,cb:s,className:a,styles:o}){this.type=e,this.cfiRange=t,this.data=i,this.sectionIndex=r,this.mark=void 0,this.cb=s,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:i,type:r,mark:s,cb:a,className:o,styles:l}=this,u;return r==="highlight"?u=e.highlight(t,i,a,o,l):r==="underline"?u=e.underline(t,i,a,o,l):r==="mark"&&(u=e.mark(t,i,a)),this.mark=u,this.emit(et.ANNOTATION.ATTACH,u),u}detach(e){let{cfiRange:t,type:i}=this,r;return e&&(i==="highlight"?r=e.unhighlight(t):i==="underline"?r=e.ununderline(t):i==="mark"&&(r=e.unmark(t))),this.mark=void 0,this.emit(et.ANNOTATION.DETACH,r),r}text(){}}mo(xP.prototype);var tl={},vw={};Object.defineProperty(vw,"__esModule",{value:!0});vw.createElement=SP;function SP(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}vw.default={createElement:SP};var Lv={};Object.defineProperty(Lv,"__esModule",{value:!0});Lv.proxyMouse=CP;Lv.clone=kP;Lv.default={proxyMouse:CP};function CP(n,e){function t(a){for(var o=e.length-1;o>=0;o--){var l=e[o],u=a.clientX,h=a.clientY;if(a.touches&&a.touches.length&&(u=a.touches[0].clientX,h=a.touches[0].clientY),!!BB(l,n,u,h)){l.dispatchEvent(kP(a));break}}}if(n.nodeName==="iframe"||n.nodeName==="IFRAME")try{this.target=n.contentDocument}catch{this.target=n}else this.target=n;for(var i=["mouseup","mousedown","click","touchstart"],r=0;r<i.length;r++){var s=i[r];this.target.addEventListener(s,function(a){return t(a)},!1)}}function kP(n){var e=Object.assign({},n,{bubbles:!1});try{return new MouseEvent(n.type,e)}catch{var t=document.createEvent("MouseEvents");return t.initMouseEvent(n.type,!1,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}}function BB(n,e,t,i){var r=e.getBoundingClientRect();function s(h,d,f){var m=h.top-r.top,b=h.left-r.left,_=m+h.height,w=b+h.width;return m<=f&&b<=d&&_>f&&w>d}var a=n.getBoundingClientRect();if(!s(a,t,i))return!1;for(var o=n.getClientRects(),l=0,u=o.length;l<u;l++)if(s(o[l],t,i))return!0;return!1}var fb,rx;Object.defineProperty(tl,"__esModule",{value:!0});var TP=tl.Underline=rx=tl.Highlight=tl.Mark=fb=tl.Pane=void 0,jB=function n(e,t,i){e===null&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(r===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:n(s,t,i)}else{if("value"in r)return r.value;var a=r.get;return a===void 0?void 0:a.call(i)}},yw=function(){function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),zB=vw,Um=DP(zB),UB=Lv,$B=DP(UB);function DP(n){return n&&n.__esModule?n:{default:n}}function RP(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function PP(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}function bw(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}fb=tl.Pane=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;bw(this,n),this.target=e,this.element=Um.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),$B.default.proxyMouse(this.target,this.marks),this.container=t,this.container.appendChild(this.element),this.render()}return yw(n,[{key:"addMark",value:function(t){var i=Um.default.createElement("g");return this.element.appendChild(i),t.bind(i,this.container),this.marks.push(t),t.render(),t}},{key:"removeMark",value:function(t){var i=this.marks.indexOf(t);if(i!==-1){var r=t.unbind();this.element.removeChild(r),this.marks.splice(i,1)}}},{key:"render",value:function(){VB(this.element,WB(this.target,this.container));var t=!0,i=!1,r=void 0;try{for(var s=this.marks[Symbol.iterator](),a;!(t=(a=s.next()).done);t=!0){var o=a.value;o.render()}}catch(l){i=!0,r=l}finally{try{!t&&s.return&&s.return()}finally{if(i)throw r}}}}]),n}();var HB=tl.Mark=function(){function n(){bw(this,n),this.element=null}return yw(n,[{key:"bind",value:function(t,i){this.element=t,this.container=i}},{key:"unbind",value:function(){var t=this.element;return this.element=null,t}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(t){this.element&&this.element.dispatchEvent(t)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var t=[],i=this.element.firstChild;i;)t.push(i.getBoundingClientRect()),i=i.nextSibling;return t}},{key:"filteredRanges",value:function(){var t=Array.from(this.range.getClientRects());return t.filter(function(i){for(var r=0;r<t.length;r++){if(t[r]===i)return!0;var s=GB(t[r],i);if(s)return!1}return!0})}}]),n}(),qB=rx=tl.Highlight=function(n){PP(e,n);function e(t,i,r,s){bw(this,e);var a=RP(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.range=t,a.className=i,a.data=r||{},a.attributes=s||{},a}return yw(e,[{key:"bind",value:function(i,r){jB(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"bind",this).call(this,i,r);for(var s in this.data)this.data.hasOwnProperty(s)&&(this.element.dataset[s]=this.data[s]);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&this.element.setAttribute(s,this.attributes[s]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),r=this.filteredRanges(),s=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=r.length;o<l;o++){var u=r[o],h=Um.default.createElement("rect");h.setAttribute("x",u.left-s.left+a.left),h.setAttribute("y",u.top-s.top+a.top),h.setAttribute("height",u.height),h.setAttribute("width",u.width),i.appendChild(h)}this.element.appendChild(i)}}]),e}(HB);TP=tl.Underline=function(n){PP(e,n);function e(t,i,r,s){return bw(this,e),RP(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,r,s))}return yw(e,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var i=this.element.ownerDocument.createDocumentFragment(),r=this.filteredRanges(),s=this.element.getBoundingClientRect(),a=this.container.getBoundingClientRect(),o=0,l=r.length;o<l;o++){var u=r[o],h=Um.default.createElement("rect");h.setAttribute("x",u.left-s.left+a.left),h.setAttribute("y",u.top-s.top+a.top),h.setAttribute("height",u.height),h.setAttribute("width",u.width),h.setAttribute("fill","none");var d=Um.default.createElement("line");d.setAttribute("x1",u.left-s.left+a.left),d.setAttribute("x2",u.left-s.left+a.left+u.width),d.setAttribute("y1",u.top-s.top+a.top+u.height-1),d.setAttribute("y2",u.top-s.top+a.top+u.height-1),d.setAttribute("stroke-width",1),d.setAttribute("stroke","black"),d.setAttribute("stroke-linecap","square"),i.appendChild(h),i.appendChild(d)}this.element.appendChild(i)}}]),e}(qB);function WB(n,e){var t=e.getBoundingClientRect(),i=n.getBoundingClientRect();return{top:i.top-t.top,left:i.left-t.left,height:n.scrollHeight,width:n.scrollWidth}}function VB(n,e){n.style.setProperty("top",e.top+"px","important"),n.style.setProperty("left",e.left+"px","important"),n.style.setProperty("height",e.height+"px","important"),n.style.setProperty("width",e.width+"px","important")}function GB(n,e){return e.right<=n.right&&e.left>=n.left&&e.top>=n.top&&e.bottom<=n.bottom}class NP{constructor(e,t){this.settings=qi({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id="epubjs-view-"+mw(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new qt,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement("div");return t.classList.add("epub-view"),t.style.height="0px",t.style.width="0px",t.style.overflow="hidden",t.style.position="relative",t.style.display="block",e&&e=="horizontal"?t.style.flex="none":t.style.flex="initial",t}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Wy(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(e)),this.sectionRender.then(function(i){return this.load(i)}.bind(this)).then(function(){let i=this.contents.writingMode(),r;return this.settings.flow==="scrolled"?r=i.indexOf("vertical")===0?"horizontal":"vertical":r=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(r),this.emit(et.VIEWS.AXIS,r),this.setWritingMode(i),this.emit(et.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((s,a)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),s()})}.bind(this),function(i){return this.emit(et.VIEWS.LOAD_ERROR,i),new Promise((r,s)=>{s(i)})}.bind(this)).then(function(){this.emit(et.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var i=e||this.settings.width,r=t||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,r):this.settings.axis==="horizontal"?this.lock("height",i,r):this.lock("width",i,r),this.settings.width=i,this.settings.height=r}lock(e,t,i){var r=ob(this.element),s;this.iframe?s=ob(this.iframe):s={width:0,height:0},e=="width"&&qn(t)&&(this.lockedWidth=t-r.width-s.width),e=="height"&&qn(i)&&(this.lockedHeight=i-r.height-s.height),e==="both"&&qn(t)&&qn(i)&&(this.lockedWidth=t-r.width-s.width,this.lockedHeight=i-r.height-s.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,i=this.lockedHeight,r;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(t=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(r=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&r%2>0&&(t+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||i!=this._height)&&this.reframe(t,i),this._expanding=!1)}reframe(e,t){var i;qn(e)&&(this.element.style.width=e+"px",this.iframe.style.width=e+"px",this._width=e),qn(t)&&(this.element.style.height=t+"px",this.iframe.style.height=t+"px",this._height=t);let r=this.prevBounds?e-this.prevBounds.width:e,s=this.prevBounds?t-this.prevBounds.height:t;i={width:e,height:t,widthDelta:r,heightDelta:s},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let a;for(let o in this.marks)this.marks.hasOwnProperty(o)&&(a=this.marks[o],this.placeMark(a.element,a.range))}),this.onResize(this,i),this.emit(et.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=Wy(this.element)}load(e){var t=new Ht,i=t.promise;if(!this.iframe)return t.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=function(s){this.onLoad(s,t)}.bind(this),this.settings.method==="blobUrl")this.blobUrl=ub(e,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var r=this;MSApp.execUnsafeLocalFunction(function(){r.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return i}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new ix(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(et.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(et.CONTENTS.RESIZE,r=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new Ht;return this.displayed?t.resolve(this):this.render(e).then(function(){this.emit(et.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}.bind(this),function(i){t.reject(i,this)}),t.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(et.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(et.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=Wy(this.element)),this.elementBounds}highlight(e,t={},i,r="epubjs-hl",s={}){if(!this.contents)return;const a=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},s);let o=this.contents.range(e),l=()=>{this.emit(et.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new fb(this.iframe,this.element));let u=new rx(o,r,t,a),h=this.pane.addMark(u);return this.highlights[e]={mark:h,element:h.element,listeners:[l,i]},h.element.setAttribute("ref",r),h.element.addEventListener("click",l),h.element.addEventListener("touchstart",l),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}underline(e,t={},i,r="epubjs-ul",s={}){if(!this.contents)return;const a=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},s);let o=this.contents.range(e),l=()=>{this.emit(et.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||(this.pane=new fb(this.iframe,this.element));let u=new TP(o,r,t,a),h=this.pane.addMark(u);return this.underlines[e]={mark:h,element:h.element,listeners:[l,i]},h.element.setAttribute("ref",r),h.element.addEventListener("click",l),h.element.addEventListener("touchstart",l),i&&(h.element.addEventListener("click",i),h.element.addEventListener("touchstart",i)),h}mark(e,t={},i){if(!this.contents)return;if(e in this.marks)return this.marks[e];let r=this.contents.range(e);if(!r)return;let s=r.commonAncestorContainer,a=s.nodeType===1?s:s.parentNode,o=u=>{this.emit(et.VIEWS.MARK_CLICKED,e,t)};r.collapsed&&s.nodeType===1?(r=new Range,r.selectNodeContents(s)):r.collapsed&&(r=new Range,r.selectNodeContents(a));let l=this.document.createElement("a");return l.setAttribute("ref","epubjs-mk"),l.style.position="absolute",l.dataset.epubcfi=e,t&&Object.keys(t).forEach(u=>{l.dataset[u]=t[u]}),i&&(l.addEventListener("click",i),l.addEventListener("touchstart",i)),l.addEventListener("click",o),l.addEventListener("touchstart",o),this.placeMark(l,r),this.element.appendChild(l),this.marks[e]={element:l,range:r,listeners:[o,i]},a}placeMark(e,t){let i,r,s;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let o=t.getBoundingClientRect();i=o.top,r=o.right}else{let o=t.getClientRects(),l;for(var a=0;a!=o.length;a++)l=o[a],(!s||l.left<s)&&(s=l.left,r=Math.ceil(s/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=l.top)}e.style.top=`${i}px`,e.style.left=`${r}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(i=>{i&&(t.element.removeEventListener("click",i),t.element.removeEventListener("touchstart",i))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&pP(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}mo(NP.prototype);function KB(){var n="reverse",e=XB();return document.body.appendChild(e),e.scrollLeft>0?n="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(e.children[0].children[1].scrollIntoView(),e.scrollLeft<0&&(n="negative")):(e.scrollLeft=1,e.scrollLeft===0&&(n="negative")),document.body.removeChild(e),n}function XB(){var n=document.createElement("div");n.dir="rtl",n.style.position="fixed",n.style.width="1px",n.style.height="1px",n.style.top="0px",n.style.left="0px",n.style.overflow="hidden";var e=document.createElement("div");e.style.width="2px";var t=document.createElement("span");t.style.width="1px",t.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",e.appendChild(t),e.appendChild(i),n.appendChild(e),n}function YB(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var sx=YB,QB=typeof Cr=="object"&&Cr&&Cr.Object===Object&&Cr,ZB=QB,JB=ZB,e4=typeof self=="object"&&self&&self.Object===Object&&self,t4=JB||e4||Function("return this")(),IP=t4,n4=IP,i4=function(){return n4.Date.now()},r4=i4,s4=/\s/;function a4(n){for(var e=n.length;e--&&s4.test(n.charAt(e)););return e}var o4=a4,l4=o4,u4=/^\s+/;function c4(n){return n&&n.slice(0,l4(n)+1).replace(u4,"")}var h4=c4,d4=IP,f4=d4.Symbol,LP=f4,qC=LP,OP=Object.prototype,p4=OP.hasOwnProperty,m4=OP.toString,kp=qC?qC.toStringTag:void 0;function g4(n){var e=p4.call(n,kp),t=n[kp];try{n[kp]=void 0;var i=!0}catch{}var r=m4.call(n);return i&&(e?n[kp]=t:delete n[kp]),r}var v4=g4,y4=Object.prototype,b4=y4.toString;function w4(n){return b4.call(n)}var _4=w4,WC=LP,E4=v4,A4=_4,x4="[object Null]",S4="[object Undefined]",VC=WC?WC.toStringTag:void 0;function C4(n){return n==null?n===void 0?S4:x4:VC&&VC in Object(n)?E4(n):A4(n)}var k4=C4;function T4(n){return n!=null&&typeof n=="object"}var D4=T4,R4=k4,P4=D4,N4="[object Symbol]";function I4(n){return typeof n=="symbol"||P4(n)&&R4(n)==N4}var L4=I4,O4=h4,GC=sx,M4=L4,KC=NaN,F4=/^[-+]0x[0-9a-f]+$/i,B4=/^0b[01]+$/i,j4=/^0o[0-7]+$/i,z4=parseInt;function U4(n){if(typeof n=="number")return n;if(M4(n))return KC;if(GC(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=GC(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=O4(n);var t=B4.test(n);return t||j4.test(n)?z4(n.slice(2),t?2:8):F4.test(n)?KC:+n}var $4=U4,H4=sx,q1=r4,XC=$4,q4="Expected a function",W4=Math.max,V4=Math.min;function G4(n,e,t){var i,r,s,a,o,l,u=0,h=!1,d=!1,f=!0;if(typeof n!="function")throw new TypeError(q4);e=XC(e)||0,H4(t)&&(h=!!t.leading,d="maxWait"in t,s=d?W4(XC(t.maxWait)||0,e):s,f="trailing"in t?!!t.trailing:f);function m(D){var P=i,F=r;return i=r=void 0,u=D,a=n.apply(F,P),a}function b(D){return u=D,o=setTimeout(v,e),h?m(D):a}function _(D){var P=D-l,F=D-u,H=e-P;return d?V4(H,s-F):H}function w(D){var P=D-l,F=D-u;return l===void 0||P>=e||P<0||d&&F>=s}function v(){var D=q1();if(w(D))return y(D);o=setTimeout(v,_(D))}function y(D){return o=void 0,f&&i?m(D):(i=r=void 0,a)}function E(){o!==void 0&&clearTimeout(o),u=0,i=l=r=o=void 0}function k(){return o===void 0?a:y(q1())}function S(){var D=q1(),P=w(D);if(i=arguments,r=this,l=D,P){if(o===void 0)return b(l);if(d)return clearTimeout(o),o=setTimeout(v,e),m(l)}return o===void 0&&(o=setTimeout(v,e)),a}return S.cancel=E,S.flush=k,S}var MP=G4;const K4=po(MP);var X4=MP,Y4=sx,Q4="Expected a function";function Z4(n,e,t){var i=!0,r=!0;if(typeof n!="function")throw new TypeError(Q4);return Y4(t)&&(i="leading"in t?!!t.leading:i,r="trailing"in t?!!t.trailing:r),X4(n,e,{leading:i,maxWait:e,trailing:r})}var J4=Z4;const ej=po(J4);class tj{constructor(e){this.settings=e||{},this.id="epubjs-container-"+mw(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,i=e.width,r=e.overflow||!1,s=e.axis||"vertical",a=e.direction;qi(this.settings,e),e.height&&qn(e.height)&&(t=e.height+"px"),e.width&&qn(e.width)&&(i=e.width+"px");let o=document.createElement("div");return o.id=this.id,o.classList.add("epub-container"),o.style.wordSpacing="0",o.style.lineHeight="0",o.style.verticalAlign="top",o.style.position="relative",s==="horizontal"&&(o.style.display="flex",o.style.flexDirection="row",o.style.flexWrap="nowrap"),i&&(o.style.width=i),t&&(o.style.height=t),r&&(r==="scroll"&&s==="vertical"?(o.style["overflow-y"]=r,o.style["overflow-x"]="hidden"):r==="scroll"&&s==="horizontal"?(o.style["overflow-y"]="hidden",o.style["overflow-x"]=r):o.style.overflow=r),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement("div");return t.style.visibility="hidden",t.style.overflow="hidden",t.style.width="0",t.style.height="0",t.appendChild(e),t}getElement(e){var t;if(uP(e)?t=e:typeof e=="string"&&(t=document.getElementById(e)),!t)throw new Error("Not an Element");return t}attachTo(e){var t=this.getElement(e),i;if(t)return this.settings.hidden?i=this.wrapper:i=this.container,t.appendChild(i),this.element=t,t}getContainer(){return this.container}onResize(e){(!qn(this.settings.width)||!qn(this.settings.height))&&(this.resizeFunc=ej(e,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(e,t){var i;let r=e||this.settings.width,s=t||this.settings.height;e===null?(i=this.element.getBoundingClientRect(),i.width&&(e=Math.floor(i.width),this.container.style.width=e+"px")):qn(e)?this.container.style.width=e+"px":this.container.style.width=e,t===null?(i=i||this.element.getBoundingClientRect(),i.height&&(t=i.height,this.container.style.height=t+"px")):qn(t)?this.container.style.height=t+"px":this.container.style.height=t,qn(e)||(e=this.container.clientWidth),qn(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let a=lb(),o=window.getComputedStyle(document.body),l={left:parseFloat(o["padding-left"])||0,right:parseFloat(o["padding-right"])||0,top:parseFloat(o["padding-top"])||0,bottom:parseFloat(o["padding-bottom"])||0};return r||(e=a.width-l.left-l.right),(this.settings.fullsize&&!s||!s)&&(t=a.height-l.top-l.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!=="visible"&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?lb():e}getSheet(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var i="#"+this.id+" ",r="";this.sheet||(this.sheet=this.getSheet()),t.forEach(function(s){for(var a in s)s.hasOwnProperty(a)&&(r+=a+":"+s[a]+";")}),this.sheet.insertRule(i+e+" {"+r+"}",0)}axis(e){e==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=e,this.container.style["overflow-x"]="hidden"):e==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class nj{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var i=0;i<t;i++)e=this._views[i],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,i=this.length,r=0;r<i;r++)if(t=this._views[r],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,i=this.length,r=0;r<i;r++)t=this._views[r],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,i=0;i<t;i++)e=this._views[i],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,i=0;i<t;i++)e=this._views[i],e.displayed&&e.hide();this.hidden=!0}}class pb{constructor(e){this.name="default",this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new nx(this),this.settings=qi(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),qi(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let i=e.tagName;typeof this.settings.fullsize>"u"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=KB(),this.stage=new tj({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new nj(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener("unload",function(t){this.destroy()}.bind(this)),this.settings.fullsize?e=window:e=this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll)}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(et.MANAGERS.ORIENTATION_CHANGE,t)}.bind(this),500)}onResized(e){this.resize()}resize(e,t,i){let r=this.stage.size(e,t);if(this.winBounds=lb(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===r.width&&this._stageSize.height===r.height||(this._stageSize=r,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(et.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(e,t){return new this.View(e,qi(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,i){let r;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(e||t.index===0)return;if(r=t.next(),r&&!r.properties.includes("page-spread-left"))return i.call(this,r)}}display(e,t){var i=new Ht,r=i.promise;(t===e.href||qn(t))&&(t=void 0);var s=this.views.find(e);if(s&&e&&this.layout.name!=="pre-paginated"){let o=s.offset();if(this.settings.direction==="ltr")this.scrollTo(o.left,o.top,!0);else{let l=s.width();this.scrollTo(o.left+l,o.top,!0)}if(t){let l=s.locationOf(t),u=s.width();this.moveTo(l,u)}return i.resolve(),r}this.clear();let a=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(a=!0),this.add(e,a).then(function(o){if(t){let l=o.locationOf(t),u=o.width();this.moveTo(l,u)}}.bind(this),o=>{i.reject(o)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),i.resolve()}.bind(this)),r}afterDisplayed(e){this.emit(et.MANAGERS.ADDED,e)}afterResized(e){this.emit(et.MANAGERS.RESIZE,e.section)}moveTo(e,t){var i=0,r=0;this.isPaginated?(i=Math.floor(e.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),r=Math.floor(e.top/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollHeight&&(r=this.container.scrollHeight-this.layout.delta)):r=e.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-t),this.scrollTo(i,r,!0)}add(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(et.VIEWS.AXIS,r=>{this.updateAxis(r)}),i.on(et.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),i.display(this.request)}append(e,t){var i=this.createView(e,t);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(et.VIEWS.AXIS,r=>{this.updateAxis(r)}),i.on(et.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),i.display(this.request)}prepend(e,t){var i=this.createView(e,t);return i.on(et.VIEWS.RESIZED,r=>{this.counter(r)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(et.VIEWS.AXIS,r=>{this.updateAxis(r)}),i.on(et.VIEWS.WRITING_MODE,r=>{this.updateWritingMode(r)}),i.display(this.request)}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let r=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&e.properties.includes("page-spread-right")&&(r=!0),this.append(e,r).then(function(){return this.handleNextPrePaginated(r,e,this.append)}.bind(this),s=>s).then(function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,t;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let r=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof e.prev()!="object"&&(r=!0),this.prepend(e,r).then(function(){var s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(s=e.prev(),s))return this.prepend(s)}.bind(this),s=>s).then(function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=t.height<window.innerHeight?t.height:window.innerHeight,r=t.width<window.innerWidth?t.width:window.innerWidth,s=this.settings.axis==="vertical";this.settings.direction;let a=0,o=0;return this.settings.fullsize&&(a=s?window.scrollY:window.scrollX),e.map(u=>{let{index:h,href:d}=u.section,f=u.position(),m=u.width(),b=u.height(),_,w,v,y;s?(_=a+t.top-f.top+o,w=_+i-o,y=this.layout.count(b,i).pages,v=i):(_=a+t.left-f.left+o,w=_+r-o,y=this.layout.count(m,r).pages,v=r);let E=Math.ceil(_/v),k=[],S=Math.ceil(w/v);if(this.settings.direction==="rtl"&&!s){let F=E;E=y-S,S=y-F}k=[];for(var D=E;D<=S;D++){let F=D+1;k.push(F)}let P=this.mapping.page(u.contents,u.section.cfiBase,_,w);return{index:h,href:d,pages:k,totalPages:y,mapping:P}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),i=0,r=0;return this.settings.fullsize&&(i=window.scrollX),e.map(a=>{let{index:o,href:l}=a.section,u,h=a.position(),d=a.width(),f,m,b;this.settings.direction==="rtl"?(u=t.right-i,b=Math.min(Math.abs(u-h.left),this.layout.width)-r,m=h.width-(h.right-u)-r,f=m-b):(u=t.left+i,b=Math.min(h.right-u,this.layout.width)-r,f=u-h.left+r,m=f+b),r+=b;let _=this.mapping.page(a.contents,a.section.cfiBase,f,m),w=this.layout.count(d).pages,v=Math.floor(f/this.layout.pageWidth),y=[],E=Math.floor(m/this.layout.pageWidth);if(v<0&&(v=0,E=E+1),this.settings.direction==="rtl"){let S=v;v=w-E,E=w-S}for(var k=v+1;k<=E;k++){let S=k;y.push(S)}return{index:o,href:l,pages:y,totalPages:w,mapping:_}})}isVisible(e,t,i,r){var s=e.position(),a=r||this.bounds();return this.settings.axis==="horizontal"&&s.right>a.left-t&&s.left<a.right+i?!0:this.settings.axis==="vertical"&&s.bottom>a.top-t&&s.top<a.bottom+i}visible(){for(var e=this.bounds(),t=this.views.displayed(),i=t.length,r=[],s,a,o=0;o<i;o++)a=t[o],s=this.isVisible(a,0,0,e),s===!0&&r.push(a);return r}scrollBy(e,t,i){let r=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*r,t*r):(e&&(this.container.scrollLeft+=e*r),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit(et.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(et.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){var e;return e=this.stage.bounds(),e}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new db(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&(this.mapping=new db(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(e==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t="auto"){let i=e==="paginated"||e==="auto";this.isPaginated=i,e==="scrolled-doc"||e==="scrolled-continuous"||e==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){const i=t&&t.contents;i&&e.push(i)}),e}direction(e="ltr"){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}}mo(pb.prototype);const ij={easeInCubic:function(n){return Math.pow(n,3)}};class p2{constructor(e,t){this.settings=qi({duration:80,minVelocity:.2,minDistance:10,easing:ij.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(et.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(et.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;["touchstart","touchmove","touchend"].forEach(i=>{t.on(i,r=>this.triggerViewEvent(r,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:i}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:i}=e.touches[0],r=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&r<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t!==0?this.snap(t):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,i=Math.abs(t),r=this.endTime-this.startTime,s=t/r,a=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=e)return 0;if(s>a)return-1;if(s<-a)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,r=Math.round(t/i)*i;return e&&(r+=e*i),this.smoothScrollTo(r)}smoothScrollTo(e){const t=new Ht,i=this.scrollLeft,r=this.now(),s=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){const l=this.now(),u=Math.min(1,(l-r)/s);if(a(u),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}u<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(i+(e-i)*u,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}mo(p2.prototype);class rj extends pb{constructor(e){super(e),this.name="continuous",this.settings=qi(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),qi(this.settings,e.settings||{}),e.settings.gap!="undefined"&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return pb.prototype.display.call(this,e,t).then(function(){return this.fill()}.bind(this))}fill(e){var t=e||new Ht;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,i=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(i=e.top,e.top+this.settings.offsetDelta),(t>0||i>0)&&this.scrollBy(t,i,!0)}afterResized(e){this.emit(et.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on(et.VIEWS.RESIZED,i=>{t.expanded=!0}),t.on(et.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on(et.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on(et.VIEWS.RESIZED,i=>{t.expanded=!0}),t.on(et.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on(et.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on(et.VIEWS.RESIZED,i=>{this.counter(i),t.expanded=!0}),t.on(et.VIEWS.AXIS,i=>{this.updateAxis(i)}),t.on(et.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis==="vertical"?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),i=this.views.all(),r=i.length,s=typeof e<"u"?e:this.settings.offset||0,a,o,l=new Ht,u=[],h=0;h<r;h++)if(o=i[h],a=this.isVisible(o,s,s,t),a===!0)if(o.displayed)o.show();else{let d=o.display(this.request).then(function(f){f.show()},f=>{o.hide()});u.push(d)}else this.q.enqueue(o.destroy.bind(o)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return u.length?Promise.all(u).catch(d=>{l.reject(d)}):(l.resolve(),l.promise)}check(e,t){var i=new Ht,r=[],s=this.settings.axis==="horizontal",a=this.settings.offset||0;e&&s&&(a=e),t&&!s&&(a=t);var o=this._bounds;let l=s?this.scrollLeft:this.scrollTop,u=s?Math.floor(o.width):o.height,h=s?this.container.scrollWidth:this.container.scrollHeight,d=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",f=this.settings.rtlScrollType,m=this.settings.direction==="rtl";this.settings.fullsize?(s&&m&&f==="negative"||!s&&m&&f==="default")&&(l=l*-1):(m&&f==="default"&&d==="horizontal"&&(l=h-u-l),m&&f==="negative"&&d==="horizontal"&&(l=l*-1));let b=()=>{let E=this.views.first(),k=E&&E.section.prev();k&&r.push(this.prepend(k))},_=()=>{let E=this.views.last(),k=E&&E.section.next();k&&r.push(this.append(k))},w=l+u+a,v=l-a;w>=h&&_(),v<0&&b();let y=r.map(E=>E.display(this.request));return r.length?Promise.all(y).then(()=>this.check()).then(()=>this.update(a),E=>E):(this.q.enqueue(function(){this.update()}.bind(this)),i.resolve(!1),i.promise)}trim(){for(var e=new Ht,t=this.views.displayed(),i=t[0],r=t[t.length-1],s=this.views.indexOf(i),a=this.views.indexOf(r),o=this.views.slice(0,s),l=this.views.slice(a+1),u=0;u<o.length-1;u++)this.erase(o[u],o);for(var h=1;h<l.length;h++)this.erase(l[h]);return e.resolve(),e.promise}erase(e,t){var i,r;this.settings.fullsize?(i=window.scrollY,r=window.scrollX):(i=this.container.scrollTop,r=this.container.scrollLeft);var s=e.bounds();this.views.remove(e),t&&(this.settings.axis==="vertical"?this.scrollTo(0,i-s.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(r+Math.floor(s.width),0,!0):this.scrollTo(r,0,!0):this.scrollTo(r-Math.floor(s.width),0,!0))}addEventListeners(e){window.addEventListener("unload",function(t){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new p2(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var e;this.tick=JA;let t=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener("scroll",this._onScroll),this._scrolled=K4(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var e;this.settings.fullsize?e=window:e=this.container,e.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let e,t,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(e=window.scrollY*i,t=window.scrollX*i):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit(et.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(et.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new p2(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class ax{constructor(e,t){this.settings=qi(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),qi(this.settings,t),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new ya(this),this.hooks.serialize=new ya(this),this.hooks.content=new ya(this),this.hooks.unloaded=new ya(this),this.hooks.layout=new ya(this),this.hooks.render=new ya(this),this.hooks.show=new ya(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new LB(this),this.annotations=new FB(this),this.epubcfi=new qt,this.q=new nx(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Ht,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){var t;return typeof e=="string"&&e==="default"?t=pb:typeof e=="string"&&e==="continuous"?t=rj:t=e,t}requireView(e){var t;return typeof e=="string"&&e==="iframe"?t=NP:t=e,t}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(et.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(et.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(et.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(et.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(et.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(et.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit(et.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new Ht,i=t.promise,r;return this.displaying=t,this.book.locations.length()&&cP(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),r=this.book.spine.get(e),r?(this.manager.display(r,e).then(()=>{t.resolve(r),this.displaying=void 0,this.emit(et.RENDITION.DISPLAYED,r),this.reportLocation()},s=>{this.emit(et.RENDITION.DISPLAY_ERROR,s)}),i):(t.reject(new Error("No Section Found")),i)}}afterDisplayed(e){e.on(et.VIEWS.MARK_CLICKED,(t,i)=>this.triggerMarkEvent(t,i,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit(et.RENDITION.RENDERED,e.section,e)}):this.emit(et.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit(et.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit(et.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit(et.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,i){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,i=this.settings.layout||e.layout||"reflowable",r=this.settings.spread||e.spread||"auto",s=this.settings.orientation||e.orientation||"auto",a=this.settings.flow||e.flow||"auto",o=e.viewport||"",l=this.settings.minSpreadWidth||e.minSpreadWidth||800,u=this.settings.direction||e.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),t={layout:i,spread:r,orientation:s,flow:a,viewport:o,minSpreadWidth:l,direction:u},t}flow(e){var t=e;(e==="scrolled"||e==="scrolled-doc"||e==="scrolled-continuous")&&(t="scrolled"),(e==="auto"||e==="paginated")&&(t="paginated"),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new EP(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on(et.LAYOUT.UPDATED,(t,i)=>{this.emit(et.RENDITION.LAYOUT,t,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then(function(r){let s=this.located(r);!s||!s.start||!s.end||(this.location=s,this.emit(et.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(et.RENDITION.RELOCATED,this.location))}.bind(this));else if(i){let r=this.located(i);if(!r||!r.start||!r.end)return;this.location=r,this.emit(et.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(et.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then=="function")e.then(function(t){return this.located(t)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],i=e[e.length-1],r={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},s=this.book.locations.locationFromCfi(t.mapping.start),a=this.book.locations.locationFromCfi(i.mapping.end);s!=null&&(r.start.location=s,r.start.percentage=this.book.locations.percentageFromLocation(s)),a!=null&&(r.end.location=a,r.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(t.mapping.start),l=this.book.pageList.pageFromCfi(i.mapping.end);return o!=-1&&(r.start.page=o),l!=-1&&(r.end.page=l),i.index===this.book.spine.last().index&&r.end.displayed.page>=r.end.displayed.total&&(r.atEnd=!0),t.index===this.book.spine.first().index&&r.start.displayed.page===1&&(r.atStart=!0),r}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){Gy.forEach(t=>{e.on(t,i=>this.triggerViewEvent(i,e))}),e.on(et.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit(et.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,i){this.emit(et.RENDITION.MARK_CLICKED,e,t,i)}getRange(e,t){var i=new qt(e),r=this.manager.visible().filter(function(s){if(i.spinePos===s.index)return!0});if(r.length)return r[0].contents.range(i,t)}adjustImages(e){if(this._layout.name==="pre-paginated")return new Promise(function(s){s()});let t=e.window.getComputedStyle(e.content,null),i=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,r=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(s,a){setTimeout(function(){s()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on(et.CONTENTS.LINK_CLICKED,t=>{let i=this.book.path.relative(t);this.display(i)})}injectStylesheet(e,t){let i=e.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),e.getElementsByTagName("head")[0].appendChild(i)}injectScript(e,t){let i=e.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",e.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(e,t){let i=this.book.packaging.metadata.identifier,r=e.createElement("meta");r.setAttribute("name","dc.relation.ispartof"),i&&r.setAttribute("content",i),e.getElementsByTagName("head")[0].appendChild(r)}}mo(ax.prototype);function nl(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var FP={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,r,s){function a(u,h){if(!r[u]){if(!i[u]){var d=typeof nl=="function"&&nl;if(!h&&d)return d(u,!0);if(o)return o(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var m=r[u]={exports:{}};i[u][0].call(m.exports,function(b){var _=i[u][1][b];return a(_||b)},m,m.exports,t,i,r,s)}return r[u].exports}for(var o=typeof nl=="function"&&nl,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,i,r){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(l){for(var u=[],h,d,f,m,b,_,w,v=0,y=l.length,E=y,k=s.getTypeOf(l)!=="string";v<l.length;)E=y-v,k?(h=l[v++],d=v<y?l[v++]:0,f=v<y?l[v++]:0):(h=l.charCodeAt(v++),d=v<y?l.charCodeAt(v++):0,f=v<y?l.charCodeAt(v++):0),m=h>>2,b=(h&3)<<4|d>>4,_=E>1?(d&15)<<2|f>>6:64,w=E>2?f&63:64,u.push(o.charAt(m)+o.charAt(b)+o.charAt(_)+o.charAt(w));return u.join("")},r.decode=function(l){var u,h,d,f,m,b,_,w=0,v=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");l=l.replace(/[^A-Za-z0-9+/=]/g,"");var E=l.length*3/4;if(l.charAt(l.length-1)===o.charAt(64)&&E--,l.charAt(l.length-2)===o.charAt(64)&&E--,E%1!==0)throw new Error("Invalid base64 input, bad content length.");var k;for(a.uint8array?k=new Uint8Array(E|0):k=new Array(E|0);w<l.length;)f=o.indexOf(l.charAt(w++)),m=o.indexOf(l.charAt(w++)),b=o.indexOf(l.charAt(w++)),_=o.indexOf(l.charAt(w++)),u=f<<2|m>>4,h=(m&15)<<4|b>>2,d=(b&3)<<6|_,k[v++]=u,b!==64&&(k[v++]=h),_!==64&&(k[v++]=d);return k}},{"./support":30,"./utils":32}],2:[function(t,i,r){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(h,d,f,m,b){this.compressedSize=h,this.uncompressedSize=d,this.crc32=f,this.compression=m,this.compressedContent=b}u.prototype={getContentWorker:function(){var h=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return h.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(h,d,f){return h.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},i.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var s=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var s=t("./utils");function a(){for(var h,d=[],f=0;f<256;f++){h=f;for(var m=0;m<8;m++)h=h&1?3988292384^h>>>1:h>>>1;d[f]=h}return d}var o=a();function l(h,d,f,m){var b=o,_=m+f;h=h^-1;for(var w=m;w<_;w++)h=h>>>8^b[(h^d[w])&255];return h^-1}function u(h,d,f,m){var b=o,_=m+f;h=h^-1;for(var w=m;w<_;w++)h=h>>>8^b[(h^d.charCodeAt(w))&255];return h^-1}i.exports=function(d,f){if(typeof d>"u"||!d.length)return 0;var m=s.getTypeOf(d)!=="string";return m?l(f|0,d,d.length,0):u(f|0,d,d.length,0)}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var s=null;typeof Promise<"u"?s=Promise:s=t("lie"),i.exports={Promise:s}},{lie:37}],7:[function(t,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),u=s?"uint8array":"array";r.magic="\b\0";function h(d,f){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=f,this.meta={}}o.inherits(h,l),h.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(u,d.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(f){d.push({data:f,meta:d.meta})}},r.compressWorker=function(d){return new h("Deflate",d)},r.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){var s=t("../utils"),a=t("../stream/GenericWorker"),o=t("../utf8"),l=t("../crc32"),u=t("../signature"),h=function(v,y){var E="",k;for(k=0;k<y;k++)E+=String.fromCharCode(v&255),v=v>>>8;return E},d=function(v,y){var E=v;return v||(E=y?16893:33204),(E&65535)<<16},f=function(v){return(v||0)&63},m=function(v,y,E,k,S,D){var P=v.file,F=v.compression,H=D!==o.utf8encode,z=s.transformTo("string",D(P.name)),te=s.transformTo("string",o.utf8encode(P.name)),de=P.comment,ke=s.transformTo("string",D(de)),Me=s.transformTo("string",o.utf8encode(de)),ze=te.length!==P.name.length,ve=Me.length!==de.length,xe,he,ie="",ae="",me="",_e=P.dir,pe=P.date,De={crc32:0,compressedSize:0,uncompressedSize:0};(!y||E)&&(De.crc32=v.crc32,De.compressedSize=v.compressedSize,De.uncompressedSize=v.uncompressedSize);var it=0;y&&(it|=8),!H&&(ze||ve)&&(it|=2048);var Xe=0,We=0;_e&&(Xe|=16),S==="UNIX"?(We=798,Xe|=d(P.unixPermissions,_e)):(We=20,Xe|=f(P.dosPermissions)),xe=pe.getUTCHours(),xe=xe<<6,xe=xe|pe.getUTCMinutes(),xe=xe<<5,xe=xe|pe.getUTCSeconds()/2,he=pe.getUTCFullYear()-1980,he=he<<4,he=he|pe.getUTCMonth()+1,he=he<<5,he=he|pe.getUTCDate(),ze&&(ae=h(1,1)+h(l(z),4)+te,ie+="up"+h(ae.length,2)+ae),ve&&(me=h(1,1)+h(l(ke),4)+Me,ie+="uc"+h(me.length,2)+me);var nt="";nt+=`
\0`,nt+=h(it,2),nt+=F.magic,nt+=h(xe,2),nt+=h(he,2),nt+=h(De.crc32,4),nt+=h(De.compressedSize,4),nt+=h(De.uncompressedSize,4),nt+=h(z.length,2),nt+=h(ie.length,2);var Ve=u.LOCAL_FILE_HEADER+nt+z+ie,Bt=u.CENTRAL_FILE_HEADER+h(We,2)+nt+h(ke.length,2)+"\0\0\0\0"+h(Xe,4)+h(k,4)+z+ie+ke;return{fileRecord:Ve,dirRecord:Bt}},b=function(v,y,E,k,S){var D="",P=s.transformTo("string",S(k));return D=u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+h(v,2)+h(v,2)+h(y,4)+h(E,4)+h(P.length,2)+P,D},_=function(v){var y="";return y=u.DATA_DESCRIPTOR+h(v.crc32,4)+h(v.compressedSize,4)+h(v.uncompressedSize,4),y};function w(v,y,E,k){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=E,this.encodeFileName=k,this.streamFiles=v,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(w,a),w.prototype.push=function(v){var y=v.meta.percent||0,E=this.entriesCount,k=this._sources.length;this.accumulate?this.contentBuffer.push(v):(this.bytesWritten+=v.data.length,a.prototype.push.call(this,{data:v.data,meta:{currentFile:this.currentFile,percent:E?(y+100*(E-k-1))/E:100}}))},w.prototype.openedSource=function(v){this.currentSourceOffset=this.bytesWritten,this.currentFile=v.file.name;var y=this.streamFiles&&!v.file.dir;if(y){var E=m(v,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:E.fileRecord,meta:{percent:0}})}else this.accumulate=!0},w.prototype.closedSource=function(v){this.accumulate=!1;var y=this.streamFiles&&!v.file.dir,E=m(v,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(E.dirRecord),y)this.push({data:_(v),meta:{percent:100}});else for(this.push({data:E.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},w.prototype.flush=function(){for(var v=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var E=this.bytesWritten-v,k=b(this.dirRecords.length,E,v,this.zipComment,this.encodeFileName);this.push({data:k,meta:{percent:100}})},w.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},w.prototype.registerPrevious=function(v){this._sources.push(v);var y=this;return v.on("data",function(E){y.processChunk(E)}),v.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),v.on("error",function(E){y.error(E)}),this},w.prototype.resume=function(){if(!a.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},w.prototype.error=function(v){var y=this._sources;if(!a.prototype.error.call(this,v))return!1;for(var E=0;E<y.length;E++)try{y[E].error(v)}catch{}return!0},w.prototype.lock=function(){a.prototype.lock.call(this);for(var v=this._sources,y=0;y<v.length;y++)v[y].lock()},i.exports=w},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var s=t("../compressions"),a=t("./ZipFileWorker"),o=function(l,u){var h=l||u,d=s[h];if(!d)throw new Error(h+" is not a valid compression method !");return d};r.generateWorker=function(l,u,h){var d=new a(u.streamFiles,h,u.platform,u.encodeFileName),f=0;try{l.forEach(function(m,b){f++;var _=o(b.options.compression,u.compression),w=b.options.compressionOptions||u.compressionOptions||{},v=b.dir,y=b.date;b._compressWorker(_,w).withStreamInfo("file",{name:m,dir:v,date:y,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(d)}),d.entriesCount=f}catch(m){d.error(m)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}s.prototype=t("./object"),s.prototype.loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),h=t("./nodejsUtils");function d(f){return new a.Promise(function(m,b){var _=f.decompressed.getContentWorker().pipe(new u);_.on("error",function(w){b(w)}).on("end",function(){_.streamInfo.crc32!==f.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}i.exports=function(f,m){var b=this;return m=s.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),h.isNode&&h.isStream(f)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",f,!0,m.optimizedBinaryString,m.base64).then(function(_){var w=new l(m);return w.load(_),w}).then(function(w){var v=[a.Promise.resolve(w)],y=w.files;if(m.checkCRC32)for(var E=0;E<y.length;E++)v.push(d(y[E]));return a.Promise.all(v)}).then(function(w){for(var v=w.shift(),y=v.files,E=0;E<y.length;E++){var k=y[E],S=k.fileNameStr,D=s.resolve(k.fileNameStr);b.file(D,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:m.createFolders}),k.dir||(b.file(D).unsafeOriginalName=S)}return v.zipComment.length&&(b.comment=v.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,u){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}s.inherits(o,a),o.prototype._bindStream=function(l){var u=this;this._stream=l,l.pause(),l.on("data",function(h){u.push({data:h,meta:{percent:0}})}).on("error",function(h){u.isPaused?this.generatedError=h:u.error(h)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},o.prototype.pause=function(){return a.prototype.pause.call(this)?(this._stream.pause(),!0):!1},o.prototype.resume=function(){return a.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var s=t("readable-stream").Readable,a=t("../utils");a.inherits(o,s);function o(l,u,h){s.call(this,u),this._helper=l;var d=this;l.on("data",function(f,m){d.push(f)||d._helper.pause(),h&&h(m)}).on("error",function(f){d.emit("error",f)}).on("end",function(){d.push(null)})}o.prototype._read=function(){this._helper.resume()},i.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,i,r){var s=t("./utf8"),a=t("./utils"),o=t("./stream/GenericWorker"),l=t("./stream/StreamHelper"),u=t("./defaults"),h=t("./compressedObject"),d=t("./zipObject"),f=t("./generate"),m=t("./nodejsUtils"),b=t("./nodejs/NodejsStreamInputAdapter"),_=function(S,D,P){var F=a.getTypeOf(D),H,z=a.extend(P||{},u);z.date=z.date||new Date,z.compression!==null&&(z.compression=z.compression.toUpperCase()),typeof z.unixPermissions=="string"&&(z.unixPermissions=parseInt(z.unixPermissions,8)),z.unixPermissions&&z.unixPermissions&16384&&(z.dir=!0),z.dosPermissions&&z.dosPermissions&16&&(z.dir=!0),z.dir&&(S=v(S)),z.createFolders&&(H=w(S))&&y.call(this,H,!0);var te=F==="string"&&z.binary===!1&&z.base64===!1;(!P||typeof P.binary>"u")&&(z.binary=!te);var de=D instanceof h&&D.uncompressedSize===0;(de||z.dir||!D||D.length===0)&&(z.base64=!1,z.binary=!0,D="",z.compression="STORE",F="string");var ke=null;D instanceof h||D instanceof o?ke=D:m.isNode&&m.isStream(D)?ke=new b(S,D):ke=a.prepareContent(S,D,z.binary,z.optimizedBinaryString,z.base64);var Me=new d(S,ke,z);this.files[S]=Me},w=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var D=S.lastIndexOf("/");return D>0?S.substring(0,D):""},v=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},y=function(S,D){return D=typeof D<"u"?D:u.createFolders,S=v(S),this.files[S]||_.call(this,S,null,{dir:!0,createFolders:D}),this.files[S]};function E(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var D,P,F;for(D in this.files)F=this.files[D],P=D.slice(this.root.length,D.length),P&&D.slice(0,this.root.length)===this.root&&S(P,F)},filter:function(S){var D=[];return this.forEach(function(P,F){S(P,F)&&D.push(F)}),D},file:function(S,D,P){if(arguments.length===1)if(E(S)){var F=S;return this.filter(function(z,te){return!te.dir&&F.test(z)})}else{var H=this.files[this.root+S];return H&&!H.dir?H:null}else S=this.root+S,_.call(this,S,D,P);return this},folder:function(S){if(!S)return this;if(E(S))return this.filter(function(H,z){return z.dir&&S.test(H)});var D=this.root+S,P=y.call(this,D),F=this.clone();return F.root=P.name,F},remove:function(S){S=this.root+S;var D=this.files[S];if(D||(S.slice(-1)!=="/"&&(S+="/"),D=this.files[S]),D&&!D.dir)delete this.files[S];else for(var P=this.filter(function(H,z){return z.name.slice(0,S.length)===S}),F=0;F<P.length;F++)delete this.files[P[F].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var D,P={};try{if(P=a.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode}),P.type=P.type.toLowerCase(),P.compression=P.compression.toUpperCase(),P.type==="binarystring"&&(P.type="string"),!P.type)throw new Error("No output type specified.");a.checkSupport(P.type),(P.platform==="darwin"||P.platform==="freebsd"||P.platform==="linux"||P.platform==="sunos")&&(P.platform="UNIX"),P.platform==="win32"&&(P.platform="DOS");var F=P.comment||this.comment||"";D=f.generateWorker(this,P,F)}catch(H){D=new o("error"),D.error(H)}return new l(D,P.type||"string",P.mimeType)},generateAsync:function(S,D){return this.generateInternalStream(S).accumulate(D)},generateNodeStream:function(S,D){return S=S||{},S.type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(D)}};i.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var s=t("./DataReader"),a=t("../utils");function o(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=l[u]&255}a.inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),h=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),m=this.length-4;m>=0;--m)if(this.data[m]===u&&this.data[m+1]===h&&this.data[m+2]===d&&this.data[m+3]===f)return m-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),h=l.charCodeAt(1),d=l.charCodeAt(2),f=l.charCodeAt(3),m=this.readData(4);return u===m[0]&&h===m[1]&&d===m[2]&&f===m[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l=0,u;for(this.checkOffset(o),u=this.index+o-1;u>=this.index;u--)l=(l<<8)+this.byteAt(u);return this.index+=o,l},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC((o>>25&127)+1980,(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(o&31)<<1))}},i.exports=a},{"../utils":32}],19:[function(t,i,r){var s=t("./Uint8ArrayReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var s=t("./DataReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){var u=this.readData(4);return l===u},o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var s=t("./ArrayReader"),a=t("../utils");function o(l){s.call(this,l)}a.inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},i.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),h=t("./Uint8ArrayReader");i.exports=function(d){var f=s.getTypeOf(d);return s.checkSupport(f),f==="string"&&!a.uint8array?new l(d):f==="nodebuffer"?new u(d):a.uint8array?new h(s.transformTo("uint8array",d)):new o(s.transformTo("array",d))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,i,r){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},i.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var s=t("./GenericWorker"),a=t("../crc32"),o=t("../utils");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}o.inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}a.prototype.processChunk.call(this,l)},i.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var s=t("../utils"),a=t("./GenericWorker"),o=16*1024;function l(u){a.call(this,"DataWorker");var h=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){h.dataIsReady=!0,h.data=d,h.max=d&&d.length||0,h.type=s.getTypeOf(d),h.isPaused||h._tickAndRepeat()},function(d){h.error(d)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return a.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0):!1},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=o,h=null,d=Math.min(this.max,this.index+u);if(this.index>=this.max)return this.end();switch(this.type){case"string":h=this.data.substring(this.index,d);break;case"uint8array":h=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":h=this.data.slice(this.index,d);break}return this.index=d,this.push({data:h,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return this.isFinished?!1:(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var a=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=s},{}],29:[function(t,i,r){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),u=t("../support"),h=t("../external"),d=null;if(u.nodestream)try{d=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(w,v,y){switch(w){case"blob":return s.newBlob(s.transformTo("arraybuffer",v),y);case"base64":return l.encode(v);default:return s.transformTo(w,v)}}function m(w,v){var y,E=0,k=null,S=0;for(y=0;y<v.length;y++)S+=v[y].length;switch(w){case"string":return v.join("");case"array":return Array.prototype.concat.apply([],v);case"uint8array":for(k=new Uint8Array(S),y=0;y<v.length;y++)k.set(v[y],E),E+=v[y].length;return k;case"nodebuffer":return Buffer.concat(v);default:throw new Error("concat : unsupported type '"+w+"'")}}function b(w,v){return new h.Promise(function(y,E){var k=[],S=w._internalType,D=w._outputType,P=w._mimeType;w.on("data",function(F,H){k.push(F),v&&v(H)}).on("error",function(F){k=[],E(F)}).on("end",function(){try{var F=f(D,m(S,k),P);y(F)}catch(H){E(H)}k=[]}).resume()})}function _(w,v,y){var E=v;switch(v){case"blob":case"arraybuffer":E="uint8array";break;case"base64":E="string";break}try{this._internalType=E,this._outputType=v,this._mimeType=y,s.checkSupport(E),this._worker=w.pipe(new a(E)),w.lock()}catch(k){this._worker=new o("error"),this._worker.error(k)}}_.prototype={accumulate:function(w){return b(this,w)},on:function(w,v){var y=this;return w==="data"?this._worker.on(w,function(E){v.call(y,E.data,E.meta)}):this._worker.on(w,function(){s.delay(v,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},w)}},i.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",r.nodebuffer=typeof Buffer<"u",r.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")r.blob=!1;else{var s=new ArrayBuffer(0);try{r.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,o=new a;o.append(s),r.blob=o.getBlob("application/zip").size===0}catch{r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch{r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),h=0;h<256;h++)u[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;u[254]=u[254]=1;var d=function(w){var v,y,E,k,S,D=w.length,P=0;for(k=0;k<D;k++)y=w.charCodeAt(k),(y&64512)===55296&&k+1<D&&(E=w.charCodeAt(k+1),(E&64512)===56320&&(y=65536+(y-55296<<10)+(E-56320),k++)),P+=y<128?1:y<2048?2:y<65536?3:4;for(a.uint8array?v=new Uint8Array(P):v=new Array(P),S=0,k=0;S<P;k++)y=w.charCodeAt(k),(y&64512)===55296&&k+1<D&&(E=w.charCodeAt(k+1),(E&64512)===56320&&(y=65536+(y-55296<<10)+(E-56320),k++)),y<128?v[S++]=y:y<2048?(v[S++]=192|y>>>6,v[S++]=128|y&63):y<65536?(v[S++]=224|y>>>12,v[S++]=128|y>>>6&63,v[S++]=128|y&63):(v[S++]=240|y>>>18,v[S++]=128|y>>>12&63,v[S++]=128|y>>>6&63,v[S++]=128|y&63);return v},f=function(w,v){var y;for(v=v||w.length,v>w.length&&(v=w.length),y=v-1;y>=0&&(w[y]&192)===128;)y--;return y<0||y===0?v:y+u[w[y]]>v?y:v},m=function(w){var v,y,E,k,S=w.length,D=new Array(S*2);for(y=0,v=0;v<S;){if(E=w[v++],E<128){D[y++]=E;continue}if(k=u[E],k>4){D[y++]=65533,v+=k-1;continue}for(E&=k===2?31:k===3?15:7;k>1&&v<S;)E=E<<6|w[v++]&63,k--;if(k>1){D[y++]=65533;continue}E<65536?D[y++]=E:(E-=65536,D[y++]=55296|E>>10&1023,D[y++]=56320|E&1023)}return D.length!==y&&(D.subarray?D=D.subarray(0,y):D.length=y),s.applyFromCharCode(D)};r.utf8encode=function(v){return a.nodebuffer?o.newBufferFrom(v,"utf-8"):d(v)},r.utf8decode=function(v){return a.nodebuffer?s.transformTo("nodebuffer",v).toString("utf-8"):(v=s.transformTo(a.uint8array?"uint8array":"array",v),m(v))};function b(){l.call(this,"utf-8 decode"),this.leftOver=null}s.inherits(b,l),b.prototype.processChunk=function(w){var v=s.transformTo(a.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var y=v;v=new Uint8Array(y.length+this.leftOver.length),v.set(this.leftOver,0),v.set(y,this.leftOver.length)}else v=this.leftOver.concat(v);this.leftOver=null}var E=f(v),k=v;E!==v.length&&(a.uint8array?(k=v.subarray(0,E),this.leftOver=v.subarray(E,v.length)):(k=v.slice(0,E),this.leftOver=v.slice(E,v.length))),this.push({data:r.utf8decode(k),meta:w.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=b;function _(){l.call(this,"utf-8 encode")}s.inherits(_,l),_.prototype.processChunk=function(w){this.push({data:r.utf8encode(w.data),meta:w.meta})},r.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");t("setimmediate");function u(w){var v=null;return s.uint8array?v=new Uint8Array(w.length):v=new Array(w.length),d(w,v)}r.newBlob=function(w,v){r.checkSupport("blob");try{return new Blob([w],{type:v})}catch{try{var y=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,E=new y;return E.append(w),E.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};function h(w){return w}function d(w,v){for(var y=0;y<w.length;++y)v[y]=w.charCodeAt(y)&255;return v}var f={stringifyByChunk:function(w,v,y){var E=[],k=0,S=w.length;if(S<=y)return String.fromCharCode.apply(null,w);for(;k<S;)v==="array"||v==="nodebuffer"?E.push(String.fromCharCode.apply(null,w.slice(k,Math.min(k+y,S)))):E.push(String.fromCharCode.apply(null,w.subarray(k,Math.min(k+y,S)))),k+=y;return E.join("")},stringifyByChar:function(w){for(var v="",y=0;y<w.length;y++)v+=String.fromCharCode(w[y]);return v},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function m(w){var v=65536,y=r.getTypeOf(w),E=!0;if(y==="uint8array"?E=f.applyCanBeUsed.uint8array:y==="nodebuffer"&&(E=f.applyCanBeUsed.nodebuffer),E)for(;v>1;)try{return f.stringifyByChunk(w,y,v)}catch{v=Math.floor(v/2)}return f.stringifyByChar(w)}r.applyFromCharCode=m;function b(w,v){for(var y=0;y<w.length;y++)v[y]=w[y];return v}var _={};_.string={string:h,array:function(w){return d(w,new Array(w.length))},arraybuffer:function(w){return _.string.uint8array(w).buffer},uint8array:function(w){return d(w,new Uint8Array(w.length))},nodebuffer:function(w){return d(w,o.allocBuffer(w.length))}},_.array={string:m,array:h,arraybuffer:function(w){return new Uint8Array(w).buffer},uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return o.newBufferFrom(w)}},_.arraybuffer={string:function(w){return m(new Uint8Array(w))},array:function(w){return b(new Uint8Array(w),new Array(w.byteLength))},arraybuffer:h,uint8array:function(w){return new Uint8Array(w)},nodebuffer:function(w){return o.newBufferFrom(new Uint8Array(w))}},_.uint8array={string:m,array:function(w){return b(w,new Array(w.length))},arraybuffer:function(w){return w.buffer},uint8array:h,nodebuffer:function(w){return o.newBufferFrom(w)}},_.nodebuffer={string:m,array:function(w){return b(w,new Array(w.length))},arraybuffer:function(w){return _.nodebuffer.uint8array(w).buffer},uint8array:function(w){return b(w,new Uint8Array(w.length))},nodebuffer:h},r.transformTo=function(w,v){if(v||(v=""),!w)return v;r.checkSupport(w);var y=r.getTypeOf(v),E=_[y][w](v);return E},r.resolve=function(w){for(var v=w.split("/"),y=[],E=0;E<v.length;E++){var k=v[E];k==="."||k===""&&E!==0&&E!==v.length-1||(k===".."?y.pop():y.push(k))}return y.join("/")},r.getTypeOf=function(w){if(typeof w=="string")return"string";if(Object.prototype.toString.call(w)==="[object Array]")return"array";if(s.nodebuffer&&o.isBuffer(w))return"nodebuffer";if(s.uint8array&&w instanceof Uint8Array)return"uint8array";if(s.arraybuffer&&w instanceof ArrayBuffer)return"arraybuffer"},r.checkSupport=function(w){var v=s[w.toLowerCase()];if(!v)throw new Error(w+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(w){var v="",y,E;for(E=0;E<(w||"").length;E++)y=w.charCodeAt(E),v+="\\x"+(y<16?"0":"")+y.toString(16).toUpperCase();return v},r.delay=function(w,v,y){setImmediate(function(){w.apply(y||null,v||[])})},r.inherits=function(w,v){var y=function(){};y.prototype=v.prototype,w.prototype=new y},r.extend=function(){var w={},v,y;for(v=0;v<arguments.length;v++)for(y in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],y)&&typeof w[y]>"u"&&(w[y]=arguments[v][y]);return w},r.prepareContent=function(w,v,y,E,k){var S=l.Promise.resolve(v).then(function(D){var P=s.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1);return P&&typeof FileReader<"u"?new l.Promise(function(F,H){var z=new FileReader;z.onload=function(te){F(te.target.result)},z.onerror=function(te){H(te.target.error)},z.readAsArrayBuffer(D)}):D});return S.then(function(D){var P=r.getTypeOf(D);return P?(P==="arraybuffer"?D=r.transformTo("uint8array",D):P==="string"&&(k?D=a.decode(D):y&&E!==!0&&(D=u(D))),D):l.Promise.reject(new Error("Can't read the data of '"+w+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),u=t("./support");function h(d){this.files=[],this.loadOptions=d}h.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(f)+", expected "+a.pretty(d)+")")}},isSignature:function(d,f){var m=this.reader.index;this.reader.setIndex(d);var b=this.reader.readString(4),_=b===f;return this.reader.setIndex(m),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),f=u.uint8array?"uint8array":"array",m=a.transformTo(f,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d=this.zip64EndOfCentralSize-44,f=0,m,b,_;f<d;)m=this.reader.readInt(2),b=this.reader.readInt(4),_=this.reader.readData(b),this.zip64ExtensibleData[m]={id:m,length:b,value:_}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,f;for(d=0;d<this.files.length;d++)f=this.files[d],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)d=new l({zip64:this.zip64},this.loadOptions),d.readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0){var f=!this.isSignature(0,o.LOCAL_FILE_HEADER);throw f?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(d);var m=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),d<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var _=m-b;if(_>0)this.isSignature(m,o.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),h=t("./compressions"),d=t("./support"),f=0,m=3,b=function(w){for(var v in h)if(Object.prototype.hasOwnProperty.call(h,v)&&h[v].magic===w)return h[v];return null};function _(w,v){this.options=w,this.loadOptions=v}_.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(w){var v,y;if(w.skip(22),this.fileNameLength=w.readInt(2),y=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(v=b(this.compressionMethod),v===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,v,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var v=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(v),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),w===f&&(this.dosPermissions=this.externalFileAttributes&63),w===m&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var v=w.index+this.extraFieldsLength,y,E,k;for(this.extraFields||(this.extraFields={});w.index+4<v;)y=w.readInt(2),E=w.readInt(2),k=w.readData(E),this.extraFields[y]={id:y,length:E,value:k};w.setIndex(v)},handleUTF8:function(){var w=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var v=this.findExtraFieldUnicodePath();if(v!==null)this.fileNameStr=v;else{var y=a.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var E=this.findExtraFieldUnicodeComment();if(E!==null)this.fileCommentStr=E;else{var k=a.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(k)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var v=s(w.value);return v.readInt(1)!==1||l(this.fileName)!==v.readInt(4)?null:u.utf8decode(v.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var v=s(w.value);return v.readInt(1)!==1||l(this.fileComment)!==v.readInt(4)?null:u.utf8decode(v.readData(w.length-5))}return null}},i.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){var s=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),o=t("./utf8"),l=t("./compressedObject"),u=t("./stream/GenericWorker"),h=function(b,_,w){this.name=b,this.dir=w.dir,this.date=w.date,this.comment=w.comment,this.unixPermissions=w.unixPermissions,this.dosPermissions=w.dosPermissions,this._data=_,this._dataBinary=w.binary,this.options={compression:w.compression,compressionOptions:w.compressionOptions}};h.prototype={internalStream:function(b){var _=null,w="string";try{if(!b)throw new Error("No output type specified.");w=b.toLowerCase();var v=w==="string"||w==="text";(w==="binarystring"||w==="text")&&(w="string"),_=this._decompressWorker();var y=!this._dataBinary;y&&!v&&(_=_.pipe(new o.Utf8EncodeWorker)),!y&&v&&(_=_.pipe(new o.Utf8DecodeWorker))}catch(E){_=new u("error"),_.error(E)}return new s(_,w,"")},async:function(b,_){return this.internalStream(b).accumulate(_)},nodeStream:function(b,_){return this.internalStream(b||"nodebuffer").toNodejsStream(_)},_compressWorker:function(b,_){if(this._data instanceof l&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var w=this._decompressWorker();return this._dataBinary||(w=w.pipe(new o.Utf8EncodeWorker)),l.createWorkerFrom(w,b,_)},_decompressWorker:function(){return this._data instanceof l?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)h.prototype[d[m]]=f;i.exports=h},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,u=new a(b),h=s.document.createTextNode("");u.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var d=new s.MessageChannel;d.port1.onmessage=b,o=function(){d.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var w=s.document.createElement("script");w.onreadystatechange=function(){b(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},s.document.documentElement.appendChild(w)}:o=function(){setTimeout(b,0)};var f,m=[];function b(){f=!0;for(var w,v,y=m.length;y;){for(v=m,m=[],w=-1;++w<y;)v[w]();y=m.length}f=!1}i.exports=_;function _(w){m.push(w)===1&&!f&&o()}}).call(this,typeof Cr<"u"?Cr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,i,r){var s=t("immediate");function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],h=["PENDING"];i.exports=d;function d(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,S!==a&&_(this,S)}d.prototype.finally=function(S){if(typeof S!="function")return this;var D=this.constructor;return this.then(P,F);function P(H){function z(){return H}return D.resolve(S()).then(z)}function F(H){function z(){throw H}return D.resolve(S()).then(z)}},d.prototype.catch=function(S){return this.then(null,S)},d.prototype.then=function(S,D){if(typeof S!="function"&&this.state===u||typeof D!="function"&&this.state===l)return this;var P=new this.constructor(a);if(this.state!==h){var F=this.state===u?S:D;m(P,F,this.outcome)}else this.queue.push(new f(P,S,D));return P};function f(S,D,P){this.promise=S,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof P=="function"&&(this.onRejected=P,this.callRejected=this.otherCallRejected)}f.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},f.prototype.otherCallFulfilled=function(S){m(this.promise,this.onFulfilled,S)},f.prototype.callRejected=function(S){o.reject(this.promise,S)},f.prototype.otherCallRejected=function(S){m(this.promise,this.onRejected,S)};function m(S,D,P){s(function(){var F;try{F=D(P)}catch(H){return o.reject(S,H)}F===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,F)})}o.resolve=function(S,D){var P=w(b,D);if(P.status==="error")return o.reject(S,P.value);var F=P.value;if(F)_(S,F);else{S.state=u,S.outcome=D;for(var H=-1,z=S.queue.length;++H<z;)S.queue[H].callFulfilled(D)}return S},o.reject=function(S,D){S.state=l,S.outcome=D;for(var P=-1,F=S.queue.length;++P<F;)S.queue[P].callRejected(D);return S};function b(S){var D=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof D=="function")return function(){D.apply(S,arguments)}}function _(S,D){var P=!1;function F(de){P||(P=!0,o.reject(S,de))}function H(de){P||(P=!0,o.resolve(S,de))}function z(){D(H,F)}var te=w(z);te.status==="error"&&F(te.value)}function w(S,D){var P={};try{P.value=S(D),P.status="success"}catch(F){P.status="error",P.value=F}return P}d.resolve=v;function v(S){return S instanceof this?S:o.resolve(new this(a),S)}d.reject=y;function y(S){var D=new this(a);return o.reject(D,S)}d.all=E;function E(S){var D=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=S.length,F=!1;if(!P)return this.resolve([]);for(var H=new Array(P),z=0,te=-1,de=new this(a);++te<P;)ke(S[te],te);return de;function ke(Me,ze){D.resolve(Me).then(ve,function(xe){F||(F=!0,o.reject(de,xe))});function ve(xe){H[ze]=xe,++z===P&&!F&&(F=!0,o.resolve(de,H))}}}d.race=k;function k(S){var D=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=S.length,F=!1;if(!P)return this.resolve([]);for(var H=-1,z=new this(a);++H<P;)te(S[H]);return z;function te(de){D.resolve(de).then(function(ke){F||(F=!0,o.resolve(z,ke))},function(ke){F||(F=!0,o.reject(z,ke))})}}},{immediate:36}],38:[function(t,i,r){var s=t("./lib/utils/common").assign,a=t("./lib/deflate"),o=t("./lib/inflate"),l=t("./lib/zlib/constants"),u={};s(u,a,o,l),i.exports=u},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),h=Object.prototype.toString,d=0,f=4,m=0,b=1,_=2,w=-1,v=0,y=8;function E(P){if(!(this instanceof E))return new E(P);this.options=a.assign({level:w,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:v,to:""},P||{});var F=this.options;F.raw&&F.windowBits>0?F.windowBits=-F.windowBits:F.gzip&&F.windowBits>0&&F.windowBits<16&&(F.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var H=s.deflateInit2(this.strm,F.level,F.method,F.windowBits,F.memLevel,F.strategy);if(H!==m)throw new Error(l[H]);if(F.header&&s.deflateSetHeader(this.strm,F.header),F.dictionary){var z;if(typeof F.dictionary=="string"?z=o.string2buf(F.dictionary):h.call(F.dictionary)==="[object ArrayBuffer]"?z=new Uint8Array(F.dictionary):z=F.dictionary,H=s.deflateSetDictionary(this.strm,z),H!==m)throw new Error(l[H]);this._dict_set=!0}}E.prototype.push=function(P,F){var H=this.strm,z=this.options.chunkSize,te,de;if(this.ended)return!1;de=F===~~F?F:F===!0?f:d,typeof P=="string"?H.input=o.string2buf(P):h.call(P)==="[object ArrayBuffer]"?H.input=new Uint8Array(P):H.input=P,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new a.Buf8(z),H.next_out=0,H.avail_out=z),te=s.deflate(H,de),te!==b&&te!==m)return this.onEnd(te),this.ended=!0,!1;(H.avail_out===0||H.avail_in===0&&(de===f||de===_))&&(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(H.output,H.next_out))):this.onData(a.shrinkBuf(H.output,H.next_out)))}while((H.avail_in>0||H.avail_out===0)&&te!==b);return de===f?(te=s.deflateEnd(this.strm),this.onEnd(te),this.ended=!0,te===m):(de===_&&(this.onEnd(m),H.avail_out=0),!0)},E.prototype.onData=function(P){this.chunks.push(P)},E.prototype.onEnd=function(P){P===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg};function k(P,F){var H=new E(F);if(H.push(P,!0),H.err)throw H.msg||l[H.err];return H.result}function S(P,F){return F=F||{},F.raw=!0,k(P,F)}function D(P,F){return F=F||{},F.gzip=!0,k(P,F)}r.Deflate=E,r.deflate=k,r.deflateRaw=S,r.gzip=D},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),h=t("./zlib/zstream"),d=t("./zlib/gzheader"),f=Object.prototype.toString;function m(w){if(!(this instanceof m))return new m(w);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},w||{});var v=this.options;v.raw&&v.windowBits>=0&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),v.windowBits>=0&&v.windowBits<16&&!(w&&w.windowBits)&&(v.windowBits+=32),v.windowBits>15&&v.windowBits<48&&(v.windowBits&15||(v.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var y=s.inflateInit2(this.strm,v.windowBits);if(y!==l.Z_OK)throw new Error(u[y]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}m.prototype.push=function(w,v){var y=this.strm,E=this.options.chunkSize,k=this.options.dictionary,S,D,P,F,H,z,te=!1;if(this.ended)return!1;D=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof w=="string"?y.input=o.binstring2buf(w):f.call(w)==="[object ArrayBuffer]"?y.input=new Uint8Array(w):y.input=w,y.next_in=0,y.avail_in=y.input.length;do{if(y.avail_out===0&&(y.output=new a.Buf8(E),y.next_out=0,y.avail_out=E),S=s.inflate(y,l.Z_NO_FLUSH),S===l.Z_NEED_DICT&&k&&(typeof k=="string"?z=o.string2buf(k):f.call(k)==="[object ArrayBuffer]"?z=new Uint8Array(k):z=k,S=s.inflateSetDictionary(this.strm,z)),S===l.Z_BUF_ERROR&&te===!0&&(S=l.Z_OK,te=!1),S!==l.Z_STREAM_END&&S!==l.Z_OK)return this.onEnd(S),this.ended=!0,!1;y.next_out&&(y.avail_out===0||S===l.Z_STREAM_END||y.avail_in===0&&(D===l.Z_FINISH||D===l.Z_SYNC_FLUSH))&&(this.options.to==="string"?(P=o.utf8border(y.output,y.next_out),F=y.next_out-P,H=o.buf2string(y.output,P),y.next_out=F,y.avail_out=E-F,F&&a.arraySet(y.output,y.output,P,F,0),this.onData(H)):this.onData(a.shrinkBuf(y.output,y.next_out))),y.avail_in===0&&y.avail_out===0&&(te=!0)}while((y.avail_in>0||y.avail_out===0)&&S!==l.Z_STREAM_END);return S===l.Z_STREAM_END&&(D=l.Z_FINISH),D===l.Z_FINISH?(S=s.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===l.Z_OK):(D===l.Z_SYNC_FLUSH&&(this.onEnd(l.Z_OK),y.avail_out=0),!0)},m.prototype.onData=function(w){this.chunks.push(w)},m.prototype.onEnd=function(w){w===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,v){var y=new m(v);if(y.push(w,!0),y.err)throw y.msg||u[y.err];return y.result}function _(w,v){return v=v||{},v.raw=!0,b(w,v)}r.Inflate=m,r.inflate=b,r.inflateRaw=_,r.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";r.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var h=u.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var d in h)h.hasOwnProperty(d)&&(l[d]=h[d])}}return l},r.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var a={arraySet:function(l,u,h,d,f){if(u.subarray&&l.subarray){l.set(u.subarray(h,h+d),f);return}for(var m=0;m<d;m++)l[f+m]=u[h+m]},flattenChunks:function(l){var u,h,d,f,m,b;for(d=0,u=0,h=l.length;u<h;u++)d+=l[u].length;for(b=new Uint8Array(d),f=0,u=0,h=l.length;u<h;u++)m=l[u],b.set(m,f),f+=m.length;return b}},o={arraySet:function(l,u,h,d,f){for(var m=0;m<d;m++)l[f+m]=u[h+m]},flattenChunks:function(l){return[].concat.apply([],l)}};r.setTyped=function(l){l?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(s)},{}],42:[function(t,i,r){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),u=0;u<256;u++)l[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;l[254]=l[254]=1,r.string2buf=function(d){var f,m,b,_,w,v=d.length,y=0;for(_=0;_<v;_++)m=d.charCodeAt(_),(m&64512)===55296&&_+1<v&&(b=d.charCodeAt(_+1),(b&64512)===56320&&(m=65536+(m-55296<<10)+(b-56320),_++)),y+=m<128?1:m<2048?2:m<65536?3:4;for(f=new s.Buf8(y),w=0,_=0;w<y;_++)m=d.charCodeAt(_),(m&64512)===55296&&_+1<v&&(b=d.charCodeAt(_+1),(b&64512)===56320&&(m=65536+(m-55296<<10)+(b-56320),_++)),m<128?f[w++]=m:m<2048?(f[w++]=192|m>>>6,f[w++]=128|m&63):m<65536?(f[w++]=224|m>>>12,f[w++]=128|m>>>6&63,f[w++]=128|m&63):(f[w++]=240|m>>>18,f[w++]=128|m>>>12&63,f[w++]=128|m>>>6&63,f[w++]=128|m&63);return f};function h(d,f){if(f<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(d,f));for(var m="",b=0;b<f;b++)m+=String.fromCharCode(d[b]);return m}r.buf2binstring=function(d){return h(d,d.length)},r.binstring2buf=function(d){for(var f=new s.Buf8(d.length),m=0,b=f.length;m<b;m++)f[m]=d.charCodeAt(m);return f},r.buf2string=function(d,f){var m,b,_,w,v=f||d.length,y=new Array(v*2);for(b=0,m=0;m<v;){if(_=d[m++],_<128){y[b++]=_;continue}if(w=l[_],w>4){y[b++]=65533,m+=w-1;continue}for(_&=w===2?31:w===3?15:7;w>1&&m<v;)_=_<<6|d[m++]&63,w--;if(w>1){y[b++]=65533;continue}_<65536?y[b++]=_:(_-=65536,y[b++]=55296|_>>10&1023,y[b++]=56320|_&1023)}return h(y,b)},r.utf8border=function(d,f){var m;for(f=f||d.length,f>d.length&&(f=d.length),m=f-1;m>=0&&(d[m]&192)===128;)m--;return m<0||m===0?f:m+l[d[m]]>f?m:f}},{"./common":41}],43:[function(t,i,r){function s(a,o,l,u){for(var h=a&65535|0,d=a>>>16&65535|0,f=0;l!==0;){f=l>2e3?2e3:l,l-=f;do h=h+o[u++]|0,d=d+h|0;while(--f);h%=65521,d%=65521}return h|d<<16|0}i.exports=s},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){function s(){for(var l,u=[],h=0;h<256;h++){l=h;for(var d=0;d<8;d++)l=l&1?3988292384^l>>>1:l>>>1;u[h]=l}return u}var a=s();function o(l,u,h,d){var f=a,m=d+h;l^=-1;for(var b=d;b<m;b++)l=l>>>8^f[(l^u[b])&255];return l^-1}i.exports=o},{}],46:[function(t,i,r){var s=t("../utils/common"),a=t("./trees"),o=t("./adler32"),l=t("./crc32"),u=t("./messages"),h=0,d=1,f=3,m=4,b=5,_=0,w=1,v=-2,y=-3,E=-5,k=-1,S=1,D=2,P=3,F=4,H=0,z=2,te=8,de=9,ke=15,Me=8,ze=29,ve=256,xe=ve+1+ze,he=30,ie=19,ae=2*xe+1,me=15,_e=3,pe=258,De=pe+_e+1,it=32,Xe=42,We=69,nt=73,Ve=91,Bt=103,wt=113,pt=666,It=1,ei=2,en=3,Vi=4,Wt=3;function Wn(x,be){return x.msg=u[be],be}function Jr(x){return(x<<1)-(x>4?9:0)}function ti(x){for(var be=x.length;--be>=0;)x[be]=0}function ln(x){var be=x.state,Ee=be.pending;Ee>x.avail_out&&(Ee=x.avail_out),Ee!==0&&(s.arraySet(x.output,be.pending_buf,be.pending_out,Ee,x.next_out),x.next_out+=Ee,be.pending_out+=Ee,x.total_out+=Ee,x.avail_out-=Ee,be.pending-=Ee,be.pending===0&&(be.pending_out=0))}function tn(x,be){a._tr_flush_block(x,x.block_start>=0?x.block_start:-1,x.strstart-x.block_start,be),x.block_start=x.strstart,ln(x.strm)}function yt(x,be){x.pending_buf[x.pending++]=be}function vi(x,be){x.pending_buf[x.pending++]=be>>>8&255,x.pending_buf[x.pending++]=be&255}function fr(x,be,Ee,B){var K=x.avail_in;return K>B&&(K=B),K===0?0:(x.avail_in-=K,s.arraySet(be,x.input,x.next_in,K,Ee),x.state.wrap===1?x.adler=o(x.adler,be,K,Ee):x.state.wrap===2&&(x.adler=l(x.adler,be,K,Ee)),x.next_in+=K,x.total_in+=K,K)}function ai(x,be){var Ee=x.max_chain_length,B=x.strstart,K,ge,lt=x.prev_length,Oe=x.nice_match,He=x.strstart>x.w_size-De?x.strstart-(x.w_size-De):0,Nt=x.window,Gi=x.w_mask,nn=x.prev,Dt=x.strstart+pe,Rn=Nt[B+lt-1],dn=Nt[B+lt];x.prev_length>=x.good_match&&(Ee>>=2),Oe>x.lookahead&&(Oe=x.lookahead);do if(K=be,!(Nt[K+lt]!==dn||Nt[K+lt-1]!==Rn||Nt[K]!==Nt[B]||Nt[++K]!==Nt[B+1])){B+=2,K++;do;while(Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&Nt[++B]===Nt[++K]&&B<Dt);if(ge=pe-(Dt-B),B=Dt-pe,ge>lt){if(x.match_start=be,lt=ge,ge>=Oe)break;Rn=Nt[B+lt-1],dn=Nt[B+lt]}}while((be=nn[be&Gi])>He&&--Ee!==0);return lt<=x.lookahead?lt:x.lookahead}function Dn(x){var be=x.w_size,Ee,B,K,ge,lt;do{if(ge=x.window_size-x.lookahead-x.strstart,x.strstart>=be+(be-De)){s.arraySet(x.window,x.window,be,be,0),x.match_start-=be,x.strstart-=be,x.block_start-=be,B=x.hash_size,Ee=B;do K=x.head[--Ee],x.head[Ee]=K>=be?K-be:0;while(--B);B=be,Ee=B;do K=x.prev[--Ee],x.prev[Ee]=K>=be?K-be:0;while(--B);ge+=be}if(x.strm.avail_in===0)break;if(B=fr(x.strm,x.window,x.strstart+x.lookahead,ge),x.lookahead+=B,x.lookahead+x.insert>=_e)for(lt=x.strstart-x.insert,x.ins_h=x.window[lt],x.ins_h=(x.ins_h<<x.hash_shift^x.window[lt+1])&x.hash_mask;x.insert&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[lt+_e-1])&x.hash_mask,x.prev[lt&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=lt,lt++,x.insert--,!(x.lookahead+x.insert<_e)););}while(x.lookahead<De&&x.strm.avail_in!==0)}function es(x,be){var Ee=65535;for(Ee>x.pending_buf_size-5&&(Ee=x.pending_buf_size-5);;){if(x.lookahead<=1){if(Dn(x),x.lookahead===0&&be===h)return It;if(x.lookahead===0)break}x.strstart+=x.lookahead,x.lookahead=0;var B=x.block_start+Ee;if((x.strstart===0||x.strstart>=B)&&(x.lookahead=x.strstart-B,x.strstart=B,tn(x,!1),x.strm.avail_out===0)||x.strstart-x.block_start>=x.w_size-De&&(tn(x,!1),x.strm.avail_out===0))return It}return x.insert=0,be===m?(tn(x,!0),x.strm.avail_out===0?en:Vi):(x.strstart>x.block_start&&(tn(x,!1),x.strm.avail_out===0),It)}function Ii(x,be){for(var Ee,B;;){if(x.lookahead<De){if(Dn(x),x.lookahead<De&&be===h)return It;if(x.lookahead===0)break}if(Ee=0,x.lookahead>=_e&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+_e-1])&x.hash_mask,Ee=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart),Ee!==0&&x.strstart-Ee<=x.w_size-De&&(x.match_length=ai(x,Ee)),x.match_length>=_e)if(B=a._tr_tally(x,x.strstart-x.match_start,x.match_length-_e),x.lookahead-=x.match_length,x.match_length<=x.max_lazy_match&&x.lookahead>=_e){x.match_length--;do x.strstart++,x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+_e-1])&x.hash_mask,Ee=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart;while(--x.match_length!==0);x.strstart++}else x.strstart+=x.match_length,x.match_length=0,x.ins_h=x.window[x.strstart],x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+1])&x.hash_mask;else B=a._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++;if(B&&(tn(x,!1),x.strm.avail_out===0))return It}return x.insert=x.strstart<_e-1?x.strstart:_e-1,be===m?(tn(x,!0),x.strm.avail_out===0?en:Vi):x.last_lit&&(tn(x,!1),x.strm.avail_out===0)?It:ei}function yi(x,be){for(var Ee,B,K;;){if(x.lookahead<De){if(Dn(x),x.lookahead<De&&be===h)return It;if(x.lookahead===0)break}if(Ee=0,x.lookahead>=_e&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+_e-1])&x.hash_mask,Ee=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart),x.prev_length=x.match_length,x.prev_match=x.match_start,x.match_length=_e-1,Ee!==0&&x.prev_length<x.max_lazy_match&&x.strstart-Ee<=x.w_size-De&&(x.match_length=ai(x,Ee),x.match_length<=5&&(x.strategy===S||x.match_length===_e&&x.strstart-x.match_start>4096)&&(x.match_length=_e-1)),x.prev_length>=_e&&x.match_length<=x.prev_length){K=x.strstart+x.lookahead-_e,B=a._tr_tally(x,x.strstart-1-x.prev_match,x.prev_length-_e),x.lookahead-=x.prev_length-1,x.prev_length-=2;do++x.strstart<=K&&(x.ins_h=(x.ins_h<<x.hash_shift^x.window[x.strstart+_e-1])&x.hash_mask,Ee=x.prev[x.strstart&x.w_mask]=x.head[x.ins_h],x.head[x.ins_h]=x.strstart);while(--x.prev_length!==0);if(x.match_available=0,x.match_length=_e-1,x.strstart++,B&&(tn(x,!1),x.strm.avail_out===0))return It}else if(x.match_available){if(B=a._tr_tally(x,0,x.window[x.strstart-1]),B&&tn(x,!1),x.strstart++,x.lookahead--,x.strm.avail_out===0)return It}else x.match_available=1,x.strstart++,x.lookahead--}return x.match_available&&(B=a._tr_tally(x,0,x.window[x.strstart-1]),x.match_available=0),x.insert=x.strstart<_e-1?x.strstart:_e-1,be===m?(tn(x,!0),x.strm.avail_out===0?en:Vi):x.last_lit&&(tn(x,!1),x.strm.avail_out===0)?It:ei}function Ir(x,be){for(var Ee,B,K,ge,lt=x.window;;){if(x.lookahead<=pe){if(Dn(x),x.lookahead<=pe&&be===h)return It;if(x.lookahead===0)break}if(x.match_length=0,x.lookahead>=_e&&x.strstart>0&&(K=x.strstart-1,B=lt[K],B===lt[++K]&&B===lt[++K]&&B===lt[++K])){ge=x.strstart+pe;do;while(B===lt[++K]&&B===lt[++K]&&B===lt[++K]&&B===lt[++K]&&B===lt[++K]&&B===lt[++K]&&B===lt[++K]&&B===lt[++K]&&K<ge);x.match_length=pe-(ge-K),x.match_length>x.lookahead&&(x.match_length=x.lookahead)}if(x.match_length>=_e?(Ee=a._tr_tally(x,1,x.match_length-_e),x.lookahead-=x.match_length,x.strstart+=x.match_length,x.match_length=0):(Ee=a._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++),Ee&&(tn(x,!1),x.strm.avail_out===0))return It}return x.insert=0,be===m?(tn(x,!0),x.strm.avail_out===0?en:Vi):x.last_lit&&(tn(x,!1),x.strm.avail_out===0)?It:ei}function oi(x,be){for(var Ee;;){if(x.lookahead===0&&(Dn(x),x.lookahead===0)){if(be===h)return It;break}if(x.match_length=0,Ee=a._tr_tally(x,0,x.window[x.strstart]),x.lookahead--,x.strstart++,Ee&&(tn(x,!1),x.strm.avail_out===0))return It}return x.insert=0,be===m?(tn(x,!0),x.strm.avail_out===0?en:Vi):x.last_lit&&(tn(x,!1),x.strm.avail_out===0)?It:ei}function En(x,be,Ee,B,K){this.good_length=x,this.max_lazy=be,this.nice_length=Ee,this.max_chain=B,this.func=K}var bi;bi=[new En(0,0,0,0,es),new En(4,4,8,4,Ii),new En(4,5,16,8,Ii),new En(4,6,32,32,Ii),new En(4,4,16,16,yi),new En(8,16,32,32,yi),new En(8,16,128,128,yi),new En(8,32,128,256,yi),new En(32,128,258,1024,yi),new En(32,258,258,4096,yi)];function Li(x){x.window_size=2*x.w_size,ti(x.head),x.max_lazy_match=bi[x.level].max_lazy,x.good_match=bi[x.level].good_length,x.nice_match=bi[x.level].nice_length,x.max_chain_length=bi[x.level].max_chain,x.strstart=0,x.block_start=0,x.lookahead=0,x.insert=0,x.match_length=x.prev_length=_e-1,x.match_available=0,x.ins_h=0}function M(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=te,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(ae*2),this.dyn_dtree=new s.Buf16((2*he+1)*2),this.bl_tree=new s.Buf16((2*ie+1)*2),ti(this.dyn_ltree),ti(this.dyn_dtree),ti(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(me+1),this.heap=new s.Buf16(2*xe+1),ti(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*xe+1),ti(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ne(x){var be;return!x||!x.state?Wn(x,v):(x.total_in=x.total_out=0,x.data_type=z,be=x.state,be.pending=0,be.pending_out=0,be.wrap<0&&(be.wrap=-be.wrap),be.status=be.wrap?Xe:wt,x.adler=be.wrap===2?0:1,be.last_flush=h,a._tr_init(be),_)}function Le(x){var be=Ne(x);return be===_&&Li(x.state),be}function tt(x,be){return!x||!x.state||x.state.wrap!==2?v:(x.state.gzhead=be,_)}function q(x,be,Ee,B,K,ge){if(!x)return v;var lt=1;if(be===k&&(be=6),B<0?(lt=0,B=-B):B>15&&(lt=2,B-=16),K<1||K>de||Ee!==te||B<8||B>15||be<0||be>9||ge<0||ge>F)return Wn(x,v);B===8&&(B=9);var Oe=new M;return x.state=Oe,Oe.strm=x,Oe.wrap=lt,Oe.gzhead=null,Oe.w_bits=B,Oe.w_size=1<<Oe.w_bits,Oe.w_mask=Oe.w_size-1,Oe.hash_bits=K+7,Oe.hash_size=1<<Oe.hash_bits,Oe.hash_mask=Oe.hash_size-1,Oe.hash_shift=~~((Oe.hash_bits+_e-1)/_e),Oe.window=new s.Buf8(Oe.w_size*2),Oe.head=new s.Buf16(Oe.hash_size),Oe.prev=new s.Buf16(Oe.w_size),Oe.lit_bufsize=1<<K+6,Oe.pending_buf_size=Oe.lit_bufsize*4,Oe.pending_buf=new s.Buf8(Oe.pending_buf_size),Oe.d_buf=1*Oe.lit_bufsize,Oe.l_buf=3*Oe.lit_bufsize,Oe.level=be,Oe.strategy=ge,Oe.method=Ee,Le(x)}function Se(x,be){return q(x,be,te,ke,Me,H)}function O(x,be){var Ee,B,K,ge;if(!x||!x.state||be>b||be<0)return x?Wn(x,v):v;if(B=x.state,!x.output||!x.input&&x.avail_in!==0||B.status===pt&&be!==m)return Wn(x,x.avail_out===0?E:v);if(B.strm=x,Ee=B.last_flush,B.last_flush=be,B.status===Xe)if(B.wrap===2)x.adler=0,yt(B,31),yt(B,139),yt(B,8),B.gzhead?(yt(B,(B.gzhead.text?1:0)+(B.gzhead.hcrc?2:0)+(B.gzhead.extra?4:0)+(B.gzhead.name?8:0)+(B.gzhead.comment?16:0)),yt(B,B.gzhead.time&255),yt(B,B.gzhead.time>>8&255),yt(B,B.gzhead.time>>16&255),yt(B,B.gzhead.time>>24&255),yt(B,B.level===9?2:B.strategy>=D||B.level<2?4:0),yt(B,B.gzhead.os&255),B.gzhead.extra&&B.gzhead.extra.length&&(yt(B,B.gzhead.extra.length&255),yt(B,B.gzhead.extra.length>>8&255)),B.gzhead.hcrc&&(x.adler=l(x.adler,B.pending_buf,B.pending,0)),B.gzindex=0,B.status=We):(yt(B,0),yt(B,0),yt(B,0),yt(B,0),yt(B,0),yt(B,B.level===9?2:B.strategy>=D||B.level<2?4:0),yt(B,Wt),B.status=wt);else{var lt=te+(B.w_bits-8<<4)<<8,Oe=-1;B.strategy>=D||B.level<2?Oe=0:B.level<6?Oe=1:B.level===6?Oe=2:Oe=3,lt|=Oe<<6,B.strstart!==0&&(lt|=it),lt+=31-lt%31,B.status=wt,vi(B,lt),B.strstart!==0&&(vi(B,x.adler>>>16),vi(B,x.adler&65535)),x.adler=1}if(B.status===We)if(B.gzhead.extra){for(K=B.pending;B.gzindex<(B.gzhead.extra.length&65535)&&!(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>K&&(x.adler=l(x.adler,B.pending_buf,B.pending-K,K)),ln(x),K=B.pending,B.pending===B.pending_buf_size));)yt(B,B.gzhead.extra[B.gzindex]&255),B.gzindex++;B.gzhead.hcrc&&B.pending>K&&(x.adler=l(x.adler,B.pending_buf,B.pending-K,K)),B.gzindex===B.gzhead.extra.length&&(B.gzindex=0,B.status=nt)}else B.status=nt;if(B.status===nt)if(B.gzhead.name){K=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>K&&(x.adler=l(x.adler,B.pending_buf,B.pending-K,K)),ln(x),K=B.pending,B.pending===B.pending_buf_size)){ge=1;break}B.gzindex<B.gzhead.name.length?ge=B.gzhead.name.charCodeAt(B.gzindex++)&255:ge=0,yt(B,ge)}while(ge!==0);B.gzhead.hcrc&&B.pending>K&&(x.adler=l(x.adler,B.pending_buf,B.pending-K,K)),ge===0&&(B.gzindex=0,B.status=Ve)}else B.status=Ve;if(B.status===Ve)if(B.gzhead.comment){K=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>K&&(x.adler=l(x.adler,B.pending_buf,B.pending-K,K)),ln(x),K=B.pending,B.pending===B.pending_buf_size)){ge=1;break}B.gzindex<B.gzhead.comment.length?ge=B.gzhead.comment.charCodeAt(B.gzindex++)&255:ge=0,yt(B,ge)}while(ge!==0);B.gzhead.hcrc&&B.pending>K&&(x.adler=l(x.adler,B.pending_buf,B.pending-K,K)),ge===0&&(B.status=Bt)}else B.status=Bt;if(B.status===Bt&&(B.gzhead.hcrc?(B.pending+2>B.pending_buf_size&&ln(x),B.pending+2<=B.pending_buf_size&&(yt(B,x.adler&255),yt(B,x.adler>>8&255),x.adler=0,B.status=wt)):B.status=wt),B.pending!==0){if(ln(x),x.avail_out===0)return B.last_flush=-1,_}else if(x.avail_in===0&&Jr(be)<=Jr(Ee)&&be!==m)return Wn(x,E);if(B.status===pt&&x.avail_in!==0)return Wn(x,E);if(x.avail_in!==0||B.lookahead!==0||be!==h&&B.status!==pt){var He=B.strategy===D?oi(B,be):B.strategy===P?Ir(B,be):bi[B.level].func(B,be);if((He===en||He===Vi)&&(B.status=pt),He===It||He===en)return x.avail_out===0&&(B.last_flush=-1),_;if(He===ei&&(be===d?a._tr_align(B):be!==b&&(a._tr_stored_block(B,0,0,!1),be===f&&(ti(B.head),B.lookahead===0&&(B.strstart=0,B.block_start=0,B.insert=0))),ln(x),x.avail_out===0))return B.last_flush=-1,_}return be!==m?_:B.wrap<=0?w:(B.wrap===2?(yt(B,x.adler&255),yt(B,x.adler>>8&255),yt(B,x.adler>>16&255),yt(B,x.adler>>24&255),yt(B,x.total_in&255),yt(B,x.total_in>>8&255),yt(B,x.total_in>>16&255),yt(B,x.total_in>>24&255)):(vi(B,x.adler>>>16),vi(B,x.adler&65535)),ln(x),B.wrap>0&&(B.wrap=-B.wrap),B.pending!==0?_:w)}function Ie(x){var be;return!x||!x.state?v:(be=x.state.status,be!==Xe&&be!==We&&be!==nt&&be!==Ve&&be!==Bt&&be!==wt&&be!==pt?Wn(x,v):(x.state=null,be===wt?Wn(x,y):_))}function ft(x,be){var Ee=be.length,B,K,ge,lt,Oe,He,Nt,Gi;if(!x||!x.state||(B=x.state,lt=B.wrap,lt===2||lt===1&&B.status!==Xe||B.lookahead))return v;for(lt===1&&(x.adler=o(x.adler,be,Ee,0)),B.wrap=0,Ee>=B.w_size&&(lt===0&&(ti(B.head),B.strstart=0,B.block_start=0,B.insert=0),Gi=new s.Buf8(B.w_size),s.arraySet(Gi,be,Ee-B.w_size,B.w_size,0),be=Gi,Ee=B.w_size),Oe=x.avail_in,He=x.next_in,Nt=x.input,x.avail_in=Ee,x.next_in=0,x.input=be,Dn(B);B.lookahead>=_e;){K=B.strstart,ge=B.lookahead-(_e-1);do B.ins_h=(B.ins_h<<B.hash_shift^B.window[K+_e-1])&B.hash_mask,B.prev[K&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=K,K++;while(--ge);B.strstart=K,B.lookahead=_e-1,Dn(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=_e-1,B.match_available=0,x.next_in=He,x.input=Nt,x.avail_in=Oe,B.wrap=lt,_}r.deflateInit=Se,r.deflateInit2=q,r.deflateReset=Le,r.deflateResetKeep=Ne,r.deflateSetHeader=tt,r.deflate=O,r.deflateEnd=Ie,r.deflateSetDictionary=ft,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){function s(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=s},{}],48:[function(t,i,r){var s=30,a=12;i.exports=function(l,u){var h,d,f,m,b,_,w,v,y,E,k,S,D,P,F,H,z,te,de,ke,Me,ze,ve,xe,he;h=l.state,d=l.next_in,xe=l.input,f=d+(l.avail_in-5),m=l.next_out,he=l.output,b=m-(u-l.avail_out),_=m+(l.avail_out-257),w=h.dmax,v=h.wsize,y=h.whave,E=h.wnext,k=h.window,S=h.hold,D=h.bits,P=h.lencode,F=h.distcode,H=(1<<h.lenbits)-1,z=(1<<h.distbits)-1;e:do{D<15&&(S+=xe[d++]<<D,D+=8,S+=xe[d++]<<D,D+=8),te=P[S&H];t:for(;;){if(de=te>>>24,S>>>=de,D-=de,de=te>>>16&255,de===0)he[m++]=te&65535;else if(de&16){ke=te&65535,de&=15,de&&(D<de&&(S+=xe[d++]<<D,D+=8),ke+=S&(1<<de)-1,S>>>=de,D-=de),D<15&&(S+=xe[d++]<<D,D+=8,S+=xe[d++]<<D,D+=8),te=F[S&z];n:for(;;){if(de=te>>>24,S>>>=de,D-=de,de=te>>>16&255,de&16){if(Me=te&65535,de&=15,D<de&&(S+=xe[d++]<<D,D+=8,D<de&&(S+=xe[d++]<<D,D+=8)),Me+=S&(1<<de)-1,Me>w){l.msg="invalid distance too far back",h.mode=s;break e}if(S>>>=de,D-=de,de=m-b,Me>de){if(de=Me-de,de>y&&h.sane){l.msg="invalid distance too far back",h.mode=s;break e}if(ze=0,ve=k,E===0){if(ze+=v-de,de<ke){ke-=de;do he[m++]=k[ze++];while(--de);ze=m-Me,ve=he}}else if(E<de){if(ze+=v+E-de,de-=E,de<ke){ke-=de;do he[m++]=k[ze++];while(--de);if(ze=0,E<ke){de=E,ke-=de;do he[m++]=k[ze++];while(--de);ze=m-Me,ve=he}}}else if(ze+=E-de,de<ke){ke-=de;do he[m++]=k[ze++];while(--de);ze=m-Me,ve=he}for(;ke>2;)he[m++]=ve[ze++],he[m++]=ve[ze++],he[m++]=ve[ze++],ke-=3;ke&&(he[m++]=ve[ze++],ke>1&&(he[m++]=ve[ze++]))}else{ze=m-Me;do he[m++]=he[ze++],he[m++]=he[ze++],he[m++]=he[ze++],ke-=3;while(ke>2);ke&&(he[m++]=he[ze++],ke>1&&(he[m++]=he[ze++]))}}else if(de&64){l.msg="invalid distance code",h.mode=s;break e}else{te=F[(te&65535)+(S&(1<<de)-1)];continue n}break}}else if(de&64)if(de&32){h.mode=a;break e}else{l.msg="invalid literal/length code",h.mode=s;break e}else{te=P[(te&65535)+(S&(1<<de)-1)];continue t}break}}while(d<f&&m<_);ke=D>>3,d-=ke,D-=ke<<3,S&=(1<<D)-1,l.next_in=d,l.next_out=m,l.avail_in=d<f?5+(f-d):5-(d-f),l.avail_out=m<_?257+(_-m):257-(m-_),h.hold=S,h.bits=D}},{}],49:[function(t,i,r){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),h=0,d=1,f=2,m=4,b=5,_=6,w=0,v=1,y=2,E=-2,k=-3,S=-4,D=-5,P=8,F=1,H=2,z=3,te=4,de=5,ke=6,Me=7,ze=8,ve=9,xe=10,he=11,ie=12,ae=13,me=14,_e=15,pe=16,De=17,it=18,Xe=19,We=20,nt=21,Ve=22,Bt=23,wt=24,pt=25,It=26,ei=27,en=28,Vi=29,Wt=30,Wn=31,Jr=32,ti=852,ln=592,tn=15,yt=tn;function vi(q){return(q>>>24&255)+(q>>>8&65280)+((q&65280)<<8)+((q&255)<<24)}function fr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ai(q){var Se;return!q||!q.state?E:(Se=q.state,q.total_in=q.total_out=Se.total=0,q.msg="",Se.wrap&&(q.adler=Se.wrap&1),Se.mode=F,Se.last=0,Se.havedict=0,Se.dmax=32768,Se.head=null,Se.hold=0,Se.bits=0,Se.lencode=Se.lendyn=new s.Buf32(ti),Se.distcode=Se.distdyn=new s.Buf32(ln),Se.sane=1,Se.back=-1,w)}function Dn(q){var Se;return!q||!q.state?E:(Se=q.state,Se.wsize=0,Se.whave=0,Se.wnext=0,ai(q))}function es(q,Se){var O,Ie;return!q||!q.state||(Ie=q.state,Se<0?(O=0,Se=-Se):(O=(Se>>4)+1,Se<48&&(Se&=15)),Se&&(Se<8||Se>15))?E:(Ie.window!==null&&Ie.wbits!==Se&&(Ie.window=null),Ie.wrap=O,Ie.wbits=Se,Dn(q))}function Ii(q,Se){var O,Ie;return q?(Ie=new fr,q.state=Ie,Ie.window=null,O=es(q,Se),O!==w&&(q.state=null),O):E}function yi(q){return Ii(q,yt)}var Ir=!0,oi,En;function bi(q){if(Ir){var Se;for(oi=new s.Buf32(512),En=new s.Buf32(32),Se=0;Se<144;)q.lens[Se++]=8;for(;Se<256;)q.lens[Se++]=9;for(;Se<280;)q.lens[Se++]=7;for(;Se<288;)q.lens[Se++]=8;for(u(d,q.lens,0,288,oi,0,q.work,{bits:9}),Se=0;Se<32;)q.lens[Se++]=5;u(f,q.lens,0,32,En,0,q.work,{bits:5}),Ir=!1}q.lencode=oi,q.lenbits=9,q.distcode=En,q.distbits=5}function Li(q,Se,O,Ie){var ft,x=q.state;return x.window===null&&(x.wsize=1<<x.wbits,x.wnext=0,x.whave=0,x.window=new s.Buf8(x.wsize)),Ie>=x.wsize?(s.arraySet(x.window,Se,O-x.wsize,x.wsize,0),x.wnext=0,x.whave=x.wsize):(ft=x.wsize-x.wnext,ft>Ie&&(ft=Ie),s.arraySet(x.window,Se,O-Ie,ft,x.wnext),Ie-=ft,Ie?(s.arraySet(x.window,Se,O-Ie,Ie,0),x.wnext=Ie,x.whave=x.wsize):(x.wnext+=ft,x.wnext===x.wsize&&(x.wnext=0),x.whave<x.wsize&&(x.whave+=ft))),0}function M(q,Se){var O,Ie,ft,x,be,Ee,B,K,ge,lt,Oe,He,Nt,Gi,nn=0,Dt,Rn,dn,Pn,pr,Vs,An,Nn,zn=new s.Buf8(4),li,mr,wl=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!q||!q.state||!q.output||!q.input&&q.avail_in!==0)return E;O=q.state,O.mode===ie&&(O.mode=ae),be=q.next_out,ft=q.output,B=q.avail_out,x=q.next_in,Ie=q.input,Ee=q.avail_in,K=O.hold,ge=O.bits,lt=Ee,Oe=B,Nn=w;e:for(;;)switch(O.mode){case F:if(O.wrap===0){O.mode=ae;break}for(;ge<16;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(O.wrap&2&&K===35615){O.check=0,zn[0]=K&255,zn[1]=K>>>8&255,O.check=o(O.check,zn,2,0),K=0,ge=0,O.mode=H;break}if(O.flags=0,O.head&&(O.head.done=!1),!(O.wrap&1)||(((K&255)<<8)+(K>>8))%31){q.msg="incorrect header check",O.mode=Wt;break}if((K&15)!==P){q.msg="unknown compression method",O.mode=Wt;break}if(K>>>=4,ge-=4,An=(K&15)+8,O.wbits===0)O.wbits=An;else if(An>O.wbits){q.msg="invalid window size",O.mode=Wt;break}O.dmax=1<<An,q.adler=O.check=1,O.mode=K&512?xe:ie,K=0,ge=0;break;case H:for(;ge<16;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(O.flags=K,(O.flags&255)!==P){q.msg="unknown compression method",O.mode=Wt;break}if(O.flags&57344){q.msg="unknown header flags set",O.mode=Wt;break}O.head&&(O.head.text=K>>8&1),O.flags&512&&(zn[0]=K&255,zn[1]=K>>>8&255,O.check=o(O.check,zn,2,0)),K=0,ge=0,O.mode=z;case z:for(;ge<32;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}O.head&&(O.head.time=K),O.flags&512&&(zn[0]=K&255,zn[1]=K>>>8&255,zn[2]=K>>>16&255,zn[3]=K>>>24&255,O.check=o(O.check,zn,4,0)),K=0,ge=0,O.mode=te;case te:for(;ge<16;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}O.head&&(O.head.xflags=K&255,O.head.os=K>>8),O.flags&512&&(zn[0]=K&255,zn[1]=K>>>8&255,O.check=o(O.check,zn,2,0)),K=0,ge=0,O.mode=de;case de:if(O.flags&1024){for(;ge<16;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}O.length=K,O.head&&(O.head.extra_len=K),O.flags&512&&(zn[0]=K&255,zn[1]=K>>>8&255,O.check=o(O.check,zn,2,0)),K=0,ge=0}else O.head&&(O.head.extra=null);O.mode=ke;case ke:if(O.flags&1024&&(He=O.length,He>Ee&&(He=Ee),He&&(O.head&&(An=O.head.extra_len-O.length,O.head.extra||(O.head.extra=new Array(O.head.extra_len)),s.arraySet(O.head.extra,Ie,x,He,An)),O.flags&512&&(O.check=o(O.check,Ie,He,x)),Ee-=He,x+=He,O.length-=He),O.length))break e;O.length=0,O.mode=Me;case Me:if(O.flags&2048){if(Ee===0)break e;He=0;do An=Ie[x+He++],O.head&&An&&O.length<65536&&(O.head.name+=String.fromCharCode(An));while(An&&He<Ee);if(O.flags&512&&(O.check=o(O.check,Ie,He,x)),Ee-=He,x+=He,An)break e}else O.head&&(O.head.name=null);O.length=0,O.mode=ze;case ze:if(O.flags&4096){if(Ee===0)break e;He=0;do An=Ie[x+He++],O.head&&An&&O.length<65536&&(O.head.comment+=String.fromCharCode(An));while(An&&He<Ee);if(O.flags&512&&(O.check=o(O.check,Ie,He,x)),Ee-=He,x+=He,An)break e}else O.head&&(O.head.comment=null);O.mode=ve;case ve:if(O.flags&512){for(;ge<16;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(K!==(O.check&65535)){q.msg="header crc mismatch",O.mode=Wt;break}K=0,ge=0}O.head&&(O.head.hcrc=O.flags>>9&1,O.head.done=!0),q.adler=O.check=0,O.mode=ie;break;case xe:for(;ge<32;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}q.adler=O.check=vi(K),K=0,ge=0,O.mode=he;case he:if(O.havedict===0)return q.next_out=be,q.avail_out=B,q.next_in=x,q.avail_in=Ee,O.hold=K,O.bits=ge,y;q.adler=O.check=1,O.mode=ie;case ie:if(Se===b||Se===_)break e;case ae:if(O.last){K>>>=ge&7,ge-=ge&7,O.mode=ei;break}for(;ge<3;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}switch(O.last=K&1,K>>>=1,ge-=1,K&3){case 0:O.mode=me;break;case 1:if(bi(O),O.mode=We,Se===_){K>>>=2,ge-=2;break e}break;case 2:O.mode=De;break;case 3:q.msg="invalid block type",O.mode=Wt}K>>>=2,ge-=2;break;case me:for(K>>>=ge&7,ge-=ge&7;ge<32;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if((K&65535)!==(K>>>16^65535)){q.msg="invalid stored block lengths",O.mode=Wt;break}if(O.length=K&65535,K=0,ge=0,O.mode=_e,Se===_)break e;case _e:O.mode=pe;case pe:if(He=O.length,He){if(He>Ee&&(He=Ee),He>B&&(He=B),He===0)break e;s.arraySet(ft,Ie,x,He,be),Ee-=He,x+=He,B-=He,be+=He,O.length-=He;break}O.mode=ie;break;case De:for(;ge<14;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(O.nlen=(K&31)+257,K>>>=5,ge-=5,O.ndist=(K&31)+1,K>>>=5,ge-=5,O.ncode=(K&15)+4,K>>>=4,ge-=4,O.nlen>286||O.ndist>30){q.msg="too many length or distance symbols",O.mode=Wt;break}O.have=0,O.mode=it;case it:for(;O.have<O.ncode;){for(;ge<3;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}O.lens[wl[O.have++]]=K&7,K>>>=3,ge-=3}for(;O.have<19;)O.lens[wl[O.have++]]=0;if(O.lencode=O.lendyn,O.lenbits=7,li={bits:O.lenbits},Nn=u(h,O.lens,0,19,O.lencode,0,O.work,li),O.lenbits=li.bits,Nn){q.msg="invalid code lengths set",O.mode=Wt;break}O.have=0,O.mode=Xe;case Xe:for(;O.have<O.nlen+O.ndist;){for(;nn=O.lencode[K&(1<<O.lenbits)-1],Dt=nn>>>24,Rn=nn>>>16&255,dn=nn&65535,!(Dt<=ge);){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(dn<16)K>>>=Dt,ge-=Dt,O.lens[O.have++]=dn;else{if(dn===16){for(mr=Dt+2;ge<mr;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(K>>>=Dt,ge-=Dt,O.have===0){q.msg="invalid bit length repeat",O.mode=Wt;break}An=O.lens[O.have-1],He=3+(K&3),K>>>=2,ge-=2}else if(dn===17){for(mr=Dt+3;ge<mr;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}K>>>=Dt,ge-=Dt,An=0,He=3+(K&7),K>>>=3,ge-=3}else{for(mr=Dt+7;ge<mr;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}K>>>=Dt,ge-=Dt,An=0,He=11+(K&127),K>>>=7,ge-=7}if(O.have+He>O.nlen+O.ndist){q.msg="invalid bit length repeat",O.mode=Wt;break}for(;He--;)O.lens[O.have++]=An}}if(O.mode===Wt)break;if(O.lens[256]===0){q.msg="invalid code -- missing end-of-block",O.mode=Wt;break}if(O.lenbits=9,li={bits:O.lenbits},Nn=u(d,O.lens,0,O.nlen,O.lencode,0,O.work,li),O.lenbits=li.bits,Nn){q.msg="invalid literal/lengths set",O.mode=Wt;break}if(O.distbits=6,O.distcode=O.distdyn,li={bits:O.distbits},Nn=u(f,O.lens,O.nlen,O.ndist,O.distcode,0,O.work,li),O.distbits=li.bits,Nn){q.msg="invalid distances set",O.mode=Wt;break}if(O.mode=We,Se===_)break e;case We:O.mode=nt;case nt:if(Ee>=6&&B>=258){q.next_out=be,q.avail_out=B,q.next_in=x,q.avail_in=Ee,O.hold=K,O.bits=ge,l(q,Oe),be=q.next_out,ft=q.output,B=q.avail_out,x=q.next_in,Ie=q.input,Ee=q.avail_in,K=O.hold,ge=O.bits,O.mode===ie&&(O.back=-1);break}for(O.back=0;nn=O.lencode[K&(1<<O.lenbits)-1],Dt=nn>>>24,Rn=nn>>>16&255,dn=nn&65535,!(Dt<=ge);){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(Rn&&!(Rn&240)){for(Pn=Dt,pr=Rn,Vs=dn;nn=O.lencode[Vs+((K&(1<<Pn+pr)-1)>>Pn)],Dt=nn>>>24,Rn=nn>>>16&255,dn=nn&65535,!(Pn+Dt<=ge);){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}K>>>=Pn,ge-=Pn,O.back+=Pn}if(K>>>=Dt,ge-=Dt,O.back+=Dt,O.length=dn,Rn===0){O.mode=It;break}if(Rn&32){O.back=-1,O.mode=ie;break}if(Rn&64){q.msg="invalid literal/length code",O.mode=Wt;break}O.extra=Rn&15,O.mode=Ve;case Ve:if(O.extra){for(mr=O.extra;ge<mr;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}O.length+=K&(1<<O.extra)-1,K>>>=O.extra,ge-=O.extra,O.back+=O.extra}O.was=O.length,O.mode=Bt;case Bt:for(;nn=O.distcode[K&(1<<O.distbits)-1],Dt=nn>>>24,Rn=nn>>>16&255,dn=nn&65535,!(Dt<=ge);){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(!(Rn&240)){for(Pn=Dt,pr=Rn,Vs=dn;nn=O.distcode[Vs+((K&(1<<Pn+pr)-1)>>Pn)],Dt=nn>>>24,Rn=nn>>>16&255,dn=nn&65535,!(Pn+Dt<=ge);){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}K>>>=Pn,ge-=Pn,O.back+=Pn}if(K>>>=Dt,ge-=Dt,O.back+=Dt,Rn&64){q.msg="invalid distance code",O.mode=Wt;break}O.offset=dn,O.extra=Rn&15,O.mode=wt;case wt:if(O.extra){for(mr=O.extra;ge<mr;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}O.offset+=K&(1<<O.extra)-1,K>>>=O.extra,ge-=O.extra,O.back+=O.extra}if(O.offset>O.dmax){q.msg="invalid distance too far back",O.mode=Wt;break}O.mode=pt;case pt:if(B===0)break e;if(He=Oe-B,O.offset>He){if(He=O.offset-He,He>O.whave&&O.sane){q.msg="invalid distance too far back",O.mode=Wt;break}He>O.wnext?(He-=O.wnext,Nt=O.wsize-He):Nt=O.wnext-He,He>O.length&&(He=O.length),Gi=O.window}else Gi=ft,Nt=be-O.offset,He=O.length;He>B&&(He=B),B-=He,O.length-=He;do ft[be++]=Gi[Nt++];while(--He);O.length===0&&(O.mode=nt);break;case It:if(B===0)break e;ft[be++]=O.length,B--,O.mode=nt;break;case ei:if(O.wrap){for(;ge<32;){if(Ee===0)break e;Ee--,K|=Ie[x++]<<ge,ge+=8}if(Oe-=B,q.total_out+=Oe,O.total+=Oe,Oe&&(q.adler=O.check=O.flags?o(O.check,ft,Oe,be-Oe):a(O.check,ft,Oe,be-Oe)),Oe=B,(O.flags?K:vi(K))!==O.check){q.msg="incorrect data check",O.mode=Wt;break}K=0,ge=0}O.mode=en;case en:if(O.wrap&&O.flags){for(;ge<32;){if(Ee===0)break e;Ee--,K+=Ie[x++]<<ge,ge+=8}if(K!==(O.total&4294967295)){q.msg="incorrect length check",O.mode=Wt;break}K=0,ge=0}O.mode=Vi;case Vi:Nn=v;break e;case Wt:Nn=k;break e;case Wn:return S;case Jr:default:return E}return q.next_out=be,q.avail_out=B,q.next_in=x,q.avail_in=Ee,O.hold=K,O.bits=ge,(O.wsize||Oe!==q.avail_out&&O.mode<Wt&&(O.mode<ei||Se!==m))&&Li(q,q.output,q.next_out,Oe-q.avail_out),lt-=q.avail_in,Oe-=q.avail_out,q.total_in+=lt,q.total_out+=Oe,O.total+=Oe,O.wrap&&Oe&&(q.adler=O.check=O.flags?o(O.check,ft,Oe,q.next_out-Oe):a(O.check,ft,Oe,q.next_out-Oe)),q.data_type=O.bits+(O.last?64:0)+(O.mode===ie?128:0)+(O.mode===We||O.mode===_e?256:0),(lt===0&&Oe===0||Se===m)&&Nn===w&&(Nn=D),Nn}function Ne(q){if(!q||!q.state)return E;var Se=q.state;return Se.window&&(Se.window=null),q.state=null,w}function Le(q,Se){var O;return!q||!q.state||(O=q.state,!(O.wrap&2))?E:(O.head=Se,Se.done=!1,w)}function tt(q,Se){var O=Se.length,Ie,ft,x;return!q||!q.state||(Ie=q.state,Ie.wrap!==0&&Ie.mode!==he)?E:Ie.mode===he&&(ft=1,ft=a(ft,Se,O,0),ft!==Ie.check)?k:(x=Li(q,Se,O,O),x?(Ie.mode=Wn,S):(Ie.havedict=1,w))}r.inflateReset=Dn,r.inflateReset2=es,r.inflateResetKeep=ai,r.inflateInit=yi,r.inflateInit2=Ii,r.inflate=M,r.inflateEnd=Ne,r.inflateGetHeader=Le,r.inflateSetDictionary=tt,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var s=t("../utils/common"),a=15,o=852,l=592,u=0,h=1,d=2,f=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],m=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],b=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],_=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(v,y,E,k,S,D,P,F){var H=F.bits,z=0,te=0,de=0,ke=0,Me=0,ze=0,ve=0,xe=0,he=0,ie=0,ae,me,_e,pe,De,it=null,Xe=0,We,nt=new s.Buf16(a+1),Ve=new s.Buf16(a+1),Bt=null,wt=0,pt,It,ei;for(z=0;z<=a;z++)nt[z]=0;for(te=0;te<k;te++)nt[y[E+te]]++;for(Me=H,ke=a;ke>=1&&nt[ke]===0;ke--);if(Me>ke&&(Me=ke),ke===0)return S[D++]=1<<24|64<<16|0,S[D++]=1<<24|64<<16|0,F.bits=1,0;for(de=1;de<ke&&nt[de]===0;de++);for(Me<de&&(Me=de),xe=1,z=1;z<=a;z++)if(xe<<=1,xe-=nt[z],xe<0)return-1;if(xe>0&&(v===u||ke!==1))return-1;for(Ve[1]=0,z=1;z<a;z++)Ve[z+1]=Ve[z]+nt[z];for(te=0;te<k;te++)y[E+te]!==0&&(P[Ve[y[E+te]]++]=te);if(v===u?(it=Bt=P,We=19):v===h?(it=f,Xe-=257,Bt=m,wt-=257,We=256):(it=b,Bt=_,We=-1),ie=0,te=0,z=de,De=D,ze=Me,ve=0,_e=-1,he=1<<Me,pe=he-1,v===h&&he>o||v===d&&he>l)return 1;for(;;){pt=z-ve,P[te]<We?(It=0,ei=P[te]):P[te]>We?(It=Bt[wt+P[te]],ei=it[Xe+P[te]]):(It=96,ei=0),ae=1<<z-ve,me=1<<ze,de=me;do me-=ae,S[De+(ie>>ve)+me]=pt<<24|It<<16|ei|0;while(me!==0);for(ae=1<<z-1;ie&ae;)ae>>=1;if(ae!==0?(ie&=ae-1,ie+=ae):ie=0,te++,--nt[z]===0){if(z===ke)break;z=y[E+P[te]]}if(z>Me&&(ie&pe)!==_e){for(ve===0&&(ve=Me),De+=de,ze=z-ve,xe=1<<ze;ze+ve<ke&&(xe-=nt[ze+ve],!(xe<=0));)ze++,xe<<=1;if(he+=1<<ze,v===h&&he>o||v===d&&he>l)return 1;_e=ie&pe,S[_e]=Me<<24|ze<<16|De-D|0}}return ie!==0&&(S[De+ie]=z-ve<<24|64<<16|0),F.bits=Me,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var s=t("../utils/common"),a=4,o=0,l=1,u=2;function h(M){for(var Ne=M.length;--Ne>=0;)M[Ne]=0}var d=0,f=1,m=2,b=3,_=258,w=29,v=256,y=v+1+w,E=30,k=19,S=2*y+1,D=15,P=16,F=7,H=256,z=16,te=17,de=18,ke=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Me=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=512,he=new Array((y+2)*2);h(he);var ie=new Array(E*2);h(ie);var ae=new Array(xe);h(ae);var me=new Array(_-b+1);h(me);var _e=new Array(w);h(_e);var pe=new Array(E);h(pe);function De(M,Ne,Le,tt,q){this.static_tree=M,this.extra_bits=Ne,this.extra_base=Le,this.elems=tt,this.max_length=q,this.has_stree=M&&M.length}var it,Xe,We;function nt(M,Ne){this.dyn_tree=M,this.max_code=0,this.stat_desc=Ne}function Ve(M){return M<256?ae[M]:ae[256+(M>>>7)]}function Bt(M,Ne){M.pending_buf[M.pending++]=Ne&255,M.pending_buf[M.pending++]=Ne>>>8&255}function wt(M,Ne,Le){M.bi_valid>P-Le?(M.bi_buf|=Ne<<M.bi_valid&65535,Bt(M,M.bi_buf),M.bi_buf=Ne>>P-M.bi_valid,M.bi_valid+=Le-P):(M.bi_buf|=Ne<<M.bi_valid&65535,M.bi_valid+=Le)}function pt(M,Ne,Le){wt(M,Le[Ne*2],Le[Ne*2+1])}function It(M,Ne){var Le=0;do Le|=M&1,M>>>=1,Le<<=1;while(--Ne>0);return Le>>>1}function ei(M){M.bi_valid===16?(Bt(M,M.bi_buf),M.bi_buf=0,M.bi_valid=0):M.bi_valid>=8&&(M.pending_buf[M.pending++]=M.bi_buf&255,M.bi_buf>>=8,M.bi_valid-=8)}function en(M,Ne){var Le=Ne.dyn_tree,tt=Ne.max_code,q=Ne.stat_desc.static_tree,Se=Ne.stat_desc.has_stree,O=Ne.stat_desc.extra_bits,Ie=Ne.stat_desc.extra_base,ft=Ne.stat_desc.max_length,x,be,Ee,B,K,ge,lt=0;for(B=0;B<=D;B++)M.bl_count[B]=0;for(Le[M.heap[M.heap_max]*2+1]=0,x=M.heap_max+1;x<S;x++)be=M.heap[x],B=Le[Le[be*2+1]*2+1]+1,B>ft&&(B=ft,lt++),Le[be*2+1]=B,!(be>tt)&&(M.bl_count[B]++,K=0,be>=Ie&&(K=O[be-Ie]),ge=Le[be*2],M.opt_len+=ge*(B+K),Se&&(M.static_len+=ge*(q[be*2+1]+K)));if(lt!==0){do{for(B=ft-1;M.bl_count[B]===0;)B--;M.bl_count[B]--,M.bl_count[B+1]+=2,M.bl_count[ft]--,lt-=2}while(lt>0);for(B=ft;B!==0;B--)for(be=M.bl_count[B];be!==0;)Ee=M.heap[--x],!(Ee>tt)&&(Le[Ee*2+1]!==B&&(M.opt_len+=(B-Le[Ee*2+1])*Le[Ee*2],Le[Ee*2+1]=B),be--)}}function Vi(M,Ne,Le){var tt=new Array(D+1),q=0,Se,O;for(Se=1;Se<=D;Se++)tt[Se]=q=q+Le[Se-1]<<1;for(O=0;O<=Ne;O++){var Ie=M[O*2+1];Ie!==0&&(M[O*2]=It(tt[Ie]++,Ie))}}function Wt(){var M,Ne,Le,tt,q,Se=new Array(D+1);for(Le=0,tt=0;tt<w-1;tt++)for(_e[tt]=Le,M=0;M<1<<ke[tt];M++)me[Le++]=tt;for(me[Le-1]=tt,q=0,tt=0;tt<16;tt++)for(pe[tt]=q,M=0;M<1<<Me[tt];M++)ae[q++]=tt;for(q>>=7;tt<E;tt++)for(pe[tt]=q<<7,M=0;M<1<<Me[tt]-7;M++)ae[256+q++]=tt;for(Ne=0;Ne<=D;Ne++)Se[Ne]=0;for(M=0;M<=143;)he[M*2+1]=8,M++,Se[8]++;for(;M<=255;)he[M*2+1]=9,M++,Se[9]++;for(;M<=279;)he[M*2+1]=7,M++,Se[7]++;for(;M<=287;)he[M*2+1]=8,M++,Se[8]++;for(Vi(he,y+1,Se),M=0;M<E;M++)ie[M*2+1]=5,ie[M*2]=It(M,5);it=new De(he,ke,v+1,y,D),Xe=new De(ie,Me,0,E,D),We=new De(new Array(0),ze,0,k,F)}function Wn(M){var Ne;for(Ne=0;Ne<y;Ne++)M.dyn_ltree[Ne*2]=0;for(Ne=0;Ne<E;Ne++)M.dyn_dtree[Ne*2]=0;for(Ne=0;Ne<k;Ne++)M.bl_tree[Ne*2]=0;M.dyn_ltree[H*2]=1,M.opt_len=M.static_len=0,M.last_lit=M.matches=0}function Jr(M){M.bi_valid>8?Bt(M,M.bi_buf):M.bi_valid>0&&(M.pending_buf[M.pending++]=M.bi_buf),M.bi_buf=0,M.bi_valid=0}function ti(M,Ne,Le,tt){Jr(M),Bt(M,Le),Bt(M,~Le),s.arraySet(M.pending_buf,M.window,Ne,Le,M.pending),M.pending+=Le}function ln(M,Ne,Le,tt){var q=Ne*2,Se=Le*2;return M[q]<M[Se]||M[q]===M[Se]&&tt[Ne]<=tt[Le]}function tn(M,Ne,Le){for(var tt=M.heap[Le],q=Le<<1;q<=M.heap_len&&(q<M.heap_len&&ln(Ne,M.heap[q+1],M.heap[q],M.depth)&&q++,!ln(Ne,tt,M.heap[q],M.depth));)M.heap[Le]=M.heap[q],Le=q,q<<=1;M.heap[Le]=tt}function yt(M,Ne,Le){var tt,q,Se=0,O,Ie;if(M.last_lit!==0)do tt=M.pending_buf[M.d_buf+Se*2]<<8|M.pending_buf[M.d_buf+Se*2+1],q=M.pending_buf[M.l_buf+Se],Se++,tt===0?pt(M,q,Ne):(O=me[q],pt(M,O+v+1,Ne),Ie=ke[O],Ie!==0&&(q-=_e[O],wt(M,q,Ie)),tt--,O=Ve(tt),pt(M,O,Le),Ie=Me[O],Ie!==0&&(tt-=pe[O],wt(M,tt,Ie)));while(Se<M.last_lit);pt(M,H,Ne)}function vi(M,Ne){var Le=Ne.dyn_tree,tt=Ne.stat_desc.static_tree,q=Ne.stat_desc.has_stree,Se=Ne.stat_desc.elems,O,Ie,ft=-1,x;for(M.heap_len=0,M.heap_max=S,O=0;O<Se;O++)Le[O*2]!==0?(M.heap[++M.heap_len]=ft=O,M.depth[O]=0):Le[O*2+1]=0;for(;M.heap_len<2;)x=M.heap[++M.heap_len]=ft<2?++ft:0,Le[x*2]=1,M.depth[x]=0,M.opt_len--,q&&(M.static_len-=tt[x*2+1]);for(Ne.max_code=ft,O=M.heap_len>>1;O>=1;O--)tn(M,Le,O);x=Se;do O=M.heap[1],M.heap[1]=M.heap[M.heap_len--],tn(M,Le,1),Ie=M.heap[1],M.heap[--M.heap_max]=O,M.heap[--M.heap_max]=Ie,Le[x*2]=Le[O*2]+Le[Ie*2],M.depth[x]=(M.depth[O]>=M.depth[Ie]?M.depth[O]:M.depth[Ie])+1,Le[O*2+1]=Le[Ie*2+1]=x,M.heap[1]=x++,tn(M,Le,1);while(M.heap_len>=2);M.heap[--M.heap_max]=M.heap[1],en(M,Ne),Vi(Le,ft,M.bl_count)}function fr(M,Ne,Le){var tt,q=-1,Se,O=Ne[0*2+1],Ie=0,ft=7,x=4;for(O===0&&(ft=138,x=3),Ne[(Le+1)*2+1]=65535,tt=0;tt<=Le;tt++)Se=O,O=Ne[(tt+1)*2+1],!(++Ie<ft&&Se===O)&&(Ie<x?M.bl_tree[Se*2]+=Ie:Se!==0?(Se!==q&&M.bl_tree[Se*2]++,M.bl_tree[z*2]++):Ie<=10?M.bl_tree[te*2]++:M.bl_tree[de*2]++,Ie=0,q=Se,O===0?(ft=138,x=3):Se===O?(ft=6,x=3):(ft=7,x=4))}function ai(M,Ne,Le){var tt,q=-1,Se,O=Ne[0*2+1],Ie=0,ft=7,x=4;for(O===0&&(ft=138,x=3),tt=0;tt<=Le;tt++)if(Se=O,O=Ne[(tt+1)*2+1],!(++Ie<ft&&Se===O)){if(Ie<x)do pt(M,Se,M.bl_tree);while(--Ie!==0);else Se!==0?(Se!==q&&(pt(M,Se,M.bl_tree),Ie--),pt(M,z,M.bl_tree),wt(M,Ie-3,2)):Ie<=10?(pt(M,te,M.bl_tree),wt(M,Ie-3,3)):(pt(M,de,M.bl_tree),wt(M,Ie-11,7));Ie=0,q=Se,O===0?(ft=138,x=3):Se===O?(ft=6,x=3):(ft=7,x=4)}}function Dn(M){var Ne;for(fr(M,M.dyn_ltree,M.l_desc.max_code),fr(M,M.dyn_dtree,M.d_desc.max_code),vi(M,M.bl_desc),Ne=k-1;Ne>=3&&M.bl_tree[ve[Ne]*2+1]===0;Ne--);return M.opt_len+=3*(Ne+1)+5+5+4,Ne}function es(M,Ne,Le,tt){var q;for(wt(M,Ne-257,5),wt(M,Le-1,5),wt(M,tt-4,4),q=0;q<tt;q++)wt(M,M.bl_tree[ve[q]*2+1],3);ai(M,M.dyn_ltree,Ne-1),ai(M,M.dyn_dtree,Le-1)}function Ii(M){var Ne=4093624447,Le;for(Le=0;Le<=31;Le++,Ne>>>=1)if(Ne&1&&M.dyn_ltree[Le*2]!==0)return o;if(M.dyn_ltree[9*2]!==0||M.dyn_ltree[10*2]!==0||M.dyn_ltree[13*2]!==0)return l;for(Le=32;Le<v;Le++)if(M.dyn_ltree[Le*2]!==0)return l;return o}var yi=!1;function Ir(M){yi||(Wt(),yi=!0),M.l_desc=new nt(M.dyn_ltree,it),M.d_desc=new nt(M.dyn_dtree,Xe),M.bl_desc=new nt(M.bl_tree,We),M.bi_buf=0,M.bi_valid=0,Wn(M)}function oi(M,Ne,Le,tt){wt(M,(d<<1)+(tt?1:0),3),ti(M,Ne,Le)}function En(M){wt(M,f<<1,3),pt(M,H,he),ei(M)}function bi(M,Ne,Le,tt){var q,Se,O=0;M.level>0?(M.strm.data_type===u&&(M.strm.data_type=Ii(M)),vi(M,M.l_desc),vi(M,M.d_desc),O=Dn(M),q=M.opt_len+3+7>>>3,Se=M.static_len+3+7>>>3,Se<=q&&(q=Se)):q=Se=Le+5,Le+4<=q&&Ne!==-1?oi(M,Ne,Le,tt):M.strategy===a||Se===q?(wt(M,(f<<1)+(tt?1:0),3),yt(M,he,ie)):(wt(M,(m<<1)+(tt?1:0),3),es(M,M.l_desc.max_code+1,M.d_desc.max_code+1,O+1),yt(M,M.dyn_ltree,M.dyn_dtree)),Wn(M),tt&&Jr(M)}function Li(M,Ne,Le){return M.pending_buf[M.d_buf+M.last_lit*2]=Ne>>>8&255,M.pending_buf[M.d_buf+M.last_lit*2+1]=Ne&255,M.pending_buf[M.l_buf+M.last_lit]=Le&255,M.last_lit++,Ne===0?M.dyn_ltree[Le*2]++:(M.matches++,Ne--,M.dyn_ltree[(me[Le]+v+1)*2]++,M.dyn_dtree[Ve(Ne)*2]++),M.last_lit===M.lit_bufsize-1}r._tr_init=Ir,r._tr_stored_block=oi,r._tr_flush_block=bi,r._tr_tally=Li,r._tr_align=En},{"../utils/common":41}],53:[function(t,i,r){function s(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=s},{}],54:[function(t,i,r){(function(s){(function(a,o){if(a.setImmediate)return;var l=1,u={},h=!1,d=a.document,f;function m(F){typeof F!="function"&&(F=new Function(""+F));for(var H=new Array(arguments.length-1),z=0;z<H.length;z++)H[z]=arguments[z+1];var te={callback:F,args:H};return u[l]=te,f(l),l++}function b(F){delete u[F]}function _(F){var H=F.callback,z=F.args;switch(z.length){case 0:H();break;case 1:H(z[0]);break;case 2:H(z[0],z[1]);break;case 3:H(z[0],z[1],z[2]);break;default:H.apply(o,z);break}}function w(F){if(h)setTimeout(w,0,F);else{var H=u[F];if(H){h=!0;try{_(H)}finally{b(F),h=!1}}}}function v(){f=function(F){process.nextTick(function(){w(F)})}}function y(){if(a.postMessage&&!a.importScripts){var F=!0,H=a.onmessage;return a.onmessage=function(){F=!1},a.postMessage("","*"),a.onmessage=H,F}}function E(){var F="setImmediate$"+Math.random()+"$",H=function(z){z.source===a&&typeof z.data=="string"&&z.data.indexOf(F)===0&&w(+z.data.slice(F.length))};a.addEventListener?a.addEventListener("message",H,!1):a.attachEvent("onmessage",H),f=function(z){a.postMessage(F+z,"*")}}function k(){var F=new MessageChannel;F.port1.onmessage=function(H){var z=H.data;w(z)},f=function(H){F.port2.postMessage(H)}}function S(){var F=d.documentElement;f=function(H){var z=d.createElement("script");z.onreadystatechange=function(){w(H),z.onreadystatechange=null,F.removeChild(z),z=null},F.appendChild(z)}}function D(){f=function(F){setTimeout(w,0,F)}}var P=Object.getPrototypeOf&&Object.getPrototypeOf(a);P=P&&P.setTimeout?P:a,{}.toString.call(a.process)==="[object process]"?v():y()?E():a.MessageChannel?k():d&&"onreadystatechange"in d.createElement("script")?S():D(),P.setImmediate=m,P.clearImmediate=b})(typeof self>"u"?typeof s>"u"?this:s:self)}).call(this,typeof Cr<"u"?Cr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(FP);var sj=FP.exports;const aj=po(sj);class oj{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new aj}catch{throw new Error("JSZip lib not loaded")}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return zm(e,"binary").then(function(i){return this.zip.loadAsync(i,{base64:t})}.bind(this))}request(e,t){var i=new Ht,r,s=new ml(e);return t||(t=s.extension),t=="blob"?r=this.getBlob(e):r=this.getText(e),r?r.then(function(a){let o=this.handleResponse(a,t);i.resolve(o)}.bind(this)):i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise}handleResponse(e,t){var i;return t=="json"?i=JSON.parse(e):jm(t)?i=ho(e,"text/xml"):t=="xhtml"?i=ho(e,"application/xhtml+xml"):t=="html"||t=="htm"?i=ho(e,"text/html"):i=e,i}getBlob(e,t){var i=window.decodeURIComponent(e.substr(1)),r=this.zip.file(i);if(r)return t=t||xd.lookup(r.name),r.async("uint8array").then(function(s){return new Blob([s],{type:t})})}getText(e,t){var i=window.decodeURIComponent(e.substr(1)),r=this.zip.file(i);if(r)return r.async("string").then(function(s){return s})}getBase64(e,t){var i=window.decodeURIComponent(e.substr(1)),r=this.zip.file(i);if(r)return t=t||xd.lookup(r.name),r.async("base64").then(function(s){return"data:"+t+";base64,"+s})}createUrl(e,t){var i=new Ht,r=window.URL||window.webkitURL||window.mozURL,s,a,o=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,i.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){s=r.createObjectURL(l),this.urlCache[e]=s,i.resolve(s)}.bind(this))),a||i.reject({message:"File not found in the epub: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}}var BP={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,r,s){function a(u,h){if(!r[u]){if(!i[u]){var d=typeof nl=="function"&&nl;if(!h&&d)return d(u,!0);if(o)return o(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var m=r[u]={exports:{}};i[u][0].call(m.exports,function(b){var _=i[u][1][b];return a(_||b)},m,m.exports,t,i,r,s)}return r[u].exports}for(var o=typeof nl=="function"&&nl,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(t,i,r){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,o;if(a){var l=0,u=new a(b),h=s.document.createTextNode("");u.observe(h,{characterData:!0}),o=function(){h.data=l=++l%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var d=new s.MessageChannel;d.port1.onmessage=b,o=function(){d.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?o=function(){var w=s.document.createElement("script");w.onreadystatechange=function(){b(),w.onreadystatechange=null,w.parentNode.removeChild(w),w=null},s.document.documentElement.appendChild(w)}:o=function(){setTimeout(b,0)};var f,m=[];function b(){f=!0;for(var w,v,y=m.length;y;){for(v=m,m=[],w=-1;++w<y;)v[w]();y=m.length}f=!1}i.exports=_;function _(w){m.push(w)===1&&!f&&o()}}).call(this,typeof Cr<"u"?Cr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(t,i,r){var s=t(1);function a(){}var o={},l=["REJECTED"],u=["FULFILLED"],h=["PENDING"];i.exports=d;function d(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,S!==a&&_(this,S)}d.prototype.catch=function(S){return this.then(null,S)},d.prototype.then=function(S,D){if(typeof S!="function"&&this.state===u||typeof D!="function"&&this.state===l)return this;var P=new this.constructor(a);if(this.state!==h){var F=this.state===u?S:D;m(P,F,this.outcome)}else this.queue.push(new f(P,S,D));return P};function f(S,D,P){this.promise=S,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof P=="function"&&(this.onRejected=P,this.callRejected=this.otherCallRejected)}f.prototype.callFulfilled=function(S){o.resolve(this.promise,S)},f.prototype.otherCallFulfilled=function(S){m(this.promise,this.onFulfilled,S)},f.prototype.callRejected=function(S){o.reject(this.promise,S)},f.prototype.otherCallRejected=function(S){m(this.promise,this.onRejected,S)};function m(S,D,P){s(function(){var F;try{F=D(P)}catch(H){return o.reject(S,H)}F===S?o.reject(S,new TypeError("Cannot resolve promise with itself")):o.resolve(S,F)})}o.resolve=function(S,D){var P=w(b,D);if(P.status==="error")return o.reject(S,P.value);var F=P.value;if(F)_(S,F);else{S.state=u,S.outcome=D;for(var H=-1,z=S.queue.length;++H<z;)S.queue[H].callFulfilled(D)}return S},o.reject=function(S,D){S.state=l,S.outcome=D;for(var P=-1,F=S.queue.length;++P<F;)S.queue[P].callRejected(D);return S};function b(S){var D=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof D=="function")return function(){D.apply(S,arguments)}}function _(S,D){var P=!1;function F(de){P||(P=!0,o.reject(S,de))}function H(de){P||(P=!0,o.resolve(S,de))}function z(){D(H,F)}var te=w(z);te.status==="error"&&F(te.value)}function w(S,D){var P={};try{P.value=S(D),P.status="success"}catch(F){P.status="error",P.value=F}return P}d.resolve=v;function v(S){return S instanceof this?S:o.resolve(new this(a),S)}d.reject=y;function y(S){var D=new this(a);return o.reject(D,S)}d.all=E;function E(S){var D=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=S.length,F=!1;if(!P)return this.resolve([]);for(var H=new Array(P),z=0,te=-1,de=new this(a);++te<P;)ke(S[te],te);return de;function ke(Me,ze){D.resolve(Me).then(ve,function(xe){F||(F=!0,o.reject(de,xe))});function ve(xe){H[ze]=xe,++z===P&&!F&&(F=!0,o.resolve(de,H))}}}d.race=k;function k(S){var D=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var P=S.length,F=!1;if(!P)return this.resolve([]);for(var H=-1,z=new this(a);++H<P;)te(S[H]);return z;function te(de){D.resolve(de).then(function(ke){F||(F=!0,o.resolve(z,ke))},function(ke){F||(F=!0,o.reject(z,ke))})}}},{1:1}],3:[function(t,i,r){(function(s){typeof s.Promise!="function"&&(s.Promise=t(2))}).call(this,typeof Cr<"u"?Cr:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(t,i,r){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j};function a(j,X){if(!(j instanceof X))throw new TypeError("Cannot call a class as a function")}function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var l=o();function u(){try{if(!l||!l.open)return!1;var j=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),X=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!j||X)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function h(j,X){j=j||[],X=X||{};try{return new Blob(j,X)}catch(ee){if(ee.name!=="TypeError")throw ee;for(var $=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,ne=new $,le=0;le<j.length;le+=1)ne.append(j[le]);return ne.getBlob(X.type)}}typeof Promise>"u"&&t(3);var d=Promise;function f(j,X){X&&j.then(function($){X(null,$)},function($){X($)})}function m(j,X,$){typeof X=="function"&&j.then(X),typeof $=="function"&&j.catch($)}function b(j){return typeof j!="string"&&(console.warn(j+" used as a key, but it is not a string."),j=String(j)),j}function _(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var w="local-forage-detect-blob-support",v=void 0,y={},E=Object.prototype.toString,k="readonly",S="readwrite";function D(j){for(var X=j.length,$=new ArrayBuffer(X),ne=new Uint8Array($),le=0;le<X;le++)ne[le]=j.charCodeAt(le);return $}function P(j){return new d(function(X){var $=j.transaction(w,S),ne=h([""]);$.objectStore(w).put(ne,"key"),$.onabort=function(le){le.preventDefault(),le.stopPropagation(),X(!1)},$.oncomplete=function(){var le=navigator.userAgent.match(/Chrome\/(\d+)/),ee=navigator.userAgent.match(/Edge\//);X(ee||!le||parseInt(le[1],10)>=43)}}).catch(function(){return!1})}function F(j){return typeof v=="boolean"?d.resolve(v):P(j).then(function(X){return v=X,v})}function H(j){var X=y[j.name],$={};$.promise=new d(function(ne,le){$.resolve=ne,$.reject=le}),X.deferredOperations.push($),X.dbReady?X.dbReady=X.dbReady.then(function(){return $.promise}):X.dbReady=$.promise}function z(j){var X=y[j.name],$=X.deferredOperations.pop();if($)return $.resolve(),$.promise}function te(j,X){var $=y[j.name],ne=$.deferredOperations.pop();if(ne)return ne.reject(X),ne.promise}function de(j,X){return new d(function($,ne){if(y[j.name]=y[j.name]||_e(),j.db)if(X)H(j),j.db.close();else return $(j.db);var le=[j.name];X&&le.push(j.version);var ee=l.open.apply(l,le);X&&(ee.onupgradeneeded=function(Re){var Te=ee.result;try{Te.createObjectStore(j.storeName),Re.oldVersion<=1&&Te.createObjectStore(w)}catch(Fe){if(Fe.name==="ConstraintError")console.warn('The database "'+j.name+'" has been upgraded from version '+Re.oldVersion+" to version "+Re.newVersion+', but the storage "'+j.storeName+'" already exists.');else throw Fe}}),ee.onerror=function(Re){Re.preventDefault(),ne(ee.error)},ee.onsuccess=function(){var Re=ee.result;Re.onversionchange=function(Te){Te.target.close()},$(Re),z(j)}})}function ke(j){return de(j,!1)}function Me(j){return de(j,!0)}function ze(j,X){if(!j.db)return!0;var $=!j.db.objectStoreNames.contains(j.storeName),ne=j.version<j.db.version,le=j.version>j.db.version;if(ne&&(j.version!==X&&console.warn('The database "'+j.name+`" can't be downgraded from version `+j.db.version+" to version "+j.version+"."),j.version=j.db.version),le||$){if($){var ee=j.db.version+1;ee>j.version&&(j.version=ee)}return!0}return!1}function ve(j){return new d(function(X,$){var ne=new FileReader;ne.onerror=$,ne.onloadend=function(le){var ee=btoa(le.target.result||"");X({__local_forage_encoded_blob:!0,data:ee,type:j.type})},ne.readAsBinaryString(j)})}function xe(j){var X=D(atob(j.data));return h([X],{type:j.type})}function he(j){return j&&j.__local_forage_encoded_blob}function ie(j){var X=this,$=X._initReady().then(function(){var ne=y[X._dbInfo.name];if(ne&&ne.dbReady)return ne.dbReady});return m($,j,j),$}function ae(j){H(j);for(var X=y[j.name],$=X.forages,ne=0;ne<$.length;ne++){var le=$[ne];le._dbInfo.db&&(le._dbInfo.db.close(),le._dbInfo.db=null)}return j.db=null,ke(j).then(function(ee){return j.db=ee,ze(j)?Me(j):ee}).then(function(ee){j.db=X.db=ee;for(var Re=0;Re<$.length;Re++)$[Re]._dbInfo.db=ee}).catch(function(ee){throw te(j,ee),ee})}function me(j,X,$,ne){ne===void 0&&(ne=1);try{var le=j.db.transaction(j.storeName,X);$(null,le)}catch(ee){if(ne>0&&(!j.db||ee.name==="InvalidStateError"||ee.name==="NotFoundError"))return d.resolve().then(function(){if(!j.db||ee.name==="NotFoundError"&&!j.db.objectStoreNames.contains(j.storeName)&&j.version<=j.db.version)return j.db&&(j.version=j.db.version+1),Me(j)}).then(function(){return ae(j).then(function(){me(j,X,$,ne-1)})}).catch($);$(ee)}}function _e(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function pe(j){var X=this,$={db:null};if(j)for(var ne in j)$[ne]=j[ne];var le=y[$.name];le||(le=_e(),y[$.name]=le),le.forages.push(X),X._initReady||(X._initReady=X.ready,X.ready=ie);var ee=[];function Re(){return d.resolve()}for(var Te=0;Te<le.forages.length;Te++){var Fe=le.forages[Te];Fe!==X&&ee.push(Fe._initReady().catch(Re))}var Be=le.forages.slice(0);return d.all(ee).then(function(){return $.db=le.db,ke($)}).then(function($e){return $.db=$e,ze($,X._defaultConfig.version)?Me($):$e}).then(function($e){$.db=le.db=$e,X._dbInfo=$;for(var ct=0;ct<Be.length;ct++){var Et=Be[ct];Et!==X&&(Et._dbInfo.db=$.db,Et._dbInfo.version=$.version)}})}function De(j,X){var $=this;j=b(j);var ne=new d(function(le,ee){$.ready().then(function(){me($._dbInfo,k,function(Re,Te){if(Re)return ee(Re);try{var Fe=Te.objectStore($._dbInfo.storeName),Be=Fe.get(j);Be.onsuccess=function(){var $e=Be.result;$e===void 0&&($e=null),he($e)&&($e=xe($e)),le($e)},Be.onerror=function(){ee(Be.error)}}catch($e){ee($e)}})}).catch(ee)});return f(ne,X),ne}function it(j,X){var $=this,ne=new d(function(le,ee){$.ready().then(function(){me($._dbInfo,k,function(Re,Te){if(Re)return ee(Re);try{var Fe=Te.objectStore($._dbInfo.storeName),Be=Fe.openCursor(),$e=1;Be.onsuccess=function(){var ct=Be.result;if(ct){var Et=ct.value;he(Et)&&(Et=xe(Et));var Ut=j(Et,ct.key,$e++);Ut!==void 0?le(Ut):ct.continue()}else le()},Be.onerror=function(){ee(Be.error)}}catch(ct){ee(ct)}})}).catch(ee)});return f(ne,X),ne}function Xe(j,X,$){var ne=this;j=b(j);var le=new d(function(ee,Re){var Te;ne.ready().then(function(){return Te=ne._dbInfo,E.call(X)==="[object Blob]"?F(Te.db).then(function(Fe){return Fe?X:ve(X)}):X}).then(function(Fe){me(ne._dbInfo,S,function(Be,$e){if(Be)return Re(Be);try{var ct=$e.objectStore(ne._dbInfo.storeName);Fe===null&&(Fe=void 0);var Et=ct.put(Fe,j);$e.oncomplete=function(){Fe===void 0&&(Fe=null),ee(Fe)},$e.onabort=$e.onerror=function(){var Ut=Et.error?Et.error:Et.transaction.error;Re(Ut)}}catch(Ut){Re(Ut)}})}).catch(Re)});return f(le,$),le}function We(j,X){var $=this;j=b(j);var ne=new d(function(le,ee){$.ready().then(function(){me($._dbInfo,S,function(Re,Te){if(Re)return ee(Re);try{var Fe=Te.objectStore($._dbInfo.storeName),Be=Fe.delete(j);Te.oncomplete=function(){le()},Te.onerror=function(){ee(Be.error)},Te.onabort=function(){var $e=Be.error?Be.error:Be.transaction.error;ee($e)}}catch($e){ee($e)}})}).catch(ee)});return f(ne,X),ne}function nt(j){var X=this,$=new d(function(ne,le){X.ready().then(function(){me(X._dbInfo,S,function(ee,Re){if(ee)return le(ee);try{var Te=Re.objectStore(X._dbInfo.storeName),Fe=Te.clear();Re.oncomplete=function(){ne()},Re.onabort=Re.onerror=function(){var Be=Fe.error?Fe.error:Fe.transaction.error;le(Be)}}catch(Be){le(Be)}})}).catch(le)});return f($,j),$}function Ve(j){var X=this,$=new d(function(ne,le){X.ready().then(function(){me(X._dbInfo,k,function(ee,Re){if(ee)return le(ee);try{var Te=Re.objectStore(X._dbInfo.storeName),Fe=Te.count();Fe.onsuccess=function(){ne(Fe.result)},Fe.onerror=function(){le(Fe.error)}}catch(Be){le(Be)}})}).catch(le)});return f($,j),$}function Bt(j,X){var $=this,ne=new d(function(le,ee){if(j<0){le(null);return}$.ready().then(function(){me($._dbInfo,k,function(Re,Te){if(Re)return ee(Re);try{var Fe=Te.objectStore($._dbInfo.storeName),Be=!1,$e=Fe.openKeyCursor();$e.onsuccess=function(){var ct=$e.result;if(!ct){le(null);return}j===0||Be?le(ct.key):(Be=!0,ct.advance(j))},$e.onerror=function(){ee($e.error)}}catch(ct){ee(ct)}})}).catch(ee)});return f(ne,X),ne}function wt(j){var X=this,$=new d(function(ne,le){X.ready().then(function(){me(X._dbInfo,k,function(ee,Re){if(ee)return le(ee);try{var Te=Re.objectStore(X._dbInfo.storeName),Fe=Te.openKeyCursor(),Be=[];Fe.onsuccess=function(){var $e=Fe.result;if(!$e){ne(Be);return}Be.push($e.key),$e.continue()},Fe.onerror=function(){le(Fe.error)}}catch($e){le($e)}})}).catch(le)});return f($,j),$}function pt(j,X){X=_.apply(this,arguments);var $=this.config();j=typeof j!="function"&&j||{},j.name||(j.name=j.name||$.name,j.storeName=j.storeName||$.storeName);var ne=this,le;if(!j.name)le=d.reject("Invalid arguments");else{var ee=j.name===$.name&&ne._dbInfo.db,Re=ee?d.resolve(ne._dbInfo.db):ke(j).then(function(Te){var Fe=y[j.name],Be=Fe.forages;Fe.db=Te;for(var $e=0;$e<Be.length;$e++)Be[$e]._dbInfo.db=Te;return Te});j.storeName?le=Re.then(function(Te){if(Te.objectStoreNames.contains(j.storeName)){var Fe=Te.version+1;H(j);var Be=y[j.name],$e=Be.forages;Te.close();for(var ct=0;ct<$e.length;ct++){var Et=$e[ct];Et._dbInfo.db=null,Et._dbInfo.version=Fe}var Ut=new d(function(Xt,vn){var xn=l.open(j.name,Fe);xn.onerror=function(Lr){var Lt=xn.result;Lt.close(),vn(Lr)},xn.onupgradeneeded=function(){var Lr=xn.result;Lr.deleteObjectStore(j.storeName)},xn.onsuccess=function(){var Lr=xn.result;Lr.close(),Xt(Lr)}});return Ut.then(function(Xt){Be.db=Xt;for(var vn=0;vn<$e.length;vn++){var xn=$e[vn];xn._dbInfo.db=Xt,z(xn._dbInfo)}}).catch(function(Xt){throw(te(j,Xt)||d.resolve()).catch(function(){}),Xt})}}):le=Re.then(function(Te){H(j);var Fe=y[j.name],Be=Fe.forages;Te.close();for(var $e=0;$e<Be.length;$e++){var ct=Be[$e];ct._dbInfo.db=null}var Et=new d(function(Ut,Xt){var vn=l.deleteDatabase(j.name);vn.onerror=function(){var xn=vn.result;xn&&xn.close(),Xt(vn.error)},vn.onblocked=function(){console.warn('dropInstance blocked for database "'+j.name+'" until all open connections are closed')},vn.onsuccess=function(){var xn=vn.result;xn&&xn.close(),Ut(xn)}});return Et.then(function(Ut){Fe.db=Ut;for(var Xt=0;Xt<Be.length;Xt++){var vn=Be[Xt];z(vn._dbInfo)}}).catch(function(Ut){throw(te(j,Ut)||d.resolve()).catch(function(){}),Ut})})}return f(le,X),le}var It={_driver:"asyncStorage",_initStorage:pe,_support:u(),iterate:it,getItem:De,setItem:Xe,removeItem:We,clear:nt,length:Ve,key:Bt,keys:wt,dropInstance:pt};function ei(){return typeof openDatabase=="function"}var en="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Vi="~~local_forage_type~",Wt=/^~~local_forage_type~([^~]+)~/,Wn="__lfsc__:",Jr=Wn.length,ti="arbf",ln="blob",tn="si08",yt="ui08",vi="uic8",fr="si16",ai="si32",Dn="ur16",es="ui32",Ii="fl32",yi="fl64",Ir=Jr+ti.length,oi=Object.prototype.toString;function En(j){var X=j.length*.75,$=j.length,ne,le=0,ee,Re,Te,Fe;j[j.length-1]==="="&&(X--,j[j.length-2]==="="&&X--);var Be=new ArrayBuffer(X),$e=new Uint8Array(Be);for(ne=0;ne<$;ne+=4)ee=en.indexOf(j[ne]),Re=en.indexOf(j[ne+1]),Te=en.indexOf(j[ne+2]),Fe=en.indexOf(j[ne+3]),$e[le++]=ee<<2|Re>>4,$e[le++]=(Re&15)<<4|Te>>2,$e[le++]=(Te&3)<<6|Fe&63;return Be}function bi(j){var X=new Uint8Array(j),$="",ne;for(ne=0;ne<X.length;ne+=3)$+=en[X[ne]>>2],$+=en[(X[ne]&3)<<4|X[ne+1]>>4],$+=en[(X[ne+1]&15)<<2|X[ne+2]>>6],$+=en[X[ne+2]&63];return X.length%3===2?$=$.substring(0,$.length-1)+"=":X.length%3===1&&($=$.substring(0,$.length-2)+"=="),$}function Li(j,X){var $="";if(j&&($=oi.call(j)),j&&($==="[object ArrayBuffer]"||j.buffer&&oi.call(j.buffer)==="[object ArrayBuffer]")){var ne,le=Wn;j instanceof ArrayBuffer?(ne=j,le+=ti):(ne=j.buffer,$==="[object Int8Array]"?le+=tn:$==="[object Uint8Array]"?le+=yt:$==="[object Uint8ClampedArray]"?le+=vi:$==="[object Int16Array]"?le+=fr:$==="[object Uint16Array]"?le+=Dn:$==="[object Int32Array]"?le+=ai:$==="[object Uint32Array]"?le+=es:$==="[object Float32Array]"?le+=Ii:$==="[object Float64Array]"?le+=yi:X(new Error("Failed to get type for BinaryArray"))),X(le+bi(ne))}else if($==="[object Blob]"){var ee=new FileReader;ee.onload=function(){var Re=Vi+j.type+"~"+bi(this.result);X(Wn+ln+Re)},ee.readAsArrayBuffer(j)}else try{X(JSON.stringify(j))}catch(Re){console.error("Couldn't convert value into a JSON string: ",j),X(null,Re)}}function M(j){if(j.substring(0,Jr)!==Wn)return JSON.parse(j);var X=j.substring(Ir),$=j.substring(Jr,Ir),ne;if($===ln&&Wt.test(X)){var le=X.match(Wt);ne=le[1],X=X.substring(le[0].length)}var ee=En(X);switch($){case ti:return ee;case ln:return h([ee],{type:ne});case tn:return new Int8Array(ee);case yt:return new Uint8Array(ee);case vi:return new Uint8ClampedArray(ee);case fr:return new Int16Array(ee);case Dn:return new Uint16Array(ee);case ai:return new Int32Array(ee);case es:return new Uint32Array(ee);case Ii:return new Float32Array(ee);case yi:return new Float64Array(ee);default:throw new Error("Unkown type: "+$)}}var Ne={serialize:Li,deserialize:M,stringToBuffer:En,bufferToString:bi};function Le(j,X,$,ne){j.executeSql("CREATE TABLE IF NOT EXISTS "+X.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],$,ne)}function tt(j){var X=this,$={db:null};if(j)for(var ne in j)$[ne]=typeof j[ne]!="string"?j[ne].toString():j[ne];var le=new d(function(ee,Re){try{$.db=openDatabase($.name,String($.version),$.description,$.size)}catch(Te){return Re(Te)}$.db.transaction(function(Te){Le(Te,$,function(){X._dbInfo=$,ee()},function(Fe,Be){Re(Be)})},Re)});return $.serializer=Ne,le}function q(j,X,$,ne,le,ee){j.executeSql($,ne,le,function(Re,Te){Te.code===Te.SYNTAX_ERR?Re.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[X.storeName],function(Fe,Be){Be.rows.length?ee(Fe,Te):Le(Fe,X,function(){Fe.executeSql($,ne,le,ee)},ee)},ee):ee(Re,Te)},ee)}function Se(j,X){var $=this;j=b(j);var ne=new d(function(le,ee){$.ready().then(function(){var Re=$._dbInfo;Re.db.transaction(function(Te){q(Te,Re,"SELECT * FROM "+Re.storeName+" WHERE key = ? LIMIT 1",[j],function(Fe,Be){var $e=Be.rows.length?Be.rows.item(0).value:null;$e&&($e=Re.serializer.deserialize($e)),le($e)},function(Fe,Be){ee(Be)})})}).catch(ee)});return f(ne,X),ne}function O(j,X){var $=this,ne=new d(function(le,ee){$.ready().then(function(){var Re=$._dbInfo;Re.db.transaction(function(Te){q(Te,Re,"SELECT * FROM "+Re.storeName,[],function(Fe,Be){for(var $e=Be.rows,ct=$e.length,Et=0;Et<ct;Et++){var Ut=$e.item(Et),Xt=Ut.value;if(Xt&&(Xt=Re.serializer.deserialize(Xt)),Xt=j(Xt,Ut.key,Et+1),Xt!==void 0){le(Xt);return}}le()},function(Fe,Be){ee(Be)})})}).catch(ee)});return f(ne,X),ne}function Ie(j,X,$,ne){var le=this;j=b(j);var ee=new d(function(Re,Te){le.ready().then(function(){X===void 0&&(X=null);var Fe=X,Be=le._dbInfo;Be.serializer.serialize(X,function($e,ct){ct?Te(ct):Be.db.transaction(function(Et){q(Et,Be,"INSERT OR REPLACE INTO "+Be.storeName+" (key, value) VALUES (?, ?)",[j,$e],function(){Re(Fe)},function(Ut,Xt){Te(Xt)})},function(Et){if(Et.code===Et.QUOTA_ERR){if(ne>0){Re(Ie.apply(le,[j,Fe,$,ne-1]));return}Te(Et)}})})}).catch(Te)});return f(ee,$),ee}function ft(j,X,$){return Ie.apply(this,[j,X,$,1])}function x(j,X){var $=this;j=b(j);var ne=new d(function(le,ee){$.ready().then(function(){var Re=$._dbInfo;Re.db.transaction(function(Te){q(Te,Re,"DELETE FROM "+Re.storeName+" WHERE key = ?",[j],function(){le()},function(Fe,Be){ee(Be)})})}).catch(ee)});return f(ne,X),ne}function be(j){var X=this,$=new d(function(ne,le){X.ready().then(function(){var ee=X._dbInfo;ee.db.transaction(function(Re){q(Re,ee,"DELETE FROM "+ee.storeName,[],function(){ne()},function(Te,Fe){le(Fe)})})}).catch(le)});return f($,j),$}function Ee(j){var X=this,$=new d(function(ne,le){X.ready().then(function(){var ee=X._dbInfo;ee.db.transaction(function(Re){q(Re,ee,"SELECT COUNT(key) as c FROM "+ee.storeName,[],function(Te,Fe){var Be=Fe.rows.item(0).c;ne(Be)},function(Te,Fe){le(Fe)})})}).catch(le)});return f($,j),$}function B(j,X){var $=this,ne=new d(function(le,ee){$.ready().then(function(){var Re=$._dbInfo;Re.db.transaction(function(Te){q(Te,Re,"SELECT key FROM "+Re.storeName+" WHERE id = ? LIMIT 1",[j+1],function(Fe,Be){var $e=Be.rows.length?Be.rows.item(0).key:null;le($e)},function(Fe,Be){ee(Be)})})}).catch(ee)});return f(ne,X),ne}function K(j){var X=this,$=new d(function(ne,le){X.ready().then(function(){var ee=X._dbInfo;ee.db.transaction(function(Re){q(Re,ee,"SELECT key FROM "+ee.storeName,[],function(Te,Fe){for(var Be=[],$e=0;$e<Fe.rows.length;$e++)Be.push(Fe.rows.item($e).key);ne(Be)},function(Te,Fe){le(Fe)})})}).catch(le)});return f($,j),$}function ge(j){return new d(function(X,$){j.transaction(function(ne){ne.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(le,ee){for(var Re=[],Te=0;Te<ee.rows.length;Te++)Re.push(ee.rows.item(Te).name);X({db:j,storeNames:Re})},function(le,ee){$(ee)})},function(ne){$(ne)})})}function lt(j,X){X=_.apply(this,arguments);var $=this.config();j=typeof j!="function"&&j||{},j.name||(j.name=j.name||$.name,j.storeName=j.storeName||$.storeName);var ne=this,le;return j.name?le=new d(function(ee){var Re;j.name===$.name?Re=ne._dbInfo.db:Re=openDatabase(j.name,"","",0),j.storeName?ee({db:Re,storeNames:[j.storeName]}):ee(ge(Re))}).then(function(ee){return new d(function(Re,Te){ee.db.transaction(function(Fe){function Be(Ut){return new d(function(Xt,vn){Fe.executeSql("DROP TABLE IF EXISTS "+Ut,[],function(){Xt()},function(xn,Lr){vn(Lr)})})}for(var $e=[],ct=0,Et=ee.storeNames.length;ct<Et;ct++)$e.push(Be(ee.storeNames[ct]));d.all($e).then(function(){Re()}).catch(function(Ut){Te(Ut)})},function(Fe){Te(Fe)})})}):le=d.reject("Invalid arguments"),f(le,X),le}var Oe={_driver:"webSQLStorage",_initStorage:tt,_support:ei(),iterate:O,getItem:Se,setItem:ft,removeItem:x,clear:be,length:Ee,key:B,keys:K,dropInstance:lt};function He(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function Nt(j,X){var $=j.name+"/";return j.storeName!==X.storeName&&($+=j.storeName+"/"),$}function Gi(){var j="_localforage_support_test";try{return localStorage.setItem(j,!0),localStorage.removeItem(j),!1}catch{return!0}}function nn(){return!Gi()||localStorage.length>0}function Dt(j){var X=this,$={};if(j)for(var ne in j)$[ne]=j[ne];return $.keyPrefix=Nt(j,X._defaultConfig),nn()?(X._dbInfo=$,$.serializer=Ne,d.resolve()):d.reject()}function Rn(j){var X=this,$=X.ready().then(function(){for(var ne=X._dbInfo.keyPrefix,le=localStorage.length-1;le>=0;le--){var ee=localStorage.key(le);ee.indexOf(ne)===0&&localStorage.removeItem(ee)}});return f($,j),$}function dn(j,X){var $=this;j=b(j);var ne=$.ready().then(function(){var le=$._dbInfo,ee=localStorage.getItem(le.keyPrefix+j);return ee&&(ee=le.serializer.deserialize(ee)),ee});return f(ne,X),ne}function Pn(j,X){var $=this,ne=$.ready().then(function(){for(var le=$._dbInfo,ee=le.keyPrefix,Re=ee.length,Te=localStorage.length,Fe=1,Be=0;Be<Te;Be++){var $e=localStorage.key(Be);if($e.indexOf(ee)===0){var ct=localStorage.getItem($e);if(ct&&(ct=le.serializer.deserialize(ct)),ct=j(ct,$e.substring(Re),Fe++),ct!==void 0)return ct}}});return f(ne,X),ne}function pr(j,X){var $=this,ne=$.ready().then(function(){var le=$._dbInfo,ee;try{ee=localStorage.key(j)}catch{ee=null}return ee&&(ee=ee.substring(le.keyPrefix.length)),ee});return f(ne,X),ne}function Vs(j){var X=this,$=X.ready().then(function(){for(var ne=X._dbInfo,le=localStorage.length,ee=[],Re=0;Re<le;Re++){var Te=localStorage.key(Re);Te.indexOf(ne.keyPrefix)===0&&ee.push(Te.substring(ne.keyPrefix.length))}return ee});return f($,j),$}function An(j){var X=this,$=X.keys().then(function(ne){return ne.length});return f($,j),$}function Nn(j,X){var $=this;j=b(j);var ne=$.ready().then(function(){var le=$._dbInfo;localStorage.removeItem(le.keyPrefix+j)});return f(ne,X),ne}function zn(j,X,$){var ne=this;j=b(j);var le=ne.ready().then(function(){X===void 0&&(X=null);var ee=X;return new d(function(Re,Te){var Fe=ne._dbInfo;Fe.serializer.serialize(X,function(Be,$e){if($e)Te($e);else try{localStorage.setItem(Fe.keyPrefix+j,Be),Re(ee)}catch(ct){(ct.name==="QuotaExceededError"||ct.name==="NS_ERROR_DOM_QUOTA_REACHED")&&Te(ct),Te(ct)}})})});return f(le,$),le}function li(j,X){if(X=_.apply(this,arguments),j=typeof j!="function"&&j||{},!j.name){var $=this.config();j.name=j.name||$.name,j.storeName=j.storeName||$.storeName}var ne=this,le;return j.name?le=new d(function(ee){j.storeName?ee(Nt(j,ne._defaultConfig)):ee(j.name+"/")}).then(function(ee){for(var Re=localStorage.length-1;Re>=0;Re--){var Te=localStorage.key(Re);Te.indexOf(ee)===0&&localStorage.removeItem(Te)}}):le=d.reject("Invalid arguments"),f(le,X),le}var mr={_driver:"localStorageWrapper",_initStorage:Dt,_support:He(),iterate:Pn,getItem:dn,setItem:zn,removeItem:Nn,clear:Rn,length:An,key:pr,keys:Vs,dropInstance:li},wl=function(X,$){return X===$||typeof X=="number"&&typeof $=="number"&&isNaN(X)&&isNaN($)},In=function(X,$){for(var ne=X.length,le=0;le<ne;){if(wl(X[le],$))return!0;le++}return!1},Ta=Array.isArray||function(j){return Object.prototype.toString.call(j)==="[object Array]"},gr={},op={},ts={INDEXEDDB:It,WEBSQL:Oe,LOCALSTORAGE:mr},Mh=[ts.INDEXEDDB._driver,ts.WEBSQL._driver,ts.LOCALSTORAGE._driver],_l=["dropInstance"],Hu=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(_l),go={description:"",driver:Mh.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Wv(j,X){j[X]=function(){var $=arguments;return j.ready().then(function(){return j[X].apply(j,$)})}}function El(){for(var j=1;j<arguments.length;j++){var X=arguments[j];if(X)for(var $ in X)X.hasOwnProperty($)&&(Ta(X[$])?arguments[0][$]=X[$].slice():arguments[0][$]=X[$])}return arguments[0]}var Vv=function(){function j(X){a(this,j);for(var $ in ts)if(ts.hasOwnProperty($)){var ne=ts[$],le=ne._driver;this[$]=le,gr[le]||this.defineDriver(ne)}this._defaultConfig=El({},go),this._config=El({},this._defaultConfig,X),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return j.prototype.config=function($){if((typeof $>"u"?"undefined":s($))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var ne in $){if(ne==="storeName"&&($[ne]=$[ne].replace(/\W/g,"_")),ne==="version"&&typeof $[ne]!="number")return new Error("Database version must be a number.");this._config[ne]=$[ne]}return"driver"in $&&$.driver?this.setDriver(this._config.driver):!0}else return typeof $=="string"?this._config[$]:this._config},j.prototype.defineDriver=function($,ne,le){var ee=new d(function(Re,Te){try{var Fe=$._driver,Be=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!$._driver){Te(Be);return}for(var $e=Hu.concat("_initStorage"),ct=0,Et=$e.length;ct<Et;ct++){var Ut=$e[ct],Xt=!In(_l,Ut);if((Xt||$[Ut])&&typeof $[Ut]!="function"){Te(Be);return}}var vn=function(){for(var Lt=function(Al){return function(){var Bh=new Error("Method "+Al+" is not implemented by the current driver"),Gs=d.reject(Bh);return f(Gs,arguments[arguments.length-1]),Gs}},Fh=0,Bw=_l.length;Fh<Bw;Fh++){var lp=_l[Fh];$[lp]||($[lp]=Lt(lp))}};vn();var xn=function(Lt){gr[Fe]&&console.info("Redefining LocalForage driver: "+Fe),gr[Fe]=$,op[Fe]=Lt,Re()};"_support"in $?$._support&&typeof $._support=="function"?$._support().then(xn,Te):xn(!!$._support):xn(!0)}catch(Lr){Te(Lr)}});return m(ee,ne,le),ee},j.prototype.driver=function(){return this._driver||null},j.prototype.getDriver=function($,ne,le){var ee=gr[$]?d.resolve(gr[$]):d.reject(new Error("Driver not found."));return m(ee,ne,le),ee},j.prototype.getSerializer=function($){var ne=d.resolve(Ne);return m(ne,$),ne},j.prototype.ready=function($){var ne=this,le=ne._driverSet.then(function(){return ne._ready===null&&(ne._ready=ne._initDriver()),ne._ready});return m(le,$,$),le},j.prototype.setDriver=function($,ne,le){var ee=this;Ta($)||($=[$]);var Re=this._getSupportedDrivers($);function Te(){ee._config.driver=ee.driver()}function Fe(ct){return ee._extend(ct),Te(),ee._ready=ee._initStorage(ee._config),ee._ready}function Be(ct){return function(){var Et=0;function Ut(){for(;Et<ct.length;){var Xt=ct[Et];return Et++,ee._dbInfo=null,ee._ready=null,ee.getDriver(Xt).then(Fe).catch(Ut)}Te();var vn=new Error("No available storage method found.");return ee._driverSet=d.reject(vn),ee._driverSet}return Ut()}}var $e=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=$e.then(function(){var ct=Re[0];return ee._dbInfo=null,ee._ready=null,ee.getDriver(ct).then(function(Et){ee._driver=Et._driver,Te(),ee._wrapLibraryMethodsWithReady(),ee._initDriver=Be(Re)})}).catch(function(){Te();var ct=new Error("No available storage method found.");return ee._driverSet=d.reject(ct),ee._driverSet}),m(this._driverSet,ne,le),this._driverSet},j.prototype.supports=function($){return!!op[$]},j.prototype._extend=function($){El(this,$)},j.prototype._getSupportedDrivers=function($){for(var ne=[],le=0,ee=$.length;le<ee;le++){var Re=$[le];this.supports(Re)&&ne.push(Re)}return ne},j.prototype._wrapLibraryMethodsWithReady=function(){for(var $=0,ne=Hu.length;$<ne;$++)Wv(this,Hu[$])},j.prototype.createInstance=function($){return new j($)},j}(),jt=new Vv;i.exports=jt},{3:3}]},{},[4])(4)})})(BP);var lj=BP.exports;const YC=po(lj);class jP{constructor(e,t,i){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||zm,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;typeof YC>"u"&&(e=YC),this.storage=e.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit("online",this):this.emit("offline",this)}add(e,t){let i=e.resources.map(r=>{let{href:s}=r,a=this.resolver(s),o=window.encodeURIComponent(a);return this.storage.getItem(o).then(l=>!l||t?this.requester(a,"binary").then(u=>this.storage.setItem(o,u)):l)});return Promise.all(i)}put(e,t,i){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(s=>s||this.requester(e,"binary",t,i).then(a=>this.storage.setItem(r,a)))}request(e,t,i,r){return this.online?this.requester(e,t,i,r).then(s=>(this.put(e),s)):this.retrieve(e,t)}retrieve(e,t){new Ht;var i,r=new ml(e);return t||(t=r.extension),t=="blob"?i=this.getBlob(e):i=this.getText(e),i.then(s=>{var a=new Ht,o;return s?(o=this.handleResponse(s,t),a.resolve(o)):a.reject({message:"File not found in storage: "+e,stack:new Error().stack}),a.promise})}handleResponse(e,t){var i;return t=="json"?i=JSON.parse(e):jm(t)?i=ho(e,"text/xml"):t=="xhtml"?i=ho(e,"application/xhtml+xml"):t=="html"||t=="htm"?i=ho(e,"text/html"):i=e,i}getBlob(e,t){let i=window.encodeURIComponent(e);return this.storage.getItem(i).then(function(r){if(r)return t=t||xd.lookup(e),new Blob([r],{type:t})})}getText(e,t){let i=window.encodeURIComponent(e);return t=t||xd.lookup(e),this.storage.getItem(i).then(function(r){var s=new Ht,a=new FileReader,o;if(r)return o=new Blob([r],{type:t}),a.addEventListener("loadend",()=>{s.resolve(a.result)}),a.readAsText(o,t),s.promise})}getBase64(e,t){let i=window.encodeURIComponent(e);return t=t||xd.lookup(e),this.storage.getItem(i).then(r=>{var s=new Ht,a=new FileReader,o;if(r)return o=new Blob([r],{type:t}),a.addEventListener("loadend",()=>{s.resolve(a.result)}),a.readAsDataURL(o,t),s.promise})}createUrl(e,t){var i=new Ht,r=window.URL||window.webkitURL||window.mozURL,s,a,o=t&&t.base64;return e in this.urlCache?(i.resolve(this.urlCache[e]),i.promise):(o?(a=this.getBase64(e),a&&a.then(function(l){this.urlCache[e]=l,i.resolve(l)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(l){s=r.createObjectURL(l),this.urlCache[e]=s,i.resolve(s)}.bind(this))),a||i.reject({message:"File not found in storage: "+e,stack:new Error().stack}),i.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[e];i&&t.revokeObjectURL(i)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}}mo(jP.prototype);class W1{constructor(e){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",e&&this.parse(e)}parse(e){if(!e)return this;const t=fn(e,"display_options");return t?(pl(t,"option").forEach(r=>{let s="";switch(r.childNodes.length&&(s=r.childNodes[0].nodeValue),r.attributes.name.value){case"interactive":this.interactive=s;break;case"fixed-layout":this.fixedLayout=s;break;case"open-to-spread":this.openToSpread=s;break;case"orientation-lock":this.orientationLock=s;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const QC="META-INF/container.xml",uj="META-INF/com.apple.ibooks.display-options.xml",Xs={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class ox{constructor(e,t){typeof t>"u"&&typeof e!="string"&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=qi(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),qi(this.settings,t),this.opening=new Ht,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Ht,spine:new Ht,metadata:new Ht,cover:new Ht,navigation:new Ht,pageList:new Ht,resources:new Ht,displayOptions:new Ht},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||zm,this.spine=new TB,this.locations=new _P(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(i=>{var r=new Error("Cannot load book at "+e);this.emit(et.BOOK.OPEN_FAILED,r)})}open(e,t){var i,r=t||this.determineType(e);return r===Xs.BINARY?(this.archived=!0,this.url=new ta("/",""),i=this.openEpub(e)):r===Xs.BASE64?(this.archived=!0,this.url=new ta("/",""),i=this.openEpub(e,r)):r===Xs.EPUB?(this.archived=!0,this.url=new ta("/",""),i=this.request(e,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):r==Xs.OPF?(this.url=new ta(e),i=this.openPackaging(this.url.Path.toString())):r==Xs.MANIFEST?(this.url=new ta(e),i=this.openManifest(this.url.Path.toString())):(this.url=new ta(e),i=this.openContainer(QC).then(this.openPackaging.bind(this))),i}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(QC)).then(i=>this.openPackaging(i))}openContainer(e){return this.load(e).then(t=>(this.container=new DB(t),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new ml(e),this.load(e).then(t=>(this.packaging=new $C(t),this.unpack(this.packaging)))}openManifest(e){return this.path=new ml(e),this.load(e).then(t=>(this.packaging=new $C,this.packaging.load(t),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var i=e,r=e.indexOf("://")>-1;return r?e:(this.path&&(i=this.path.resolve(e)),t!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(e){var t=e;return e?(this.settings.canonical?t=this.settings.canonical(e):t=this.resolve(e,!0),t):""}determineType(e){var t,i,r;if(this.settings.encoding==="base64")return Xs.BASE64;if(typeof e!="string")return Xs.BINARY;if(t=new ta(e),i=t.path(),r=i.extension,r&&(r=r.replace(/\?.*$/,"")),!r)return Xs.DIRECTORY;if(r==="epub")return Xs.EPUB;if(r==="opf")return Xs.OPF;if(r==="json")return Xs.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===""?this.load(this.url.resolve(uj)).then(t=>{this.displayOptions=new W1(t),this.loading.displayOptions.resolve(this.displayOptions)}).catch(t=>{this.displayOptions=new W1,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new W1,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new IB(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(t=>{console.error(t)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,i=e.toc;return i?new Promise((r,s)=>{this.navigation=new $1(i),e.pageList&&(this.pageList=new H1(e.pageList)),r(this.navigation)}):t?this.load(t,"xml").then(r=>(this.navigation=new $1(r),this.pageList=new H1(r),this.navigation)):new Promise((r,s)=>{this.navigation=new $1,this.pageList=new H1,r(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new ax(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new oj,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,r=this.settings.requestMethod||zm.bind(this);return this.storage=new jP(e,r,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let s=(a,o)=>{o.output=this.resources.substitute(a,o.url)};this.resources.settings.replacements=t||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new ta("/",""),this.spine.hooks.serialize.register(s)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(s)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new qt(e),i=this.spine.get(t.spinePos),r=this.load.bind(this);return i?i.load(r).then(function(s){var a=t.toRange(i.document);return a}):new Promise((s,a)=>{a("CFI could not be found")})}key(e){var t=e||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${gw}:${t}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}mo(ox.prototype);function Lh(n,e){return new ox(n,e)}Lh.VERSION=gw;typeof global<"u"&&(global.EPUBJS_VERSION=gw);Lh.Book=ox;Lh.Rendition=ax;Lh.Contents=ix;Lh.CFI=qt;Lh.utils=wB;const cj={},ZC=n=>{let e;const t=new Set,i=(h,d)=>{const f=typeof h=="function"?h(e):h;if(!Object.is(f,e)){const m=e;e=d??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(b=>b(e,m))}},r=()=>e,l={setState:i,getState:r,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(cj?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},u=e=n(i,r,l);return l},hj=n=>n?ZC(n):ZC;var zP={exports:{}},UP={},$P={exports:{}},HP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zf=kt;function dj(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var fj=typeof Object.is=="function"?Object.is:dj,pj=Zf.useState,mj=Zf.useEffect,gj=Zf.useLayoutEffect,vj=Zf.useDebugValue;function yj(n,e){var t=e(),i=pj({inst:{value:t,getSnapshot:e}}),r=i[0].inst,s=i[1];return gj(function(){r.value=t,r.getSnapshot=e,V1(r)&&s({inst:r})},[n,t,e]),mj(function(){return V1(r)&&s({inst:r}),n(function(){V1(r)&&s({inst:r})})},[n]),vj(t),t}function V1(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!fj(n,t)}catch{return!0}}function bj(n,e){return e()}var wj=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?bj:yj;HP.useSyncExternalStore=Zf.useSyncExternalStore!==void 0?Zf.useSyncExternalStore:wj;$P.exports=HP;var _j=$P.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww=kt,Ej=_j;function Aj(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var xj=typeof Object.is=="function"?Object.is:Aj,Sj=Ej.useSyncExternalStore,Cj=ww.useRef,kj=ww.useEffect,Tj=ww.useMemo,Dj=ww.useDebugValue;UP.useSyncExternalStoreWithSelector=function(n,e,t,i,r){var s=Cj(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=Tj(function(){function l(m){if(!u){if(u=!0,h=m,m=i(m),r!==void 0&&a.hasValue){var b=a.value;if(r(b,m))return d=b}return d=m}if(b=d,xj(h,m))return b;var _=i(m);return r!==void 0&&r(b,_)?(h=m,b):(h=m,d=_)}var u=!1,h,d,f=t===void 0?null:t;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,t,i,r]);var o=Sj(n,s[0],s[1]);return kj(function(){a.hasValue=!0,a.value=o},[o]),Dj(o),o};zP.exports=UP;var Rj=zP.exports;const Pj=po(Rj),lx={},{useDebugValue:Nj}=gm,{useSyncExternalStoreWithSelector:Ij}=Pj;let JC=!1;const Lj=n=>n;function Oj(n,e=Lj,t){(lx?"production":void 0)!=="production"&&t&&!JC&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),JC=!0);const i=Ij(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return Nj(i),i}const ek=n=>{(lx?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?hj(n):n,t=(i,r)=>Oj(e,i,r);return Object.assign(t,e),t},Mj=n=>n?ek(n):ek;var _w=n=>((lx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),Mj(n)),qP={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(Cr,function(){var t=function(p,g){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,C){A.__proto__=C}||function(A,C){for(var R in C)Object.prototype.hasOwnProperty.call(C,R)&&(A[R]=C[R])})(p,g)},i=function(){return(i=Object.assign||function(p){for(var g,A=1,C=arguments.length;A<C;A++)for(var R in g=arguments[A])Object.prototype.hasOwnProperty.call(g,R)&&(p[R]=g[R]);return p}).apply(this,arguments)};function r(p,g,A){for(var C,R=0,L=g.length;R<L;R++)!C&&R in g||((C=C||Array.prototype.slice.call(g,0,R))[R]=g[R]);return p.concat(C||Array.prototype.slice.call(g))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Cr,a=Object.keys,o=Array.isArray;function l(p,g){return typeof g!="object"||a(g).forEach(function(A){p[A]=g[A]}),p}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var u=Object.getPrototypeOf,h={}.hasOwnProperty;function d(p,g){return h.call(p,g)}function f(p,g){typeof g=="function"&&(g=g(u(p))),(typeof Reflect>"u"?a:Reflect.ownKeys)(g).forEach(function(A){b(p,A,g[A])})}var m=Object.defineProperty;function b(p,g,A,C){m(p,g,l(A&&d(A,"get")&&typeof A.get=="function"?{get:A.get,set:A.set,configurable:!0}:{value:A,configurable:!0,writable:!0},C))}function _(p){return{from:function(g){return p.prototype=Object.create(g.prototype),b(p.prototype,"constructor",p),{extend:f.bind(null,p.prototype)}}}}var w=Object.getOwnPropertyDescriptor,v=[].slice;function y(p,g,A){return v.call(p,g,A)}function E(p,g){return g(p)}function k(p){if(!p)throw new Error("Assertion Failed")}function S(p){s.setImmediate?setImmediate(p):setTimeout(p,0)}function D(p,g){if(typeof g=="string"&&d(p,g))return p[g];if(!g)return p;if(typeof g!="string"){for(var A=[],C=0,R=g.length;C<R;++C){var L=D(p,g[C]);A.push(L)}return A}var U=g.indexOf(".");if(U!==-1){var V=p[g.substr(0,U)];return V==null?void 0:D(V,g.substr(U+1))}}function P(p,g,A){if(p&&g!==void 0&&!("isFrozen"in Object&&Object.isFrozen(p)))if(typeof g!="string"&&"length"in g){k(typeof A!="string"&&"length"in A);for(var C=0,R=g.length;C<R;++C)P(p,g[C],A[C])}else{var L,U,V=g.indexOf(".");V!==-1?(L=g.substr(0,V),(U=g.substr(V+1))===""?A===void 0?o(p)&&!isNaN(parseInt(L))?p.splice(L,1):delete p[L]:p[L]=A:P(V=!(V=p[L])||!d(p,L)?p[L]={}:V,U,A)):A===void 0?o(p)&&!isNaN(parseInt(g))?p.splice(g,1):delete p[g]:p[g]=A}}function F(p){var g,A={};for(g in p)d(p,g)&&(A[g]=p[g]);return A}var H=[].concat;function z(p){return H.apply([],p)}var ai="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(z([8,16,32,64].map(function(p){return["Int","Uint","Float"].map(function(g){return g+p+"Array"})}))).filter(function(p){return s[p]}),te=new Set(ai.map(function(p){return s[p]})),de=null;function ke(p){return de=new WeakMap,p=function g(A){if(!A||typeof A!="object")return A;var C=de.get(A);if(C)return C;if(o(A)){C=[],de.set(A,C);for(var R=0,L=A.length;R<L;++R)C.push(g(A[R]))}else if(te.has(A.constructor))C=A;else{var U,V=u(A);for(U in C=V===Object.prototype?{}:Object.create(V),de.set(A,C),A)d(A,U)&&(C[U]=g(A[U]))}return C}(p),de=null,p}var Me={}.toString;function ze(p){return Me.call(p).slice(8,-1)}var ve=typeof Symbol<"u"?Symbol.iterator:"@@iterator",xe=typeof ve=="symbol"?function(p){var g;return p!=null&&(g=p[ve])&&g.apply(p)}:function(){return null};function he(p,g){return g=p.indexOf(g),0<=g&&p.splice(g,1),0<=g}var ie={};function ae(p){var g,A,C,R;if(arguments.length===1){if(o(p))return p.slice();if(this===ie&&typeof p=="string")return[p];if(R=xe(p)){for(A=[];!(C=R.next()).done;)A.push(C.value);return A}if(p==null)return[p];if(typeof(g=p.length)!="number")return[p];for(A=new Array(g);g--;)A[g]=p[g];return A}for(g=arguments.length,A=new Array(g);g--;)A[g]=arguments[g];return A}var me=typeof Symbol<"u"?function(p){return p[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},fr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Cs=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(fr),_e={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pe(p,g){this.name=p,this.message=g}function De(p,g){return p+". Errors: "+Object.keys(g).map(function(A){return g[A].toString()}).filter(function(A,C,R){return R.indexOf(A)===C}).join(`
`)}function it(p,g,A,C){this.failures=g,this.failedKeys=C,this.successCount=A,this.message=De(p,g)}function Xe(p,g){this.name="BulkError",this.failures=Object.keys(g).map(function(A){return g[A]}),this.failuresByPos=g,this.message=De(p,this.failures)}_(pe).from(Error).extend({toString:function(){return this.name+": "+this.message}}),_(it).from(pe),_(Xe).from(pe);var We=Cs.reduce(function(p,g){return p[g]=g+"Error",p},{}),nt=pe,Ve=Cs.reduce(function(p,g){var A=g+"Error";function C(R,L){this.name=A,R?typeof R=="string"?(this.message="".concat(R).concat(L?`
 `+L:""),this.inner=L||null):typeof R=="object"&&(this.message="".concat(R.name," ").concat(R.message),this.inner=R):(this.message=_e[g]||A,this.inner=null)}return _(C).from(nt),p[g]=C,p},{});Ve.Syntax=SyntaxError,Ve.Type=TypeError,Ve.Range=RangeError;var Bt=fr.reduce(function(p,g){return p[g+"Error"]=Ve[g],p},{}),wt=Cs.reduce(function(p,g){return["Syntax","Type","Range"].indexOf(g)===-1&&(p[g+"Error"]=Ve[g]),p},{});function pt(){}function It(p){return p}function ei(p,g){return p==null||p===It?g:function(A){return g(p(A))}}function en(p,g){return function(){p.apply(this,arguments),g.apply(this,arguments)}}function Vi(p,g){return p===pt?g:function(){var A=p.apply(this,arguments);A!==void 0&&(arguments[0]=A);var C=this.onsuccess,R=this.onerror;this.onsuccess=null,this.onerror=null;var L=g.apply(this,arguments);return C&&(this.onsuccess=this.onsuccess?en(C,this.onsuccess):C),R&&(this.onerror=this.onerror?en(R,this.onerror):R),L!==void 0?L:A}}function Wt(p,g){return p===pt?g:function(){p.apply(this,arguments);var A=this.onsuccess,C=this.onerror;this.onsuccess=this.onerror=null,g.apply(this,arguments),A&&(this.onsuccess=this.onsuccess?en(A,this.onsuccess):A),C&&(this.onerror=this.onerror?en(C,this.onerror):C)}}function Wn(p,g){return p===pt?g:function(A){var C=p.apply(this,arguments);l(A,C);var R=this.onsuccess,L=this.onerror;return this.onsuccess=null,this.onerror=null,A=g.apply(this,arguments),R&&(this.onsuccess=this.onsuccess?en(R,this.onsuccess):R),L&&(this.onerror=this.onerror?en(L,this.onerror):L),C===void 0?A===void 0?void 0:A:l(C,A)}}function Jr(p,g){return p===pt?g:function(){return g.apply(this,arguments)!==!1&&p.apply(this,arguments)}}function ti(p,g){return p===pt?g:function(){var A=p.apply(this,arguments);if(A&&typeof A.then=="function"){for(var C=this,R=arguments.length,L=new Array(R);R--;)L[R]=arguments[R];return A.then(function(){return g.apply(C,L)})}return g.apply(this,arguments)}}wt.ModifyError=it,wt.DexieError=pe,wt.BulkError=Xe;var ln=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function tn(p){ln=p}var yt={},vi=100,ai=typeof Promise>"u"?[]:function(){var p=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[p,u(p),p];var g=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[g,u(g),p]}(),fr=ai[0],Cs=ai[1],ai=ai[2],Cs=Cs&&Cs.then,Dn=fr&&fr.constructor,es=!!ai,Ii=function(p,g){Ne.push([p,g]),Ir&&(queueMicrotask(Ee),Ir=!1)},yi=!0,Ir=!0,oi=[],En=[],bi=It,Li={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pt,pgp:!1,env:{},finalize:pt},M=Li,Ne=[],Le=0,tt=[];function q(p){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var g=this._PSD=M;if(typeof p!="function"){if(p!==yt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ie(this,this._value))}this._state=null,this._value=null,++g.ref,function A(C,R){try{R(function(L){if(C._state===null){if(L===C)throw new TypeError("A promise cannot be resolved with itself.");var U=C._lib&&B();L&&typeof L.then=="function"?A(C,function(V,Y){L instanceof q?L._then(V,Y):L.then(V,Y)}):(C._state=!0,C._value=L,ft(C)),U&&K()}},Ie.bind(null,C))}catch(L){Ie(C,L)}}(this,p)}var Se={get:function(){var p=M,g=Dt;function A(C,R){var L=this,U=!p.global&&(p!==M||g!==Dt),V=U&&!pr(),Y=new q(function(Z,oe){x(L,new O(mr(C,p,U,V),mr(R,p,U,V),Z,oe,p))});return this._consoleTask&&(Y._consoleTask=this._consoleTask),Y}return A.prototype=yt,A},set:function(p){b(this,"then",p&&p.prototype===yt?Se:{get:function(){return p},set:Se.set})}};function O(p,g,A,C,R){this.onFulfilled=typeof p=="function"?p:null,this.onRejected=typeof g=="function"?g:null,this.resolve=A,this.reject=C,this.psd=R}function Ie(p,g){var A,C;En.push(g),p._state===null&&(A=p._lib&&B(),g=bi(g),p._state=!1,p._value=g,C=p,oi.some(function(R){return R._value===C._value})||oi.push(C),ft(p),A&&K())}function ft(p){var g=p._listeners;p._listeners=[];for(var A=0,C=g.length;A<C;++A)x(p,g[A]);var R=p._PSD;--R.ref||R.finalize(),Le===0&&(++Le,Ii(function(){--Le==0&&ge()},[]))}function x(p,g){if(p._state!==null){var A=p._state?g.onFulfilled:g.onRejected;if(A===null)return(p._state?g.resolve:g.reject)(p._value);++g.psd.ref,++Le,Ii(be,[A,p,g])}else p._listeners.push(g)}function be(p,g,A){try{var C,R=g._value;!g._state&&En.length&&(En=[]),C=ln&&g._consoleTask?g._consoleTask.run(function(){return p(R)}):p(R),g._state||En.indexOf(R)!==-1||function(L){for(var U=oi.length;U;)if(oi[--U]._value===L._value)return oi.splice(U,1)}(g),A.resolve(C)}catch(L){A.reject(L)}finally{--Le==0&&ge(),--A.psd.ref||A.psd.finalize()}}function Ee(){li(Li,function(){B()&&K()})}function B(){var p=yi;return Ir=yi=!1,p}function K(){var p,g,A;do for(;0<Ne.length;)for(p=Ne,Ne=[],A=p.length,g=0;g<A;++g){var C=p[g];C[0].apply(null,C[1])}while(0<Ne.length);Ir=yi=!0}function ge(){var p=oi;oi=[],p.forEach(function(C){C._PSD.onunhandled.call(null,C._value,C)});for(var g=tt.slice(0),A=g.length;A;)g[--A]()}function lt(p){return new q(yt,!1,p)}function Oe(p,g){var A=M;return function(){var C=B(),R=M;try{return Nn(A,!0),p.apply(this,arguments)}catch(L){g&&g(L)}finally{Nn(R,!1),C&&K()}}}f(q.prototype,{then:Se,_then:function(p,g){x(this,new O(null,null,p,g,M))},catch:function(p){if(arguments.length===1)return this.then(null,p);var g=p,A=arguments[1];return typeof g=="function"?this.then(null,function(C){return(C instanceof g?A:lt)(C)}):this.then(null,function(C){return(C&&C.name===g?A:lt)(C)})},finally:function(p){return this.then(function(g){return q.resolve(p()).then(function(){return g})},function(g){return q.resolve(p()).then(function(){return lt(g)})})},timeout:function(p,g){var A=this;return p<1/0?new q(function(C,R){var L=setTimeout(function(){return R(new Ve.Timeout(g))},p);A.then(C,R).finally(clearTimeout.bind(null,L))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&b(q.prototype,Symbol.toStringTag,"Dexie.Promise"),Li.env=zn(),f(q,{all:function(){var p=ae.apply(null,arguments).map(Vs);return new q(function(g,A){p.length===0&&g([]);var C=p.length;p.forEach(function(R,L){return q.resolve(R).then(function(U){p[L]=U,--C||g(p)},A)})})},resolve:function(p){return p instanceof q?p:p&&typeof p.then=="function"?new q(function(g,A){p.then(g,A)}):new q(yt,!0,p)},reject:lt,race:function(){var p=ae.apply(null,arguments).map(Vs);return new q(function(g,A){p.map(function(C){return q.resolve(C).then(g,A)})})},PSD:{get:function(){return M},set:function(p){return M=p}},totalEchoes:{get:function(){return Dt}},newPSD:dn,usePSD:li,scheduler:{get:function(){return Ii},set:function(p){Ii=p}},rejectionMapper:{get:function(){return bi},set:function(p){bi=p}},follow:function(p,g){return new q(function(A,C){return dn(function(R,L){var U=M;U.unhandleds=[],U.onunhandled=L,U.finalize=en(function(){var V,Y=this;V=function(){Y.unhandleds.length===0?R():L(Y.unhandleds[0])},tt.push(function Z(){V(),tt.splice(tt.indexOf(Z),1)}),++Le,Ii(function(){--Le==0&&ge()},[])},U.finalize),p()},g,A,C)})}}),Dn&&(Dn.allSettled&&b(q,"allSettled",function(){var p=ae.apply(null,arguments).map(Vs);return new q(function(g){p.length===0&&g([]);var A=p.length,C=new Array(A);p.forEach(function(R,L){return q.resolve(R).then(function(U){return C[L]={status:"fulfilled",value:U}},function(U){return C[L]={status:"rejected",reason:U}}).then(function(){return--A||g(C)})})})}),Dn.any&&typeof AggregateError<"u"&&b(q,"any",function(){var p=ae.apply(null,arguments).map(Vs);return new q(function(g,A){p.length===0&&A(new AggregateError([]));var C=p.length,R=new Array(C);p.forEach(function(L,U){return q.resolve(L).then(function(V){return g(V)},function(V){R[U]=V,--C||A(new AggregateError(R))})})})}),Dn.withResolvers&&(q.withResolvers=Dn.withResolvers));var He={awaits:0,echoes:0,id:0},Nt=0,Gi=[],nn=0,Dt=0,Rn=0;function dn(p,g,A,C){var R=M,L=Object.create(R);return L.parent=R,L.ref=0,L.global=!1,L.id=++Rn,Li.env,L.env=es?{Promise:q,PromiseProp:{value:q,configurable:!0,writable:!0},all:q.all,race:q.race,allSettled:q.allSettled,any:q.any,resolve:q.resolve,reject:q.reject}:{},g&&l(L,g),++R.ref,L.finalize=function(){--this.parent.ref||this.parent.finalize()},C=li(L,p,A,C),L.ref===0&&L.finalize(),C}function Pn(){return He.id||(He.id=++Nt),++He.awaits,He.echoes+=vi,He.id}function pr(){return!!He.awaits&&(--He.awaits==0&&(He.id=0),He.echoes=He.awaits*vi,!0)}function Vs(p){return He.echoes&&p&&p.constructor===Dn?(Pn(),p.then(function(g){return pr(),g},function(g){return pr(),In(g)})):p}function An(){var p=Gi[Gi.length-1];Gi.pop(),Nn(p,!1)}function Nn(p,g){var A,C=M;(g?!He.echoes||nn++&&p===M:!nn||--nn&&p===M)||queueMicrotask(g?function(R){++Dt,He.echoes&&--He.echoes!=0||(He.echoes=He.awaits=He.id=0),Gi.push(M),Nn(R,!0)}.bind(null,p):An),p!==M&&(M=p,C===Li&&(Li.env=zn()),es&&(A=Li.env.Promise,g=p.env,(C.global||p.global)&&(Object.defineProperty(s,"Promise",g.PromiseProp),A.all=g.all,A.race=g.race,A.resolve=g.resolve,A.reject=g.reject,g.allSettled&&(A.allSettled=g.allSettled),g.any&&(A.any=g.any))))}function zn(){var p=s.Promise;return es?{Promise:p,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:p.all,race:p.race,allSettled:p.allSettled,any:p.any,resolve:p.resolve,reject:p.reject}:{}}function li(p,g,A,C,R){var L=M;try{return Nn(p,!0),g(A,C,R)}finally{Nn(L,!1)}}function mr(p,g,A,C){return typeof p!="function"?p:function(){var R=M;A&&Pn(),Nn(g,!0);try{return p.apply(this,arguments)}finally{Nn(R,!1),C&&queueMicrotask(pr)}}}function wl(p){Promise===Dn&&He.echoes===0?nn===0?p():enqueueNativeMicroTask(p):setTimeout(p,0)}(""+Cs).indexOf("[native code]")===-1&&(Pn=pr=pt);var In=q.reject,Ta="￿",gr="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",op="String expected.",ts=[],Mh="__dbnames",_l="readonly",Hu="readwrite";function go(p,g){return p?g?function(){return p.apply(this,arguments)&&g.apply(this,arguments)}:p:g}var Wv={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function El(p){return typeof p!="string"||/\./.test(p)?function(g){return g}:function(g){return g[p]===void 0&&p in g&&delete(g=ke(g))[p],g}}function Vv(){throw Ve.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function jt(p,g){try{var A=j(p),C=j(g);if(A!==C)return A==="Array"?1:C==="Array"?-1:A==="binary"?1:C==="binary"?-1:A==="string"?1:C==="string"?-1:A==="Date"?1:C!=="Date"?NaN:-1;switch(A){case"number":case"Date":case"string":return g<p?1:p<g?-1:0;case"binary":return function(R,L){for(var U=R.length,V=L.length,Y=U<V?U:V,Z=0;Z<Y;++Z)if(R[Z]!==L[Z])return R[Z]<L[Z]?-1:1;return U===V?0:U<V?-1:1}(X(p),X(g));case"Array":return function(R,L){for(var U=R.length,V=L.length,Y=U<V?U:V,Z=0;Z<Y;++Z){var oe=jt(R[Z],L[Z]);if(oe!==0)return oe}return U===V?0:U<V?-1:1}(p,g)}}catch{}return NaN}function j(p){var g=typeof p;return g!="object"?g:ArrayBuffer.isView(p)?"binary":(p=ze(p),p==="ArrayBuffer"?"binary":p)}function X(p){return p instanceof Uint8Array?p:ArrayBuffer.isView(p)?new Uint8Array(p.buffer,p.byteOffset,p.byteLength):new Uint8Array(p)}function $(p,g,A){var C=p.schema.yProps;return C?(g&&0<A.numFailures&&(g=g.filter(function(R,L){return!A.failures[L]})),Promise.all(C.map(function(R){return R=R.updatesTable,g?p.db.table(R).where("k").anyOf(g).delete():p.db.table(R).clear()})).then(function(){return A})):A}var ne=(le.prototype.execute=function(p){var g=this["@@propmod"];if(g.add!==void 0){var A=g.add;if(o(A))return r(r([],o(p)?p:[],!0),A).sort();if(typeof A=="number")return(Number(p)||0)+A;if(typeof A=="bigint")try{return BigInt(p)+A}catch{return BigInt(0)+A}throw new TypeError("Invalid term ".concat(A))}if(g.remove!==void 0){var C=g.remove;if(o(C))return o(p)?p.filter(function(R){return!C.includes(R)}).sort():[];if(typeof C=="number")return Number(p)-C;if(typeof C=="bigint")try{return BigInt(p)-C}catch{return BigInt(0)-C}throw new TypeError("Invalid subtrahend ".concat(C))}return A=(A=g.replacePrefix)===null||A===void 0?void 0:A[0],A&&typeof p=="string"&&p.startsWith(A)?g.replacePrefix[1]+p.substring(A.length):p},le);function le(p){this["@@propmod"]=p}function ee(p,g){for(var A=a(g),C=A.length,R=!1,L=0;L<C;++L){var U=A[L],V=g[U],Y=D(p,U);V instanceof ne?(P(p,U,V.execute(Y)),R=!0):Y!==V&&(P(p,U,V),R=!0)}return R}var Re=(Te.prototype._trans=function(p,g,A){var C=this._tx||M.trans,R=this.name,L=ln&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(p==="readonly"?"read":"write"," ").concat(this.name));function U(Z,oe,G){if(!G.schema[R])throw new Ve.NotFound("Table "+R+" not part of transaction");return g(G.idbtrans,G)}var V=B();try{var Y=C&&C.db._novip===this.db._novip?C===M.trans?C._promise(p,U,A):dn(function(){return C._promise(p,U,A)},{trans:C,transless:M.transless||M}):function Z(oe,G,ce,J){if(oe.idbdb&&(oe._state.openComplete||M.letThrough||oe._vip)){var re=oe._createTransaction(G,ce,oe._dbSchema);try{re.create(),oe._state.PR1398_maxLoop=3}catch(se){return se.name===We.InvalidState&&oe.isOpen()&&0<--oe._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),oe.close({disableAutoOpen:!1}),oe.open().then(function(){return Z(oe,G,ce,J)})):In(se)}return re._promise(G,function(se,ue){return dn(function(){return M.trans=re,J(se,ue,re)})}).then(function(se){if(G==="readwrite")try{re.idbtrans.commit()}catch{}return G==="readonly"?se:re._completion.then(function(){return se})})}if(oe._state.openComplete)return In(new Ve.DatabaseClosed(oe._state.dbOpenError));if(!oe._state.isBeingOpened){if(!oe._state.autoOpen)return In(new Ve.DatabaseClosed);oe.open().catch(pt)}return oe._state.dbReadyPromise.then(function(){return Z(oe,G,ce,J)})}(this.db,p,[this.name],U);return L&&(Y._consoleTask=L,Y=Y.catch(function(Z){return console.trace(Z),In(Z)})),Y}finally{V&&K()}},Te.prototype.get=function(p,g){var A=this;return p&&p.constructor===Object?this.where(p).first(g):p==null?In(new Ve.Type("Invalid argument to Table.get()")):this._trans("readonly",function(C){return A.core.get({trans:C,key:p}).then(function(R){return A.hook.reading.fire(R)})}).then(g)},Te.prototype.where=function(p){if(typeof p=="string")return new this.db.WhereClause(this,p);if(o(p))return new this.db.WhereClause(this,"[".concat(p.join("+"),"]"));var g=a(p);if(g.length===1)return this.where(g[0]).equals(p[g[0]]);var A=this.schema.indexes.concat(this.schema.primKey).filter(function(V){if(V.compound&&g.every(function(Z){return 0<=V.keyPath.indexOf(Z)})){for(var Y=0;Y<g.length;++Y)if(g.indexOf(V.keyPath[Y])===-1)return!1;return!0}return!1}).sort(function(V,Y){return V.keyPath.length-Y.keyPath.length})[0];if(A&&this.db._maxKey!==Ta){var L=A.keyPath.slice(0,g.length);return this.where(L).equals(L.map(function(Y){return p[Y]}))}!A&&ln&&console.warn("The query ".concat(JSON.stringify(p)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(g.join("+"),"]"));var C=this.schema.idxByName;function R(V,Y){return jt(V,Y)===0}var U=g.reduce(function(G,Y){var Z=G[0],oe=G[1],G=C[Y],ce=p[Y];return[Z||G,Z||!G?go(oe,G&&G.multi?function(J){return J=D(J,Y),o(J)&&J.some(function(re){return R(ce,re)})}:function(J){return R(ce,D(J,Y))}):oe]},[null,null]),L=U[0],U=U[1];return L?this.where(L.name).equals(p[L.keyPath]).filter(U):A?this.filter(U):this.where(g).equals("")},Te.prototype.filter=function(p){return this.toCollection().and(p)},Te.prototype.count=function(p){return this.toCollection().count(p)},Te.prototype.offset=function(p){return this.toCollection().offset(p)},Te.prototype.limit=function(p){return this.toCollection().limit(p)},Te.prototype.each=function(p){return this.toCollection().each(p)},Te.prototype.toArray=function(p){return this.toCollection().toArray(p)},Te.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Te.prototype.orderBy=function(p){return new this.db.Collection(new this.db.WhereClause(this,o(p)?"[".concat(p.join("+"),"]"):p))},Te.prototype.reverse=function(){return this.toCollection().reverse()},Te.prototype.mapToClass=function(p){var g,A=this.db,C=this.name;function R(){return g!==null&&g.apply(this,arguments)||this}(this.schema.mappedClass=p).prototype instanceof Vv&&(function(Y,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Class extends value "+String(Z)+" is not a constructor or null");function oe(){this.constructor=Y}t(Y,Z),Y.prototype=Z===null?Object.create(Z):(oe.prototype=Z.prototype,new oe)}(R,g=p),Object.defineProperty(R.prototype,"db",{get:function(){return A},enumerable:!1,configurable:!0}),R.prototype.table=function(){return C},p=R);for(var L=new Set,U=p.prototype;U;U=u(U))Object.getOwnPropertyNames(U).forEach(function(Y){return L.add(Y)});function V(Y){if(!Y)return Y;var Z,oe=Object.create(p.prototype);for(Z in Y)if(!L.has(Z))try{oe[Z]=Y[Z]}catch{}return oe}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=V,this.hook("reading",V),p},Te.prototype.defineClass=function(){return this.mapToClass(function(p){l(this,p)})},Te.prototype.add=function(p,g){var A=this,C=this.schema.primKey,R=C.auto,L=C.keyPath,U=p;return L&&R&&(U=El(L)(p)),this._trans("readwrite",function(V){return A.core.mutate({trans:V,type:"add",keys:g!=null?[g]:null,values:[U]})}).then(function(V){return V.numFailures?q.reject(V.failures[0]):V.lastResult}).then(function(V){if(L)try{P(p,L,V)}catch{}return V})},Te.prototype.upsert=function(p,g){var A=this,C=this.schema.primKey.keyPath;return this._trans("readwrite",function(R){return A.core.get({trans:R,key:p}).then(function(L){var U=L??{};return ee(U,g),C&&P(U,C,p),A.core.mutate({trans:R,type:"put",values:[U],keys:[p],upsert:!0,updates:{keys:[p],changeSpecs:[g]}}).then(function(V){return V.numFailures?q.reject(V.failures[0]):!!L})})})},Te.prototype.update=function(p,g){return typeof p!="object"||o(p)?this.where(":id").equals(p).modify(g):(p=D(p,this.schema.primKey.keyPath),p===void 0?In(new Ve.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(p).modify(g))},Te.prototype.put=function(p,g){var A=this,C=this.schema.primKey,R=C.auto,L=C.keyPath,U=p;return L&&R&&(U=El(L)(p)),this._trans("readwrite",function(V){return A.core.mutate({trans:V,type:"put",values:[U],keys:g!=null?[g]:null})}).then(function(V){return V.numFailures?q.reject(V.failures[0]):V.lastResult}).then(function(V){if(L)try{P(p,L,V)}catch{}return V})},Te.prototype.delete=function(p){var g=this;return this._trans("readwrite",function(A){return g.core.mutate({trans:A,type:"delete",keys:[p]}).then(function(C){return $(g,[p],C)}).then(function(C){return C.numFailures?q.reject(C.failures[0]):void 0})})},Te.prototype.clear=function(){var p=this;return this._trans("readwrite",function(g){return p.core.mutate({trans:g,type:"deleteRange",range:Wv}).then(function(A){return $(p,null,A)})}).then(function(g){return g.numFailures?q.reject(g.failures[0]):void 0})},Te.prototype.bulkGet=function(p){var g=this;return this._trans("readonly",function(A){return g.core.getMany({keys:p,trans:A}).then(function(C){return C.map(function(R){return g.hook.reading.fire(R)})})})},Te.prototype.bulkAdd=function(p,g,A){var C=this,R=Array.isArray(g)?g:void 0,L=(A=A||(R?void 0:g))?A.allKeys:void 0;return this._trans("readwrite",function(U){var Z=C.schema.primKey,V=Z.auto,Z=Z.keyPath;if(Z&&R)throw new Ve.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(R&&R.length!==p.length)throw new Ve.InvalidArgument("Arguments objects and keys must have the same length");var Y=p.length,Z=Z&&V?p.map(El(Z)):p;return C.core.mutate({trans:U,type:"add",keys:R,values:Z,wantResults:L}).then(function(re){var G=re.numFailures,ce=re.results,J=re.lastResult,re=re.failures;if(G===0)return L?ce:J;throw new Xe("".concat(C.name,".bulkAdd(): ").concat(G," of ").concat(Y," operations failed"),re)})})},Te.prototype.bulkPut=function(p,g,A){var C=this,R=Array.isArray(g)?g:void 0,L=(A=A||(R?void 0:g))?A.allKeys:void 0;return this._trans("readwrite",function(U){var Z=C.schema.primKey,V=Z.auto,Z=Z.keyPath;if(Z&&R)throw new Ve.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(R&&R.length!==p.length)throw new Ve.InvalidArgument("Arguments objects and keys must have the same length");var Y=p.length,Z=Z&&V?p.map(El(Z)):p;return C.core.mutate({trans:U,type:"put",keys:R,values:Z,wantResults:L}).then(function(re){var G=re.numFailures,ce=re.results,J=re.lastResult,re=re.failures;if(G===0)return L?ce:J;throw new Xe("".concat(C.name,".bulkPut(): ").concat(G," of ").concat(Y," operations failed"),re)})})},Te.prototype.bulkUpdate=function(p){var g=this,A=this.core,C=p.map(function(U){return U.key}),R=p.map(function(U){return U.changes}),L=[];return this._trans("readwrite",function(U){return A.getMany({trans:U,keys:C,cache:"clone"}).then(function(V){var Y=[],Z=[];p.forEach(function(G,ce){var J=G.key,re=G.changes,se=V[ce];if(se){for(var ue=0,fe=Object.keys(re);ue<fe.length;ue++){var ye=fe[ue],Ce=re[ye];if(ye===g.schema.primKey.keyPath){if(jt(Ce,J)!==0)throw new Ve.Constraint("Cannot update primary key in bulkUpdate()")}else P(se,ye,Ce)}L.push(ce),Y.push(J),Z.push(se)}});var oe=Y.length;return A.mutate({trans:U,type:"put",keys:Y,values:Z,updates:{keys:C,changeSpecs:R}}).then(function(G){var ce=G.numFailures,J=G.failures;if(ce===0)return oe;for(var re=0,se=Object.keys(J);re<se.length;re++){var ue,fe=se[re],ye=L[Number(fe)];ye!=null&&(ue=J[fe],delete J[fe],J[ye]=ue)}throw new Xe("".concat(g.name,".bulkUpdate(): ").concat(ce," of ").concat(oe," operations failed"),J)})})})},Te.prototype.bulkDelete=function(p){var g=this,A=p.length;return this._trans("readwrite",function(C){return g.core.mutate({trans:C,type:"delete",keys:p}).then(function(R){return $(g,p,R)})}).then(function(U){var R=U.numFailures,L=U.lastResult,U=U.failures;if(R===0)return L;throw new Xe("".concat(g.name,".bulkDelete(): ").concat(R," of ").concat(A," operations failed"),U)})},Te);function Te(){}function Fe(p){function g(U,V){if(V){for(var Y=arguments.length,Z=new Array(Y-1);--Y;)Z[Y-1]=arguments[Y];return A[U].subscribe.apply(null,Z),p}if(typeof U=="string")return A[U]}var A={};g.addEventType=L;for(var C=1,R=arguments.length;C<R;++C)L(arguments[C]);return g;function L(U,V,Y){if(typeof U!="object"){var Z;V=V||Jr;var oe={subscribers:[],fire:Y=Y||pt,subscribe:function(G){oe.subscribers.indexOf(G)===-1&&(oe.subscribers.push(G),oe.fire=V(oe.fire,G))},unsubscribe:function(G){oe.subscribers=oe.subscribers.filter(function(ce){return ce!==G}),oe.fire=oe.subscribers.reduce(V,Y)}};return A[U]=g[U]=oe}a(Z=U).forEach(function(G){var ce=Z[G];if(o(ce))L(G,Z[G][0],Z[G][1]);else{if(ce!=="asap")throw new Ve.InvalidArgument("Invalid event config");var J=L(G,It,function(){for(var re=arguments.length,se=new Array(re);re--;)se[re]=arguments[re];J.subscribers.forEach(function(ue){S(function(){ue.apply(null,se)})})})}})}}function Be(p,g){return _(g).from({prototype:p}),g}function $e(p,g){return!(p.filter||p.algorithm||p.or)&&(g?p.justLimit:!p.replayFilter)}function ct(p,g){p.filter=go(p.filter,g)}function Et(p,g,A){var C=p.replayFilter;p.replayFilter=C?function(){return go(C(),g())}:g,p.justLimit=A&&!C}function Ut(p,g){if(p.isPrimKey)return g.primaryKey;var A=g.getIndexByKeyPath(p.index);if(!A)throw new Ve.Schema("KeyPath "+p.index+" on object store "+g.name+" is not indexed");return A}function Xt(p,g,A){var C=Ut(p,g.schema);return g.openCursor({trans:A,values:!p.keysOnly,reverse:p.dir==="prev",unique:!!p.unique,query:{index:C,range:p.range}})}function vn(p,g,A,C){var R=p.replayFilter?go(p.filter,p.replayFilter()):p.filter;if(p.or){var L={},U=function(V,Y,Z){var oe,G;R&&!R(Y,Z,function(ce){return Y.stop(ce)},function(ce){return Y.fail(ce)})||((G=""+(oe=Y.primaryKey))=="[object ArrayBuffer]"&&(G=""+new Uint8Array(oe)),d(L,G)||(L[G]=!0,g(V,Y,Z)))};return Promise.all([p.or._iterate(U,A),xn(Xt(p,C,A),p.algorithm,U,!p.keysOnly&&p.valueMapper)])}return xn(Xt(p,C,A),go(p.algorithm,R),g,!p.keysOnly&&p.valueMapper)}function xn(p,g,A,C){var R=Oe(C?function(L,U,V){return A(C(L),U,V)}:A);return p.then(function(L){if(L)return L.start(function(){var U=function(){return L.continue()};g&&!g(L,function(V){return U=V},function(V){L.stop(V),U=pt},function(V){L.fail(V),U=pt})||R(L.value,L,function(V){return U=V}),U()})})}var Lr=(Lt.prototype._read=function(p,g){var A=this._ctx;return A.error?A.table._trans(null,In.bind(null,A.error)):A.table._trans("readonly",p).then(g)},Lt.prototype._write=function(p){var g=this._ctx;return g.error?g.table._trans(null,In.bind(null,g.error)):g.table._trans("readwrite",p,"locked")},Lt.prototype._addAlgorithm=function(p){var g=this._ctx;g.algorithm=go(g.algorithm,p)},Lt.prototype._iterate=function(p,g){return vn(this._ctx,p,g,this._ctx.table.core)},Lt.prototype.clone=function(p){var g=Object.create(this.constructor.prototype),A=Object.create(this._ctx);return p&&l(A,p),g._ctx=A,g},Lt.prototype.raw=function(){return this._ctx.valueMapper=null,this},Lt.prototype.each=function(p){var g=this._ctx;return this._read(function(A){return vn(g,p,A,g.table.core)})},Lt.prototype.count=function(p){var g=this;return this._read(function(A){var C=g._ctx,R=C.table.core;if($e(C,!0))return R.count({trans:A,query:{index:Ut(C,R.schema),range:C.range}}).then(function(U){return Math.min(U,C.limit)});var L=0;return vn(C,function(){return++L,!1},A,R).then(function(){return L})}).then(p)},Lt.prototype.sortBy=function(p,g){var A=p.split(".").reverse(),C=A[0],R=A.length-1;function L(Y,Z){return Z?L(Y[A[Z]],Z-1):Y[C]}var U=this._ctx.dir==="next"?1:-1;function V(Y,Z){return jt(L(Y,R),L(Z,R))*U}return this.toArray(function(Y){return Y.sort(V)}).then(g)},Lt.prototype.toArray=function(p){var g=this;return this._read(function(A){var C=g._ctx;if(C.dir==="next"&&$e(C,!0)&&0<C.limit){var R=C.valueMapper,L=Ut(C,C.table.core.schema);return C.table.core.query({trans:A,limit:C.limit,values:!0,query:{index:L,range:C.range}}).then(function(V){return V=V.result,R?V.map(R):V})}var U=[];return vn(C,function(V){return U.push(V)},A,C.table.core).then(function(){return U})},p)},Lt.prototype.offset=function(p){var g=this._ctx;return p<=0||(g.offset+=p,$e(g)?Et(g,function(){var A=p;return function(C,R){return A===0||(A===1?--A:R(function(){C.advance(A),A=0}),!1)}}):Et(g,function(){var A=p;return function(){return--A<0}})),this},Lt.prototype.limit=function(p){return this._ctx.limit=Math.min(this._ctx.limit,p),Et(this._ctx,function(){var g=p;return function(A,C,R){return--g<=0&&C(R),0<=g}},!0),this},Lt.prototype.until=function(p,g){return ct(this._ctx,function(A,C,R){return!p(A.value)||(C(R),g)}),this},Lt.prototype.first=function(p){return this.limit(1).toArray(function(g){return g[0]}).then(p)},Lt.prototype.last=function(p){return this.reverse().first(p)},Lt.prototype.filter=function(p){var g;return ct(this._ctx,function(A){return p(A.value)}),(g=this._ctx).isMatch=go(g.isMatch,p),this},Lt.prototype.and=function(p){return this.filter(p)},Lt.prototype.or=function(p){return new this.db.WhereClause(this._ctx.table,p,this)},Lt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Lt.prototype.desc=function(){return this.reverse()},Lt.prototype.eachKey=function(p){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(A,C){p(C.key,C)})},Lt.prototype.eachUniqueKey=function(p){return this._ctx.unique="unique",this.eachKey(p)},Lt.prototype.eachPrimaryKey=function(p){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(A,C){p(C.primaryKey,C)})},Lt.prototype.keys=function(p){var g=this._ctx;g.keysOnly=!g.isMatch;var A=[];return this.each(function(C,R){A.push(R.key)}).then(function(){return A}).then(p)},Lt.prototype.primaryKeys=function(p){var g=this._ctx;if(g.dir==="next"&&$e(g,!0)&&0<g.limit)return this._read(function(C){var R=Ut(g,g.table.core.schema);return g.table.core.query({trans:C,values:!1,limit:g.limit,query:{index:R,range:g.range}})}).then(function(C){return C.result}).then(p);g.keysOnly=!g.isMatch;var A=[];return this.each(function(C,R){A.push(R.primaryKey)}).then(function(){return A}).then(p)},Lt.prototype.uniqueKeys=function(p){return this._ctx.unique="unique",this.keys(p)},Lt.prototype.firstKey=function(p){return this.limit(1).keys(function(g){return g[0]}).then(p)},Lt.prototype.lastKey=function(p){return this.reverse().firstKey(p)},Lt.prototype.distinct=function(){var p=this._ctx,p=p.index&&p.table.schema.idxByName[p.index];if(!p||!p.multi)return this;var g={};return ct(this._ctx,function(R){var C=R.primaryKey.toString(),R=d(g,C);return g[C]=!0,!R}),this},Lt.prototype.modify=function(p){var g=this,A=this._ctx;return this._write(function(C){var R=typeof p=="function"?p:function(se){return ee(se,p)},L=A.table.core,Z=L.schema.primaryKey,U=Z.outbound,V=Z.extractKey,Y=200,Z=g.db._options.modifyChunkSize;Z&&(Y=typeof Z=="object"?Z[L.name]||Z["*"]||200:Z);function oe(se,ye){var fe=ye.failures,ye=ye.numFailures;ce+=se-ye;for(var Ce=0,Pe=a(fe);Ce<Pe.length;Ce++){var qe=Pe[Ce];G.push(fe[qe])}}var G=[],ce=0,J=[],re=p===Fh;return g.clone().primaryKeys().then(function(se){function ue(ye){var Ce=Math.min(Y,se.length-ye),Pe=se.slice(ye,ye+Ce);return(re?Promise.resolve([]):L.getMany({trans:C,keys:Pe,cache:"immutable"})).then(function(qe){var Ye=[],Ue=[],Ge=U?[]:null,Qe=re?Pe:[];if(!re)for(var Ke=0;Ke<Ce;++Ke){var st=qe[Ke],At={value:ke(st),primKey:se[ye+Ke]};R.call(At,At.value,At)!==!1&&(At.value==null?Qe.push(se[ye+Ke]):U||jt(V(st),V(At.value))===0?(Ue.push(At.value),U&&Ge.push(se[ye+Ke])):(Qe.push(se[ye+Ke]),Ye.push(At.value)))}return Promise.resolve(0<Ye.length&&L.mutate({trans:C,type:"add",values:Ye}).then(function(Rt){for(var Ot in Rt.failures)Qe.splice(parseInt(Ot),1);oe(Ye.length,Rt)})).then(function(){return(0<Ue.length||fe&&typeof p=="object")&&L.mutate({trans:C,type:"put",keys:Ge,values:Ue,criteria:fe,changeSpec:typeof p!="function"&&p,isAdditionalChunk:0<ye}).then(function(Rt){return oe(Ue.length,Rt)})}).then(function(){return(0<Qe.length||fe&&re)&&L.mutate({trans:C,type:"delete",keys:Qe,criteria:fe,isAdditionalChunk:0<ye}).then(function(Rt){return $(A.table,Qe,Rt)}).then(function(Rt){return oe(Qe.length,Rt)})}).then(function(){return se.length>ye+Ce&&ue(ye+Y)})})}var fe=$e(A)&&A.limit===1/0&&(typeof p!="function"||re)&&{index:A.index,range:A.range};return ue(0).then(function(){if(0<G.length)throw new it("Error modifying one or more objects",G,ce,J);return se.length})})})},Lt.prototype.delete=function(){var p=this._ctx,g=p.range;return!$e(p)||p.table.schema.yProps||!p.isPrimKey&&g.type!==3?this.modify(Fh):this._write(function(A){var C=p.table.core.schema.primaryKey,R=g;return p.table.core.count({trans:A,query:{index:C,range:R}}).then(function(L){return p.table.core.mutate({trans:A,type:"deleteRange",range:R}).then(function(Y){var V=Y.failures,Y=Y.numFailures;if(Y)throw new it("Could not delete some values",Object.keys(V).map(function(Z){return V[Z]}),L-Y);return L-Y})})})},Lt);function Lt(){}var Fh=function(p,g){return g.value=null};function Bw(p,g){return p<g?-1:p===g?0:1}function lp(p,g){return g<p?-1:p===g?0:1}function Or(p,g,A){return p=p instanceof jx?new p.Collection(p):p,p._ctx.error=new(A||TypeError)(g),p}function Al(p){return new p.Collection(p,function(){return Bx("")}).limit(0)}function Bh(p,g,A,C){var R,L,U,V,Y,Z,oe,G=A.length;if(!A.every(function(re){return typeof re=="string"}))return Or(p,op);function ce(re){R=re==="next"?function(ue){return ue.toUpperCase()}:function(ue){return ue.toLowerCase()},L=re==="next"?function(ue){return ue.toLowerCase()}:function(ue){return ue.toUpperCase()},U=re==="next"?Bw:lp;var se=A.map(function(ue){return{lower:L(ue),upper:R(ue)}}).sort(function(ue,fe){return U(ue.lower,fe.lower)});V=se.map(function(ue){return ue.upper}),Y=se.map(function(ue){return ue.lower}),oe=(Z=re)==="next"?"":C}ce("next"),p=new p.Collection(p,function(){return Gs(V[0],Y[G-1]+C)}),p._ondirectionchange=function(re){ce(re)};var J=0;return p._addAlgorithm(function(re,se,ue){var fe=re.key;if(typeof fe!="string")return!1;var ye=L(fe);if(g(ye,Y,J))return!0;for(var Ce=null,Pe=J;Pe<G;++Pe){var qe=function(Ye,Ue,Ge,Qe,Ke,st){for(var At=Math.min(Ye.length,Qe.length),Rt=-1,Ot=0;Ot<At;++Ot){var ns=Ue[Ot];if(ns!==Qe[Ot])return Ke(Ye[Ot],Ge[Ot])<0?Ye.substr(0,Ot)+Ge[Ot]+Ge.substr(Ot+1):Ke(Ye[Ot],Qe[Ot])<0?Ye.substr(0,Ot)+Qe[Ot]+Ge.substr(Ot+1):0<=Rt?Ye.substr(0,Rt)+Ue[Rt]+Ge.substr(Rt+1):null;Ke(Ye[Ot],ns)<0&&(Rt=Ot)}return At<Qe.length&&st==="next"?Ye+Ge.substr(Ye.length):At<Ye.length&&st==="prev"?Ye.substr(0,Ge.length):Rt<0?null:Ye.substr(0,Rt)+Qe[Rt]+Ge.substr(Rt+1)}(fe,ye,V[Pe],Y[Pe],U,Z);qe===null&&Ce===null?J=Pe+1:(Ce===null||0<U(Ce,qe))&&(Ce=qe)}return se(Ce!==null?function(){re.continue(Ce+oe)}:ue),!1}),p}function Gs(p,g,A,C){return{type:2,lower:p,upper:g,lowerOpen:A,upperOpen:C}}function Bx(p){return{type:1,lower:p,upper:p}}var jx=(Object.defineProperty(wi.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),wi.prototype.between=function(p,g,A,C){A=A!==!1,C=C===!0;try{return 0<this._cmp(p,g)||this._cmp(p,g)===0&&(A||C)&&(!A||!C)?Al(this):new this.Collection(this,function(){return Gs(p,g,!A,!C)})}catch{return Or(this,gr)}},wi.prototype.equals=function(p){return p==null?Or(this,gr):new this.Collection(this,function(){return Bx(p)})},wi.prototype.above=function(p){return p==null?Or(this,gr):new this.Collection(this,function(){return Gs(p,void 0,!0)})},wi.prototype.aboveOrEqual=function(p){return p==null?Or(this,gr):new this.Collection(this,function(){return Gs(p,void 0,!1)})},wi.prototype.below=function(p){return p==null?Or(this,gr):new this.Collection(this,function(){return Gs(void 0,p,!1,!0)})},wi.prototype.belowOrEqual=function(p){return p==null?Or(this,gr):new this.Collection(this,function(){return Gs(void 0,p)})},wi.prototype.startsWith=function(p){return typeof p!="string"?Or(this,op):this.between(p,p+Ta,!0,!0)},wi.prototype.startsWithIgnoreCase=function(p){return p===""?this.startsWith(p):Bh(this,function(g,A){return g.indexOf(A[0])===0},[p],Ta)},wi.prototype.equalsIgnoreCase=function(p){return Bh(this,function(g,A){return g===A[0]},[p],"")},wi.prototype.anyOfIgnoreCase=function(){var p=ae.apply(ie,arguments);return p.length===0?Al(this):Bh(this,function(g,A){return A.indexOf(g)!==-1},p,"")},wi.prototype.startsWithAnyOfIgnoreCase=function(){var p=ae.apply(ie,arguments);return p.length===0?Al(this):Bh(this,function(g,A){return A.some(function(C){return g.indexOf(C)===0})},p,Ta)},wi.prototype.anyOf=function(){var p=this,g=ae.apply(ie,arguments),A=this._cmp;try{g.sort(A)}catch{return Or(this,gr)}if(g.length===0)return Al(this);var C=new this.Collection(this,function(){return Gs(g[0],g[g.length-1])});C._ondirectionchange=function(L){A=L==="next"?p._ascending:p._descending,g.sort(A)};var R=0;return C._addAlgorithm(function(L,U,V){for(var Y=L.key;0<A(Y,g[R]);)if(++R===g.length)return U(V),!1;return A(Y,g[R])===0||(U(function(){L.continue(g[R])}),!1)}),C},wi.prototype.notEqual=function(p){return this.inAnyRange([[-1/0,p],[p,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},wi.prototype.noneOf=function(){var p=ae.apply(ie,arguments);if(p.length===0)return new this.Collection(this);try{p.sort(this._ascending)}catch{return Or(this,gr)}var g=p.reduce(function(A,C){return A?A.concat([[A[A.length-1][1],C]]):[[-1/0,C]]},null);return g.push([p[p.length-1],this.db._maxKey]),this.inAnyRange(g,{includeLowers:!1,includeUppers:!1})},wi.prototype.inAnyRange=function(fe,g){var A=this,C=this._cmp,R=this._ascending,L=this._descending,U=this._min,V=this._max;if(fe.length===0)return Al(this);if(!fe.every(function(ye){return ye[0]!==void 0&&ye[1]!==void 0&&R(ye[0],ye[1])<=0}))return Or(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ve.InvalidArgument);var Y=!g||g.includeLowers!==!1,Z=g&&g.includeUppers===!0,oe,G=R;function ce(ye,Ce){return G(ye[0],Ce[0])}try{(oe=fe.reduce(function(ye,Ce){for(var Pe=0,qe=ye.length;Pe<qe;++Pe){var Ye=ye[Pe];if(C(Ce[0],Ye[1])<0&&0<C(Ce[1],Ye[0])){Ye[0]=U(Ye[0],Ce[0]),Ye[1]=V(Ye[1],Ce[1]);break}}return Pe===qe&&ye.push(Ce),ye},[])).sort(ce)}catch{return Or(this,gr)}var J=0,re=Z?function(ye){return 0<R(ye,oe[J][1])}:function(ye){return 0<=R(ye,oe[J][1])},se=Y?function(ye){return 0<L(ye,oe[J][0])}:function(ye){return 0<=L(ye,oe[J][0])},ue=re,fe=new this.Collection(this,function(){return Gs(oe[0][0],oe[oe.length-1][1],!Y,!Z)});return fe._ondirectionchange=function(ye){G=ye==="next"?(ue=re,R):(ue=se,L),oe.sort(ce)},fe._addAlgorithm(function(ye,Ce,Pe){for(var qe,Ye=ye.key;ue(Ye);)if(++J===oe.length)return Ce(Pe),!1;return!re(qe=Ye)&&!se(qe)||(A._cmp(Ye,oe[J][1])===0||A._cmp(Ye,oe[J][0])===0||Ce(function(){G===R?ye.continue(oe[J][0]):ye.continue(oe[J][1])}),!1)}),fe},wi.prototype.startsWithAnyOf=function(){var p=ae.apply(ie,arguments);return p.every(function(g){return typeof g=="string"})?p.length===0?Al(this):this.inAnyRange(p.map(function(g){return[g,g+Ta]})):Or(this,"startsWithAnyOf() only works with strings")},wi);function wi(){}function Da(p){return Oe(function(g){return up(g),p(g.target.error),!1})}function up(p){p.stopPropagation&&p.stopPropagation(),p.preventDefault&&p.preventDefault()}var cp="storagemutated",jw="x-storagemutated-1",xl=Fe(null,cp),GL=(Ra.prototype._lock=function(){return k(!M.global),++this._reculock,this._reculock!==1||M.global||(M.lockOwnerFor=this),this},Ra.prototype._unlock=function(){if(k(!M.global),--this._reculock==0)for(M.global||(M.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var p=this._blockedFuncs.shift();try{li(p[1],p[0])}catch{}}return this},Ra.prototype._locked=function(){return this._reculock&&M.lockOwnerFor!==this},Ra.prototype.create=function(p){var g=this;if(!this.mode)return this;var A=this.db.idbdb,C=this.db._state.dbOpenError;if(k(!this.idbtrans),!p&&!A)switch(C&&C.name){case"DatabaseClosedError":throw new Ve.DatabaseClosed(C);case"MissingAPIError":throw new Ve.MissingAPI(C.message,C);default:throw new Ve.OpenFailed(C)}if(!this.active)throw new Ve.TransactionInactive;return k(this._completion._state===null),(p=this.idbtrans=p||(this.db.core||A).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Oe(function(R){up(R),g._reject(p.error)}),p.onabort=Oe(function(R){up(R),g.active&&g._reject(new Ve.Abort(p.error)),g.active=!1,g.on("abort").fire(R)}),p.oncomplete=Oe(function(){g.active=!1,g._resolve(),"mutatedParts"in p&&xl.storagemutated.fire(p.mutatedParts)}),this},Ra.prototype._promise=function(p,g,A){var C=this;if(p==="readwrite"&&this.mode!=="readwrite")return In(new Ve.ReadOnly("Transaction is readonly"));if(!this.active)return In(new Ve.TransactionInactive);if(this._locked())return new q(function(L,U){C._blockedFuncs.push([function(){C._promise(p,g,A).then(L,U)},M])});if(A)return dn(function(){var L=new q(function(U,V){C._lock();var Y=g(U,V,C);Y&&Y.then&&Y.then(U,V)});return L.finally(function(){return C._unlock()}),L._lib=!0,L});var R=new q(function(L,U){var V=g(L,U,C);V&&V.then&&V.then(L,U)});return R._lib=!0,R},Ra.prototype._root=function(){return this.parent?this.parent._root():this},Ra.prototype.waitFor=function(p){var g,A=this._root(),C=q.resolve(p);A._waitingFor?A._waitingFor=A._waitingFor.then(function(){return C}):(A._waitingFor=C,A._waitingQueue=[],g=A.idbtrans.objectStore(A.storeNames[0]),function L(){for(++A._spinCount;A._waitingQueue.length;)A._waitingQueue.shift()();A._waitingFor&&(g.get(-1/0).onsuccess=L)}());var R=A._waitingFor;return new q(function(L,U){C.then(function(V){return A._waitingQueue.push(Oe(L.bind(null,V)))},function(V){return A._waitingQueue.push(Oe(U.bind(null,V)))}).finally(function(){A._waitingFor===R&&(A._waitingFor=null)})})},Ra.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ve.Abort))},Ra.prototype.table=function(p){var g=this._memoizedTables||(this._memoizedTables={});if(d(g,p))return g[p];var A=this.schema[p];if(!A)throw new Ve.NotFound("Table "+p+" not part of transaction");return A=new this.db.Table(p,A,this),A.core=this.db.core.table(p),g[p]=A},Ra);function Ra(){}function zw(p,g,A,C,R,L,U,V){return{name:p,keyPath:g,unique:A,multi:C,auto:R,compound:L,src:(A&&!U?"&":"")+(C?"*":"")+(R?"++":"")+zx(g),type:V}}function zx(p){return typeof p=="string"?p:p?"["+[].join.call(p,"+")+"]":""}function Uw(p,g,A){return{name:p,primKey:g,indexes:A,mappedClass:null,idxByName:(C=function(R){return[R.name,R]},A.reduce(function(R,L,U){return U=C(L,U),U&&(R[U[0]]=U[1]),R},{}))};var C}var hp=function(p){try{return p.only([[]]),hp=function(){return[[]]},[[]]}catch{return hp=function(){return Ta},Ta}};function $w(p){return p==null?function(){}:typeof p=="string"?(g=p).split(".").length===1?function(A){return A[g]}:function(A){return D(A,g)}:function(A){return D(A,p)};var g}function Ux(p){return[].slice.call(p)}var KL=0;function dp(p){return p==null?":id":typeof p=="string"?p:"[".concat(p.join("+"),"]")}function XL(p,g,Y){function C(ue){if(ue.type===3)return null;if(ue.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var J=ue.lower,re=ue.upper,se=ue.lowerOpen,ue=ue.upperOpen;return J===void 0?re===void 0?null:g.upperBound(re,!!ue):re===void 0?g.lowerBound(J,!!se):g.bound(J,re,!!se,!!ue)}function R(ce){var J,re=ce.name;return{name:re,schema:ce,mutate:function(se){var ue=se.trans,fe=se.type,ye=se.keys,Ce=se.values,Pe=se.range;return new Promise(function(qe,Ye){qe=Oe(qe);var Ue=ue.objectStore(re),Ge=Ue.keyPath==null,Qe=fe==="put"||fe==="add";if(!Qe&&fe!=="delete"&&fe!=="deleteRange")throw new Error("Invalid operation type: "+fe);var Ke,st=(ye||Ce||{length:1}).length;if(ye&&Ce&&ye.length!==Ce.length)throw new Error("Given keys array must have same length as given values array.");if(st===0)return qe({numFailures:0,failures:{},results:[],lastResult:void 0});function At(vr){++ns,up(vr)}var Rt=[],Ot=[],ns=0;if(fe==="deleteRange"){if(Pe.type===4)return qe({numFailures:ns,failures:Ot,results:[],lastResult:void 0});Pe.type===3?Rt.push(Ke=Ue.clear()):Rt.push(Ke=Ue.delete(C(Pe)))}else{var Ge=Qe?Ge?[Ce,ye]:[Ce,null]:[ye,null],_t=Ge[0],Xi=Ge[1];if(Qe)for(var Yi=0;Yi<st;++Yi)Rt.push(Ke=Xi&&Xi[Yi]!==void 0?Ue[fe](_t[Yi],Xi[Yi]):Ue[fe](_t[Yi])),Ke.onerror=At;else for(Yi=0;Yi<st;++Yi)Rt.push(Ke=Ue[fe](_t[Yi])),Ke.onerror=At}function ry(vr){vr=vr.target.result,Rt.forEach(function(Vu,a1){return Vu.error!=null&&(Ot[a1]=Vu.error)}),qe({numFailures:ns,failures:Ot,results:fe==="delete"?ye:Rt.map(function(Vu){return Vu.result}),lastResult:vr})}Ke.onerror=function(vr){At(vr),ry(vr)},Ke.onsuccess=ry})},getMany:function(se){var ue=se.trans,fe=se.keys;return new Promise(function(ye,Ce){ye=Oe(ye);for(var Pe,qe=ue.objectStore(re),Ye=fe.length,Ue=new Array(Ye),Ge=0,Qe=0,Ke=function(Rt){Rt=Rt.target,Ue[Rt._pos]=Rt.result,++Qe===Ge&&ye(Ue)},st=Da(Ce),At=0;At<Ye;++At)fe[At]!=null&&((Pe=qe.get(fe[At]))._pos=At,Pe.onsuccess=Ke,Pe.onerror=st,++Ge);Ge===0&&ye(Ue)})},get:function(se){var ue=se.trans,fe=se.key;return new Promise(function(ye,Ce){ye=Oe(ye);var Pe=ue.objectStore(re).get(fe);Pe.onsuccess=function(qe){return ye(qe.target.result)},Pe.onerror=Da(Ce)})},query:(J=Z,function(se){return new Promise(function(ue,fe){ue=Oe(ue);var ye,Ce,Pe,Ge=se.trans,qe=se.values,Ye=se.limit,Ke=se.query,Ue=Ye===1/0?void 0:Ye,Qe=Ke.index,Ke=Ke.range,Ge=Ge.objectStore(re),Qe=Qe.isPrimaryKey?Ge:Ge.index(Qe.name),Ke=C(Ke);if(Ye===0)return ue({result:[]});J?((Ue=qe?Qe.getAll(Ke,Ue):Qe.getAllKeys(Ke,Ue)).onsuccess=function(st){return ue({result:st.target.result})},Ue.onerror=Da(fe)):(ye=0,Ce=!qe&&"openKeyCursor"in Qe?Qe.openKeyCursor(Ke):Qe.openCursor(Ke),Pe=[],Ce.onsuccess=function(st){var At=Ce.result;return At?(Pe.push(qe?At.value:At.primaryKey),++ye===Ye?ue({result:Pe}):void At.continue()):ue({result:Pe})},Ce.onerror=Da(fe))})}),openCursor:function(se){var ue=se.trans,fe=se.values,ye=se.query,Ce=se.reverse,Pe=se.unique;return new Promise(function(qe,Ye){qe=Oe(qe);var Qe=ye.index,Ue=ye.range,Ge=ue.objectStore(re),Ge=Qe.isPrimaryKey?Ge:Ge.index(Qe.name),Qe=Ce?Pe?"prevunique":"prev":Pe?"nextunique":"next",Ke=!fe&&"openKeyCursor"in Ge?Ge.openKeyCursor(C(Ue),Qe):Ge.openCursor(C(Ue),Qe);Ke.onerror=Da(Ye),Ke.onsuccess=Oe(function(st){var At,Rt,Ot,ns,_t=Ke.result;_t?(_t.___id=++KL,_t.done=!1,At=_t.continue.bind(_t),Rt=(Rt=_t.continuePrimaryKey)&&Rt.bind(_t),Ot=_t.advance.bind(_t),ns=function(){throw new Error("Cursor not stopped")},_t.trans=ue,_t.stop=_t.continue=_t.continuePrimaryKey=_t.advance=function(){throw new Error("Cursor not started")},_t.fail=Oe(Ye),_t.next=function(){var Xi=this,Yi=1;return this.start(function(){return Yi--?Xi.continue():Xi.stop()}).then(function(){return Xi})},_t.start=function(Xi){function Yi(){if(Ke.result)try{Xi()}catch(vr){_t.fail(vr)}else _t.done=!0,_t.start=function(){throw new Error("Cursor behind last entry")},_t.stop()}var ry=new Promise(function(vr,Vu){vr=Oe(vr),Ke.onerror=Da(Vu),_t.fail=Vu,_t.stop=function(a1){_t.stop=_t.continue=_t.continuePrimaryKey=_t.advance=ns,vr(a1)}});return Ke.onsuccess=Oe(function(vr){Ke.onsuccess=Yi,Yi()}),_t.continue=At,_t.continuePrimaryKey=Rt,_t.advance=Ot,Yi(),ry},qe(_t)):qe(null)},Ye)})},count:function(se){var ue=se.query,fe=se.trans,ye=ue.index,Ce=ue.range;return new Promise(function(Pe,qe){var Ye=fe.objectStore(re),Ue=ye.isPrimaryKey?Ye:Ye.index(ye.name),Ye=C(Ce),Ue=Ye?Ue.count(Ye):Ue.count();Ue.onsuccess=Oe(function(Ge){return Pe(Ge.target.result)}),Ue.onerror=Da(qe)})}}}var L,U,V,oe=(U=Y,V=Ux((L=p).objectStoreNames),{schema:{name:L.name,tables:V.map(function(ce){return U.objectStore(ce)}).map(function(ce){var J=ce.keyPath,ue=ce.autoIncrement,re=o(J),se={},ue={name:ce.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:J==null,compound:re,keyPath:J,autoIncrement:ue,unique:!0,extractKey:$w(J)},indexes:Ux(ce.indexNames).map(function(fe){return ce.index(fe)}).map(function(Pe){var ye=Pe.name,Ce=Pe.unique,qe=Pe.multiEntry,Pe=Pe.keyPath,qe={name:ye,compound:o(Pe),keyPath:Pe,unique:Ce,multiEntry:qe,extractKey:$w(Pe)};return se[dp(Pe)]=qe}),getIndexByKeyPath:function(fe){return se[dp(fe)]}};return se[":id"]=ue.primaryKey,J!=null&&(se[dp(J)]=ue.primaryKey),ue})},hasGetAll:0<V.length&&"getAll"in U.objectStore(V[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Y=oe.schema,Z=oe.hasGetAll,oe=Y.tables.map(R),G={};return oe.forEach(function(ce){return G[ce.name]=ce}),{stack:"dbcore",transaction:p.transaction.bind(p),table:function(ce){if(!G[ce])throw new Error("Table '".concat(ce,"' not found"));return G[ce]},MIN_KEY:-1/0,MAX_KEY:hp(g),schema:Y}}function YL(p,g,A,C){var R=A.IDBKeyRange;return A.indexedDB,{dbcore:(C=XL(g,R,C),p.dbcore.reduce(function(L,U){return U=U.create,i(i({},L),U(L))},C))}}function Gv(p,C){var A=C.db,C=YL(p._middlewares,A,p._deps,C);p.core=C.dbcore,p.tables.forEach(function(R){var L=R.name;p.core.schema.tables.some(function(U){return U.name===L})&&(R.core=p.core.table(L),p[L]instanceof p.Table&&(p[L].core=R.core))})}function Kv(p,g,A,C){A.forEach(function(R){var L=C[R];g.forEach(function(U){var V=function Y(Z,oe){return w(Z,oe)||(Z=u(Z))&&Y(Z,oe)}(U,R);(!V||"value"in V&&V.value===void 0)&&(U===p.Transaction.prototype||U instanceof p.Transaction?b(U,R,{get:function(){return this.table(R)},set:function(Y){m(this,R,{value:Y,writable:!0,configurable:!0,enumerable:!0})}}):U[R]=new p.Table(R,L))})})}function Hw(p,g){g.forEach(function(A){for(var C in A)A[C]instanceof p.Table&&delete A[C]})}function QL(p,g){return p._cfg.version-g._cfg.version}function ZL(p,g,A,C){var R=p._dbSchema;A.objectStoreNames.contains("$meta")&&!R.$meta&&(R.$meta=Uw("$meta",Hx("")[0],[]),p._storeNames.push("$meta"));var L=p._createTransaction("readwrite",p._storeNames,R);L.create(A),L._completion.catch(C);var U=L._reject.bind(L),V=M.transless||M;dn(function(){return M.trans=L,M.transless=V,g!==0?(Gv(p,A),Z=g,((Y=L).storeNames.includes("$meta")?Y.table("$meta").get("version").then(function(oe){return oe??Z}):q.resolve(Z)).then(function(oe){return ce=oe,J=L,re=A,se=[],oe=(G=p)._versions,ue=G._dbSchema=Yv(0,G.idbdb,re),(oe=oe.filter(function(fe){return fe._cfg.version>=ce})).length!==0?(oe.forEach(function(fe){se.push(function(){var ye=ue,Ce=fe._cfg.dbschema;Qv(G,ye,re),Qv(G,Ce,re),ue=G._dbSchema=Ce;var Pe=qw(ye,Ce);Pe.add.forEach(function(Qe){Ww(re,Qe[0],Qe[1].primKey,Qe[1].indexes)}),Pe.change.forEach(function(Qe){if(Qe.recreate)throw new Ve.Upgrade("Not yet support for changing primary key");var Ke=re.objectStore(Qe.name);Qe.add.forEach(function(st){return Xv(Ke,st)}),Qe.change.forEach(function(st){Ke.deleteIndex(st.name),Xv(Ke,st)}),Qe.del.forEach(function(st){return Ke.deleteIndex(st)})});var qe=fe._cfg.contentUpgrade;if(qe&&fe._cfg.version>ce){Gv(G,re),J._memoizedTables={};var Ye=F(Ce);Pe.del.forEach(function(Qe){Ye[Qe]=ye[Qe]}),Hw(G,[G.Transaction.prototype]),Kv(G,[G.Transaction.prototype],a(Ye),Ye),J.schema=Ye;var Ue,Ge=me(qe);return Ge&&Pn(),Pe=q.follow(function(){var Qe;(Ue=qe(J))&&Ge&&(Qe=pr.bind(null,null),Ue.then(Qe,Qe))}),Ue&&typeof Ue.then=="function"?q.resolve(Ue):Pe.then(function(){return Ue})}}),se.push(function(ye){var Ce,Pe,qe=fe._cfg.dbschema;Ce=qe,Pe=ye,[].slice.call(Pe.db.objectStoreNames).forEach(function(Ye){return Ce[Ye]==null&&Pe.db.deleteObjectStore(Ye)}),Hw(G,[G.Transaction.prototype]),Kv(G,[G.Transaction.prototype],G._storeNames,G._dbSchema),J.schema=G._dbSchema}),se.push(function(ye){G.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(G.idbdb.version/10)===fe._cfg.version?(G.idbdb.deleteObjectStore("$meta"),delete G._dbSchema.$meta,G._storeNames=G._storeNames.filter(function(Ce){return Ce!=="$meta"})):ye.objectStore("$meta").put(fe._cfg.version,"version"))})}),function fe(){return se.length?q.resolve(se.shift()(J.idbtrans)).then(fe):q.resolve()}().then(function(){$x(ue,re)})):q.resolve();var G,ce,J,re,se,ue}).catch(U)):(a(R).forEach(function(oe){Ww(A,oe,R[oe].primKey,R[oe].indexes)}),Gv(p,A),void q.follow(function(){return p.on.populate.fire(L)}).catch(U));var Y,Z})}function JL(p,g){$x(p._dbSchema,g),g.db.version%10!=0||g.objectStoreNames.contains("$meta")||g.db.createObjectStore("$meta").add(Math.ceil(g.db.version/10-1),"version");var A=Yv(0,p.idbdb,g);Qv(p,p._dbSchema,g);for(var C=0,R=qw(A,p._dbSchema).change;C<R.length;C++){var L=function(U){if(U.change.length||U.recreate)return console.warn("Unable to patch indexes of table ".concat(U.name," because it has changes on the type of index or primary key.")),{value:void 0};var V=g.objectStore(U.name);U.add.forEach(function(Y){ln&&console.debug("Dexie upgrade patch: Creating missing index ".concat(U.name,".").concat(Y.src)),Xv(V,Y)})}(R[C]);if(typeof L=="object")return L.value}}function qw(p,g){var A,C={del:[],add:[],change:[]};for(A in p)g[A]||C.del.push(A);for(A in g){var R=p[A],L=g[A];if(R){var U={name:A,def:L,recreate:!1,del:[],add:[],change:[]};if(""+(R.primKey.keyPath||"")!=""+(L.primKey.keyPath||"")||R.primKey.auto!==L.primKey.auto)U.recreate=!0,C.change.push(U);else{var V=R.idxByName,Y=L.idxByName,Z=void 0;for(Z in V)Y[Z]||U.del.push(Z);for(Z in Y){var oe=V[Z],G=Y[Z];oe?oe.src!==G.src&&U.change.push(G):U.add.push(G)}(0<U.del.length||0<U.add.length||0<U.change.length)&&C.change.push(U)}}else C.add.push([A,L])}return C}function Ww(p,g,A,C){var R=p.db.createObjectStore(g,A.keyPath?{keyPath:A.keyPath,autoIncrement:A.auto}:{autoIncrement:A.auto});return C.forEach(function(L){return Xv(R,L)}),R}function $x(p,g){a(p).forEach(function(A){g.db.objectStoreNames.contains(A)||(ln&&console.debug("Dexie: Creating missing table",A),Ww(g,A,p[A].primKey,p[A].indexes))})}function Xv(p,g){p.createIndex(g.name,g.keyPath,{unique:g.unique,multiEntry:g.multi})}function Yv(p,g,A){var C={};return y(g.objectStoreNames,0).forEach(function(R){for(var L=A.objectStore(R),U=zw(zx(Z=L.keyPath),Z||"",!0,!1,!!L.autoIncrement,Z&&typeof Z!="string",!0),V=[],Y=0;Y<L.indexNames.length;++Y){var oe=L.index(L.indexNames[Y]),Z=oe.keyPath,oe=zw(oe.name,Z,!!oe.unique,!!oe.multiEntry,!1,Z&&typeof Z!="string",!1);V.push(oe)}C[R]=Uw(R,U,V)}),C}function Qv(p,g,A){for(var C=A.db.objectStoreNames,R=0;R<C.length;++R){var L=C[R],U=A.objectStore(L);p._hasGetAll="getAll"in U;for(var V=0;V<U.indexNames.length;++V){var Y=U.indexNames[V],Z=U.index(Y).keyPath,oe=typeof Z=="string"?Z:"["+y(Z).join("+")+"]";!g[L]||(Z=g[L].idxByName[oe])&&(Z.name=Y,delete g[L].idxByName[oe],g[L].idxByName[Y]=Z)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(p._hasGetAll=!1)}function Hx(p){return p.split(",").map(function(g,A){var L=g.split(":"),C=(R=L[1])===null||R===void 0?void 0:R.trim(),R=(g=L[0].trim()).replace(/([&*]|\+\+)/g,""),L=/^\[/.test(R)?R.match(/^\[(.*)\]$/)[1].split("+"):R;return zw(R,L||null,/\&/.test(g),/\*/.test(g),/\+\+/.test(g),o(L),A===0,C)})}var eO=(jh.prototype._createTableSchema=Uw,jh.prototype._parseIndexSyntax=Hx,jh.prototype._parseStoresSpec=function(p,g){var A=this;a(p).forEach(function(C){if(p[C]!==null){var R=A._parseIndexSyntax(p[C]),L=R.shift();if(!L)throw new Ve.Schema("Invalid schema for table "+C+": "+p[C]);if(L.unique=!0,L.multi)throw new Ve.Schema("Primary key cannot be multiEntry*");R.forEach(function(U){if(U.auto)throw new Ve.Schema("Only primary key can be marked as autoIncrement (++)");if(!U.keyPath)throw new Ve.Schema("Index must have a name and cannot be an empty string")}),R=A._createTableSchema(C,L,R),g[C]=R}})},jh.prototype.stores=function(A){var g=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,A):A;var A=g._versions,C={},R={};return A.forEach(function(L){l(C,L._cfg.storesSource),R=L._cfg.dbschema={},L._parseStoresSpec(C,R)}),g._dbSchema=R,Hw(g,[g._allTables,g,g.Transaction.prototype]),Kv(g,[g._allTables,g,g.Transaction.prototype,this._cfg.tables],a(R),R),g._storeNames=a(R),this},jh.prototype.upgrade=function(p){return this._cfg.contentUpgrade=ti(this._cfg.contentUpgrade||pt,p),this},jh);function jh(){}function Vw(p,g){var A=p._dbNamesDB;return A||(A=p._dbNamesDB=new vo(Mh,{addons:[],indexedDB:p,IDBKeyRange:g})).version(1).stores({dbnames:"name"}),A.table("dbnames")}function Gw(p){return p&&typeof p.databases=="function"}function Kw(p){return dn(function(){return M.letThrough=!0,p()})}function Xw(p){return!("from"in p)}var Ki=function(p,g){if(!this){var A=new Ki;return p&&"d"in p&&l(A,p),A}l(this,arguments.length?{d:1,from:p,to:1<arguments.length?g:p}:{d:0})};function fp(p,g,A){var C=jt(g,A);if(!isNaN(C)){if(0<C)throw RangeError();if(Xw(p))return l(p,{from:g,to:A,d:1});var R=p.l,C=p.r;if(jt(A,p.from)<0)return R?fp(R,g,A):p.l={from:g,to:A,d:1,l:null,r:null},Wx(p);if(0<jt(g,p.to))return C?fp(C,g,A):p.r={from:g,to:A,d:1,l:null,r:null},Wx(p);jt(g,p.from)<0&&(p.from=g,p.l=null,p.d=C?C.d+1:1),0<jt(A,p.to)&&(p.to=A,p.r=null,p.d=p.l?p.l.d+1:1),A=!p.r,R&&!p.l&&pp(p,R),C&&A&&pp(p,C)}}function pp(p,g){Xw(g)||function A(C,Y){var L=Y.from,U=Y.to,V=Y.l,Y=Y.r;fp(C,L,U),V&&A(C,V),Y&&A(C,Y)}(p,g)}function qx(p,g){var A=Zv(g),C=A.next();if(C.done)return!1;for(var R=C.value,L=Zv(p),U=L.next(R.from),V=U.value;!C.done&&!U.done;){if(jt(V.from,R.to)<=0&&0<=jt(V.to,R.from))return!0;jt(R.from,V.from)<0?R=(C=A.next(V.from)).value:V=(U=L.next(R.from)).value}return!1}function Zv(p){var g=Xw(p)?null:{s:0,n:p};return{next:function(A){for(var C=0<arguments.length;g;)switch(g.s){case 0:if(g.s=1,C)for(;g.n.l&&jt(A,g.n.from)<0;)g={up:g,n:g.n.l,s:1};else for(;g.n.l;)g={up:g,n:g.n.l,s:1};case 1:if(g.s=2,!C||jt(A,g.n.to)<=0)return{value:g.n,done:!1};case 2:if(g.n.r){g.s=3,g={up:g,n:g.n.r,s:0};continue}case 3:g=g.up}return{done:!0}}}}function Wx(p){var g,A,C=(((g=p.r)===null||g===void 0?void 0:g.d)||0)-(((A=p.l)===null||A===void 0?void 0:A.d)||0),R=1<C?"r":C<-1?"l":"";R&&(g=R=="r"?"l":"r",A=i({},p),C=p[R],p.from=C.from,p.to=C.to,p[R]=C[R],A[R]=C[g],(p[g]=A).d=Vx(A)),p.d=Vx(p)}function Vx(A){var g=A.r,A=A.l;return(g?A?Math.max(g.d,A.d):g.d:A?A.d:0)+1}function Jv(p,g){return a(g).forEach(function(A){p[A]?pp(p[A],g[A]):p[A]=function C(R){var L,U,V={};for(L in R)d(R,L)&&(U=R[L],V[L]=!U||typeof U!="object"||te.has(U.constructor)?U:C(U));return V}(g[A])}),p}function Yw(p,g){return p.all||g.all||Object.keys(p).some(function(A){return g[A]&&qx(g[A],p[A])})}f(Ki.prototype,((Cs={add:function(p){return pp(this,p),this},addKey:function(p){return fp(this,p,p),this},addKeys:function(p){var g=this;return p.forEach(function(A){return fp(g,A,A)}),this},hasKey:function(p){var g=Zv(this).next(p).value;return g&&jt(g.from,p)<=0&&0<=jt(g.to,p)}})[ve]=function(){return Zv(this)},Cs));var qu={},Qw={},Zw=!1;function ey(p){Jv(Qw,p),Zw||(Zw=!0,setTimeout(function(){Zw=!1,Jw(Qw,!(Qw={}))},0))}function Jw(p,g){g===void 0&&(g=!1);var A=new Set;if(p.all)for(var C=0,R=Object.values(qu);C<R.length;C++)Gx(U=R[C],p,A,g);else for(var L in p){var U,V=/^idb\:\/\/(.*)\/(.*)\//.exec(L);V&&(L=V[1],V=V[2],(U=qu["idb://".concat(L,"/").concat(V)])&&Gx(U,p,A,g))}A.forEach(function(Y){return Y()})}function Gx(p,g,A,C){for(var R=[],L=0,U=Object.entries(p.queries.query);L<U.length;L++){for(var V=U[L],Y=V[0],Z=[],oe=0,G=V[1];oe<G.length;oe++){var ce=G[oe];Yw(g,ce.obsSet)?ce.subscribers.forEach(function(ue){return A.add(ue)}):C&&Z.push(ce)}C&&R.push([Y,Z])}if(C)for(var J=0,re=R;J<re.length;J++){var se=re[J],Y=se[0],Z=se[1];p.queries.query[Y]=Z}}function tO(p){var g=p._state,A=p._deps.indexedDB;if(g.isBeingOpened||p.idbdb)return g.dbReadyPromise.then(function(){return g.dbOpenError?In(g.dbOpenError):p});g.isBeingOpened=!0,g.dbOpenError=null,g.openComplete=!1;var C=g.openCanceller,R=Math.round(10*p.verno),L=!1;function U(){if(g.openCanceller!==C)throw new Ve.DatabaseClosed("db.open() was cancelled")}function V(){return new q(function(ce,J){if(U(),!A)throw new Ve.MissingAPI;var re=p.name,se=g.autoSchema||!R?A.open(re):A.open(re,R);if(!se)throw new Ve.MissingAPI;se.onerror=Da(J),se.onblocked=Oe(p._fireOnBlocked),se.onupgradeneeded=Oe(function(ue){var fe;oe=se.transaction,g.autoSchema&&!p._options.allowEmptyDB?(se.onerror=up,oe.abort(),se.result.close(),(fe=A.deleteDatabase(re)).onsuccess=fe.onerror=Oe(function(){J(new Ve.NoSuchDatabase("Database ".concat(re," doesnt exist")))})):(oe.onerror=Da(J),ue=ue.oldVersion>Math.pow(2,62)?0:ue.oldVersion,G=ue<1,p.idbdb=se.result,L&&JL(p,oe),ZL(p,ue/10,oe,J))},J),se.onsuccess=Oe(function(){oe=null;var ue,fe,ye,Ce,Pe,qe=p.idbdb=se.result,Ye=y(qe.objectStoreNames);if(0<Ye.length)try{var Ue=qe.transaction((Ce=Ye).length===1?Ce[0]:Ce,"readonly");if(g.autoSchema)fe=qe,ye=Ue,(ue=p).verno=fe.version/10,ye=ue._dbSchema=Yv(0,fe,ye),ue._storeNames=y(fe.objectStoreNames,0),Kv(ue,[ue._allTables],a(ye),ye);else if(Qv(p,p._dbSchema,Ue),((Pe=qw(Yv(0,(Pe=p).idbdb,Ue),Pe._dbSchema)).add.length||Pe.change.some(function(Ge){return Ge.add.length||Ge.change.length}))&&!L)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),qe.close(),R=qe.version+1,L=!0,ce(V());Gv(p,Ue)}catch{}ts.push(p),qe.onversionchange=Oe(function(Ge){g.vcFired=!0,p.on("versionchange").fire(Ge)}),qe.onclose=Oe(function(){p.close({disableAutoOpen:!1})}),G&&(Pe=p._deps,Ue=re,qe=Pe.indexedDB,Pe=Pe.IDBKeyRange,Gw(qe)||Ue===Mh||Vw(qe,Pe).put({name:Ue}).catch(pt)),ce()},J)}).catch(function(ce){switch(ce?.name){case"UnknownError":if(0<g.PR1398_maxLoop)return g.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),V();break;case"VersionError":if(0<R)return R=0,V()}return q.reject(ce)})}var Y,Z=g.dbReadyResolve,oe=null,G=!1;return q.race([C,(typeof navigator>"u"?q.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ce){function J(){return indexedDB.databases().finally(ce)}Y=setInterval(J,100),J()}).finally(function(){return clearInterval(Y)}):Promise.resolve()).then(V)]).then(function(){return U(),g.onReadyBeingFired=[],q.resolve(Kw(function(){return p.on.ready.fire(p.vip)})).then(function ce(){if(0<g.onReadyBeingFired.length){var J=g.onReadyBeingFired.reduce(ti,pt);return g.onReadyBeingFired=[],q.resolve(Kw(function(){return J(p.vip)})).then(ce)}})}).finally(function(){g.openCanceller===C&&(g.onReadyBeingFired=null,g.isBeingOpened=!1)}).catch(function(ce){g.dbOpenError=ce;try{oe&&oe.abort()}catch{}return C===g.openCanceller&&p._close(),In(ce)}).finally(function(){g.openComplete=!0,Z()}).then(function(){var ce;return G&&(ce={},p.tables.forEach(function(J){J.schema.indexes.forEach(function(re){re.name&&(ce["idb://".concat(p.name,"/").concat(J.name,"/").concat(re.name)]=new Ki(-1/0,[[[]]]))}),ce["idb://".concat(p.name,"/").concat(J.name,"/")]=ce["idb://".concat(p.name,"/").concat(J.name,"/:dels")]=new Ki(-1/0,[[[]]])}),xl(cp).fire(ce),Jw(ce,!0)),p})}function e1(p){function g(L){return p.next(L)}var A=R(g),C=R(function(L){return p.throw(L)});function R(L){return function(Y){var V=L(Y),Y=V.value;return V.done?Y:Y&&typeof Y.then=="function"?Y.then(A,C):o(Y)?Promise.all(Y).then(A,C):A(Y)}}return R(g)()}function ty(p,g,A){for(var C=o(p)?p.slice():[p],R=0;R<A;++R)C.push(g);return C}var nO={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(p){return i(i({},p),{table:function(g){var A=p.table(g),C=A.schema,R={},L=[];function U(G,ce,J){var re=dp(G),se=R[re]=R[re]||[],ue=G==null?0:typeof G=="string"?1:G.length,fe=0<ce,fe=i(i({},J),{name:fe?"".concat(re,"(virtual-from:").concat(J.name,")"):J.name,lowLevelIndex:J,isVirtual:fe,keyTail:ce,keyLength:ue,extractKey:$w(G),unique:!fe&&J.unique});return se.push(fe),fe.isPrimaryKey||L.push(fe),1<ue&&U(ue===2?G[0]:G.slice(0,ue-1),ce+1,J),se.sort(function(ye,Ce){return ye.keyTail-Ce.keyTail}),fe}g=U(C.primaryKey.keyPath,0,C.primaryKey),R[":id"]=[g];for(var V=0,Y=C.indexes;V<Y.length;V++){var Z=Y[V];U(Z.keyPath,0,Z)}function oe(G){var ce,J=G.query.index;return J.isVirtual?i(i({},G),{query:{index:J.lowLevelIndex,range:(ce=G.query.range,J=J.keyTail,{type:ce.type===1?2:ce.type,lower:ty(ce.lower,ce.lowerOpen?p.MAX_KEY:p.MIN_KEY,J),lowerOpen:!0,upper:ty(ce.upper,ce.upperOpen?p.MIN_KEY:p.MAX_KEY,J),upperOpen:!0})}}):G}return i(i({},A),{schema:i(i({},C),{primaryKey:g,indexes:L,getIndexByKeyPath:function(G){return(G=R[dp(G)])&&G[0]}}),count:function(G){return A.count(oe(G))},query:function(G){return A.query(oe(G))},openCursor:function(G){var ce=G.query.index,J=ce.keyTail,re=ce.isVirtual,se=ce.keyLength;return re?A.openCursor(oe(G)).then(function(fe){return fe&&ue(fe)}):A.openCursor(G);function ue(fe){return Object.create(fe,{continue:{value:function(ye){ye!=null?fe.continue(ty(ye,G.reverse?p.MAX_KEY:p.MIN_KEY,J)):G.unique?fe.continue(fe.key.slice(0,se).concat(G.reverse?p.MIN_KEY:p.MAX_KEY,J)):fe.continue()}},continuePrimaryKey:{value:function(ye,Ce){fe.continuePrimaryKey(ty(ye,p.MAX_KEY,J),Ce)}},primaryKey:{get:function(){return fe.primaryKey}},key:{get:function(){var ye=fe.key;return se===1?ye[0]:ye.slice(0,se)}},value:{get:function(){return fe.value}}})}}})}})}};function t1(p,g,A,C){return A=A||{},C=C||"",a(p).forEach(function(R){var L,U,V;d(g,R)?(L=p[R],U=g[R],typeof L=="object"&&typeof U=="object"&&L&&U?(V=ze(L))!==ze(U)?A[C+R]=g[R]:V==="Object"?t1(L,U,A,C+R+"."):L!==U&&(A[C+R]=g[R]):L!==U&&(A[C+R]=g[R])):A[C+R]=void 0}),a(g).forEach(function(R){d(p,R)||(A[C+R]=g[R])}),A}function n1(p,g){return g.type==="delete"?g.keys:g.keys||g.values.map(p.extractKey)}var iO={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(p){return i(i({},p),{table:function(g){var A=p.table(g),C=A.schema.primaryKey;return i(i({},A),{mutate:function(R){var L=M.trans,U=L.table(g).hook,V=U.deleting,Y=U.creating,Z=U.updating;switch(R.type){case"add":if(Y.fire===pt)break;return L._promise("readwrite",function(){return oe(R)},!0);case"put":if(Y.fire===pt&&Z.fire===pt)break;return L._promise("readwrite",function(){return oe(R)},!0);case"delete":if(V.fire===pt)break;return L._promise("readwrite",function(){return oe(R)},!0);case"deleteRange":if(V.fire===pt)break;return L._promise("readwrite",function(){return function G(ce,J,re){return A.query({trans:ce,values:!1,query:{index:C,range:J},limit:re}).then(function(se){var ue=se.result;return oe({type:"delete",keys:ue,trans:ce}).then(function(fe){return 0<fe.numFailures?Promise.reject(fe.failures[0]):ue.length<re?{failures:[],numFailures:0,lastResult:void 0}:G(ce,i(i({},J),{lower:ue[ue.length-1],lowerOpen:!0}),re)})})}(R.trans,R.range,1e4)},!0)}return A.mutate(R);function oe(G){var ce,J,re,se=M.trans,ue=G.keys||n1(C,G);if(!ue)throw new Error("Keys missing");return(G=G.type==="add"||G.type==="put"?i(i({},G),{keys:ue}):i({},G)).type!=="delete"&&(G.values=r([],G.values)),G.keys&&(G.keys=r([],G.keys)),ce=A,re=ue,((J=G).type==="add"?Promise.resolve([]):ce.getMany({trans:J.trans,keys:re,cache:"immutable"})).then(function(fe){var ye=ue.map(function(Ce,Pe){var qe,Ye,Ue,Ge=fe[Pe],Qe={onerror:null,onsuccess:null};return G.type==="delete"?V.fire.call(Qe,Ce,Ge,se):G.type==="add"||Ge===void 0?(qe=Y.fire.call(Qe,Ce,G.values[Pe],se),Ce==null&&qe!=null&&(G.keys[Pe]=Ce=qe,C.outbound||P(G.values[Pe],C.keyPath,Ce))):(qe=t1(Ge,G.values[Pe]),(Ye=Z.fire.call(Qe,qe,Ce,Ge,se))&&(Ue=G.values[Pe],Object.keys(Ye).forEach(function(Ke){d(Ue,Ke)?Ue[Ke]=Ye[Ke]:P(Ue,Ke,Ye[Ke])}))),Qe});return A.mutate(G).then(function(Ce){for(var Pe=Ce.failures,qe=Ce.results,Ye=Ce.numFailures,Ce=Ce.lastResult,Ue=0;Ue<ue.length;++Ue){var Ge=(qe||ue)[Ue],Qe=ye[Ue];Ge==null?Qe.onerror&&Qe.onerror(Pe[Ue]):Qe.onsuccess&&Qe.onsuccess(G.type==="put"&&fe[Ue]?G.values[Ue]:Ge)}return{failures:Pe,results:qe,numFailures:Ye,lastResult:Ce}}).catch(function(Ce){return ye.forEach(function(Pe){return Pe.onerror&&Pe.onerror(Ce)}),Promise.reject(Ce)})})}}})}})}};function Kx(p,g,A){try{if(!g||g.keys.length<p.length)return null;for(var C=[],R=0,L=0;R<g.keys.length&&L<p.length;++R)jt(g.keys[R],p[L])===0&&(C.push(A?ke(g.values[R]):g.values[R]),++L);return C.length===p.length?C:null}catch{return null}}var rO={stack:"dbcore",level:-1,create:function(p){return{table:function(g){var A=p.table(g);return i(i({},A),{getMany:function(C){if(!C.cache)return A.getMany(C);var R=Kx(C.keys,C.trans._cache,C.cache==="clone");return R?q.resolve(R):A.getMany(C).then(function(L){return C.trans._cache={keys:C.keys,values:C.cache==="clone"?ke(L):L},L})},mutate:function(C){return C.type!=="add"&&(C.trans._cache=null),A.mutate(C)}})}}}};function Xx(p,g){return p.trans.mode==="readonly"&&!!p.subscr&&!p.trans.explicit&&p.trans.db._options.cache!=="disabled"&&!g.schema.primaryKey.outbound}function Yx(p,g){switch(p){case"query":return g.values&&!g.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var sO={stack:"dbcore",level:0,name:"Observability",create:function(p){var g=p.schema.name,A=new Ki(p.MIN_KEY,p.MAX_KEY);return i(i({},p),{transaction:function(C,R,L){if(M.subscr&&R!=="readonly")throw new Ve.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(M.querier));return p.transaction(C,R,L)},table:function(C){var R=p.table(C),L=R.schema,U=L.primaryKey,G=L.indexes,V=U.extractKey,Y=U.outbound,Z=U.autoIncrement&&G.filter(function(J){return J.compound&&J.keyPath.includes(U.keyPath)}),oe=i(i({},R),{mutate:function(J){function re(Ke){return Ke="idb://".concat(g,"/").concat(C,"/").concat(Ke),Ce[Ke]||(Ce[Ke]=new Ki)}var se,ue,fe,ye=J.trans,Ce=J.mutatedParts||(J.mutatedParts={}),Pe=re(""),qe=re(":dels"),Ye=J.type,Qe=J.type==="deleteRange"?[J.range]:J.type==="delete"?[J.keys]:J.values.length<50?[n1(U,J).filter(function(Ke){return Ke}),J.values]:[],Ue=Qe[0],Ge=Qe[1],Qe=J.trans._cache;return o(Ue)?(Pe.addKeys(Ue),(Qe=Ye==="delete"||Ue.length===Ge.length?Kx(Ue,Qe):null)||qe.addKeys(Ue),(Qe||Ge)&&(se=re,ue=Qe,fe=Ge,L.indexes.forEach(function(Ke){var st=se(Ke.name||"");function At(Ot){return Ot!=null?Ke.extractKey(Ot):null}function Rt(Ot){return Ke.multiEntry&&o(Ot)?Ot.forEach(function(ns){return st.addKey(ns)}):st.addKey(Ot)}(ue||fe).forEach(function(Ot,Xi){var _t=ue&&At(ue[Xi]),Xi=fe&&At(fe[Xi]);jt(_t,Xi)!==0&&(_t!=null&&Rt(_t),Xi!=null&&Rt(Xi))})}))):Ue?(Ge={from:(Ge=Ue.lower)!==null&&Ge!==void 0?Ge:p.MIN_KEY,to:(Ge=Ue.upper)!==null&&Ge!==void 0?Ge:p.MAX_KEY},qe.add(Ge),Pe.add(Ge)):(Pe.add(A),qe.add(A),L.indexes.forEach(function(Ke){return re(Ke.name).add(A)})),R.mutate(J).then(function(Ke){return!Ue||J.type!=="add"&&J.type!=="put"||(Pe.addKeys(Ke.results),Z&&Z.forEach(function(st){for(var At=J.values.map(function(_t){return st.extractKey(_t)}),Rt=st.keyPath.findIndex(function(_t){return _t===U.keyPath}),Ot=0,ns=Ke.results.length;Ot<ns;++Ot)At[Ot][Rt]=Ke.results[Ot];re(st.name).addKeys(At)})),ye.mutatedParts=Jv(ye.mutatedParts||{},Ce),Ke})}}),G=function(re){var se=re.query,re=se.index,se=se.range;return[re,new Ki((re=se.lower)!==null&&re!==void 0?re:p.MIN_KEY,(se=se.upper)!==null&&se!==void 0?se:p.MAX_KEY)]},ce={get:function(J){return[U,new Ki(J.key)]},getMany:function(J){return[U,new Ki().addKeys(J.keys)]},count:G,query:G,openCursor:G};return a(ce).forEach(function(J){oe[J]=function(re){var se=M.subscr,ue=!!se,fe=Xx(M,R)&&Yx(J,re)?re.obsSet={}:se;if(ue){var ye=function(Ge){return Ge="idb://".concat(g,"/").concat(C,"/").concat(Ge),fe[Ge]||(fe[Ge]=new Ki)},Ce=ye(""),Pe=ye(":dels"),se=ce[J](re),ue=se[0],se=se[1];if((J==="query"&&ue.isPrimaryKey&&!re.values?Pe:ye(ue.name||"")).add(se),!ue.isPrimaryKey){if(J!=="count"){var qe=J==="query"&&Y&&re.values&&R.query(i(i({},re),{values:!1}));return R[J].apply(this,arguments).then(function(Ge){if(J==="query"){if(Y&&re.values)return qe.then(function(At){return At=At.result,Ce.addKeys(At),Ge});var Qe=re.values?Ge.result.map(V):Ge.result;(re.values?Ce:Pe).addKeys(Qe)}else if(J==="openCursor"){var Ke=Ge,st=re.values;return Ke&&Object.create(Ke,{key:{get:function(){return Pe.addKey(Ke.primaryKey),Ke.key}},primaryKey:{get:function(){var At=Ke.primaryKey;return Pe.addKey(At),At}},value:{get:function(){return st&&Ce.addKey(Ke.primaryKey),Ke.value}}})}return Ge})}Pe.add(A)}}return R[J].apply(this,arguments)}}),oe}})}};function Qx(p,g,A){if(A.numFailures===0)return g;if(g.type==="deleteRange")return null;var C=g.keys?g.keys.length:"values"in g&&g.values?g.values.length:1;return A.numFailures===C?null:(g=i({},g),o(g.keys)&&(g.keys=g.keys.filter(function(R,L){return!(L in A.failures)})),"values"in g&&o(g.values)&&(g.values=g.values.filter(function(R,L){return!(L in A.failures)})),g)}function i1(p,g){return A=p,((C=g).lower===void 0||(C.lowerOpen?0<jt(A,C.lower):0<=jt(A,C.lower)))&&(p=p,(g=g).upper===void 0||(g.upperOpen?jt(p,g.upper)<0:jt(p,g.upper)<=0));var A,C}function Zx(p,g,ce,C,R,L){if(!ce||ce.length===0)return p;var U=g.query.index,V=U.multiEntry,Y=g.query.range,Z=C.schema.primaryKey.extractKey,oe=U.extractKey,G=(U.lowLevelIndex||U).extractKey,ce=ce.reduce(function(J,re){var se=J,ue=[];if(re.type==="add"||re.type==="put")for(var fe=new Ki,ye=re.values.length-1;0<=ye;--ye){var Ce,Pe=re.values[ye],qe=Z(Pe);fe.hasKey(qe)||(Ce=oe(Pe),(V&&o(Ce)?Ce.some(function(Ke){return i1(Ke,Y)}):i1(Ce,Y))&&(fe.addKey(qe),ue.push(Pe)))}switch(re.type){case"add":var Ye=new Ki().addKeys(g.values?J.map(function(st){return Z(st)}):J),se=J.concat(g.values?ue.filter(function(st){return st=Z(st),!Ye.hasKey(st)&&(Ye.addKey(st),!0)}):ue.map(function(st){return Z(st)}).filter(function(st){return!Ye.hasKey(st)&&(Ye.addKey(st),!0)}));break;case"put":var Ue=new Ki().addKeys(re.values.map(function(st){return Z(st)}));se=J.filter(function(st){return!Ue.hasKey(g.values?Z(st):st)}).concat(g.values?ue:ue.map(function(st){return Z(st)}));break;case"delete":var Ge=new Ki().addKeys(re.keys);se=J.filter(function(st){return!Ge.hasKey(g.values?Z(st):st)});break;case"deleteRange":var Qe=re.range;se=J.filter(function(st){return!i1(Z(st),Qe)})}return se},p);return ce===p?p:(ce.sort(function(J,re){return jt(G(J),G(re))||jt(Z(J),Z(re))}),g.limit&&g.limit<1/0&&(ce.length>g.limit?ce.length=g.limit:p.length===g.limit&&ce.length<g.limit&&(R.dirty=!0)),L?Object.freeze(ce):ce)}function Jx(p,g){return jt(p.lower,g.lower)===0&&jt(p.upper,g.upper)===0&&!!p.lowerOpen==!!g.lowerOpen&&!!p.upperOpen==!!g.upperOpen}function aO(p,g){return function(A,C,R,L){if(A===void 0)return C!==void 0?-1:0;if(C===void 0)return 1;if((C=jt(A,C))===0){if(R&&L)return 0;if(R)return 1;if(L)return-1}return C}(p.lower,g.lower,p.lowerOpen,g.lowerOpen)<=0&&0<=function(A,C,R,L){if(A===void 0)return C!==void 0?1:0;if(C===void 0)return-1;if((C=jt(A,C))===0){if(R&&L)return 0;if(R)return-1;if(L)return 1}return C}(p.upper,g.upper,p.upperOpen,g.upperOpen)}function oO(p,g,A,C){p.subscribers.add(A),C.addEventListener("abort",function(){var R,L;p.subscribers.delete(A),p.subscribers.size===0&&(R=p,L=g,setTimeout(function(){R.subscribers.size===0&&he(L,R)},3e3))})}var lO={stack:"dbcore",level:0,name:"Cache",create:function(p){var g=p.schema.name;return i(i({},p),{transaction:function(A,C,R){var L,U,V=p.transaction(A,C,R);return C==="readwrite"&&(U=(L=new AbortController).signal,R=function(Y){return function(){if(L.abort(),C==="readwrite"){for(var Z=new Set,oe=0,G=A;oe<G.length;oe++){var ce=G[oe],J=qu["idb://".concat(g,"/").concat(ce)];if(J){var re=p.table(ce),se=J.optimisticOps.filter(function(st){return st.trans===V});if(V._explicit&&Y&&V.mutatedParts)for(var ue=0,fe=Object.values(J.queries.query);ue<fe.length;ue++)for(var ye=0,Ce=(Ye=fe[ue]).slice();ye<Ce.length;ye++)Yw((Ue=Ce[ye]).obsSet,V.mutatedParts)&&(he(Ye,Ue),Ue.subscribers.forEach(function(st){return Z.add(st)}));else if(0<se.length){J.optimisticOps=J.optimisticOps.filter(function(st){return st.trans!==V});for(var Pe=0,qe=Object.values(J.queries.query);Pe<qe.length;Pe++)for(var Ye,Ue,Ge,Qe=0,Ke=(Ye=qe[Pe]).slice();Qe<Ke.length;Qe++)(Ue=Ke[Qe]).res!=null&&V.mutatedParts&&(Y&&!Ue.dirty?(Ge=Object.isFrozen(Ue.res),Ge=Zx(Ue.res,Ue.req,se,re,Ue,Ge),Ue.dirty?(he(Ye,Ue),Ue.subscribers.forEach(function(st){return Z.add(st)})):Ge!==Ue.res&&(Ue.res=Ge,Ue.promise=q.resolve({result:Ge}))):(Ue.dirty&&he(Ye,Ue),Ue.subscribers.forEach(function(st){return Z.add(st)})))}}}Z.forEach(function(st){return st()})}}},V.addEventListener("abort",R(!1),{signal:U}),V.addEventListener("error",R(!1),{signal:U}),V.addEventListener("complete",R(!0),{signal:U})),V},table:function(A){var C=p.table(A),R=C.schema.primaryKey;return i(i({},C),{mutate:function(L){var U=M.trans;if(R.outbound||U.db._options.cache==="disabled"||U.explicit||U.idbtrans.mode!=="readwrite")return C.mutate(L);var V=qu["idb://".concat(g,"/").concat(A)];return V?(U=C.mutate(L),L.type!=="add"&&L.type!=="put"||!(50<=L.values.length||n1(R,L).some(function(Y){return Y==null}))?(V.optimisticOps.push(L),L.mutatedParts&&ey(L.mutatedParts),U.then(function(Y){0<Y.numFailures&&(he(V.optimisticOps,L),(Y=Qx(0,L,Y))&&V.optimisticOps.push(Y),L.mutatedParts&&ey(L.mutatedParts))}),U.catch(function(){he(V.optimisticOps,L),L.mutatedParts&&ey(L.mutatedParts)})):U.then(function(Y){var Z=Qx(0,i(i({},L),{values:L.values.map(function(oe,G){var ce;return Y.failures[G]?oe:(oe=(ce=R.keyPath)!==null&&ce!==void 0&&ce.includes(".")?ke(oe):i({},oe),P(oe,R.keyPath,Y.results[G]),oe)})}),Y);V.optimisticOps.push(Z),queueMicrotask(function(){return L.mutatedParts&&ey(L.mutatedParts)})}),U):C.mutate(L)},query:function(L){if(!Xx(M,C)||!Yx("query",L))return C.query(L);var U=((Z=M.trans)===null||Z===void 0?void 0:Z.db._options.cache)==="immutable",G=M,V=G.requery,Y=G.signal,Z=function(re,se,ue,fe){var ye=qu["idb://".concat(re,"/").concat(se)];if(!ye)return[];if(!(se=ye.queries[ue]))return[null,!1,ye,null];var Ce=se[(fe.query?fe.query.index.name:null)||""];if(!Ce)return[null,!1,ye,null];switch(ue){case"query":var Pe=Ce.find(function(qe){return qe.req.limit===fe.limit&&qe.req.values===fe.values&&Jx(qe.req.query.range,fe.query.range)});return Pe?[Pe,!0,ye,Ce]:[Ce.find(function(qe){return("limit"in qe.req?qe.req.limit:1/0)>=fe.limit&&(!fe.values||qe.req.values)&&aO(qe.req.query.range,fe.query.range)}),!1,ye,Ce];case"count":return Pe=Ce.find(function(qe){return Jx(qe.req.query.range,fe.query.range)}),[Pe,!!Pe,ye,Ce]}}(g,A,"query",L),oe=Z[0],G=Z[1],ce=Z[2],J=Z[3];return oe&&G?oe.obsSet=L.obsSet:(G=C.query(L).then(function(re){var se=re.result;if(oe&&(oe.res=se),U){for(var ue=0,fe=se.length;ue<fe;++ue)Object.freeze(se[ue]);Object.freeze(se)}else re.result=ke(se);return re}).catch(function(re){return J&&oe&&he(J,oe),Promise.reject(re)}),oe={obsSet:L.obsSet,promise:G,subscribers:new Set,type:"query",req:L,dirty:!1},J?J.push(oe):(J=[oe],(ce=ce||(qu["idb://".concat(g,"/").concat(A)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[L.query.index.name||""]=J)),oO(oe,J,V,Y),oe.promise.then(function(re){return{result:Zx(re.result,L,ce?.optimisticOps,C,oe,U)}})}})}})}};function ny(p,g){return new Proxy(p,{get:function(A,C,R){return C==="db"?g:Reflect.get(A,C,R)}})}var vo=(Vn.prototype.version=function(p){if(isNaN(p)||p<.1)throw new Ve.Type("Given version is not a positive number");if(p=Math.round(10*p)/10,this.idbdb||this._state.isBeingOpened)throw new Ve.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,p);var g=this._versions,A=g.filter(function(C){return C._cfg.version===p})[0];return A||(A=new this.Version(p),g.push(A),g.sort(QL),A.stores({}),this._state.autoSchema=!1,A)},Vn.prototype._whenReady=function(p){var g=this;return this.idbdb&&(this._state.openComplete||M.letThrough||this._vip)?p():new q(function(A,C){if(g._state.openComplete)return C(new Ve.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return void C(new Ve.DatabaseClosed);g.open().catch(pt)}g._state.dbReadyPromise.then(A,C)}).then(p)},Vn.prototype.use=function(p){var g=p.stack,A=p.create,C=p.level,R=p.name;return R&&this.unuse({stack:g,name:R}),p=this._middlewares[g]||(this._middlewares[g]=[]),p.push({stack:g,create:A,level:C??10,name:R}),p.sort(function(L,U){return L.level-U.level}),this},Vn.prototype.unuse=function(p){var g=p.stack,A=p.name,C=p.create;return g&&this._middlewares[g]&&(this._middlewares[g]=this._middlewares[g].filter(function(R){return C?R.create!==C:!!A&&R.name!==A})),this},Vn.prototype.open=function(){var p=this;return li(Li,function(){return tO(p)})},Vn.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var p=this._state,g=ts.indexOf(this);if(0<=g&&ts.splice(g,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}p.isBeingOpened||(p.dbReadyPromise=new q(function(A){p.dbReadyResolve=A}),p.openCanceller=new q(function(A,C){p.cancelOpen=C}))},Vn.prototype.close=function(A){var g=(A===void 0?{disableAutoOpen:!0}:A).disableAutoOpen,A=this._state;g?(A.isBeingOpened&&A.cancelOpen(new Ve.DatabaseClosed),this._close(),A.autoOpen=!1,A.dbOpenError=new Ve.DatabaseClosed):(this._close(),A.autoOpen=this._options.autoOpen||A.isBeingOpened,A.openComplete=!1,A.dbOpenError=null)},Vn.prototype.delete=function(p){var g=this;p===void 0&&(p={disableAutoOpen:!0});var A=0<arguments.length&&typeof arguments[0]!="object",C=this._state;return new q(function(R,L){function U(){g.close(p);var V=g._deps.indexedDB.deleteDatabase(g.name);V.onsuccess=Oe(function(){var Y,Z,oe;Y=g._deps,Z=g.name,oe=Y.indexedDB,Y=Y.IDBKeyRange,Gw(oe)||Z===Mh||Vw(oe,Y).delete(Z).catch(pt),R()}),V.onerror=Da(L),V.onblocked=g._fireOnBlocked}if(A)throw new Ve.InvalidArgument("Invalid closeOptions argument to db.delete()");C.isBeingOpened?C.dbReadyPromise.then(U):U()})},Vn.prototype.backendDB=function(){return this.idbdb},Vn.prototype.isOpen=function(){return this.idbdb!==null},Vn.prototype.hasBeenClosed=function(){var p=this._state.dbOpenError;return p&&p.name==="DatabaseClosed"},Vn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Vn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Vn.prototype,"tables",{get:function(){var p=this;return a(this._allTables).map(function(g){return p._allTables[g]})},enumerable:!1,configurable:!0}),Vn.prototype.transaction=function(){var p=function(g,A,C){var R=arguments.length;if(R<2)throw new Ve.InvalidArgument("Too few arguments");for(var L=new Array(R-1);--R;)L[R-1]=arguments[R];return C=L.pop(),[g,z(L),C]}.apply(this,arguments);return this._transaction.apply(this,p)},Vn.prototype._transaction=function(p,g,A){var C=this,R=M.trans;R&&R.db===this&&p.indexOf("!")===-1||(R=null);var L,U,V=p.indexOf("?")!==-1;p=p.replace("!","").replace("?","");try{if(U=g.map(function(Z){if(Z=Z instanceof C.Table?Z.name:Z,typeof Z!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Z}),p=="r"||p===_l)L=_l;else{if(p!="rw"&&p!=Hu)throw new Ve.InvalidArgument("Invalid transaction mode: "+p);L=Hu}if(R){if(R.mode===_l&&L===Hu){if(!V)throw new Ve.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");R=null}R&&U.forEach(function(Z){if(R&&R.storeNames.indexOf(Z)===-1){if(!V)throw new Ve.SubTransaction("Table "+Z+" not included in parent transaction.");R=null}}),V&&R&&!R.active&&(R=null)}}catch(Z){return R?R._promise(null,function(oe,G){G(Z)}):In(Z)}var Y=function Z(oe,G,ce,J,re){return q.resolve().then(function(){var se=M.transless||M,ue=oe._createTransaction(G,ce,oe._dbSchema,J);if(ue.explicit=!0,se={trans:ue,transless:se},J)ue.idbtrans=J.idbtrans;else try{ue.create(),ue.idbtrans._explicit=!0,oe._state.PR1398_maxLoop=3}catch(Ce){return Ce.name===We.InvalidState&&oe.isOpen()&&0<--oe._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),oe.close({disableAutoOpen:!1}),oe.open().then(function(){return Z(oe,G,ce,null,re)})):In(Ce)}var fe,ye=me(re);return ye&&Pn(),se=q.follow(function(){var Ce;(fe=re.call(ue,ue))&&(ye?(Ce=pr.bind(null,null),fe.then(Ce,Ce)):typeof fe.next=="function"&&typeof fe.throw=="function"&&(fe=e1(fe)))},se),(fe&&typeof fe.then=="function"?q.resolve(fe).then(function(Ce){return ue.active?Ce:In(new Ve.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):se.then(function(){return fe})).then(function(Ce){return J&&ue._resolve(),ue._completion.then(function(){return Ce})}).catch(function(Ce){return ue._reject(Ce),In(Ce)})})}.bind(null,this,L,U,R,A);return R?R._promise(L,Y,"lock"):M.trans?li(M.transless,function(){return C._whenReady(Y)}):this._whenReady(Y)},Vn.prototype.table=function(p){if(!d(this._allTables,p))throw new Ve.InvalidTable("Table ".concat(p," does not exist"));return this._allTables[p]},Vn);function Vn(p,g){var A=this;this._middlewares={},this.verno=0;var C=Vn.dependencies;this._options=g=i({addons:Vn.addons,autoOpen:!0,indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange,cache:"cloned"},g),this._deps={indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange},C=g.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var R,L,U,V,Y,Z={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:pt,dbReadyPromise:null,cancelOpen:pt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:g.autoOpen};Z.dbReadyPromise=new q(function(G){Z.dbReadyResolve=G}),Z.openCanceller=new q(function(G,ce){Z.cancelOpen=ce}),this._state=Z,this.name=p,this.on=Fe(this,"populate","blocked","versionchange","close",{ready:[ti,pt]}),this.once=function(G,ce){var J=function(){for(var re=[],se=0;se<arguments.length;se++)re[se]=arguments[se];A.on(G).unsubscribe(J),ce.apply(A,re)};return A.on(G,J)},this.on.ready.subscribe=E(this.on.ready.subscribe,function(G){return function(ce,J){Vn.vip(function(){var re,se=A._state;se.openComplete?(se.dbOpenError||q.resolve().then(ce),J&&G(ce)):se.onReadyBeingFired?(se.onReadyBeingFired.push(ce),J&&G(ce)):(G(ce),re=A,J||G(function ue(){re.on.ready.unsubscribe(ce),re.on.ready.unsubscribe(ue)}))})}}),this.Collection=(R=this,Be(Lr.prototype,function(fe,ue){this.db=R;var J=Wv,re=null;if(ue)try{J=ue()}catch(ye){re=ye}var se=fe._ctx,ue=se.table,fe=ue.hook.reading.fire;this._ctx={table:ue,index:se.index,isPrimKey:!se.index||ue.schema.primKey.keyPath&&se.index===ue.schema.primKey.name,range:J,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:re,or:se.or,valueMapper:fe!==It?fe:null}})),this.Table=(L=this,Be(Re.prototype,function(G,ce,J){this.db=L,this._tx=J,this.name=G,this.schema=ce,this.hook=L._allTables[G]?L._allTables[G].hook:Fe(null,{creating:[Vi,pt],reading:[ei,It],updating:[Wn,pt],deleting:[Wt,pt]})})),this.Transaction=(U=this,Be(GL.prototype,function(G,ce,J,re,se){var ue=this;G!=="readonly"&&ce.forEach(function(fe){fe=(fe=J[fe])===null||fe===void 0?void 0:fe.yProps,fe&&(ce=ce.concat(fe.map(function(ye){return ye.updatesTable})))}),this.db=U,this.mode=G,this.storeNames=ce,this.schema=J,this.chromeTransactionDurability=re,this.idbtrans=null,this.on=Fe(this,"complete","error","abort"),this.parent=se||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new q(function(fe,ye){ue._resolve=fe,ue._reject=ye}),this._completion.then(function(){ue.active=!1,ue.on.complete.fire()},function(fe){var ye=ue.active;return ue.active=!1,ue.on.error.fire(fe),ue.parent?ue.parent._reject(fe):ye&&ue.idbtrans&&ue.idbtrans.abort(),In(fe)})})),this.Version=(V=this,Be(eO.prototype,function(G){this.db=V,this._cfg={version:G,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Y=this,Be(jx.prototype,function(G,ce,J){if(this.db=Y,this._ctx={table:G,index:ce===":id"?null:ce,or:J},this._cmp=this._ascending=jt,this._descending=function(re,se){return jt(se,re)},this._max=function(re,se){return 0<jt(re,se)?re:se},this._min=function(re,se){return jt(re,se)<0?re:se},this._IDBKeyRange=Y._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ve.MissingAPI})),this.on("versionchange",function(G){0<G.newVersion?console.warn("Another connection wants to upgrade database '".concat(A.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(A.name,"'. Closing db now to resume the delete request.")),A.close({disableAutoOpen:!1})}),this.on("blocked",function(G){!G.newVersion||G.newVersion<G.oldVersion?console.warn("Dexie.delete('".concat(A.name,"') was blocked")):console.warn("Upgrade '".concat(A.name,"' blocked by other connection holding version ").concat(G.oldVersion/10))}),this._maxKey=hp(g.IDBKeyRange),this._createTransaction=function(G,ce,J,re){return new A.Transaction(G,ce,J,A._options.chromeTransactionDurability,re)},this._fireOnBlocked=function(G){A.on("blocked").fire(G),ts.filter(function(ce){return ce.name===A.name&&ce!==A&&!ce._state.vcFired}).map(function(ce){return ce.on("versionchange").fire(G)})},this.use(rO),this.use(lO),this.use(sO),this.use(nO),this.use(iO);var oe=new Proxy(this,{get:function(G,ce,J){if(ce==="_vip")return!0;if(ce==="table")return function(se){return ny(A.table(se),oe)};var re=Reflect.get(G,ce,J);return re instanceof Re?ny(re,oe):ce==="tables"?re.map(function(se){return ny(se,oe)}):ce==="_createTransaction"?function(){return ny(re.apply(this,arguments),oe)}:re}});this.vip=oe,C.forEach(function(G){return G(A)})}var iy,Cs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",uO=(r1.prototype.subscribe=function(p,g,A){return this._subscribe(p&&typeof p!="function"?p:{next:p,error:g,complete:A})},r1.prototype[Cs]=function(){return this},r1);function r1(p){this._subscribe=p}try{iy={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{iy={indexedDB:null,IDBKeyRange:null}}function eS(p){var g,A=!1,C=new uO(function(R){var L=me(p),U,V=!1,Y={},Z={},oe={get closed(){return V},unsubscribe:function(){V||(V=!0,U&&U.abort(),G&&xl.storagemutated.unsubscribe(J))}};R.start&&R.start(oe);var G=!1,ce=function(){return wl(re)},J=function(se){Jv(Y,se),Yw(Z,Y)&&ce()},re=function(){var se,ue,fe;!V&&iy.indexedDB&&(Y={},se={},U&&U.abort(),U=new AbortController,fe=function(ye){var Ce=B();try{L&&Pn();var Pe=dn(p,ye);return Pe=L?Pe.finally(pr):Pe}finally{Ce&&K()}}(ue={subscr:se,signal:U.signal,requery:ce,querier:p,trans:null}),Promise.resolve(fe).then(function(ye){A=!0,g=ye,V||ue.signal.aborted||(Y={},function(Ce){for(var Pe in Ce)if(d(Ce,Pe))return;return 1}(Z=se)||G||(xl(cp,J),G=!0),wl(function(){return!V&&R.next&&R.next(ye)}))},function(ye){A=!1,["DatabaseClosedError","AbortError"].includes(ye?.name)||V||wl(function(){V||R.error&&R.error(ye)})}))};return setTimeout(ce,0),oe});return C.hasValue=function(){return A},C.getValue=function(){return g},C}var Wu=vo;function s1(p){var g=Sl;try{Sl=!0,xl.storagemutated.fire(p),Jw(p,!0)}finally{Sl=g}}f(Wu,i(i({},wt),{delete:function(p){return new Wu(p,{addons:[]}).delete()},exists:function(p){return new Wu(p,{addons:[]}).open().then(function(g){return g.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(p){try{return g=Wu.dependencies,A=g.indexedDB,g=g.IDBKeyRange,(Gw(A)?Promise.resolve(A.databases()).then(function(C){return C.map(function(R){return R.name}).filter(function(R){return R!==Mh})}):Vw(A,g).toCollection().primaryKeys()).then(p)}catch{return In(new Ve.MissingAPI)}var g,A},defineClass:function(){return function(p){l(this,p)}},ignoreTransaction:function(p){return M.trans?li(M.transless,p):p()},vip:Kw,async:function(p){return function(){try{var g=e1(p.apply(this,arguments));return g&&typeof g.then=="function"?g:q.resolve(g)}catch(A){return In(A)}}},spawn:function(p,g,A){try{var C=e1(p.apply(A,g||[]));return C&&typeof C.then=="function"?C:q.resolve(C)}catch(R){return In(R)}},currentTransaction:{get:function(){return M.trans||null}},waitFor:function(p,g){return g=q.resolve(typeof p=="function"?Wu.ignoreTransaction(p):p).timeout(g||6e4),M.trans?M.trans.waitFor(g):g},Promise:q,debug:{get:function(){return ln},set:function(p){tn(p)}},derive:_,extend:l,props:f,override:E,Events:Fe,on:xl,liveQuery:eS,extendObservabilitySet:Jv,getByKeyPath:D,setByKeyPath:P,delByKeyPath:function(p,g){typeof g=="string"?P(p,g,void 0):"length"in g&&[].map.call(g,function(A){P(p,A,void 0)})},shallowClone:F,deepClone:ke,getObjectDiff:t1,cmp:jt,asap:S,minKey:-1/0,addons:[],connections:ts,errnames:We,dependencies:iy,cache:qu,semVer:"4.2.1",version:"4.2.1".split(".").map(function(p){return parseInt(p)}).reduce(function(p,g,A){return p+g/Math.pow(10,2*A)})})),Wu.maxKey=hp(Wu.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(xl(cp,function(p){Sl||(p=new CustomEvent(jw,{detail:p}),Sl=!0,dispatchEvent(p),Sl=!1)}),addEventListener(jw,function(p){p=p.detail,Sl||s1(p)}));var zh,Sl=!1,tS=function(){};return typeof BroadcastChannel<"u"&&((tS=function(){(zh=new BroadcastChannel(jw)).onmessage=function(p){return p.data&&s1(p.data)}})(),typeof zh.unref=="function"&&zh.unref(),xl(cp,function(p){Sl||zh.postMessage(p)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(p){if(!vo.disableBfCache&&p.persisted){ln&&console.debug("Dexie: handling persisted pagehide"),zh?.close();for(var g=0,A=ts;g<A.length;g++)A[g].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(p){!vo.disableBfCache&&p.persisted&&(ln&&console.debug("Dexie: handling persisted pageshow"),tS(),s1({all:new Ki(-1/0,[[]])}))})),q.rejectionMapper=function(p,g){return!p||p instanceof pe||p instanceof TypeError||p instanceof SyntaxError||!p.name||!Bt[p.name]?p:(g=new Bt[p.name](g||p.message,p),"stack"in p&&b(g,"stack",{get:function(){return this.inner.stack}}),g)},tn(ln),i(vo,Object.freeze({__proto__:null,Dexie:vo,liveQuery:eS,Entity:Vv,cmp:jt,PropModification:ne,replacePrefix:function(p,g){return new ne({replacePrefix:[p,g]})},add:function(p){return new ne({add:p})},remove:function(p){return new ne({remove:p})},default:vo,RangeSet:Ki,mergeRanges:pp,rangesOverlap:qx}),{default:vo}),vo})})(qP);var Fj=qP.exports;const m2=po(Fj),tk=Symbol.for("Dexie"),mb=globalThis[tk]||(globalThis[tk]=m2);if(m2.semVer!==mb.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${m2.semVer} and ${mb.semVer}`);const{liveQuery:Q$,mergeRanges:Z$,rangesOverlap:J$,RangeSet:eH,cmp:tH,Entity:nH,PropModification:iH,replacePrefix:rH,add:sH,remove:aH,DexieYProvider:oH}=mb;class Bj extends mb{constructor(){super("JPDBReaderDB");Ae(this,"epubProgress");Ae(this,"mangaProgress");Ae(this,"videoProgress");Ae(this,"vocabularyCache");this.version(1).stores({epubProgress:"id, bookId, lastRead",mangaProgress:"id, mangaId, lastRead",videoProgress:"id, videoId, lastWatched",vocabularyCache:"id, text, cachedAt"})}}const Iu=new Bj,ux=(n="")=>`${n}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,nk=n=>{let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);e=(e<<5)-e+i,e=e&e}return e.toString()},G1=_w(n=>({currentBook:null,isLoading:!1,error:null,loadBook:async e=>{n({isLoading:!0,error:null});try{const t=await e.arrayBuffer(),i=ux(e.name);n({currentBook:{id:i,file:t,name:e.name},isLoading:!1})}catch(t){n({error:t instanceof Error?t.message:"Failed to load EPUB",isLoading:!1})}},saveProgress:async(e,t)=>{try{await Iu.epubProgress.put({id:e,bookId:e,cfi:t.cfi,percentage:t.percentage,lastRead:new Date})}catch(i){console.error("Failed to save EPUB progress:",i)}},loadProgress:async e=>{try{const t=await Iu.epubProgress.get(e);return t?{cfi:t.cfi,percentage:t.percentage}:null}catch(t){return console.error("Failed to load EPUB progress:",t),null}},clearCurrentBook:()=>n({currentBook:null}),setError:e=>n({error:e})}));function WP(n,e){return function(){return n.apply(e,arguments)}}const{toString:jj}=Object.prototype,{getPrototypeOf:cx}=Object,{iterator:Ew,toStringTag:VP}=Symbol,Aw=(n=>e=>{const t=jj.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ka=n=>(n=n.toLowerCase(),e=>Aw(e)===n),xw=n=>e=>typeof e===n,{isArray:rp}=Array,Jf=xw("undefined");function Ov(n){return n!==null&&!Jf(n)&&n.constructor!==null&&!Jf(n.constructor)&&Xr(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const GP=ka("ArrayBuffer");function zj(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&GP(n.buffer),e}const Uj=xw("string"),Xr=xw("function"),KP=xw("number"),Mv=n=>n!==null&&typeof n=="object",$j=n=>n===!0||n===!1,Ky=n=>{if(Aw(n)!=="object")return!1;const e=cx(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(VP in n)&&!(Ew in n)},Hj=n=>{if(!Mv(n)||Ov(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},qj=ka("Date"),Wj=ka("File"),Vj=ka("Blob"),Gj=ka("FileList"),Kj=n=>Mv(n)&&Xr(n.pipe),Xj=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Xr(n.append)&&((e=Aw(n))==="formdata"||e==="object"&&Xr(n.toString)&&n.toString()==="[object FormData]"))},Yj=ka("URLSearchParams"),[Qj,Zj,Jj,e5]=["ReadableStream","Request","Response","Headers"].map(ka),t5=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Fv(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,r;if(typeof n!="object"&&(n=[n]),rp(n))for(i=0,r=n.length;i<r;i++)e.call(null,n[i],i,n);else{if(Ov(n))return;const s=t?Object.getOwnPropertyNames(n):Object.keys(n),a=s.length;let o;for(i=0;i<a;i++)o=s[i],e.call(null,n[o],o,n)}}function XP(n,e){if(Ov(n))return null;e=e.toLowerCase();const t=Object.keys(n);let i=t.length,r;for(;i-- >0;)if(r=t[i],e===r.toLowerCase())return r;return null}const sc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,YP=n=>!Jf(n)&&n!==sc;function g2(){const{caseless:n,skipUndefined:e}=YP(this)&&this||{},t={},i=(r,s)=>{const a=n&&XP(t,s)||s;Ky(t[a])&&Ky(r)?t[a]=g2(t[a],r):Ky(r)?t[a]=g2({},r):rp(r)?t[a]=r.slice():(!e||!Jf(r))&&(t[a]=r)};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Fv(arguments[r],i);return t}const n5=(n,e,t,{allOwnKeys:i}={})=>(Fv(e,(r,s)=>{t&&Xr(r)?n[s]=WP(r,t):n[s]=r},{allOwnKeys:i}),n),i5=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),r5=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},s5=(n,e,t,i)=>{let r,s,a;const o={};if(e=e||{},n==null)return e;do{for(r=Object.getOwnPropertyNames(n),s=r.length;s-- >0;)a=r[s],(!i||i(a,n,e))&&!o[a]&&(e[a]=n[a],o[a]=!0);n=t!==!1&&cx(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},a5=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},o5=n=>{if(!n)return null;if(rp(n))return n;let e=n.length;if(!KP(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},l5=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&cx(Uint8Array)),u5=(n,e)=>{const i=(n&&n[Ew]).call(n);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(n,s[0],s[1])}},c5=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},h5=ka("HTMLFormElement"),d5=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,r){return i.toUpperCase()+r}),ik=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),f5=ka("RegExp"),QP=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};Fv(t,(r,s)=>{let a;(a=e(r,s,n))!==!1&&(i[s]=a||r)}),Object.defineProperties(n,i)},p5=n=>{QP(n,(e,t)=>{if(Xr(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(Xr(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},m5=(n,e)=>{const t={},i=r=>{r.forEach(s=>{t[s]=!0})};return rp(n)?i(n):i(String(n).split(e)),t},g5=()=>{},v5=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function y5(n){return!!(n&&Xr(n.append)&&n[VP]==="FormData"&&n[Ew])}const b5=n=>{const e=new Array(10),t=(i,r)=>{if(Mv(i)){if(e.indexOf(i)>=0)return;if(Ov(i))return i;if(!("toJSON"in i)){e[r]=i;const s=rp(i)?[]:{};return Fv(i,(a,o)=>{const l=t(a,r+1);!Jf(l)&&(s[o]=l)}),e[r]=void 0,s}}return i};return t(n,0)},w5=ka("AsyncFunction"),_5=n=>n&&(Mv(n)||Xr(n))&&Xr(n.then)&&Xr(n.catch),ZP=((n,e)=>n?setImmediate:e?((t,i)=>(sc.addEventListener("message",({source:r,data:s})=>{r===sc&&s===t&&i.length&&i.shift()()},!1),r=>{i.push(r),sc.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Xr(sc.postMessage)),E5=typeof queueMicrotask<"u"?queueMicrotask.bind(sc):typeof process<"u"&&process.nextTick||ZP,A5=n=>n!=null&&Xr(n[Ew]),we={isArray:rp,isArrayBuffer:GP,isBuffer:Ov,isFormData:Xj,isArrayBufferView:zj,isString:Uj,isNumber:KP,isBoolean:$j,isObject:Mv,isPlainObject:Ky,isEmptyObject:Hj,isReadableStream:Qj,isRequest:Zj,isResponse:Jj,isHeaders:e5,isUndefined:Jf,isDate:qj,isFile:Wj,isBlob:Vj,isRegExp:f5,isFunction:Xr,isStream:Kj,isURLSearchParams:Yj,isTypedArray:l5,isFileList:Gj,forEach:Fv,merge:g2,extend:n5,trim:t5,stripBOM:i5,inherits:r5,toFlatObject:s5,kindOf:Aw,kindOfTest:ka,endsWith:a5,toArray:o5,forEachEntry:u5,matchAll:c5,isHTMLForm:h5,hasOwnProperty:ik,hasOwnProp:ik,reduceDescriptors:QP,freezeMethods:p5,toObjectSet:m5,toCamelCase:d5,noop:g5,toFiniteNumber:v5,findKey:XP,global:sc,isContextDefined:YP,isSpecCompliantForm:y5,toJSONObject:b5,isAsyncFn:w5,isThenable:_5,setImmediate:ZP,asap:E5,isIterable:A5};function xt(n,e,t,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}we.inherits(xt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const JP=xt.prototype,eN={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{eN[n]={value:n}});Object.defineProperties(xt,eN);Object.defineProperty(JP,"isAxiosError",{value:!0});xt.from=(n,e,t,i,r,s)=>{const a=Object.create(JP);we.toFlatObject(n,a,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const o=n&&n.message?n.message:"Error",l=e==null&&n?n.code:e;return xt.call(a,o,l,t,i,r),n&&a.cause==null&&Object.defineProperty(a,"cause",{value:n,configurable:!0}),a.name=n&&n.name||"Error",s&&Object.assign(a,s),a};const x5=null;function v2(n){return we.isPlainObject(n)||we.isArray(n)}function tN(n){return we.endsWith(n,"[]")?n.slice(0,-2):n}function rk(n,e,t){return n?n.concat(e).map(function(r,s){return r=tN(r),!t&&s?"["+r+"]":r}).join(t?".":""):e}function S5(n){return we.isArray(n)&&!n.some(v2)}const C5=we.toFlatObject(we,{},null,function(e){return/^is[A-Z]/.test(e)});function Sw(n,e,t){if(!we.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=we.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,w){return!we.isUndefined(w[_])});const i=t.metaTokens,r=t.visitor||h,s=t.dots,a=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(e);if(!we.isFunction(r))throw new TypeError("visitor must be a function");function u(b){if(b===null)return"";if(we.isDate(b))return b.toISOString();if(we.isBoolean(b))return b.toString();if(!l&&we.isBlob(b))throw new xt("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(b)||we.isTypedArray(b)?l&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function h(b,_,w){let v=b;if(b&&!w&&typeof b=="object"){if(we.endsWith(_,"{}"))_=i?_:_.slice(0,-2),b=JSON.stringify(b);else if(we.isArray(b)&&S5(b)||(we.isFileList(b)||we.endsWith(_,"[]"))&&(v=we.toArray(b)))return _=tN(_),v.forEach(function(E,k){!(we.isUndefined(E)||E===null)&&e.append(a===!0?rk([_],k,s):a===null?_:_+"[]",u(E))}),!1}return v2(b)?!0:(e.append(rk(w,_,s),u(b)),!1)}const d=[],f=Object.assign(C5,{defaultVisitor:h,convertValue:u,isVisitable:v2});function m(b,_){if(!we.isUndefined(b)){if(d.indexOf(b)!==-1)throw Error("Circular reference detected in "+_.join("."));d.push(b),we.forEach(b,function(v,y){(!(we.isUndefined(v)||v===null)&&r.call(e,v,we.isString(y)?y.trim():y,_,f))===!0&&m(v,_?_.concat(y):[y])}),d.pop()}}if(!we.isObject(n))throw new TypeError("data must be an object");return m(n),e}function sk(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function hx(n,e){this._pairs=[],n&&Sw(n,this,e)}const nN=hx.prototype;nN.append=function(e,t){this._pairs.push([e,t])};nN.toString=function(e){const t=e?function(i){return e.call(this,i,sk)}:sk;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function k5(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function iN(n,e,t){if(!e)return n;const i=t&&t.encode||k5;we.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let s;if(r?s=r(e,t):s=we.isURLSearchParams(e)?e.toString():new hx(e,t).toString(i),s){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class ak{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){we.forEach(this.handlers,function(i){i!==null&&e(i)})}}const rN={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},T5=typeof URLSearchParams<"u"?URLSearchParams:hx,D5=typeof FormData<"u"?FormData:null,R5=typeof Blob<"u"?Blob:null,P5={isBrowser:!0,classes:{URLSearchParams:T5,FormData:D5,Blob:R5},protocols:["http","https","file","blob","url","data"]},dx=typeof window<"u"&&typeof document<"u",y2=typeof navigator=="object"&&navigator||void 0,N5=dx&&(!y2||["ReactNative","NativeScript","NS"].indexOf(y2.product)<0),I5=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",L5=dx&&window.location.href||"http://localhost",O5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:dx,hasStandardBrowserEnv:N5,hasStandardBrowserWebWorkerEnv:I5,navigator:y2,origin:L5},Symbol.toStringTag,{value:"Module"})),ur={...O5,...P5};function M5(n,e){return Sw(n,new ur.classes.URLSearchParams,{visitor:function(t,i,r,s){return ur.isNode&&we.isBuffer(t)?(this.append(i,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function F5(n){return we.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function B5(n){const e={},t=Object.keys(n);let i;const r=t.length;let s;for(i=0;i<r;i++)s=t[i],e[s]=n[s];return e}function sN(n){function e(t,i,r,s){let a=t[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=s>=t.length;return a=!a&&we.isArray(r)?r.length:a,l?(we.hasOwnProp(r,a)?r[a]=[r[a],i]:r[a]=i,!o):((!r[a]||!we.isObject(r[a]))&&(r[a]=[]),e(t,i,r[a],s)&&we.isArray(r[a])&&(r[a]=B5(r[a])),!o)}if(we.isFormData(n)&&we.isFunction(n.entries)){const t={};return we.forEachEntry(n,(i,r)=>{e(F5(i),r,t,0)}),t}return null}function j5(n,e,t){if(we.isString(n))try{return(e||JSON.parse)(n),we.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const Bv={transitional:rN,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",r=i.indexOf("application/json")>-1,s=we.isObject(e);if(s&&we.isHTMLForm(e)&&(e=new FormData(e)),we.isFormData(e))return r?JSON.stringify(sN(e)):e;if(we.isArrayBuffer(e)||we.isBuffer(e)||we.isStream(e)||we.isFile(e)||we.isBlob(e)||we.isReadableStream(e))return e;if(we.isArrayBufferView(e))return e.buffer;if(we.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return M5(e,this.formSerializer).toString();if((o=we.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Sw(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),j5(e)):e}],transformResponse:[function(e){const t=this.transitional||Bv.transitional,i=t&&t.forcedJSONParsing,r=this.responseType==="json";if(we.isResponse(e)||we.isReadableStream(e))return e;if(e&&we.isString(e)&&(i&&!this.responseType||r)){const a=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(o){if(a)throw o.name==="SyntaxError"?xt.from(o,xt.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ur.classes.FormData,Blob:ur.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],n=>{Bv.headers[n]={}});const z5=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),U5=n=>{const e={};let t,i,r;return n&&n.split(`
`).forEach(function(a){r=a.indexOf(":"),t=a.substring(0,r).trim().toLowerCase(),i=a.substring(r+1).trim(),!(!t||e[t]&&z5[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},ok=Symbol("internals");function Tp(n){return n&&String(n).trim().toLowerCase()}function Xy(n){return n===!1||n==null?n:we.isArray(n)?n.map(Xy):String(n)}function $5(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const H5=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function K1(n,e,t,i,r){if(we.isFunction(i))return i.call(this,e,t);if(r&&(e=t),!!we.isString(e)){if(we.isString(i))return e.indexOf(i)!==-1;if(we.isRegExp(i))return i.test(e)}}function q5(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function W5(n,e){const t=we.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(r,s,a){return this[i].call(this,e,r,s,a)},configurable:!0})})}let Yr=class{constructor(e){e&&this.set(e)}set(e,t,i){const r=this;function s(o,l,u){const h=Tp(l);if(!h)throw new Error("header name must be a non-empty string");const d=we.findKey(r,h);(!d||r[d]===void 0||u===!0||u===void 0&&r[d]!==!1)&&(r[d||l]=Xy(o))}const a=(o,l)=>we.forEach(o,(u,h)=>s(u,h,l));if(we.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(we.isString(e)&&(e=e.trim())&&!H5(e))a(U5(e),t);else if(we.isObject(e)&&we.isIterable(e)){let o={},l,u;for(const h of e){if(!we.isArray(h))throw TypeError("Object iterator must return a key-value pair");o[u=h[0]]=(l=o[u])?we.isArray(l)?[...l,h[1]]:[l,h[1]]:h[1]}a(o,t)}else e!=null&&s(t,e,i);return this}get(e,t){if(e=Tp(e),e){const i=we.findKey(this,e);if(i){const r=this[i];if(!t)return r;if(t===!0)return $5(r);if(we.isFunction(t))return t.call(this,r,i);if(we.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Tp(e),e){const i=we.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||K1(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let r=!1;function s(a){if(a=Tp(a),a){const o=we.findKey(i,a);o&&(!t||K1(i,i[o],o,t))&&(delete i[o],r=!0)}}return we.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let i=t.length,r=!1;for(;i--;){const s=t[i];(!e||K1(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const t=this,i={};return we.forEach(this,(r,s)=>{const a=we.findKey(i,s);if(a){t[a]=Xy(r),delete t[s];return}const o=e?q5(s):String(s).trim();o!==s&&delete t[s],t[o]=Xy(r),i[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return we.forEach(this,(i,r)=>{i!=null&&i!==!1&&(t[r]=e&&we.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[ok]=this[ok]={accessors:{}}).accessors,r=this.prototype;function s(a){const o=Tp(a);i[o]||(W5(r,a),i[o]=!0)}return we.isArray(e)?e.forEach(s):s(e),this}};Yr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(Yr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}});we.freezeMethods(Yr);function X1(n,e){const t=this||Bv,i=e||t,r=Yr.from(i.headers);let s=i.data;return we.forEach(n,function(o){s=o.call(t,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function aN(n){return!!(n&&n.__CANCEL__)}function sp(n,e,t){xt.call(this,n??"canceled",xt.ERR_CANCELED,e,t),this.name="CanceledError"}we.inherits(sp,xt,{__CANCEL__:!0});function oN(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new xt("Request failed with status code "+t.status,[xt.ERR_BAD_REQUEST,xt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function V5(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function G5(n,e){n=n||10;const t=new Array(n),i=new Array(n);let r=0,s=0,a;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),h=i[s];a||(a=u),t[r]=l,i[r]=u;let d=s,f=0;for(;d!==r;)f+=t[d++],d=d%n;if(r=(r+1)%n,r===s&&(s=(s+1)%n),u-a<e)return;const m=h&&u-h;return m?Math.round(f*1e3/m):void 0}}function K5(n,e){let t=0,i=1e3/e,r,s;const a=(u,h=Date.now())=>{t=h,r=null,s&&(clearTimeout(s),s=null),n(...u)};return[(...u)=>{const h=Date.now(),d=h-t;d>=i?a(u,h):(r=u,s||(s=setTimeout(()=>{s=null,a(r)},i-d)))},()=>r&&a(r)]}const gb=(n,e,t=3)=>{let i=0;const r=G5(50,250);return K5(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,l=a-i,u=r(l),h=a<=o;i=a;const d={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:u||void 0,estimated:u&&o&&h?(o-a)/u:void 0,event:s,lengthComputable:o!=null,[e?"download":"upload"]:!0};n(d)},t)},lk=(n,e)=>{const t=n!=null;return[i=>e[0]({lengthComputable:t,total:n,loaded:i}),e[1]]},uk=n=>(...e)=>we.asap(()=>n(...e)),X5=ur.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,ur.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(ur.origin),ur.navigator&&/(msie|trident)/i.test(ur.navigator.userAgent)):()=>!0,Y5=ur.hasStandardBrowserEnv?{write(n,e,t,i,r,s){const a=[n+"="+encodeURIComponent(e)];we.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),we.isString(i)&&a.push("path="+i),we.isString(r)&&a.push("domain="+r),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Q5(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Z5(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function lN(n,e,t){let i=!Q5(e);return n&&(i||t==!1)?Z5(n,e):e}const ck=n=>n instanceof Yr?{...n}:n;function kh(n,e){e=e||{};const t={};function i(u,h,d,f){return we.isPlainObject(u)&&we.isPlainObject(h)?we.merge.call({caseless:f},u,h):we.isPlainObject(h)?we.merge({},h):we.isArray(h)?h.slice():h}function r(u,h,d,f){if(we.isUndefined(h)){if(!we.isUndefined(u))return i(void 0,u,d,f)}else return i(u,h,d,f)}function s(u,h){if(!we.isUndefined(h))return i(void 0,h)}function a(u,h){if(we.isUndefined(h)){if(!we.isUndefined(u))return i(void 0,u)}else return i(void 0,h)}function o(u,h,d){if(d in e)return i(u,h);if(d in n)return i(void 0,u)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(u,h,d)=>r(ck(u),ck(h),d,!0)};return we.forEach(Object.keys({...n,...e}),function(h){const d=l[h]||r,f=d(n[h],e[h],h);we.isUndefined(f)&&d!==o||(t[h]=f)}),t}const uN=n=>{const e=kh({},n);let{data:t,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:a,auth:o}=e;if(e.headers=a=Yr.from(a),e.url=iN(lN(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),we.isFormData(t)){if(ur.hasStandardBrowserEnv||ur.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(we.isFunction(t.getHeaders)){const l=t.getHeaders(),u=["content-type","content-length"];Object.entries(l).forEach(([h,d])=>{u.includes(h.toLowerCase())&&a.set(h,d)})}}if(ur.hasStandardBrowserEnv&&(i&&we.isFunction(i)&&(i=i(e)),i||i!==!1&&X5(e.url))){const l=r&&s&&Y5.read(s);l&&a.set(r,l)}return e},J5=typeof XMLHttpRequest<"u",ez=J5&&function(n){return new Promise(function(t,i){const r=uN(n);let s=r.data;const a=Yr.from(r.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:u}=r,h,d,f,m,b;function _(){m&&m(),b&&b(),r.cancelToken&&r.cancelToken.unsubscribe(h),r.signal&&r.signal.removeEventListener("abort",h)}let w=new XMLHttpRequest;w.open(r.method.toUpperCase(),r.url,!0),w.timeout=r.timeout;function v(){if(!w)return;const E=Yr.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),S={data:!o||o==="text"||o==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:E,config:n,request:w};oN(function(P){t(P),_()},function(P){i(P),_()},S),w=null}"onloadend"in w?w.onloadend=v:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(v)},w.onabort=function(){w&&(i(new xt("Request aborted",xt.ECONNABORTED,n,w)),w=null)},w.onerror=function(k){const S=k&&k.message?k.message:"Network Error",D=new xt(S,xt.ERR_NETWORK,n,w);D.event=k||null,i(D),w=null},w.ontimeout=function(){let k=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const S=r.transitional||rN;r.timeoutErrorMessage&&(k=r.timeoutErrorMessage),i(new xt(k,S.clarifyTimeoutError?xt.ETIMEDOUT:xt.ECONNABORTED,n,w)),w=null},s===void 0&&a.setContentType(null),"setRequestHeader"in w&&we.forEach(a.toJSON(),function(k,S){w.setRequestHeader(S,k)}),we.isUndefined(r.withCredentials)||(w.withCredentials=!!r.withCredentials),o&&o!=="json"&&(w.responseType=r.responseType),u&&([f,b]=gb(u,!0),w.addEventListener("progress",f)),l&&w.upload&&([d,m]=gb(l),w.upload.addEventListener("progress",d),w.upload.addEventListener("loadend",m)),(r.cancelToken||r.signal)&&(h=E=>{w&&(i(!E||E.type?new sp(null,n,w):E),w.abort(),w=null)},r.cancelToken&&r.cancelToken.subscribe(h),r.signal&&(r.signal.aborted?h():r.signal.addEventListener("abort",h)));const y=V5(r.url);if(y&&ur.protocols.indexOf(y)===-1){i(new xt("Unsupported protocol "+y+":",xt.ERR_BAD_REQUEST,n));return}w.send(s||null)})},tz=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let i=new AbortController,r;const s=function(u){if(!r){r=!0,o();const h=u instanceof Error?u:this.reason;i.abort(h instanceof xt?h:new sp(h instanceof Error?h.message:h))}};let a=e&&setTimeout(()=>{a=null,s(new xt(`timeout ${e} of ms exceeded`,xt.ETIMEDOUT))},e);const o=()=>{n&&(a&&clearTimeout(a),a=null,n.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),n=null)};n.forEach(u=>u.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>we.asap(o),l}},nz=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let i=0,r;for(;i<t;)r=i+e,yield n.slice(i,r),i=r},iz=async function*(n,e){for await(const t of rz(n))yield*nz(t,e)},rz=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},hk=(n,e,t,i)=>{const r=iz(n,e);let s=0,a,o=l=>{a||(a=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:u,value:h}=await r.next();if(u){o(),l.close();return}let d=h.byteLength;if(t){let f=s+=d;t(f)}l.enqueue(new Uint8Array(h))}catch(u){throw o(u),u}},cancel(l){return o(l),r.return()}},{highWaterMark:2})},dk=64*1024,{isFunction:Sy}=we,sz=(({Request:n,Response:e})=>({Request:n,Response:e}))(we.global),{ReadableStream:fk,TextEncoder:pk}=we.global,mk=(n,...e)=>{try{return!!n(...e)}catch{return!1}},az=n=>{n=we.merge.call({skipUndefined:!0},sz,n);const{fetch:e,Request:t,Response:i}=n,r=e?Sy(e):typeof fetch=="function",s=Sy(t),a=Sy(i);if(!r)return!1;const o=r&&Sy(fk),l=r&&(typeof pk=="function"?(b=>_=>b.encode(_))(new pk):async b=>new Uint8Array(await new t(b).arrayBuffer())),u=s&&o&&mk(()=>{let b=!1;const _=new t(ur.origin,{body:new fk,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!_}),h=a&&o&&mk(()=>we.isReadableStream(new i("").body)),d={stream:h&&(b=>b.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!d[b]&&(d[b]=(_,w)=>{let v=_&&_[b];if(v)return v.call(_);throw new xt(`Response type '${b}' is not supported`,xt.ERR_NOT_SUPPORT,w)})});const f=async b=>{if(b==null)return 0;if(we.isBlob(b))return b.size;if(we.isSpecCompliantForm(b))return(await new t(ur.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(we.isArrayBufferView(b)||we.isArrayBuffer(b))return b.byteLength;if(we.isURLSearchParams(b)&&(b=b+""),we.isString(b))return(await l(b)).byteLength},m=async(b,_)=>{const w=we.toFiniteNumber(b.getContentLength());return w??f(_)};return async b=>{let{url:_,method:w,data:v,signal:y,cancelToken:E,timeout:k,onDownloadProgress:S,onUploadProgress:D,responseType:P,headers:F,withCredentials:H="same-origin",fetchOptions:z}=uN(b),te=e||fetch;P=P?(P+"").toLowerCase():"text";let de=tz([y,E&&E.toAbortSignal()],k),ke=null;const Me=de&&de.unsubscribe&&(()=>{de.unsubscribe()});let ze;try{if(D&&u&&w!=="get"&&w!=="head"&&(ze=await m(F,v))!==0){let me=new t(_,{method:"POST",body:v,duplex:"half"}),_e;if(we.isFormData(v)&&(_e=me.headers.get("content-type"))&&F.setContentType(_e),me.body){const[pe,De]=lk(ze,gb(uk(D)));v=hk(me.body,dk,pe,De)}}we.isString(H)||(H=H?"include":"omit");const ve=s&&"credentials"in t.prototype,xe={...z,signal:de,method:w.toUpperCase(),headers:F.normalize().toJSON(),body:v,duplex:"half",credentials:ve?H:void 0};ke=s&&new t(_,xe);let he=await(s?te(ke,z):te(_,xe));const ie=h&&(P==="stream"||P==="response");if(h&&(S||ie&&Me)){const me={};["status","statusText","headers"].forEach(it=>{me[it]=he[it]});const _e=we.toFiniteNumber(he.headers.get("content-length")),[pe,De]=S&&lk(_e,gb(uk(S),!0))||[];he=new i(hk(he.body,dk,pe,()=>{De&&De(),Me&&Me()}),me)}P=P||"text";let ae=await d[we.findKey(d,P)||"text"](he,b);return!ie&&Me&&Me(),await new Promise((me,_e)=>{oN(me,_e,{data:ae,headers:Yr.from(he.headers),status:he.status,statusText:he.statusText,config:b,request:ke})})}catch(ve){throw Me&&Me(),ve&&ve.name==="TypeError"&&/Load failed|fetch/i.test(ve.message)?Object.assign(new xt("Network Error",xt.ERR_NETWORK,b,ke),{cause:ve.cause||ve}):xt.from(ve,ve&&ve.code,b,ke)}}},oz=new Map,cN=n=>{let e=n?n.env:{};const{fetch:t,Request:i,Response:r}=e,s=[i,r,t];let a=s.length,o=a,l,u,h=oz;for(;o--;)l=s[o],u=h.get(l),u===void 0&&h.set(l,u=o?new Map:az(e)),h=u;return u};cN();const b2={http:x5,xhr:ez,fetch:{get:cN}};we.forEach(b2,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const gk=n=>`- ${n}`,lz=n=>we.isFunction(n)||n===null||n===!1,hN={getAdapter:(n,e)=>{n=we.isArray(n)?n:[n];const{length:t}=n;let i,r;const s={};for(let a=0;a<t;a++){i=n[a];let o;if(r=i,!lz(i)&&(r=b2[(o=String(i)).toLowerCase()],r===void 0))throw new xt(`Unknown adapter '${o}'`);if(r&&(we.isFunction(r)||(r=r.get(e))))break;s[o||"#"+a]=r}if(!r){const a=Object.entries(s).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?a.length>1?`since :
`+a.map(gk).join(`
`):" "+gk(a[0]):"as no adapter specified";throw new xt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:b2};function Y1(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new sp(null,n)}function vk(n){return Y1(n),n.headers=Yr.from(n.headers),n.data=X1.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),hN.getAdapter(n.adapter||Bv.adapter,n)(n).then(function(i){return Y1(n),i.data=X1.call(n,n.transformResponse,i),i.headers=Yr.from(i.headers),i},function(i){return aN(i)||(Y1(n),i&&i.response&&(i.response.data=X1.call(n,n.transformResponse,i.response),i.response.headers=Yr.from(i.response.headers))),Promise.reject(i)})}const dN="1.12.2",Cw={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Cw[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const yk={};Cw.transitional=function(e,t,i){function r(s,a){return"[Axios v"+dN+"] Transitional option '"+s+"'"+a+(i?". "+i:"")}return(s,a,o)=>{if(e===!1)throw new xt(r(a," has been removed"+(t?" in "+t:"")),xt.ERR_DEPRECATED);return t&&!yk[a]&&(yk[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,a,o):!0}};Cw.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function uz(n,e,t){if(typeof n!="object")throw new xt("options must be an object",xt.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let r=i.length;for(;r-- >0;){const s=i[r],a=e[s];if(a){const o=n[s],l=o===void 0||a(o,s,n);if(l!==!0)throw new xt("option "+s+" must be "+l,xt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new xt("Unknown option "+s,xt.ERR_BAD_OPTION)}}const Yy={assertOptions:uz,validators:Cw},Ia=Yy.validators;let wh=class{constructor(e){this.defaults=e||{},this.interceptors={request:new ak,response:new ak}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=kh(this.defaults,t);const{transitional:i,paramsSerializer:r,headers:s}=t;i!==void 0&&Yy.assertOptions(i,{silentJSONParsing:Ia.transitional(Ia.boolean),forcedJSONParsing:Ia.transitional(Ia.boolean),clarifyTimeoutError:Ia.transitional(Ia.boolean)},!1),r!=null&&(we.isFunction(r)?t.paramsSerializer={serialize:r}:Yy.assertOptions(r,{encode:Ia.function,serialize:Ia.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Yy.assertOptions(t,{baseUrl:Ia.spelling("baseURL"),withXsrfToken:Ia.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=s&&we.merge(s.common,s[t.method]);s&&we.forEach(["delete","get","head","post","put","patch","common"],b=>{delete s[b]}),t.headers=Yr.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(t)===!1||(l=l&&_.synchronous,o.unshift(_.fulfilled,_.rejected))});const u=[];this.interceptors.response.forEach(function(_){u.push(_.fulfilled,_.rejected)});let h,d=0,f;if(!l){const b=[vk.bind(this),void 0];for(b.unshift(...o),b.push(...u),f=b.length,h=Promise.resolve(t);d<f;)h=h.then(b[d++],b[d++]);return h}f=o.length;let m=t;for(;d<f;){const b=o[d++],_=o[d++];try{m=b(m)}catch(w){_.call(this,w);break}}try{h=vk.call(this,m)}catch(b){return Promise.reject(b)}for(d=0,f=u.length;d<f;)h=h.then(u[d++],u[d++]);return h}getUri(e){e=kh(this.defaults,e);const t=lN(e.baseURL,e.url,e.allowAbsoluteUrls);return iN(t,e.params,e.paramsSerializer)}};we.forEach(["delete","get","head","options"],function(e){wh.prototype[e]=function(t,i){return this.request(kh(i||{},{method:e,url:t,data:(i||{}).data}))}});we.forEach(["post","put","patch"],function(e){function t(i){return function(s,a,o){return this.request(kh(o||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}wh.prototype[e]=t(),wh.prototype[e+"Form"]=t(!0)});let cz=class fN{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const a=new Promise(o=>{i.subscribe(o),s=o}).then(r);return a.cancel=function(){i.unsubscribe(s)},a},e(function(s,a,o){i.reason||(i.reason=new sp(s,a,o),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new fN(function(r){e=r}),cancel:e}}};function hz(n){return function(t){return n.apply(null,t)}}function dz(n){return we.isObject(n)&&n.isAxiosError===!0}const w2={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(w2).forEach(([n,e])=>{w2[e]=n});function pN(n){const e=new wh(n),t=WP(wh.prototype.request,e);return we.extend(t,wh.prototype,e,{allOwnKeys:!0}),we.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return pN(kh(n,r))},t}const wn=pN(Bv);wn.Axios=wh;wn.CanceledError=sp;wn.CancelToken=cz;wn.isCancel=aN;wn.VERSION=dN;wn.toFormData=Sw;wn.AxiosError=xt;wn.Cancel=wn.CanceledError;wn.all=function(e){return Promise.all(e)};wn.spread=hz;wn.isAxiosError=dz;wn.mergeConfig=kh;wn.AxiosHeaders=Yr;wn.formToJSON=n=>sN(we.isHTMLForm(n)?new FormData(n):n);wn.getAdapter=hN.getAdapter;wn.HttpStatusCode=w2;wn.default=wn;const{Axios:cH,AxiosError:hH,CanceledError:dH,isCancel:fH,CancelToken:pH,VERSION:mH,all:gH,Cancel:vH,isAxiosError:yH,spread:bH,toFormData:wH,AxiosHeaders:_H,HttpStatusCode:EH,formToJSON:AH,getAdapter:xH,mergeConfig:SH}=wn;class _2{constructor(e){Ae(this,"apiKey");Ae(this,"baseURL","https://jpdb.io/api/v1");this.apiKey=e}async verifyConnection(){try{return(await wn.post(`${this.baseURL}/ping`,{},{headers:this.getHeaders()})).status===200}catch(e){return console.error("JPDB connection test failed:",e),!1}}async parseText(e){try{const t=this.chunkText(e,200),i=await Promise.all(t.map(r=>wn.post(`${this.baseURL}/parse`,{text:r},{headers:this.getHeaders()})));return this.combineResults(i.map(r=>r.data))}catch(t){throw console.error("JPDB parsing failed:",t),new Error("Failed to parse text with JPDB API")}}async addVocabularyToDeck(e,t,i,r){try{return(await wn.post(`${this.baseURL}/deck/${t}/add-vocabulary`,{vocabulary_id:e,context:i,source:r},{headers:this.getHeaders()})).data}catch(s){throw console.error("Failed to add vocabulary to deck:",s),new Error("Failed to add vocabulary to deck")}}async getUserDecks(){try{return(await wn.get(`${this.baseURL}/user/decks`,{headers:this.getHeaders()})).data.decks.map(t=>({id:t.id,name:t.name,description:t.description,vocabularyCount:t.vocabulary_count||0}))}catch(e){return console.error("Failed to fetch user decks:",e),[]}}async getVocabularyDetails(e){try{return(await wn.get(`${this.baseURL}/vocabulary/${e}`,{headers:this.getHeaders()})).data}catch(t){throw console.error("Failed to fetch vocabulary details:",t),new Error("Failed to fetch vocabulary details")}}getHeaders(){return{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}}chunkText(e,t){const i=[];let r="";const s=e.split(/[。！？\n]/);for(const a of s)r.length+a.length>t&&r.length>0?(i.push(r.trim()),r=a):r+=a+"。";return r.trim()&&i.push(r.trim()),i}combineResults(e){const t=new Map;return e.forEach(i=>{i.vocabulary&&i.vocabulary.forEach(r=>{t.has(r.word)||t.set(r.word,{id:r.id||r.word,word:r.word,reading:r.reading,meaning:r.meaning,state:"new",color:"#fef3c7",frequency:r.frequency,jlptLevel:r.jlpt_level})})}),Array.from(t.values())}}const fz={};function pz(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var s;const a=l=>l===null?null:JSON.parse(l,void 0),o=(s=t.getItem(r))!=null?s:null;return o instanceof Promise?o.then(a):a(o)},setItem:(r,s)=>t.setItem(r,JSON.stringify(s,void 0)),removeItem:r=>t.removeItem(r)}}const $m=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(i){return $m(i)(t)},catch(i){return this}}}catch(t){return{then(i){return this},catch(i){return $m(i)(t)}}}},mz=(n,e)=>(t,i,r)=>{let s={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,v)=>({...v,...w}),...e},a=!1;const o=new Set,l=new Set;let u;try{u=s.getStorage()}catch{}if(!u)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(...w)},i,r);const h=$m(s.serialize),d=()=>{const w=s.partialize({...i()});let v;const y=h({state:w,version:s.version}).then(E=>u.setItem(s.name,E)).catch(E=>{v=E});if(v)throw v;return y},f=r.setState;r.setState=(w,v)=>{f(w,v),d()};const m=n((...w)=>{t(...w),d()},i,r);let b;const _=()=>{var w;if(!u)return;a=!1,o.forEach(y=>y(i()));const v=((w=s.onRehydrateStorage)==null?void 0:w.call(s,i()))||void 0;return $m(u.getItem.bind(u))(s.name).then(y=>{if(y)return s.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==s.version){if(s.migrate)return s.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var E;return b=s.merge(y,(E=i())!=null?E:m),t(b,!0),d()}).then(()=>{v?.(b,void 0),a=!0,l.forEach(y=>y(b))}).catch(y=>{v?.(void 0,y)})};return r.persist={setOptions:w=>{s={...s,...w},w.getStorage&&(u=w.getStorage())},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>_(),hasHydrated:()=>a,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},_(),b||m},gz=(n,e)=>(t,i,r)=>{let s={storage:pz(()=>localStorage),partialize:_=>_,version:0,merge:(_,w)=>({...w,..._}),...e},a=!1;const o=new Set,l=new Set;let u=s.storage;if(!u)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),t(..._)},i,r);const h=()=>{const _=s.partialize({...i()});return u.setItem(s.name,{state:_,version:s.version})},d=r.setState;r.setState=(_,w)=>{d(_,w),h()};const f=n((..._)=>{t(..._),h()},i,r);r.getInitialState=()=>f;let m;const b=()=>{var _,w;if(!u)return;a=!1,o.forEach(y=>{var E;return y((E=i())!=null?E:f)});const v=((w=s.onRehydrateStorage)==null?void 0:w.call(s,(_=i())!=null?_:f))||void 0;return $m(u.getItem.bind(u))(s.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==s.version){if(s.migrate)return[!0,s.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var E;const[k,S]=y;if(m=s.merge(S,(E=i())!=null?E:f),t(m,!0),k)return h()}).then(()=>{v?.(m,void 0),m=i(),a=!0,l.forEach(y=>y(m))}).catch(y=>{v?.(void 0,y)})};return r.persist={setOptions:_=>{s={...s,..._},_.storage&&(u=_.storage)},clearStorage:()=>{u?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>b(),hasHydrated:()=>a,onHydrate:_=>(o.add(_),()=>{o.delete(_)}),onFinishHydration:_=>(l.add(_),()=>{l.delete(_)})},s.skipHydration||b(),m||f},vz=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((fz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),mz(n,e)):gz(n,e),yz=vz,ac=_w()(yz((n,e)=>({apiKey:"",isConnected:!1,selectedDeckId:"",decks:[],colorNew:"#fef3c7",colorLearning:"#fed7aa",colorKnown:"#d9f99d",knownVocabulary:new Set,setAPIKey:t=>n({apiKey:t}),setSelectedDeck:t=>n({selectedDeckId:t}),updateDecks:t=>n({decks:t}),updateKnownVocabulary:t=>n({knownVocabulary:t}),addKnownVocabulary:t=>{const i=e().knownVocabulary,r=new Set(i);r.add(t),n({knownVocabulary:r})},removeKnownVocabulary:t=>{const i=e().knownVocabulary,r=new Set(i);r.delete(t),n({knownVocabulary:r})},updateColors:t=>n({colorNew:t.new,colorLearning:t.learning,colorKnown:t.known}),testConnection:async()=>{const{apiKey:t}=e();if(!t)return!1;try{const r=(await fetch("https://jpdb.io/api/v1/ping",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).ok;return n({isConnected:r}),r}catch{return n({isConnected:!1}),!1}}}),{name:"jpdb-settings-storage",getStorage:()=>localStorage,serialize:n=>JSON.stringify({state:{...n.state,knownVocabulary:Array.from(n.state.knownVocabulary)}}),deserialize:n=>{const e=JSON.parse(n);return{state:{...e.state,knownVocabulary:new Set(e.state.knownVocabulary)}}}}));class fx{static async parseText(e){const{apiKey:t,knownVocabulary:i}=ac.getState();if(!t)throw new Error("JPDB API key not configured");const r=await this.checkCache(e);if(r)return r;try{const o=(await new _2(t).parseText(e)).map(l=>({...l,color:this.getVocabColor(l,i),state:this.getVocabState(l,i)}));return await this.cacheResult(e,o),o}catch(s){throw console.error("Parsing failed:",s),new Error("Failed to parse text. Please check your API key and connection.")}}static async parseSubtitles(e){const t=e.map(r=>r.text).join(`
`),i=await this.parseText(t);return e.map(r=>{const s=i.filter(a=>r.text.includes(a.word));return{...r,vocabulary:s}})}static async checkCache(e){try{const t=nk(e),i=await Iu.vocabularyCache.get(t);if(i&&Date.now()-i.cachedAt.getTime()<24*60*60*1e3)return i.vocabulary}catch(t){console.error("Cache check failed:",t)}return null}static async cacheResult(e,t){try{const i=nk(e);await Iu.vocabularyCache.put({id:i,text:e.slice(0,100),vocabulary:t,cachedAt:new Date})}catch(i){console.error("Cache save failed:",i)}}static getVocabColor(e,t){const{colorNew:i,colorLearning:r,colorKnown:s}=ac.getState();return t.has(e.word)?s:e.inUserDeck?r:i}static getVocabState(e,t){return t.has(e.word)?"known":e.inUserDeck?"learning":"new"}static async addToKnownVocabulary(e){const{addKnownVocabulary:t}=ac.getState();t(e)}static async removeFromKnownVocabulary(e){const{removeKnownVocabulary:t}=ac.getState();t(e)}}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ss=(n,e)=>{const t=kt.forwardRef(({color:i="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...u},h)=>kt.createElement("svg",{ref:h,...bz,width:r,height:r,stroke:i,strokeWidth:a?Number(s)*24/Number(r):s,className:["lucide",`lucide-${wz(n)}`,o].join(" "),...u},[...e.map(([d,f])=>kt.createElement(d,f)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=Ss("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=Ss("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=Ss("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=Ss("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mN=Ss("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=Ss("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=Ss("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=Ss("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=Ss("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=Ss("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=Ss("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gN=Ss("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vN=Ss("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),hm=({onFileSelect:n,acceptedTypes:e,maxSize:t=100,className:i=""})=>{const[r,s]=gm.useState(!1),a=f=>{if(f.size>t*1024*1024){alert(`File size must be less than ${t}MB`);return}const m=o(f.name),b={file:f,type:m,id:`${m}_${Date.now()}`};n(b)},o=f=>{const m=f.toLowerCase().split(".").pop();return m==="epub"?"epub":m==="pdf"?"pdf":["mp4","webm","ogg"].includes(m||"")?"video":["srt","vtt"].includes(m||"")?"subtitle":"epub"},l=f=>{f.preventDefault(),s(!1);const m=Array.from(f.dataTransfer.files);m.length>0&&a(m[0])},u=f=>{const m=f.target.files;m&&m.length>0&&a(m[0])},h=()=>{switch(e[0]){case"epub":return Q.jsx(Az,{size:24});case"pdf":return Q.jsx(mN,{size:24});case"video":return Q.jsx(gN,{size:24});default:return Q.jsx(Dz,{size:24})}},d=()=>{switch(e[0]){case"epub":return"Select EPUB File";case"pdf":return"Select PDF/Manga File";case"video":return"Select Video File";case"subtitle":return"Select Subtitle File";default:return"Select File"}};return Q.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${r?"border-primary bg-primary/5":"border-border hover:border-primary/50"} ${i}`,onDrop:l,onDragOver:f=>{f.preventDefault(),s(!0)},onDragLeave:()=>s(!1),children:Q.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[h(),Q.jsxs("div",{children:[Q.jsx("p",{className:"text-lg font-medium text-foreground",children:d()}),Q.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop or click to browse"}),Q.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Max size: ",t,"MB"]})]}),Q.jsx("input",{type:"file",accept:e.map(f=>`.${f}`).join(","),onChange:u,className:"hidden",id:"file-upload"}),Q.jsx("label",{htmlFor:"file-upload",className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 cursor-pointer transition-colors",children:"Browse Files"})]})})},vb=({size:n=24,className:e=""})=>Q.jsx("div",{className:`flex items-center justify-center ${e}`,children:Q.jsx(Sz,{size:n,className:"animate-spin text-primary"})}),px=({vocabulary:n,onClose:e,onAddToDeck:t})=>{const{selectedDeckId:i,addKnownVocabulary:r,removeKnownVocabulary:s,knownVocabulary:a}=ac(),[o,l]=gm.useState(!1),[u,h]=gm.useState(a.has(n.word)),d=async()=>{if(!(!i||!t)){l(!0);try{await t(n.id)}catch(m){console.error("Failed to add to deck:",m)}finally{l(!1)}}},f=()=>{u?s(n.word):r(n.word),h(!u)};return Q.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Q.jsxs("div",{className:"bg-card rounded-lg shadow-lg max-w-md w-full max-h-[80vh] overflow-y-auto",children:[Q.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[Q.jsx("h3",{className:"text-lg font-semibold text-foreground",children:n.word}),Q.jsx("button",{onClick:e,className:"text-muted-foreground hover:text-foreground",children:Q.jsx(vN,{size:20})})]}),Q.jsxs("div",{className:"p-4 space-y-4",children:[n.reading&&Q.jsxs("div",{children:[Q.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Reading"}),Q.jsx("p",{className:"text-foreground",children:n.reading})]}),n.meaning&&Q.jsxs("div",{children:[Q.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Meaning"}),Q.jsx("p",{className:"text-foreground",children:n.meaning})]}),n.frequency&&Q.jsxs("div",{children:[Q.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Frequency"}),Q.jsx("p",{className:"text-foreground",children:n.frequency})]}),n.jlptLevel&&Q.jsxs("div",{children:[Q.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"JLPT Level"}),Q.jsxs("p",{className:"text-foreground",children:["N",n.jlptLevel]})]}),Q.jsxs("div",{className:"flex space-x-2 pt-4 border-t border-border",children:[Q.jsxs("button",{onClick:f,className:`flex-1 flex items-center justify-center space-x-2 py-2 px-4 rounded-md transition-colors ${u?"bg-green-100 text-green-800 hover:bg-green-200":"bg-secondary text-secondary-foreground hover:bg-secondary/80"}`,children:[Q.jsx(Qy,{size:16}),Q.jsx("span",{children:u?"Known":"Mark as Known"})]}),i&&t&&Q.jsxs("button",{onClick:d,disabled:o,className:"flex-1 flex items-center justify-center space-x-2 py-2 px-4 rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[Q.jsx(kz,{size:16}),Q.jsx("span",{children:o?"Adding...":"Add to Deck"})]})]})]})]})})},bk=()=>{const n=kt.useRef(null),[e,t]=kt.useState(null),[i,r]=kt.useState(null),[s,a]=kt.useState(!1),{currentBook:o,saveProgress:l,loadProgress:u,isLoading:h,error:d}=G1();kt.useEffect(()=>{!o||!n.current||f()},[o]);const f=async()=>{if(!(!o||!n.current))try{a(!0);const k=Lh(o.file).renderTo(n.current,{width:"100%",height:"100%",spread:"always"});t(k);const S=await u(o.id);S?k.display(S.cfi):k.display(),k.on("relocated",D=>{l(o.id,{cfi:D.start.cfi,percentage:D.start.percentage})}),k.on("rendered",async D=>{await m(D)})}catch(E){console.error("Failed to load EPUB:",E)}finally{a(!1)}},m=async E=>{try{const k=await b(E);if(!k.trim())return;const S=await fx.parseText(k);_(E,S)}catch(k){console.error("Failed to parse text:",k)}},b=async E=>{const k=await e?.getContents();return!k||!Array.isArray(k)||k.length===0?"":k[0].document.body.innerText||""},_=(E,k)=>{const S=E.document;S&&k.forEach(D=>{const P=S.createTreeWalker(S.body,NodeFilter.SHOW_TEXT,null);let F;for(;F=P.nextNode();)F.textContent?.includes(D.word)&&w(F,D)})},w=(E,k)=>{const S=E.parentNode;if(!S)return;const D=E.textContent||"",P=D.indexOf(k.word);if(P===-1)return;const F=D.substring(0,P),H=D.substring(P+k.word.length),z=document.createElement("span");z.textContent=k.word,z.className=`vocab-${k.state}`,z.style.backgroundColor=k.color,z.style.cursor="pointer",z.addEventListener("click",()=>r(k)),S.insertBefore(document.createTextNode(F),E),S.insertBefore(z,E),S.insertBefore(document.createTextNode(H),E),S.removeChild(E)},v=async E=>{E.type==="epub"&&await G1.getState().loadBook(E.file)},y=async E=>{console.log("Adding vocabulary to deck:",E)};return h||s?Q.jsx(vb,{className:"h-full"}):d?Q.jsx("div",{className:"flex items-center justify-center h-full",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("p",{className:"text-destructive mb-4",children:d}),Q.jsx("button",{onClick:()=>G1.getState().setError(null),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md",children:"Try Again"})]})}):o?Q.jsxs("div",{className:"epub-reader h-full flex flex-col",children:[Q.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[Q.jsx("h2",{className:"text-lg font-semibold text-foreground",children:o.name}),Q.jsxs("div",{className:"flex space-x-2",children:[Q.jsx("button",{onClick:()=>e?.prev(),className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80",children:"← Previous"}),Q.jsx("button",{onClick:()=>e?.next(),className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80",children:"Next →"})]})]}),Q.jsx("div",{ref:n,className:"epub-viewport flex-1"}),i&&Q.jsx(px,{vocabulary:i,onClose:()=>r(null),onAddToDeck:y})]}):Q.jsx("div",{className:"p-4",children:Q.jsx(hm,{onFileSelect:v,acceptedTypes:["epub"],maxSize:50,className:"h-full"})})};var dm={};dm.d=(n,e)=>{for(var t in e)dm.o(e,t)&&!dm.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};dm.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var bt=globalThis.pdfjsLib={};dm.d(bt,{AbortException:()=>Lu,AnnotationEditorLayer:()=>RE,AnnotationEditorParamsType:()=>$t,AnnotationEditorType:()=>Ct,AnnotationEditorUIManager:()=>Dh,AnnotationLayer:()=>xU,AnnotationMode:()=>Ll,ColorPicker:()=>Ab,DOMSVGFactory:()=>Ax,DrawLayer:()=>IE,FeatureTest:()=>Tr,GlobalWorkerOptions:()=>Zo,ImageKind:()=>Zy,InvalidPDFException:()=>A2,MissingPDFException:()=>Hm,OPS:()=>na,OutputScale:()=>S2,PDFDataRangeTransport:()=>bI,PDFDateString:()=>bx,PDFWorker:()=>Cd,PasswordResponses:()=>Iz,PermissionFlag:()=>Nz,PixelsPerInch:()=>Ou,RenderingCancelledException:()=>vx,TextLayer:()=>qm,TouchManager:()=>_b,UnexpectedResponseException:()=>yb,Util:()=>dt,VerbosityLevel:()=>kw,XfaLayer:()=>_I,build:()=>rU,createValidAbsoluteUrl:()=>Fz,fetchData:()=>Pw,getDocument:()=>X8,getFilenameFromUrl:()=>Vz,getPdfFilenameFromUrl:()=>Gz,getXfaPageViewport:()=>Kz,isDataScheme:()=>Nw,isPdfFile:()=>yx,noContextMenu:()=>Sa,normalizeUnicode:()=>Hz,setLayerDimensions:()=>Th,shadow:()=>Ft,stopEvent:()=>ys,version:()=>iU});const cr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),yN=[1,0,0,1,0,0],E2=[.001,0,0,.001,0,0],Rz=1e7,Q1=1.35,ms={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ll={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Pz="pdfjs_internal_editor_",Ct={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},$t={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},Nz={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},er={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Zy={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ui={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Dp={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},kw={ERRORS:0,WARNINGS:1,INFOS:5},na={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},Iz={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Tw=kw.WARNINGS;function Lz(n){Number.isInteger(n)&&(Tw=n)}function Oz(){return Tw}function Dw(n){Tw>=kw.INFOS&&console.log(`Info: ${n}`)}function Tt(n){Tw>=kw.WARNINGS&&console.log(`Warning: ${n}`)}function pn(n){throw new Error(n)}function ri(n,e){n||pn(e)}function Mz(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Fz(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"&&(t.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),t.tryConvertEncoding))try{n=$z(n)}catch{}const i=e?new URL(n,e):new URL(n);if(Mz(i))return i}catch{}return null}function Ft(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const $u=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class wk extends $u{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Z1 extends $u{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class A2 extends $u{constructor(e){super(e,"InvalidPDFException")}}class Hm extends $u{constructor(e){super(e,"MissingPDFException")}}class yb extends $u{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class Bz extends $u{constructor(e){super(e,"FormatError")}}class Lu extends $u{constructor(e){super(e,"AbortException")}}function bN(n){(typeof n!="object"||n?.length===void 0)&&pn("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<e;r+=t){const s=Math.min(r+t,e),a=n.subarray(r,s);i.push(String.fromCharCode.apply(null,a))}return i.join("")}function Rw(n){typeof n!="string"&&pn("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function jz(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function mx(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function zz(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Uz(){try{return new Function(""),!0}catch{return!1}}class Tr{static get isLittleEndian(){return Ft(this,"isLittleEndian",zz())}static get isEvalSupported(){return Ft(this,"isEvalSupported",Uz())}static get isOffscreenCanvasSupported(){return Ft(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ft(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?Ft(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):Ft(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return Ft(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const J1=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var al,Jy,x2;class dt{static makeHexColor(e,t,i){return`#${J1[e]}${J1[t]}${J1[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[i,r]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,s=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[r,s]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),s=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],r[0],s[0],a[0]),Math.min(i[1],r[1],s[1],a[1]),Math.max(i[0],r[0],s[0],a[0]),Math.max(i[1],r[1],s[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],s=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(i+a)/2,l=Math.sqrt((i+a)**2-4*(i*a-s*r))/2,u=o+l||1,h=o-l||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>r)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>a?null:[i,s,r,a]}static bezierBoundingBox(e,t,i,r,s,a,o,l,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],I(this,al,x2).call(this,e,i,s,o,t,r,a,l,3*(-e+3*(i-s)+o),6*(e-2*i+s),3*(i-e),u),I(this,al,x2).call(this,e,i,s,o,t,r,a,l,3*(-t+3*(r-a)+l),6*(t-2*r+a),3*(r-t),u),u}}al=new WeakSet,Jy=function(e,t,i,r,s,a,o,l,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,m=f*u,b=d*(d*(d*e+3*u*t)+3*f*i)+m*r,_=d*(d*(d*s+3*u*a)+3*f*o)+m*l;h[0]=Math.min(h[0],b),h[1]=Math.min(h[1],_),h[2]=Math.max(h[2],b),h[3]=Math.max(h[3],_)},x2=function(e,t,i,r,s,a,o,l,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&I(this,al,Jy).call(this,e,t,i,r,s,a,o,l,-d/h,f);return}const m=h**2-4*d*u;if(m<0)return;const b=Math.sqrt(m),_=2*u;I(this,al,Jy).call(this,e,t,i,r,s,a,o,l,(-h+b)/_,f),I(this,al,Jy).call(this,e,t,i,r,s,a,o,l,(-h-b)/_,f)},N(dt,al);function $z(n){return decodeURIComponent(escape(n))}let e_=null,_k=null;function Hz(n){return e_||(e_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,_k=new Map([["ﬅ","ſt"]])),n.replaceAll(e_,(e,t,i)=>t?t.normalize("NFKC"):_k.get(i))}function qz(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),bN(n)}const gx="pdfjs_internal_id_";function Wz(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(bN(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const bo="http://www.w3.org/2000/svg",ec=class ec{};Ae(ec,"CSS",96),Ae(ec,"PDF",72),Ae(ec,"PDF_TO_CSS_UNITS",ec.CSS/ec.PDF);let Ou=ec;async function Pw(n,e="text"){if(jp(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class jv{constructor({viewBox:e,userUnit:t,scale:i,rotation:r,offsetX:s=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=r,this.offsetX=s,this.offsetY=a,i*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,m;switch(r%=360,r<0&&(r+=360),r){case 180:h=-1,d=0,f=0,m=1;break;case 90:h=0,d=1,f=1,m=0;break;case 270:h=0,d=-1,f=-1,m=0;break;case 0:h=1,d=0,f=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,m=-m);let b,_,w,v;h===0?(b=Math.abs(u-e[1])*i+s,_=Math.abs(l-e[0])*i+a,w=(e[3]-e[1])*i,v=(e[2]-e[0])*i):(b=Math.abs(l-e[0])*i+s,_=Math.abs(u-e[1])*i+a,w=(e[2]-e[0])*i,v=(e[3]-e[1])*i),this.transform=[h*i,d*i,f*i,m*i,b-h*i*l-f*i*u,_-d*i*l-m*i*u],this.width=w,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(r=>r*e);return Ft(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:s=!1}={}){return new jv({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:s})}convertToViewportPoint(e,t){return dt.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=dt.applyTransform([e[0],e[1]],this.transform),i=dt.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return dt.applyInverseTransform([e,t],this.transform)}}class vx extends $u{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Nw(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function yx(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function Vz(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function Gz(n,e="document.pdf"){if(typeof n!="string")return e;if(Nw(n))return Tt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(n);let s=i.exec(r[1])||i.exec(r[2])||i.exec(r[3]);if(s&&(s=s[0],s.includes("%")))try{s=i.exec(decodeURIComponent(s))[0]}catch{}return s||e}class Ek{constructor(){Ae(this,"started",Object.create(null));Ae(this,"times",[])}time(e){e in this.started&&Tt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Tt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:r,end:s}of this.times)e.push(`${i.padEnd(t)} ${s-r}ms
`);return e.join("")}}function jp(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Sa(n){n.preventDefault()}function ys(n){n.preventDefault(),n.stopPropagation()}var Jm;class bx{static toDateObject(e){if(!e||typeof e!="string")return null;c(this,Jm)||T(this,Jm,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,Jm).exec(e);if(!t)return null;const i=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=h,o+=d):u==="+"&&(a-=h,o-=d),new Date(Date.UTC(i,r,s,a,o,l))}}Jm=new WeakMap,N(bx,Jm);function Kz(n,{scale:e=1,rotation:t=0}){const{width:i,height:r}=n.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new jv({viewBox:s,userUnit:1,scale:e,rotation:t})}function wx(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Tt(`Not a valid color format: "${n}"`),[0,0,0])}function Xz(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,wx(i))}e.remove()}function Cn(n){const{a:e,b:t,c:i,d:r,e:s,f:a}=n.getTransform();return[e,t,i,r,s,a]}function La(n){const{a:e,b:t,c:i,d:r,e:s,f:a}=n.getTransform().invertSelf();return[e,t,i,r,s,a]}function Th(n,e,t=!1,i=!0){if(e instanceof jv){const{pageWidth:r,pageHeight:s}=e.rawDims,{style:a}=n,o=Tr.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,u=`var(--scale-factor) * ${s}px`,h=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class S2{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var $l,pc,sa,mc,eg,tg,Rb,wN,Dr,_N,EN,e0,AN,k2;const Ao=class Ao{constructor(e){N(this,Dr);N(this,$l,null);N(this,pc,null);N(this,sa);N(this,mc,null);N(this,eg,null);T(this,sa,e),c(Ao,tg)||T(Ao,tg,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=T(this,$l,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,sa)._uiManager._signal;e.addEventListener("contextmenu",Sa,{signal:t}),e.addEventListener("pointerdown",I(Ao,Rb,wN),{signal:t});const i=T(this,mc,document.createElement("div"));i.className="buttons",e.append(i);const r=c(this,sa).toolbarPosition;if(r){const{style:s}=e,a=c(this,sa)._uiManager.direction==="ltr"?1-r[0]:r[0];s.insetInlineEnd=`${100*a}%`,s.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return I(this,Dr,AN).call(this),e}get div(){return c(this,$l)}hide(){c(this,$l).classList.add("hidden"),c(this,pc)?.hideDropdown()}show(){c(this,$l).classList.remove("hidden"),c(this,eg)?.shown()}async addAltText(e){const t=await e.render();I(this,Dr,e0).call(this,t),c(this,mc).prepend(t,c(this,Dr,k2)),T(this,eg,e)}addColorPicker(e){T(this,pc,e);const t=e.renderButton();I(this,Dr,e0).call(this,t),c(this,mc).prepend(t,c(this,Dr,k2))}remove(){c(this,$l).remove(),c(this,pc)?.destroy(),T(this,pc,null)}};$l=new WeakMap,pc=new WeakMap,sa=new WeakMap,mc=new WeakMap,eg=new WeakMap,tg=new WeakMap,Rb=new WeakSet,wN=function(e){e.stopPropagation()},Dr=new WeakSet,_N=function(e){c(this,sa)._focusEventsAllowed=!1,ys(e)},EN=function(e){c(this,sa)._focusEventsAllowed=!0,ys(e)},e0=function(e){const t=c(this,sa)._uiManager._signal;e.addEventListener("focusin",I(this,Dr,_N).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",I(this,Dr,EN).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Sa,{signal:t})},AN=function(){const{editorType:e,_uiManager:t}=c(this,sa),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",c(Ao,tg)[e]),I(this,Dr,e0).call(this,i),i.addEventListener("click",r=>{t.delete()},{signal:t._signal}),c(this,mc).append(i)},k2=function(){const e=document.createElement("div");return e.className="divider",e},N(Ao,Rb),N(Ao,tg,null);let C2=Ao;var ng,gc,vc,Mu,xN,SN,CN;class Yz{constructor(e){N(this,Mu);N(this,ng,null);N(this,gc,null);N(this,vc);T(this,vc,e)}show(e,t,i){const[r,s]=I(this,Mu,SN).call(this,t,i),{style:a}=c(this,gc)||T(this,gc,I(this,Mu,xN).call(this));e.append(c(this,gc)),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,gc).remove()}}ng=new WeakMap,gc=new WeakMap,vc=new WeakMap,Mu=new WeakSet,xN=function(){const e=T(this,gc,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Sa,{signal:c(this,vc)._signal});const t=T(this,ng,document.createElement("div"));return t.className="buttons",e.append(t),I(this,Mu,CN).call(this),e},SN=function(e,t){let i=0,r=0;for(const s of e){const a=s.y+s.height;if(a<i)continue;const o=s.x+(t?s.width:0);if(a>i){r=o,i=a;continue}t?o>r&&(r=o):o<r&&(r=o)}return[t?1-r:r,i]},CN=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=c(this,vc)._signal;e.addEventListener("contextmenu",Sa,{signal:i}),e.addEventListener("click",()=>{c(this,vc).highlightSelection("floating_button")},{signal:i}),c(this,ng).append(e)};function bb(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var Pb;class Qz{constructor(){N(this,Pb,0)}get id(){return`${Pz}${_i(this,Pb)._++}`}}Pb=new WeakMap;var Od,ig,ir,Md,t0;const Nx=class Nx{constructor(){N(this,Md);N(this,Od,qz());N(this,ig,0);N(this,ir,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const s=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return Ft(this,"_isSVGFittingCanvas",s)}async getFromFile(e){const{lastModified:t,name:i,size:r,type:s}=e;return I(this,Md,t0).call(this,`${t}_${i}_${r}_${s}`,e)}async getFromUrl(e){return I(this,Md,t0).call(this,e,e)}async getFromBlob(e,t){const i=await t;return I(this,Md,t0).call(this,e,i)}async getFromId(e){c(this,ir)||T(this,ir,new Map);const t=c(this,ir).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,ir)||T(this,ir,new Map);let i=c(this,ir).get(e);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${c(this,Od)}_${_i(this,ig)._++}`,refCounter:1,isSvg:!1},c(this,ir).set(e,i),c(this,ir).set(i.id,i),i}getSvgUrl(e){const t=c(this,ir).get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){c(this,ir)||T(this,ir,new Map);const t=c(this,ir).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}i.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,Od)}_`)}};Od=new WeakMap,ig=new WeakMap,ir=new WeakMap,Md=new WeakSet,t0=async function(e,t){c(this,ir)||T(this,ir,new Map);let i=c(this,ir).get(e);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${c(this,Od)}_${_i(this,ig)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(i.url=t,r=await Pw(t,"blob")):t instanceof File?r=i.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const s=Nx._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,h)=>{o.onload=()=>{i.bitmap=o,i.isSvg=!0,u()},a.onload=async()=>{const d=i.svgUrl=a.result;o.src=await s?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(r),await l}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){Tt(r),i=null}return c(this,ir).set(e,i),i&&c(this,ir).set(i.id,i),i};let T2=Nx;var Gn,Hl,rg,Ln;class Zz{constructor(e=128){N(this,Gn,[]);N(this,Hl,!1);N(this,rg);N(this,Ln,-1);T(this,rg,e)}add({cmd:e,undo:t,post:i,mustExec:r,type:s=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(r&&e(),c(this,Hl))return;const l={cmd:e,undo:t,post:i,type:s};if(c(this,Ln)===-1){c(this,Gn).length>0&&(c(this,Gn).length=0),T(this,Ln,0),c(this,Gn).push(l);return}if(a&&c(this,Gn)[c(this,Ln)].type===s){o&&(l.undo=c(this,Gn)[c(this,Ln)].undo),c(this,Gn)[c(this,Ln)]=l;return}const u=c(this,Ln)+1;u===c(this,rg)?c(this,Gn).splice(0,1):(T(this,Ln,u),u<c(this,Gn).length&&c(this,Gn).splice(u)),c(this,Gn).push(l)}undo(){if(c(this,Ln)===-1)return;T(this,Hl,!0);const{undo:e,post:t}=c(this,Gn)[c(this,Ln)];e(),t?.(),T(this,Hl,!1),T(this,Ln,c(this,Ln)-1)}redo(){if(c(this,Ln)<c(this,Gn).length-1){T(this,Ln,c(this,Ln)+1),T(this,Hl,!0);const{cmd:e,post:t}=c(this,Gn)[c(this,Ln)];e(),t?.(),T(this,Hl,!1)}}hasSomethingToUndo(){return c(this,Ln)!==-1}hasSomethingToRedo(){return c(this,Ln)<c(this,Gn).length-1}cleanType(e){if(c(this,Ln)!==-1){for(let t=c(this,Ln);t>=0;t--)if(c(this,Gn)[t].type!==e){c(this,Gn).splice(t+1,c(this,Ln)-t),T(this,Ln,t);return}c(this,Gn).length=0,T(this,Ln,-1)}}destroy(){T(this,Gn,null)}}Gn=new WeakMap,Hl=new WeakMap,rg=new WeakMap,Ln=new WeakMap;var Nb,kN;class zv{constructor(e){N(this,Nb);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Tr.platform;for(const[i,r,s={}]of e)for(const a of i){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:r,options:s}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(I(this,Nb,kN).call(this,t));if(!i)return;const{callback:r,options:{bubbles:s=!1,args:a=[],checker:o=null}}=i;o&&!o(e,t)||(r.bind(e,...a,t)(),s||ys(t))}}Nb=new WeakSet,kN=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Ib=class Ib{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Xz(e),Ft(this,"_colors",e)}convert(e){const t=wx(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,r]of this._colors)if(r.every((s,a)=>s===t[a]))return Ib._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?dt.makeHexColor(...t):e}};Ae(Ib,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let D2=Ib;var Fd,is,di,Oi,Bd,ko,jd,Rs,ql,yc,zd,bc,$a,aa,wc,sg,ag,Ud,og,Ha,Wl,$d,Vl,qa,Lb,Gl,lg,Kl,_c,ug,cg,Ai,rn,To,Ec,hg,dg,Xl,Wa,Do,fg,Ps,Je,n0,R2,TN,DN,i0,RN,PN,NN,P2,IN,N2,I2,LN,yr,wo,ON,MN,L2,FN,zp,O2;const gd=class gd{constructor(e,t,i,r,s,a,o,l,u,h,d,f,m){N(this,Je);N(this,Fd,new AbortController);N(this,is,null);N(this,di,new Map);N(this,Oi,new Map);N(this,Bd,null);N(this,ko,null);N(this,jd,null);N(this,Rs,new Zz);N(this,ql,null);N(this,yc,null);N(this,zd,0);N(this,bc,new Set);N(this,$a,null);N(this,aa,null);N(this,wc,new Set);Ae(this,"_editorUndoBar",null);N(this,sg,!1);N(this,ag,!1);N(this,Ud,!1);N(this,og,null);N(this,Ha,null);N(this,Wl,null);N(this,$d,null);N(this,Vl,!1);N(this,qa,null);N(this,Lb,new Qz);N(this,Gl,!1);N(this,lg,!1);N(this,Kl,null);N(this,_c,null);N(this,ug,null);N(this,cg,null);N(this,Ai,Ct.NONE);N(this,rn,new Set);N(this,To,null);N(this,Ec,null);N(this,hg,null);N(this,dg,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});N(this,Xl,[0,0]);N(this,Wa,null);N(this,Do,null);N(this,fg,null);N(this,Ps,null);const b=this._signal=c(this,Fd).signal;T(this,Do,e),T(this,fg,t),T(this,Bd,i),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:b}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),r._on("setpreference",this.onSetPreference.bind(this),{signal:b}),r._on("switchannotationeditorparams",_=>this.updateParams(_.type,_.value),{signal:b}),I(this,Je,RN).call(this),I(this,Je,LN).call(this),I(this,Je,P2).call(this),T(this,ko,s.annotationStorage),T(this,og,s.filterFactory),T(this,Ec,a),T(this,$d,o||null),T(this,sg,l),T(this,ag,u),T(this,Ud,h),T(this,cg,d||null),this.viewParameters={realScale:Ou.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=gd.prototype,t=a=>c(a,Do).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),i=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},r=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Ft(this,"_keyboardManager",new zv([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,Do).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,Do).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}destroy(){c(this,Ps)?.resolve(),T(this,Ps,null),c(this,Fd)?.abort(),T(this,Fd,null),this._signal=null;for(const e of c(this,Oi).values())e.destroy();c(this,Oi).clear(),c(this,di).clear(),c(this,wc).clear(),T(this,is,null),c(this,rn).clear(),c(this,Rs).destroy(),c(this,Bd)?.destroy(),c(this,qa)?.hide(),T(this,qa,null),c(this,Ha)&&(clearTimeout(c(this,Ha)),T(this,Ha,null)),c(this,Wa)&&(clearTimeout(c(this,Wa)),T(this,Wa,null)),this._editorUndoBar?.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,cg)}get useNewAltTextFlow(){return c(this,ag)}get useNewAltTextWhenAddingImage(){return c(this,Ud)}get hcmFilter(){return Ft(this,"hcmFilter",c(this,Ec)?c(this,og).addHCMFilter(c(this,Ec).foreground,c(this,Ec).background):"none")}get direction(){return Ft(this,"direction",getComputedStyle(c(this,Do)).direction)}get highlightColors(){return Ft(this,"highlightColors",c(this,$d)?new Map(c(this,$d).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return Ft(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),T(this,yc,e)}setMainHighlightColorPicker(e){T(this,ug,e)}editAltText(e,t=!1){c(this,Bd)?.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":T(this,Ud,t);break}}onPageChanging({pageNumber:e}){T(this,zd,e-1)}focusMainContainer(){c(this,Do).focus()}findParent(e,t){for(const i of c(this,Oi).values()){const{x:r,y:s,width:a,height:o}=i.div.getBoundingClientRect();if(e>=r&&e<=r+a&&t>=s&&t<=s+o)return i}return null}disableUserSelect(e=!1){c(this,fg).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,wc).add(e)}removeShouldRescale(e){c(this,wc).delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Ou.PDF_TO_CSS_UNITS;for(const t of c(this,wc))t.onScaleChanging();c(this,yc)?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a}=t,o=t.toString(),u=I(this,Je,n0).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const d=I(this,Je,R2).call(this,u),f=c(this,Ai)===Ct.NONE,m=()=>{d?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:a,text:o}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(Ct.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&c(this,ko)&&!c(this,ko).has(e.id)&&c(this,ko).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,c(this,Vl)&&(T(this,Vl,!1),I(this,Je,i0).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,rn))if(t.div.contains(e)){T(this,_c,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,_c))return;const[e,t]=c(this,_c);T(this,_c,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){I(this,Je,P2).call(this),I(this,Je,N2).call(this)}removeEditListeners(){I(this,Je,IN).call(this),I(this,Je,I2).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of c(this,aa))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of c(this,aa))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),c(this,is)?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of c(this,rn)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const a of c(this,aa))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){Tt(`paste: "${s.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const s=[];for(const l of i){const u=await r.deserialize(l);if(!u)return;s.push(u)}const a=()=>{for(const l of s)I(this,Je,L2).call(this,l);I(this,Je,O2).call(this,s)},o=()=>{for(const l of s)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(s){Tt(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,Ai)!==Ct.NONE&&!this.isEditorHandlingKeyboard&&gd._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,Vl)&&(T(this,Vl,!1),I(this,Je,i0).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(I(this,Je,PN).call(this),I(this,Je,N2).call(this),I(this,Je,yr).call(this,{isEditing:c(this,Ai)!==Ct.NONE,isEmpty:I(this,Je,zp).call(this),hasSomethingToUndo:c(this,Rs).hasSomethingToUndo(),hasSomethingToRedo:c(this,Rs).hasSomethingToRedo(),hasSelectedEditor:!1})):(I(this,Je,NN).call(this),I(this,Je,I2).call(this),I(this,Je,yr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,aa)){T(this,aa,e);for(const t of c(this,aa))I(this,Je,wo).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,Lb).id}get currentLayer(){return c(this,Oi).get(c(this,zd))}getLayer(e){return c(this,Oi).get(e)}get currentPageIndex(){return c(this,zd)}addLayer(e){c(this,Oi).set(e.pageIndex,e),c(this,Gl)?e.enable():e.disable()}removeLayer(e){c(this,Oi).delete(e.pageIndex)}async updateMode(e,t=null,i=!1){if(c(this,Ai)!==e&&!(c(this,Ps)&&(await c(this,Ps).promise,!c(this,Ps)))){if(T(this,Ps,Promise.withResolvers()),T(this,Ai,e),e===Ct.NONE){this.setEditingState(!1),I(this,Je,MN).call(this),this._editorUndoBar?.hide(),c(this,Ps).resolve();return}this.setEditingState(!0),await I(this,Je,ON).call(this),this.unselectAll();for(const r of c(this,Oi).values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),c(this,Ps).resolve();return}for(const r of c(this,di).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();c(this,Ps).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==c(this,Ai)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(c(this,aa)){switch(e){case $t.CREATE:this.currentLayer.addNewEditor();return;case $t.HIGHLIGHT_DEFAULT_COLOR:c(this,ug)?.updateColor(t);break;case $t.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,hg)||T(this,hg,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of c(this,rn))i.updateParams(e,t);for(const i of c(this,aa))i.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){for(const s of c(this,di).values())s.editorType===e&&s.show(t);(c(this,hg)?.get($t.HIGHLIGHT_SHOW_ALL)??!0)!==t&&I(this,Je,wo).call(this,[[$t.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,lg)!==e){T(this,lg,e);for(const t of c(this,Oi).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of c(this,di).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return c(this,di).get(e)}addEditor(e){c(this,di).set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(c(this,Ha)&&clearTimeout(c(this,Ha)),T(this,Ha,setTimeout(()=>{this.focusMainContainer(),T(this,Ha,null)},0))),c(this,di).delete(e.id),this.unselect(e),(!e.annotationElementId||!c(this,bc).has(e.annotationElementId))&&c(this,ko)?.remove(e.id)}addDeletedAnnotationElement(e){c(this,bc).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,bc).has(e)}removeDeletedAnnotationElement(e){c(this,bc).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,is)!==e&&(T(this,is,e),e&&I(this,Je,wo).call(this,e.propertiesToUpdate))}updateUI(e){c(this,Je,FN)===e&&I(this,Je,wo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){I(this,Je,wo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,rn).has(e)){c(this,rn).delete(e),e.unselect(),I(this,Je,yr).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,rn).add(e),e.select(),I(this,Je,wo).call(this,e.propertiesToUpdate),I(this,Je,yr).call(this,{hasSelectedEditor:!0})}setSelected(e){c(this,yc)?.commitOrRemove();for(const t of c(this,rn))t!==e&&t.unselect();c(this,rn).clear(),c(this,rn).add(e),e.select(),I(this,Je,wo).call(this,e.propertiesToUpdate),I(this,Je,yr).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,rn).has(e)}get firstSelectedEditor(){return c(this,rn).values().next().value}unselect(e){e.unselect(),c(this,rn).delete(e),I(this,Je,yr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,rn).size!==0}get isEnterHandled(){return c(this,rn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){c(this,Rs).undo(),I(this,Je,yr).call(this,{hasSomethingToUndo:c(this,Rs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:I(this,Je,zp).call(this)}),this._editorUndoBar?.hide()}redo(){c(this,Rs).redo(),I(this,Je,yr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,Rs).hasSomethingToRedo(),isEmpty:I(this,Je,zp).call(this)})}addCommands(e){c(this,Rs).add(e),I(this,Je,yr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:I(this,Je,zp).call(this)})}cleanUndoStack(e){c(this,Rs).cleanType(e)}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,rn)],i=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(const s of t)s.remove()},r=()=>{for(const s of t)I(this,Je,L2).call(this,s)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){c(this,is)?.commitOrRemove()}hasSomethingToControl(){return c(this,is)||this.hasSelection}selectAll(){for(const e of c(this,rn))e.commit();I(this,Je,O2).call(this,c(this,di).values())}unselectAll(){if(!(c(this,is)&&(c(this,is).commitOrRemove(),c(this,Ai)!==Ct.NONE))&&!c(this,yc)?.commitOrRemove()&&this.hasSelection){for(const e of c(this,rn))e.unselect();c(this,rn).clear(),I(this,Je,yr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;c(this,Xl)[0]+=e,c(this,Xl)[1]+=t;const[r,s]=c(this,Xl),a=[...c(this,rn)],o=1e3;c(this,Wa)&&clearTimeout(c(this,Wa)),T(this,Wa,setTimeout(()=>{T(this,Wa,null),c(this,Xl)[0]=c(this,Xl)[1]=0,this.addCommands({cmd:()=>{for(const l of a)c(this,di).has(l.id)&&l.translateInPage(r,s)},undo:()=>{for(const l of a)c(this,di).has(l.id)&&l.translateInPage(-r,-s)},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,$a,new Map);for(const e of c(this,rn))c(this,$a).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,$a))return!1;this.disableUserSelect(!1);const e=c(this,$a);T(this,$a,null);let t=!1;for(const[{x:r,y:s,pageIndex:a},o]of e)o.newX=r,o.newY=s,o.newPageIndex=a,t||(t=r!==o.savedX||s!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const i=(r,s,a,o)=>{if(c(this,di).has(r.id)){const l=c(this,Oi).get(o);l?r._setParentAndPosition(l,s,a):(r.pageIndex=o,r.x=s,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:s,newY:a,newPageIndex:o}]of e)i(r,s,a,o)},undo:()=>{for(const[r,{savedX:s,savedY:a,savedPageIndex:o}]of e)i(r,s,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,$a))for(const i of c(this,$a).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||c(this,rn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,is)===e}getActive(){return c(this,is)}getMode(){return c(this,Ai)}get imageManager(){return Ft(this,"imageManager",new T2)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:r,width:s,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,d,f)=>({x:(h-r)/a,y:1-(u+d-i)/s,width:f/a,height:d/s});break;case"180":o=(u,h,d,f)=>({x:1-(u+d-i)/s,y:1-(h+f-r)/a,width:d/s,height:f/a});break;case"270":o=(u,h,d,f)=>({x:1-(h+f-r)/a,y:(u-i)/s,width:f/a,height:d/s});break;default:o=(u,h,d,f)=>({x:(u-i)/s,y:(h-r)/a,width:d/s,height:f/a});break}const l=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:m,width:b,height:_}of d.getClientRects())b===0||_===0||l.push(o(f,m,b,_))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,jd)||T(this,jd,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){c(this,jd)?.delete(e)}renderAnnotationElement(e){const t=c(this,jd)?.get(e.data.id);if(!t)return;const i=c(this,ko).getRawValue(t);i&&(c(this,Ai)===Ct.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}};Fd=new WeakMap,is=new WeakMap,di=new WeakMap,Oi=new WeakMap,Bd=new WeakMap,ko=new WeakMap,jd=new WeakMap,Rs=new WeakMap,ql=new WeakMap,yc=new WeakMap,zd=new WeakMap,bc=new WeakMap,$a=new WeakMap,aa=new WeakMap,wc=new WeakMap,sg=new WeakMap,ag=new WeakMap,Ud=new WeakMap,og=new WeakMap,Ha=new WeakMap,Wl=new WeakMap,$d=new WeakMap,Vl=new WeakMap,qa=new WeakMap,Lb=new WeakMap,Gl=new WeakMap,lg=new WeakMap,Kl=new WeakMap,_c=new WeakMap,ug=new WeakMap,cg=new WeakMap,Ai=new WeakMap,rn=new WeakMap,To=new WeakMap,Ec=new WeakMap,hg=new WeakMap,dg=new WeakMap,Xl=new WeakMap,Wa=new WeakMap,Do=new WeakMap,fg=new WeakMap,Ps=new WeakMap,Je=new WeakSet,n0=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},R2=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of c(this,Oi).values())if(i.hasTextLayer(e))return i;return null},TN=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=I(this,Je,n0).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(c(this,qa)||T(this,qa,new Yz(this)),c(this,qa).show(i,r,this.direction==="ltr"))},DN=function(){const e=document.getSelection();if(!e||e.isCollapsed){c(this,To)&&(c(this,qa)?.hide(),T(this,To,null),I(this,Je,yr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,To))return;const r=I(this,Je,n0).call(this,e).closest(".textLayer");if(!r){c(this,To)&&(c(this,qa)?.hide(),T(this,To,null),I(this,Je,yr).call(this,{hasSelectedText:!1}));return}if(c(this,qa)?.hide(),T(this,To,t),I(this,Je,yr).call(this,{hasSelectedText:!0}),!(c(this,Ai)!==Ct.HIGHLIGHT&&c(this,Ai)!==Ct.NONE)&&(c(this,Ai)===Ct.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,Vl,this.isShiftKeyDown),!this.isShiftKeyDown)){const s=c(this,Ai)===Ct.HIGHLIGHT?I(this,Je,R2).call(this,r):null;s?.toggleDrawing();const a=new AbortController,o=this.combinedSignal(a),l=u=>{u.type==="pointerup"&&u.button!==0||(a.abort(),s?.toggleDrawing(!0),u.type==="pointerup"&&I(this,Je,i0).call(this,"main_toolbar"))};window.addEventListener("pointerup",l,{signal:o}),window.addEventListener("blur",l,{signal:o})}},i0=function(e=""){c(this,Ai)===Ct.HIGHLIGHT?this.highlightSelection(e):c(this,sg)&&I(this,Je,TN).call(this)},RN=function(){document.addEventListener("selectionchange",I(this,Je,DN).bind(this),{signal:this._signal})},PN=function(){if(c(this,Wl))return;T(this,Wl,new AbortController);const e=this.combinedSignal(c(this,Wl));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},NN=function(){c(this,Wl)?.abort(),T(this,Wl,null)},P2=function(){if(c(this,Kl))return;T(this,Kl,new AbortController);const e=this.combinedSignal(c(this,Kl));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},IN=function(){c(this,Kl)?.abort(),T(this,Kl,null)},N2=function(){if(c(this,ql))return;T(this,ql,new AbortController);const e=this.combinedSignal(c(this,ql));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},I2=function(){c(this,ql)?.abort(),T(this,ql,null)},LN=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},yr=function(e){Object.entries(e).some(([i,r])=>c(this,dg)[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,dg),e)}),c(this,Ai)===Ct.HIGHLIGHT&&e.hasSelectedEditor===!1&&I(this,Je,wo).call(this,[[$t.HIGHLIGHT_FREE,!0]]))},wo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},ON=async function(){if(!c(this,Gl)){T(this,Gl,!0);const e=[];for(const t of c(this,Oi).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,di).values())t.enable()}},MN=function(){if(this.unselectAll(),c(this,Gl)){T(this,Gl,!1);for(const e of c(this,Oi).values())e.disable();for(const e of c(this,di).values())e.disable()}},L2=function(e){const t=c(this,Oi).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},FN=function(){let e=null;for(e of c(this,rn));return e},zp=function(){if(c(this,di).size===0)return!0;if(c(this,di).size===1)for(const e of c(this,di).values())return e.isEmpty();return!1},O2=function(e){for(const t of c(this,rn))t.unselect();c(this,rn).clear();for(const t of e)t.isEmpty()||(c(this,rn).add(t),t.select());I(this,Je,yr).call(this,{hasSelectedEditor:this.hasSelection})},Ae(gd,"TRANSLATE_SMALL",1),Ae(gd,"TRANSLATE_BIG",10);let Dh=gd;var xi,Va,oa,Hd,Ga,rs,qd,Ka,jr,Ro,Ac,Xa,Yl,wa,Up,r0;const br=class br{constructor(e){N(this,wa);N(this,xi,null);N(this,Va,!1);N(this,oa,null);N(this,Hd,null);N(this,Ga,null);N(this,rs,null);N(this,qd,!1);N(this,Ka,null);N(this,jr,null);N(this,Ro,null);N(this,Ac,null);N(this,Xa,!1);T(this,jr,e),T(this,Xa,e._uiManager.useNewAltTextFlow),c(br,Yl)||T(br,Yl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){br._l10n??(br._l10n=e)}async render(){const e=T(this,oa,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=T(this,Hd,document.createElement("span"));e.append(t),c(this,Xa)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(br,Yl).missing),t.setAttribute("data-l10n-id",c(br,Yl)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=c(this,jr)._uiManager._signal;e.addEventListener("contextmenu",Sa,{signal:i}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:i});const r=s=>{s.preventDefault(),c(this,jr)._uiManager.editAltText(c(this,jr)),c(this,Xa)&&c(this,jr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,wa,Up)}})};return e.addEventListener("click",r,{capture:!0,signal:i}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(T(this,qd,!0),r(s))},{signal:i}),await I(this,wa,r0).call(this),e}finish(){c(this,oa)&&(c(this,oa).focus({focusVisible:c(this,qd)}),T(this,qd,!1))}isEmpty(){return c(this,Xa)?c(this,xi)===null:!c(this,xi)&&!c(this,Va)}hasData(){return c(this,Xa)?c(this,xi)!==null||!!c(this,Ro):this.isEmpty()}get guessedText(){return c(this,Ro)}async setGuessedText(e){c(this,xi)===null&&(T(this,Ro,e),T(this,Ac,await br._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),I(this,wa,r0).call(this))}toggleAltTextBadge(e=!1){if(!c(this,Xa)||c(this,xi)){c(this,Ka)?.remove(),T(this,Ka,null);return}if(!c(this,Ka)){const t=T(this,Ka,document.createElement("div"));t.className="noAltTextBadge",c(this,jr).div.append(t)}c(this,Ka).classList.toggle("hidden",!e)}serialize(e){let t=c(this,xi);return!e&&c(this,Ro)===t&&(t=c(this,Ac)),{altText:t,decorative:c(this,Va),guessedText:c(this,Ro),textWithDisclaimer:c(this,Ac)}}get data(){return{altText:c(this,xi),decorative:c(this,Va)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:r,cancel:s=!1}){i&&(T(this,Ro,i),T(this,Ac,r)),!(c(this,xi)===e&&c(this,Va)===t)&&(s||(T(this,xi,e),T(this,Va,t)),I(this,wa,r0).call(this))}toggle(e=!1){c(this,oa)&&(!e&&c(this,rs)&&(clearTimeout(c(this,rs)),T(this,rs,null)),c(this,oa).disabled=!e)}shown(){c(this,jr)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,wa,Up)}})}destroy(){c(this,oa)?.remove(),T(this,oa,null),T(this,Hd,null),T(this,Ga,null),c(this,Ka)?.remove(),T(this,Ka,null)}};xi=new WeakMap,Va=new WeakMap,oa=new WeakMap,Hd=new WeakMap,Ga=new WeakMap,rs=new WeakMap,qd=new WeakMap,Ka=new WeakMap,jr=new WeakMap,Ro=new WeakMap,Ac=new WeakMap,Xa=new WeakMap,Yl=new WeakMap,wa=new WeakSet,Up=function(){return c(this,xi)&&"added"||c(this,xi)===null&&this.guessedText&&"review"||"missing"},r0=async function(){const e=c(this,oa);if(!e)return;if(c(this,Xa)){if(e.classList.toggle("done",!!c(this,xi)),e.setAttribute("data-l10n-id",c(br,Yl)[c(this,wa,Up)]),c(this,Hd)?.setAttribute("data-l10n-id",c(br,Yl)[`${c(this,wa,Up)}-label`]),!c(this,xi)){c(this,Ga)?.remove();return}}else{if(!c(this,xi)&&!c(this,Va)){e.classList.remove("done"),c(this,Ga)?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,Ga);if(!t){T(this,Ga,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,jr).id}`;const r=100,s=c(this,jr)._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(c(this,rs)),T(this,rs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{T(this,rs,setTimeout(()=>{T(this,rs,null),c(this,Ga).classList.add("show"),c(this,jr)._reportTelemetry({action:"alt_text_tooltip"})},r))},{signal:s}),e.addEventListener("mouseleave",()=>{c(this,rs)&&(clearTimeout(c(this,rs)),T(this,rs,null)),c(this,Ga)?.classList.remove("show")},{signal:s})}c(this,Va)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,xi)),t.parentNode||e.append(t),c(this,jr).getImageForAltText()?.setAttribute("aria-describedby",t.id)},N(br,Yl,null),Ae(br,"_l10n",null);let wb=br;var pg,xc,mg,gg,vg,yg,bg,Wd,Po,Sc,Ql,vl,BN,jN,M2;const Ix=class Ix{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:s=null,onPinchEnd:a=null,signal:o}){N(this,vl);N(this,pg);N(this,xc,!1);N(this,mg,null);N(this,gg);N(this,vg);N(this,yg);N(this,bg);N(this,Wd);N(this,Po,null);N(this,Sc);N(this,Ql,null);T(this,pg,e),T(this,mg,i),T(this,gg,t),T(this,vg,r),T(this,yg,s),T(this,bg,a),T(this,Sc,new AbortController),T(this,Wd,AbortSignal.any([o,c(this,Sc).signal])),e.addEventListener("touchstart",I(this,vl,BN).bind(this),{passive:!1,signal:c(this,Wd)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return Ft(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){c(this,Sc)?.abort(),T(this,Sc,null)}};pg=new WeakMap,xc=new WeakMap,mg=new WeakMap,gg=new WeakMap,vg=new WeakMap,yg=new WeakMap,bg=new WeakMap,Wd=new WeakMap,Po=new WeakMap,Sc=new WeakMap,Ql=new WeakMap,vl=new WeakSet,BN=function(e){var r,s,a;if((r=c(this,gg))!=null&&r.call(this)||e.touches.length<2)return;if(!c(this,Ql)){T(this,Ql,new AbortController);const o=AbortSignal.any([c(this,Wd),c(this,Ql).signal]),l=c(this,pg),u={signal:o,passive:!1};l.addEventListener("touchmove",I(this,vl,jN).bind(this),u),l.addEventListener("touchend",I(this,vl,M2).bind(this),u),l.addEventListener("touchcancel",I(this,vl,M2).bind(this),u),(s=c(this,vg))==null||s.call(this)}if(ys(e),e.touches.length!==2||(a=c(this,mg))!=null&&a.call(this)){T(this,Po,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),T(this,Po,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},jN=function(e){var k;if(!c(this,Po)||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:r,screenY:s}=t,{screenX:a,screenY:o}=i,l=c(this,Po),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=l,m=d-u,b=f-h,_=a-r,w=o-s,v=Math.hypot(_,w)||1,y=Math.hypot(m,b)||1;if(!c(this,xc)&&Math.abs(y-v)<=Ix.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=r,l.touch0Y=s,l.touch1X=a,l.touch1Y=o,e.preventDefault(),!c(this,xc)){T(this,xc,!0);return}const E=[(r+a)/2,(s+o)/2];(k=c(this,yg))==null||k.call(this,E,y,v)},M2=function(e){var t;c(this,Ql).abort(),T(this,Ql,null),(t=c(this,bg))==null||t.call(this),c(this,Po)&&(e.preventDefault(),T(this,Po,null),T(this,xc,!1))};let _b=Ix;var Cc,la,bn,Vd,Zl,wg,kc,Mi,Tc,No,Jl,_g,Dc,ss,Eg,Rc,Io,Ya,Gd,Kd,Ns,Pc,Ag,Ob,mt,F2,xg,B2,s0,zN,UN,j2,a0,z2,$N,HN,qN,U2,WN,$2,VN,GN,KN,H2,$p;const Pt=class Pt{constructor(e){N(this,mt);N(this,Cc,null);N(this,la,null);N(this,bn,null);N(this,Vd,!1);N(this,Zl,null);N(this,wg,"");N(this,kc,!1);N(this,Mi,null);N(this,Tc,null);N(this,No,null);N(this,Jl,null);N(this,_g,"");N(this,Dc,!1);N(this,ss,null);N(this,Eg,!1);N(this,Rc,!1);N(this,Io,!1);N(this,Ya,null);N(this,Gd,0);N(this,Kd,0);N(this,Ns,null);N(this,Pc,null);Ae(this,"_editToolbar",null);Ae(this,"_initialOptions",Object.create(null));Ae(this,"_initialData",null);Ae(this,"_isVisible",!0);Ae(this,"_uiManager",null);Ae(this,"_focusEventsAllowed",!0);N(this,Ag,!1);N(this,Ob,Pt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:r,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[s,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Pt.prototype._resizeWithKeyboard,t=Dh.TRANSLATE_SMALL,i=Dh.TRANSLATE_BIG;return Ft(this,"_resizerKeyboardManager",new zv([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],Pt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return Ft(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Jz({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Pt._l10n??(Pt._l10n=e),Pt._l10nResizer||(Pt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Pt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Pt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){pn("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,Ag)}set _isDraggable(e){T(this,Ag,e),this.div?.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,Ob)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):I(this,mt,$p).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,Dc)?T(this,Dc,!1):this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,r){const[s,a]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(e+i)/s,this.y=(t+r)/a,this.fixAndSetPosition()}translate(e,t){I(this,mt,F2).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,ss)||T(this,ss,[this.x,this.y,this.width,this.height]),I(this,mt,F2).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){c(this,ss)||T(this,ss,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[r,s]}=this;if(this.x+=e/r,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:h}=i;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,ss)&&(c(this,ss)[0]!==this.x||c(this,ss)[1]!==this.y)}get _hasBeenResized(){return!!c(this,ss)&&(c(this,ss)[2]!==this.width||c(this,ss)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=Pt,r=i/e,s=i/t;switch(this.rotation){case 90:return[-r,s];case 180:return[r,s];case 270:return[r,-s];default:return[-r,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,r]}=this;let{x:s,y:a,width:o,height:l}=this;if(o*=i,l*=r,s*=i,a*=r,this._mustFixPosition)switch(e){case 0:s=Math.max(0,Math.min(i-o,s)),a=Math.max(0,Math.min(r-l,a));break;case 90:s=Math.max(0,Math.min(i-l,s)),a=Math.min(r,Math.max(o,a));break;case 180:s=Math.min(i,Math.max(o,s)),a=Math.min(r,Math.max(l,a));break;case 270:s=Math.min(i,Math.max(l,s)),a=Math.max(0,Math.min(r-o,a));break}this.x=s/=i,this.y=a/=r;const[u,h]=this.getBaseTranslation();s+=u,a+=h,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return I(i=Pt,xg,B2).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return I(i=Pt,xg,B2).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,r]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*e/i).toFixed(2)}%`,c(this,kc)||(s.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,r=i.endsWith("%"),s=!c(this,kc)&&t.endsWith("%");if(r&&s)return;const[a,o]=this.parentDimensions;r||(e.width=`${(100*parseFloat(i)/a).toFixed(2)}%`),!c(this,kc)&&!s&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){c(this,bn)?.finish()}async addEditToolbar(){return this._editToolbar||c(this,Rc)?this._editToolbar:(this._editToolbar=new C2(this),this.div.append(this._editToolbar.render()),c(this,bn)&&await this._editToolbar.addAltText(c(this,bn)),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,c(this,bn)?.destroy())}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){c(this,bn)||(wb.initialize(Pt._l10n),T(this,bn,new wb(this)),c(this,Cc)&&(c(this,bn).data=c(this,Cc),T(this,Cc,null)),await this.addEditToolbar())}get altTextData(){return c(this,bn)?.data}set altTextData(e){c(this,bn)&&(c(this,bn).data=e)}get guessedAltText(){return c(this,bn)?.guessedText}async setGuessedAltText(e){await c(this,bn)?.setGuessedText(e)}serializeAltText(e){return c(this,bn)?.serialize(e)}hasAltText(){return!!c(this,bn)&&!c(this,bn).isEmpty()}hasAltTextData(){return c(this,bn)?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=c(this,Vd)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),I(this,mt,$2).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,r]=this.getInitialTranslation();return this.translate(i,r),bb(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,Pc)||T(this,Pc,new _b({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:I(this,mt,$N).bind(this),onPinching:I(this,mt,HN).bind(this),onPinchEnd:I(this,mt,qN).bind(this),signal:this._uiManager._signal}))),this._uiManager._editorUndoBar?.hide(),this.div}pointerdown(e){const{isMac:t}=Tr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(T(this,Dc,!0),this._isDraggable){I(this,mt,WN).call(this,e);return}I(this,mt,U2).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Ya)&&clearTimeout(c(this,Ya)),T(this,Ya,setTimeout(()=>{T(this,Ya,null),this.parent?.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const r=this.parentScale,[s,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/r,h=t/r,d=this.x*s,f=this.y*a,m=this.width*s,b=this.height*a;switch(i){case 0:return[d+u+o,a-f-h-b+l,d+u+m+o,a-f-h+l];case 90:return[d+h+o,a-f+u+l,d+h+b+o,a-f+u+m+l];case 180:return[d-u-m+o,a-f+h+l,d-u+o,a-f+h+b+l];case 270:return[d-h-b+o,a-f-u-m+l,d-h+o,a-f-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,r,s,a]=e,o=s-i,l=a-r;switch(this.rotation){case 0:return[i,t-a,o,l];case 90:return[i,t-r,l,o];case 180:return[s,t-r,o,l];case 270:return[s,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){T(this,Rc,!0)}disableEditMode(){T(this,Rc,!1)}isInEditMode(){return c(this,Rc)}shouldGetKeyboardEvents(){return c(this,Io)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:s,innerWidth:a}=window;return t<a&&r>0&&e<s&&i>0}rebuild(){I(this,mt,$2).call(this)}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){pn("An editor must be serializable")}static async deserialize(e,t,i){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});r.rotation=e.rotation,T(r,Cc,e.accessibilityData);const[s,a]=r.pageDimensions,[o,l,u,h]=r.getRectInCurrentCoords(e.rect,a);return r.x=o/s,r.y=l/a,r.width=u/s,r.height=h/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(c(this,Jl)?.abort(),T(this,Jl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,Ya)&&(clearTimeout(c(this,Ya)),T(this,Ya,null)),I(this,mt,$p).call(this),this.removeEditToolbar(),c(this,Ns)){for(const e of c(this,Ns).values())clearTimeout(e);T(this,Ns,null)}this.parent=null,c(this,Pc)?.destroy(),T(this,Pc,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(I(this,mt,zN).call(this),c(this,Mi).classList.remove("hidden"),bb(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),T(this,No,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,Mi).children;if(!c(this,la)){T(this,la,Array.from(t));const a=I(this,mt,VN).bind(this),o=I(this,mt,GN).bind(this),l=this._uiManager._signal;for(const u of c(this,la)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",I(this,mt,KN).bind(this,h),{signal:l}),u.setAttribute("data-l10n-id",Pt._l10nResizer[h])}}const i=c(this,la)[0];let r=0;for(const a of t){if(a===i)break;r++}const s=(360-this.rotation+this.parentRotation)%360/90*(c(this,la).length/4);if(s!==r){if(s<r)for(let o=0;o<r-s;o++)c(this,Mi).append(c(this,Mi).firstChild);else if(s>r)for(let o=0;o<s-r;o++)c(this,Mi).firstChild.before(c(this,Mi).lastChild);let a=0;for(const o of t){const u=c(this,la)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Pt._l10nResizer[u])}}I(this,mt,H2).call(this,0),T(this,Io,!0),c(this,Mi).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,Io)&&I(this,mt,z2).call(this,c(this,_g),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){I(this,mt,$p).call(this),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),c(this,bn)?.toggleAltTextBadge(!1)}unselect(){c(this,Mi)?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),c(this,bn)?.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return c(this,Eg)}set isEditing(e){T(this,Eg,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){T(this,kc,!0);const i=e/t,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Ns)||T(this,Ns,new Map);const{action:i}=e;let r=c(this,Ns).get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),c(this,Ns).delete(i),c(this,Ns).size===0&&T(this,Ns,null)},Pt._telemetryTimeout),c(this,Ns).set(i,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),T(this,Vd,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,Vd,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Cc=new WeakMap,la=new WeakMap,bn=new WeakMap,Vd=new WeakMap,Zl=new WeakMap,wg=new WeakMap,kc=new WeakMap,Mi=new WeakMap,Tc=new WeakMap,No=new WeakMap,Jl=new WeakMap,_g=new WeakMap,Dc=new WeakMap,ss=new WeakMap,Eg=new WeakMap,Rc=new WeakMap,Io=new WeakMap,Ya=new WeakMap,Gd=new WeakMap,Kd=new WeakMap,Ns=new WeakMap,Pc=new WeakMap,Ag=new WeakMap,Ob=new WeakMap,mt=new WeakSet,F2=function([e,t],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},xg=new WeakSet,B2=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},s0=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},zN=function(){if(c(this,Mi))return;T(this,Mi,document.createElement("div")),c(this,Mi).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const r=document.createElement("div");c(this,Mi).append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",I(this,mt,UN).bind(this,i),{signal:t}),r.addEventListener("contextmenu",Sa,{signal:t}),r.tabIndex=-1}this.div.prepend(c(this,Mi))},UN=function(e,t){t.preventDefault();const{isMac:i}=Tr.platform;if(t.button!==0||t.ctrlKey&&i)return;c(this,bn)?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,T(this,Tc,[t.screenX,t.screenY]);const s=new AbortController,a=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",I(this,mt,z2).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",ys,{passive:!1,signal:a}),window.addEventListener("contextmenu",Sa,{signal:a}),T(this,No,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{s.abort(),this.parent.togglePointerEvents(!0),c(this,bn)?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=l,I(this,mt,a0).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},j2=function(e,t,i,r){this.width=i,this.height=r,this.x=e,this.y=t;const[s,a]=this.parentDimensions;this.setDims(s*i,a*r),this.fixAndSetPosition(),this._onResized()},a0=function(){if(!c(this,No))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:r}=c(this,No);T(this,No,null);const s=this.x,a=this.y,o=this.width,l=this.height;s===e&&a===t&&o===i&&l===r||this.addCommands({cmd:I(this,mt,j2).bind(this,s,a,o,l),undo:I(this,mt,j2).bind(this,e,t,i,r),mustExec:!0})},z2=function(e,t){const[i,r]=this.parentDimensions,s=this.x,a=this.y,o=this.width,l=this.height,u=Pt.MIN_SIZE/i,h=Pt.MIN_SIZE/r,d=I(this,mt,s0).call(this,this.rotation),f=(ve,xe)=>[d[0]*ve+d[2]*xe,d[1]*ve+d[3]*xe],m=I(this,mt,s0).call(this,360-this.rotation),b=(ve,xe)=>[m[0]*ve+m[2]*xe,m[1]*ve+m[3]*xe];let _,w,v=!1,y=!1;switch(e){case"topLeft":v=!0,_=(ve,xe)=>[0,0],w=(ve,xe)=>[ve,xe];break;case"topMiddle":_=(ve,xe)=>[ve/2,0],w=(ve,xe)=>[ve/2,xe];break;case"topRight":v=!0,_=(ve,xe)=>[ve,0],w=(ve,xe)=>[0,xe];break;case"middleRight":y=!0,_=(ve,xe)=>[ve,xe/2],w=(ve,xe)=>[0,xe/2];break;case"bottomRight":v=!0,_=(ve,xe)=>[ve,xe],w=(ve,xe)=>[0,0];break;case"bottomMiddle":_=(ve,xe)=>[ve/2,xe],w=(ve,xe)=>[ve/2,0];break;case"bottomLeft":v=!0,_=(ve,xe)=>[0,xe],w=(ve,xe)=>[ve,0];break;case"middleLeft":y=!0,_=(ve,xe)=>[0,xe/2],w=(ve,xe)=>[ve,xe/2];break}const E=_(o,l),k=w(o,l);let S=f(...k);const D=Pt._round(s+S[0]),P=Pt._round(a+S[1]);let F=1,H=1,z,te;if(t.fromKeyboard)({deltaX:z,deltaY:te}=t);else{const{screenX:ve,screenY:xe}=t,[he,ie]=c(this,Tc);[z,te]=this.screenToPageTranslation(ve-he,xe-ie),c(this,Tc)[0]=ve,c(this,Tc)[1]=xe}if([z,te]=b(z/i,te/r),v){const ve=Math.hypot(o,l);F=H=Math.max(Math.min(Math.hypot(k[0]-E[0]-z,k[1]-E[1]-te)/ve,1/o,1/l),u/o,h/l)}else y?F=Math.max(u,Math.min(1,Math.abs(k[0]-E[0]-z)))/o:H=Math.max(h,Math.min(1,Math.abs(k[1]-E[1]-te)))/l;const de=Pt._round(o*F),ke=Pt._round(l*H);S=f(...w(de,ke));const Me=D-S[0],ze=P-S[1];c(this,ss)||T(this,ss,[this.x,this.y,this.width,this.height]),this.width=de,this.height=ke,this.x=Me,this.y=ze,this.setDims(i*de,r*ke),this.fixAndSetPosition(),this._onResizing()},$N=function(){T(this,No,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),c(this,bn)?.toggle(!1),this.parent.togglePointerEvents(!1)},HN=function(e,t,i){let s=.7*(i/t)+1-.7;if(s===1)return;const a=I(this,mt,s0).call(this,this.rotation),o=(D,P)=>[a[0]*D+a[2]*P,a[1]*D+a[3]*P],[l,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,m=this.height,b=Pt.MIN_SIZE/l,_=Pt.MIN_SIZE/u;s=Math.max(Math.min(s,1/f,1/m),b/f,_/m);const w=Pt._round(f*s),v=Pt._round(m*s);if(w===f&&v===m)return;c(this,ss)||T(this,ss,[h,d,f,m]);const y=o(f/2,m/2),E=Pt._round(h+y[0]),k=Pt._round(d+y[1]),S=o(w/2,v/2);this.x=E-S[0],this.y=k-S[1],this.width=w,this.height=v,this.setDims(l*w,u*v),this.fixAndSetPosition(),this._onResizing()},qN=function(){c(this,bn)?.toggle(!0),this.parent.togglePointerEvents(!0),I(this,mt,a0).call(this)},U2=function(e){const{isMac:t}=Tr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},WN=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,s=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:s},o=u=>{r.abort(),T(this,Zl,null),T(this,Dc,!1),this._uiManager.endDragSession()||I(this,mt,U2).call(this,u),i&&this._onStopDragging()};t&&(T(this,Gd,e.clientX),T(this,Kd,e.clientY),T(this,Zl,e.pointerId),T(this,wg,e.pointerType),window.addEventListener("pointermove",u=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==c(this,Zl)){ys(u);return}const[m,b]=this.screenToPageTranslation(h-c(this,Gd),d-c(this,Kd));T(this,Gd,h),T(this,Kd,d),this._uiManager.dragSelectedEditors(m,b)},a),window.addEventListener("touchmove",ys,a),window.addEventListener("pointerdown",u=>{u.pointerType===c(this,wg)&&(c(this,Pc)||u.isPrimary)&&o(u),ys(u)},a));const l=u=>{if(!c(this,Zl)||c(this,Zl)===u.pointerId){o(u);return}ys(u)};window.addEventListener("pointerup",l,{signal:s}),window.addEventListener("blur",l,{signal:s})},$2=function(){if(c(this,Jl)||!this.div)return;T(this,Jl,new AbortController);const e=this._uiManager.combinedSignal(c(this,Jl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},VN=function(e){Pt._resizerKeyboardManager.exec(this,e)},GN=function(e){c(this,Io)&&e.relatedTarget?.parentNode!==c(this,Mi)&&I(this,mt,$p).call(this)},KN=function(e){T(this,_g,c(this,Io)?e:"")},H2=function(e){if(c(this,la))for(const t of c(this,la))t.tabIndex=e},$p=function(){T(this,Io,!1),I(this,mt,H2).call(this,-1),I(this,mt,a0).call(this)},N(Pt,xg),Ae(Pt,"_l10n",null),Ae(Pt,"_l10nResizer",null),Ae(Pt,"_borderLineWidth",-1),Ae(Pt,"_colorManager",new D2),Ae(Pt,"_zIndex",1),Ae(Pt,"_telemetryTimeout",1e3);let Fn=Pt;class Jz extends Fn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ak=3285377520,Ts=4294901760,Oa=65535;class XN{constructor(e){this.h1=e?e&4294967295:Ak,this.h2=e?e&4294967295:Ak}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let _=0,w=e.length;_<w;_++){const v=e.charCodeAt(_);v<=255?t[i++]=v:(t[i++]=v>>>8,t[i++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,s=i-r*4,a=new Uint32Array(t.buffer,0,r);let o=0,l=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,m=d&Oa,b=f&Oa;for(let _=0;_<r;_++)_&1?(o=a[_],o=o*d&Ts|o*m&Oa,o=o<<15|o>>>17,o=o*f&Ts|o*b&Oa,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[_],l=l*d&Ts|l*m&Oa,l=l<<15|l>>>17,l=l*f&Ts|l*b&Oa,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,s){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*d&Ts|o*m&Oa,o=o<<15|o>>>17,o=o*f&Ts|o*b&Oa,r&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ts|e*36045&Oa,t=t*4283543511&Ts|((t<<16|e>>>16)*2950163797&Ts)>>>16,e^=t>>>1,e=e*444984403&Ts|e*60499&Oa,t=t*3301882366&Ts|((t<<16|e>>>16)*3120437893&Ts)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const q2=Object.freeze({map:null,hash:"",transfer:void 0});var Nc,Ic,Si,Mb,YN;class _x{constructor(){N(this,Mb);N(this,Nc,!1);N(this,Ic,null);N(this,Si,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=c(this,Si).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return c(this,Si).get(e)}remove(e){if(c(this,Si).delete(e),c(this,Si).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of c(this,Si).values())if(t instanceof Fn)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=c(this,Si).get(e);let r=!1;if(i!==void 0)for(const[s,a]of Object.entries(t))i[s]!==a&&(r=!0,i[s]=a);else r=!0,c(this,Si).set(e,t);r&&I(this,Mb,YN).call(this),t instanceof Fn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return c(this,Si).has(e)}getAll(){return c(this,Si).size>0?mx(c(this,Si)):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return c(this,Si).size}resetModified(){c(this,Nc)&&(T(this,Nc,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new QN(this)}get serializable(){if(c(this,Si).size===0)return q2;const e=new Map,t=new XN,i=[],r=Object.create(null);let s=!1;for(const[a,o]of c(this,Si)){const l=o instanceof Fn?o.serialize(!1,r):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),s||(s=!!l.bitmap))}if(s)for(const a of e.values())a.bitmap&&i.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:q2}get editorStats(){let e=null;const t=new Map;for(const i of c(this,Si).values()){if(!(i instanceof Fn))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:s}=r;t.has(s)||t.set(s,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const a=e[s]||(e[s]=new Map);for(const[o,l]of Object.entries(r)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const h=u.get(l)??0;u.set(l,h+1)}}for(const[i,r]of t)e[i]=r.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){T(this,Ic,null)}get modifiedIds(){if(c(this,Ic))return c(this,Ic);const e=[];for(const t of c(this,Si).values())!(t instanceof Fn)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return T(this,Ic,{ids:new Set(e),hash:e.join(",")})}}Nc=new WeakMap,Ic=new WeakMap,Si=new WeakMap,Mb=new WeakSet,YN=function(){c(this,Nc)||(T(this,Nc,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Sg;class QN extends _x{constructor(t){super();N(this,Sg);const{map:i,hash:r,transfer:s}=t.serializable,a=structuredClone(i,s?{transfer:s}:null);T(this,Sg,{map:a,hash:r,transfer:s})}get print(){pn("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,Sg)}get modifiedIds(){return Ft(this,"modifiedIds",{ids:new Set,hash:""})}}Sg=new WeakMap;var Xd;class e8{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){N(this,Xd,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,Xd).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||c(this,Xd).has(e.loadedName))){if(ri(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:r,style:s}=e,a=new FontFace(i,r,s);this.addNativeFontFace(a);try{await a.load(),c(this,Xd).add(i),t?.(e)}catch{Tt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}pn("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw Tt(`Failed to load font '${i.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Ft(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(cr||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),Ft(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(ri(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:t,callback:e};return i.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ft(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(k,S){return k.charCodeAt(S)<<24|k.charCodeAt(S+1)<<16|k.charCodeAt(S+2)<<8|k.charCodeAt(S+3)&255}function r(k,S,D,P){const F=k.substring(0,S),H=k.substring(S+D);return F+P+H}let s,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function h(k,S){if(++u>30){Tt("Load test font never loaded."),S();return}if(l.font="30px "+k,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){S();return}setTimeout(h.bind(null,k,S))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=r(f,976,d.length,d);const b=16,_=1482184792;let w=i(f,b);for(s=0,a=d.length-3;s<a;s+=4)w=w-_+i(d,s)|0;s<d.length&&(w=w-_+i(d+"XXX",s)|0),f=r(f,b,4,jz(w));const v=`url(data:font/opentype;base64,${btoa(f)});`,y=`@font-face {font-family:"${d}";src:${v}}`;this.insertRule(y);const E=this._document.createElement("div");E.style.visibility="hidden",E.style.width=E.style.height="10px",E.style.position="absolute",E.style.top=E.style.left="0px";for(const k of[e.loadedName,d]){const S=this._document.createElement("span");S.textContent="Hi",S.style.fontFamily=k,E.append(S)}this._document.body.append(E),h(d,()=>{E.remove(),t.complete()})}}Xd=new WeakMap;class t8{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${Wz(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let r;try{r=e.get(i)}catch(a){Tt(`getPathGenerator - ignoring character: "${a}".`)}const s=new Path2D(r||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=s}}const Cy={DATA:1,ERROR:2},ni={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function xk(){}function Fr(n){if(n instanceof Lu||n instanceof A2||n instanceof Hm||n instanceof wk||n instanceof yb||n instanceof Z1)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||pn('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Lu(n.message);case"InvalidPDFException":return new A2(n.message);case"MissingPDFException":return new Hm(n.message);case"PasswordException":return new wk(n.message,n.code);case"UnexpectedResponseException":return new yb(n.message,n.status);case"UnknownErrorException":return new Z1(n.message,n.details)}return new Z1(n.message,n.toString())}var Yd,Hs,ZN,JN,eI,o0;class Hp{constructor(e,t,i){N(this,Hs);N(this,Yd,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",I(this,Hs,ZN).bind(this),{signal:c(this,Yd).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const r=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},i)}catch(a){s.reject(a)}return s.promise}sendWithStream(e,t,i,r){const s=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[s]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:s,data:t,desiredSize:u.desiredSize},r),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[s].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:ni.PULL,streamId:s,desiredSize:u.desiredSize}),h.promise},cancel:u=>{ri(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[s].cancelCall=h,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:ni.CANCEL,streamId:s,reason:Fr(u)}),h.promise}},i)}destroy(){c(this,Yd)?.abort(),T(this,Yd,null)}}Yd=new WeakMap,Hs=new WeakSet,ZN=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){I(this,Hs,eI).call(this,e);return}if(e.callback){const i=e.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Cy.DATA)r.resolve(e.data);else if(e.callback===Cy.ERROR)r.reject(Fr(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,r=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(a){s.postMessage({sourceName:i,targetName:r,callback:Cy.DATA,callbackId:e.callbackId,data:a})},function(a){s.postMessage({sourceName:i,targetName:r,callback:Cy.ERROR,callbackId:e.callbackId,reason:Fr(a)})});return}if(e.streamId){I(this,Hs,JN).call(this,e);return}t(e.data)},JN=function(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,s=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:r,stream:ni.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:ni.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){ri(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:r,stream:ni.ERROR,streamId:t,reason:Fr(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){s.postMessage({sourceName:i,targetName:r,stream:ni.START_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:i,targetName:r,stream:ni.START_COMPLETE,streamId:t,reason:Fr(u)})})},eI=function(e){const t=e.streamId,i=this.sourceName,r=e.sourceName,s=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case ni.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(Fr(e.reason));break;case ni.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(Fr(e.reason));break;case ni.PULL:if(!o){s.postMessage({sourceName:i,targetName:r,stream:ni.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||xk).then(function(){s.postMessage({sourceName:i,targetName:r,stream:ni.PULL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:i,targetName:r,stream:ni.PULL_COMPLETE,streamId:t,reason:Fr(u)})});break;case ni.ENQUEUE:if(ri(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case ni.CLOSE:if(ri(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),I(this,Hs,o0).call(this,a,t);break;case ni.ERROR:ri(a,"error should have stream controller"),a.controller.error(Fr(e.reason)),I(this,Hs,o0).call(this,a,t);break;case ni.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(Fr(e.reason)),I(this,Hs,o0).call(this,a,t);break;case ni.CANCEL:if(!o)break;const l=Fr(e.reason);Promise.try(o.onCancel||xk,l).then(function(){s.postMessage({sourceName:i,targetName:r,stream:ni.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){s.postMessage({sourceName:i,targetName:r,stream:ni.CANCEL_COMPLETE,streamId:t,reason:Fr(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},o0=async function(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]};var Cg;class tI{constructor({enableHWA:e=!1}){N(this,Cg,!1);T(this,Cg,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!c(this,Cg)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){pn("Abstract method `_createCanvas` called.")}}Cg=new WeakMap;class n8 extends tI{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class nI{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){pn("Abstract method `_fetch` called.")}}class iI extends nI{async _fetch(e){const t=await Pw(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Rw(t)}}class rI{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,r,s){return"none"}destroy(e=!1){}}var Lc,Qd,Lo,Oo,rr,Oc,Mc,rt,tr,qp,Yh,l0,Qh,sI,W2,Zh,Wp,Vp,V2,Gp;class i8 extends rI{constructor({docId:t,ownerDocument:i=globalThis.document}){super();N(this,rt);N(this,Lc);N(this,Qd);N(this,Lo);N(this,Oo);N(this,rr);N(this,Oc);N(this,Mc,0);T(this,Oo,t),T(this,rr,i)}addFilter(t){if(!t)return"none";let i=c(this,rt,tr).get(t);if(i)return i;const[r,s,a]=I(this,rt,l0).call(this,t),o=t.length===1?r:`${r}${s}${a}`;if(i=c(this,rt,tr).get(o),i)return c(this,rt,tr).set(t,i),i;const l=`g_${c(this,Oo)}_transfer_map_${_i(this,Mc)._++}`,u=I(this,rt,Qh).call(this,l);c(this,rt,tr).set(t,u),c(this,rt,tr).set(o,u);const h=I(this,rt,Zh).call(this,l);return I(this,rt,Vp).call(this,r,s,a,h),u}addHCMFilter(t,i){const r=`${t}-${i}`,s="base";let a=c(this,rt,qp).get(s);if(a?.key===r||(a?(a.filter?.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},c(this,rt,qp).set(s,a)),!t||!i))return a.url;const o=I(this,rt,Gp).call(this,t);t=dt.makeHexColor(...o);const l=I(this,rt,Gp).call(this,i);if(i=dt.makeHexColor(...l),c(this,rt,Yh).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return a.url;const u=new Array(256);for(let b=0;b<=255;b++){const _=b/255;u[b]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=u.join(","),d=`g_${c(this,Oo)}_hcm_filter`,f=a.filter=I(this,rt,Zh).call(this,d);I(this,rt,Vp).call(this,h,h,h,f),I(this,rt,W2).call(this,f);const m=(b,_)=>{const w=o[b]/255,v=l[b]/255,y=new Array(_+1);for(let E=0;E<=_;E++)y[E]=w+E/_*(v-w);return y.join(",")};return I(this,rt,Vp).call(this,m(0,5),m(1,5),m(2,5),f),a.url=I(this,rt,Qh).call(this,d),a.url}addAlphaFilter(t){let i=c(this,rt,tr).get(t);if(i)return i;const[r]=I(this,rt,l0).call(this,[t]),s=`alpha_${r}`;if(i=c(this,rt,tr).get(s),i)return c(this,rt,tr).set(t,i),i;const a=`g_${c(this,Oo)}_alpha_map_${_i(this,Mc)._++}`,o=I(this,rt,Qh).call(this,a);c(this,rt,tr).set(t,o),c(this,rt,tr).set(s,o);const l=I(this,rt,Zh).call(this,a);return I(this,rt,V2).call(this,r,l),o}addLuminosityFilter(t){let i=c(this,rt,tr).get(t||"luminosity");if(i)return i;let r,s;if(t?([r]=I(this,rt,l0).call(this,[t]),s=`luminosity_${r}`):s="luminosity",i=c(this,rt,tr).get(s),i)return c(this,rt,tr).set(t,i),i;const a=`g_${c(this,Oo)}_luminosity_map_${_i(this,Mc)._++}`,o=I(this,rt,Qh).call(this,a);c(this,rt,tr).set(t,o),c(this,rt,tr).set(s,o);const l=I(this,rt,Zh).call(this,a);return I(this,rt,sI).call(this,l),t&&I(this,rt,V2).call(this,r,l),o}addHighlightHCMFilter(t,i,r,s,a){const o=`${i}-${r}-${s}-${a}`;let l=c(this,rt,qp).get(t);if(l?.key===o||(l?(l.filter?.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},c(this,rt,qp).set(t,l)),!i||!r))return l.url;const[u,h]=[i,r].map(I(this,rt,Gp).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,b]=[s,a].map(I(this,rt,Gp).bind(this));f<d&&([d,f,m,b]=[f,d,b,m]),c(this,rt,Yh).style.color="";const _=(y,E,k)=>{const S=new Array(256),D=(f-d)/k,P=y/255,F=(E-y)/(255*k);let H=0;for(let z=0;z<=k;z++){const te=Math.round(d+z*D),de=P+z*F;for(let ke=H;ke<=te;ke++)S[ke]=de;H=te+1}for(let z=H;z<256;z++)S[z]=S[H-1];return S.join(",")},w=`g_${c(this,Oo)}_hcm_${t}_filter`,v=l.filter=I(this,rt,Zh).call(this,w);return I(this,rt,W2).call(this,v),I(this,rt,Vp).call(this,_(m[0],b[0],5),_(m[1],b[1],5),_(m[2],b[2],5),v),l.url=I(this,rt,Qh).call(this,w),l.url}destroy(t=!1){t&&c(this,Oc)?.size||(c(this,Lo)?.parentNode.parentNode.remove(),T(this,Lo,null),c(this,Qd)?.clear(),T(this,Qd,null),c(this,Oc)?.clear(),T(this,Oc,null),T(this,Mc,0))}}Lc=new WeakMap,Qd=new WeakMap,Lo=new WeakMap,Oo=new WeakMap,rr=new WeakMap,Oc=new WeakMap,Mc=new WeakMap,rt=new WeakSet,tr=function(){return c(this,Qd)||T(this,Qd,new Map)},qp=function(){return c(this,Oc)||T(this,Oc,new Map)},Yh=function(){if(!c(this,Lo)){const t=c(this,rr).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const r=c(this,rr).createElementNS(bo,"svg");r.setAttribute("width",0),r.setAttribute("height",0),T(this,Lo,c(this,rr).createElementNS(bo,"defs")),t.append(r),r.append(c(this,Lo)),c(this,rr).body.append(t)}return c(this,Lo)},l0=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[i,r,s]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=i[u]/255,o[u]=r[u]/255,l[u]=s[u]/255;return[a.join(","),o.join(","),l.join(",")]},Qh=function(t){if(c(this,Lc)===void 0){T(this,Lc,"");const i=c(this,rr).URL;i!==c(this,rr).baseURI&&(Nw(i)?Tt('#createUrl: ignore "data:"-URL for performance reasons.'):T(this,Lc,i.split("#",1)[0]))}return`url(${c(this,Lc)}#${t})`},sI=function(t){const i=c(this,rr).createElementNS(bo,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},W2=function(t){const i=c(this,rr).createElementNS(bo,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Zh=function(t){const i=c(this,rr).createElementNS(bo,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),c(this,rt,Yh).append(i),i},Wp=function(t,i,r){const s=c(this,rr).createElementNS(bo,i);s.setAttribute("type","discrete"),s.setAttribute("tableValues",r),t.append(s)},Vp=function(t,i,r,s){const a=c(this,rr).createElementNS(bo,"feComponentTransfer");s.append(a),I(this,rt,Wp).call(this,a,"feFuncR",t),I(this,rt,Wp).call(this,a,"feFuncG",i),I(this,rt,Wp).call(this,a,"feFuncB",r)},V2=function(t,i){const r=c(this,rr).createElementNS(bo,"feComponentTransfer");i.append(r),I(this,rt,Wp).call(this,r,"feFuncA",t)},Gp=function(t){return c(this,rt,Yh).style.color=t,wx(getComputedStyle(c(this,rt,Yh)).getPropertyValue("color"))};class aI{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){pn("Abstract method `_fetch` called.")}}class oI extends aI{async _fetch(e){const t=await Pw(e,"arraybuffer");return new Uint8Array(t)}}cr&&Tt("Please use the `legacy` build in Node.js environments.");async function lI(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class r8 extends rI{}class s8 extends tI{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class a8 extends nI{async _fetch(e){return lI(e)}}class o8 extends aI{async _fetch(e){return lI(e)}}const or={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function G2(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,i),n.clip(r)}class Ex{getPattern(){pn("Abstract method `getPattern` called.")}}class l8 extends Ex{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,r){let s;if(r===or.STROKE||r===or.FILL){const a=t.current.getClippedPathBoundingBox(r,Cn(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),i=dt.transform(i,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),G2(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),s=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(i);s.setTransform(d)}else G2(e,this._bbox),s=this._createGradient(e);return s}}function t_(n,e,t,i,r,s,a,o){const l=e.coords,u=e.colors,h=n.data,d=n.width*4;let f;l[t+1]>l[i+1]&&(f=t,t=i,i=f,f=s,s=a,a=f),l[i+1]>l[r+1]&&(f=i,i=r,r=f,f=a,a=o,o=f),l[t+1]>l[i+1]&&(f=t,t=i,i=f,f=s,s=a,a=f);const m=(l[t]+e.offsetX)*e.scaleX,b=(l[t+1]+e.offsetY)*e.scaleY,_=(l[i]+e.offsetX)*e.scaleX,w=(l[i+1]+e.offsetY)*e.scaleY,v=(l[r]+e.offsetX)*e.scaleX,y=(l[r+1]+e.offsetY)*e.scaleY;if(b>=y)return;const E=u[s],k=u[s+1],S=u[s+2],D=u[a],P=u[a+1],F=u[a+2],H=u[o],z=u[o+1],te=u[o+2],de=Math.round(b),ke=Math.round(y);let Me,ze,ve,xe,he,ie,ae,me;for(let _e=de;_e<=ke;_e++){if(_e<w){const We=_e<b?0:(b-_e)/(b-w);Me=m-(m-_)*We,ze=E-(E-D)*We,ve=k-(k-P)*We,xe=S-(S-F)*We}else{let We;_e>y?We=1:w===y?We=0:We=(w-_e)/(w-y),Me=_-(_-v)*We,ze=D-(D-H)*We,ve=P-(P-z)*We,xe=F-(F-te)*We}let pe;_e<b?pe=0:_e>y?pe=1:pe=(b-_e)/(b-y),he=m-(m-v)*pe,ie=E-(E-H)*pe,ae=k-(k-z)*pe,me=S-(S-te)*pe;const De=Math.round(Math.min(Me,he)),it=Math.round(Math.max(Me,he));let Xe=d*_e+De*4;for(let We=De;We<=it;We++)pe=(Me-We)/(Me-he),pe<0?pe=0:pe>1&&(pe=1),h[Xe++]=ze-(ze-ie)*pe|0,h[Xe++]=ve-(ve-ae)*pe|0,h[Xe++]=xe-(xe-me)*pe|0,h[Xe++]=255}}function u8(n,e,t){const i=e.coords,r=e.colors;let s,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(i.length/o)-1,u=o-1;for(s=0;s<l;s++){let h=s*o;for(let d=0;d<u;d++,h++)t_(n,t,i[h],i[h+1],i[h+o],r[h],r[h+1],r[h+o]),t_(n,t,i[h+o+1],i[h+1],i[h+o],r[h+o+1],r[h+1],r[h+o])}break;case"triangles":for(s=0,a=i.length;s<a;s+=3)t_(n,t,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class c8 extends Ex{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=u/d,b=h/f,_={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/m,scaleY:1/b},w=d+2*2,v=f+2*2,y=i.getCanvas("mesh",w,v),E=y.context,k=E.createImageData(d,f);if(t){const D=k.data;for(let P=0,F=D.length;P<F;P+=4)D[P]=t[0],D[P+1]=t[1],D[P+2]=t[2],D[P+3]=255}for(const D of this._figures)u8(k,D,_);return E.putImageData(k,2,2),{canvas:y.canvas,offsetX:o-2*m,offsetY:l-2*b,scaleX:m,scaleY:b}}getPattern(e,t,i,r){G2(e,this._bbox);let s;if(r===or.SHADING)s=dt.singularValueDecompose2dScale(Cn(e));else if(s=dt.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=dt.singularValueDecompose2dScale(this.matrix);s=[s[0]*o[0],s[1]*o[1]]}const a=this._createMeshCanvas(s,r===or.SHADING?null:this._background,t.cachedCanvases);return r!==or.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class h8 extends Ex{getPattern(){return"hotpink"}}function d8(n){switch(n[0]){case"RadialAxial":return new l8(n);case"Mesh":return new c8(n);case"Dummy":return new h8}throw new Error(`Unknown IR type: ${n[0]}`)}const Sk={COLORED:1,UNCOLORED:2},Fb=class Fb{constructor(e,t,i,r,s){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=r,this.baseTransform=s}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:r,tilingType:s,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),Dw("TilingType: "+s);const h=t[0],d=t[1],f=t[2],m=t[3],b=f-h,_=m-d,w=dt.singularValueDecompose2dScale(this.matrix),v=dt.singularValueDecompose2dScale(this.baseTransform),y=w[0]*v[0],E=w[1]*v[1];let k=b,S=_,D=!1,P=!1;const F=Math.ceil(l*y),H=Math.ceil(u*E),z=Math.ceil(b*y),te=Math.ceil(_*E);F>=z?k=l:D=!0,H>=te?S=u:P=!0;const de=this.getSizeAndScale(k,this.ctx.canvas.width,y),ke=this.getSizeAndScale(S,this.ctx.canvas.height,E),Me=e.cachedCanvases.getCanvas("pattern",de.size,ke.size),ze=Me.context,ve=o.createCanvasGraphics(ze);if(ve.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(ve,r,a),ze.translate(-de.scale*h,-ke.scale*d),ve.transform(de.scale,0,0,ke.scale,0,0),ze.save(),this.clipBbox(ve,h,d,f,m),ve.baseTransform=Cn(ve.ctx),ve.executeOperatorList(i),ve.endDrawing(),ze.restore(),D||P){const xe=Me.canvas;D&&(k=l),P&&(S=u);const he=this.getSizeAndScale(k,this.ctx.canvas.width,y),ie=this.getSizeAndScale(S,this.ctx.canvas.height,E),ae=he.size,me=ie.size,_e=e.cachedCanvases.getCanvas("pattern-workaround",ae,me),pe=_e.context,De=D?Math.floor(b/l):0,it=P?Math.floor(_/u):0;for(let Xe=0;Xe<=De;Xe++)for(let We=0;We<=it;We++)pe.drawImage(xe,ae*Xe,me*We,ae,me,0,0,ae,me);return{canvas:_e.canvas,scaleX:he.scale,scaleY:ie.scale,offsetX:h,offsetY:d}}return{canvas:Me.canvas,scaleX:de.scale,scaleY:ke.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,i){const r=Math.max(Fb.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*i);return s>=r?s=r:i=s/e,{scale:i,size:s}}clipBbox(e,t,i,r,s){const a=r-t,o=s-i;e.ctx.rect(t,i,a,o),e.current.updateRectMinMax(Cn(e.ctx),[t,i,r,s]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const r=e.ctx,s=e.current;switch(t){case Sk.COLORED:const a=this.ctx;r.fillStyle=a.fillStyle,r.strokeStyle=a.strokeStyle,s.fillColor=a.fillStyle,s.strokeColor=a.strokeStyle;break;case Sk.UNCOLORED:const o=dt.makeHexColor(i[0],i[1],i[2]);r.fillStyle=o,r.strokeStyle=o,s.fillColor=o,s.strokeColor=o;break;default:throw new Bz(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,r){let s=i;r!==or.SHADING&&(s=dt.transform(s,t.baseTransform),this.matrix&&(s=dt.transform(s,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(s);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Ae(Fb,"MAX_PATTERN_SIZE",3e3);let K2=Fb;function f8({src:n,srcPos:e=0,dest:t,width:i,height:r,nonBlackColor:s=4294967295,inverseDecode:a=!1}){const o=Tr.isLittleEndian?4278190080:255,[l,u]=a?[s,o]:[o,s],h=i>>3,d=i&7,f=n.length;t=new Uint32Array(t.buffer);let m=0;for(let b=0;b<r;b++){for(const w=e+h;e<w;e++){const v=e<f?n[e]:255;t[m++]=v&128?u:l,t[m++]=v&64?u:l,t[m++]=v&32?u:l,t[m++]=v&16?u:l,t[m++]=v&8?u:l,t[m++]=v&4?u:l,t[m++]=v&2?u:l,t[m++]=v&1?u:l}if(d===0)continue;const _=e<f?n[e++]:255;for(let w=0;w<d;w++)t[m++]=_&1<<7-w?u:l}return{srcPos:e,destPos:m}}const Ck=16,kk=100,p8=15,Tk=10,Dk=1e3,$r=16;function m8(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,r){e.translate(i,r),this.__originalTranslate(i,r)},n.scale=function(i,r){e.scale(i,r),this.__originalScale(i,r)},n.transform=function(i,r,s,a,o,l){e.transform(i,r,s,a,o,l),this.__originalTransform(i,r,s,a,o,l)},n.setTransform=function(i,r,s,a,o,l){e.setTransform(i,r,s,a,o,l),this.__originalSetTransform(i,r,s,a,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,r,s,a,o){e.bezierCurveTo(t,i,r,s,a,o),this.__originalBezierCurveTo(t,i,r,s,a,o)},n.rect=function(t,i,r,s){e.rect(t,i,r,s),this.__originalRect(t,i,r,s)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class g8{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,i)):(r=this.canvasFactory.create(t,i),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function ky(n,e,t,i,r,s,a,o,l,u){const[h,d,f,m,b,_]=Cn(n);if(d===0&&f===0){const y=a*h+b,E=Math.round(y),k=o*m+_,S=Math.round(k),D=(a+l)*h+b,P=Math.abs(Math.round(D)-E)||1,F=(o+u)*m+_,H=Math.abs(Math.round(F)-S)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),E,S),n.drawImage(e,t,i,r,s,0,0,P,H),n.setTransform(h,d,f,m,b,_),[P,H]}if(h===0&&m===0){const y=o*f+b,E=Math.round(y),k=a*d+_,S=Math.round(k),D=(o+u)*f+b,P=Math.abs(Math.round(D)-E)||1,F=(a+l)*d+_,H=Math.abs(Math.round(F)-S)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,E,S),n.drawImage(e,t,i,r,s,0,0,H,P),n.setTransform(h,d,f,m,b,_),[H,P]}n.drawImage(e,t,i,r,s,a,o,l,u);const w=Math.hypot(h,d),v=Math.hypot(f,m);return[w*l,v*u]}function v8(n){const{width:e,height:t}=n;if(e>Dk||t>Dk)return null;const i=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=e+1;let a=new Uint8Array(s*(t+1)),o,l,u;const h=e+7&-8;let d=new Uint8Array(h*t),f=0;for(const v of n.data){let y=128;for(;y>0;)d[f++]=v&y?0:255,y>>=1}let m=0;for(f=0,d[f]!==0&&(a[0]=1,++m),l=1;l<e;l++)d[f]!==d[f+1]&&(a[l]=d[f]?2:1,++m),f++;for(d[f]!==0&&(a[l]=2,++m),o=1;o<t;o++){f=o*h,u=o*s,d[f-h]!==d[f]&&(a[u]=d[f]?1:8,++m);let v=(d[f]?4:0)+(d[f-h]?8:0);for(l=1;l<e;l++)v=(v>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),r[v]&&(a[u+l]=r[v],++m),f++;if(d[f-h]!==d[f]&&(a[u+l]=d[f]?2:4,++m),m>i)return null}for(f=h*(t-1),u=o*s,d[f]!==0&&(a[u]=8,++m),l=1;l<e;l++)d[f]!==d[f+1]&&(a[u+l]=d[f]?4:8,++m),f++;if(d[f]!==0&&(a[u+l]=4,++m),m>i)return null;const b=new Int32Array([0,s,-1,0,-s,0,0,0,1]),_=new Path2D;for(o=0;m&&o<=t;o++){let v=o*s;const y=v+e;for(;v<y&&!a[v];)v++;if(v===y)continue;_.moveTo(v%s,o);const E=v;let k=a[v];do{const S=b[k];do v+=S;while(!a[v]);const D=a[v];D!==5&&D!==10?(k=D,a[v]=0):(k=D&51*k>>4,a[v]&=k>>2|k<<2),_.lineTo(v%s,v/s|0),a[v]||--m}while(E!==v);--o}return d=null,a=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(_),v.beginPath(),v.restore()}}class Rk{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=yN,this.textMatrixScale=1,this.fontMatrix=E2,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=er.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=dt.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=dt.applyTransform(t,e),r=dt.applyTransform(t.slice(2),e),s=dt.applyTransform([t[0],t[3]],e),a=dt.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],r[0],s[0],a[0]),this.minY=Math.min(this.minY,i[1],r[1],s[1],a[1]),this.maxX=Math.max(this.maxX,i[0],r[0],s[0],a[0]),this.maxY=Math.max(this.maxY,i[1],r[1],s[1],a[1])}updateScalingPathMinMax(e,t){dt.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,r,s,a,o,l,u,h){const d=dt.bezierBoundingBox(t,i,r,s,a,o,l,u,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=or.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===or.STROKE){t||pn("Stroke bounding box must include transform.");const r=dt.singularValueDecompose2dScale(t),s=r[0]*this.lineWidth/2,a=r[1]*this.lineWidth/2;i[0]-=s,i[1]-=a,i[2]+=s,i[3]+=a}return i}updateClipFromPath(){const e=dt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=or.FILL,t=null){return dt.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Pk(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,r=t%$r,s=(t-r)/$r,a=r===0?s:s+1,o=n.createImageData(i,$r);let l=0,u;const h=e.data,d=o.data;let f,m,b,_;if(e.kind===Zy.GRAYSCALE_1BPP){const w=h.byteLength,v=new Uint32Array(d.buffer,0,d.byteLength>>2),y=v.length,E=i+7>>3,k=4294967295,S=Tr.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(b=f<s?$r:r,u=0,m=0;m<b;m++){const D=w-l;let P=0;const F=D>E?i:D*8-7,H=F&-8;let z=0,te=0;for(;P<H;P+=8)te=h[l++],v[u++]=te&128?k:S,v[u++]=te&64?k:S,v[u++]=te&32?k:S,v[u++]=te&16?k:S,v[u++]=te&8?k:S,v[u++]=te&4?k:S,v[u++]=te&2?k:S,v[u++]=te&1?k:S;for(;P<F;P++)z===0&&(te=h[l++],z=128),v[u++]=te&z?k:S,z>>=1}for(;u<y;)v[u++]=0;n.putImageData(o,0,f*$r)}}else if(e.kind===Zy.RGBA_32BPP){for(m=0,_=i*$r*4,f=0;f<s;f++)d.set(h.subarray(l,l+_)),l+=_,n.putImageData(o,0,m),m+=$r;f<a&&(_=i*r*4,d.set(h.subarray(l,l+_)),n.putImageData(o,0,m))}else if(e.kind===Zy.RGB_24BPP)for(b=$r,_=i*b,f=0;f<a;f++){for(f>=s&&(b=r,_=i*b),u=0,m=_;m--;)d[u++]=h[l++],d[u++]=h[l++],d[u++]=h[l++],d[u++]=255;n.putImageData(o,0,f*$r)}else throw new Error(`bad image kind: ${e.kind}`)}function Nk(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,r=t%$r,s=(t-r)/$r,a=r===0?s:s+1,o=n.createImageData(i,$r);let l=0;const u=e.data,h=o.data;for(let d=0;d<a;d++){const f=d<s?$r:r;({srcPos:l}=f8({src:u,srcPos:l,dest:h,width:i,height:f,nonBlackColor:0})),n.putImageData(o,0,d*$r)}}function Rp(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Ty(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!cr){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function Ik(n,e){if(e)return!0;const t=dt.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Ou.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const y8=["butt","round","square"],b8=["miter","round","bevel"],w8={},Lk={};var Ca,X2,Y2,Q2;const Lx=class Lx{constructor(e,t,i,r,s,{optionalContentConfig:a,markedContentStack:o=null},l,u){N(this,Ca);this.ctx=e,this.current=new Rk(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=r,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new g8(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:r=null}){const s=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,s,a),this.ctx.fillStyle=o,i){const l=this.cachedCanvases.getCanvas("transparent",s,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Cn(this.compositeCtx))}this.ctx.save(),Ty(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Cn(this.ctx)}executeOperatorList(e,t,i,r){const s=e.argsArray,a=e.fnArray;let o=t||0;const l=s.length;if(l===o)return o;const u=l-o>Tk&&typeof i=="function",h=u?Date.now()+p8:0;let d=0;const f=this.commonObjs,m=this.objs;let b;for(;;){if(r!==void 0&&o===r.nextBreakPoint)return r.breakIt(o,i),o;if(b=a[o],b!==na.dependency)this[b].apply(this,s[o]);else for(const _ of s[o]){const w=_.startsWith("g_")?f:m;if(!w.has(_))return w.get(_,i),o}if(o++,o===l)return o;if(u&&++d>Tk){if(Date.now()>h)return i(),o;d=0}}}endDrawing(){I(this,Ca,X2).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),I(this,Ca,Y2).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,r=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=i,l=r,u="prescale1",h,d;for(;s>2&&o>1||a>2&&l>1;){let f=o,m=l;s>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),s/=o/f),a>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/m),h=this.cachedCanvases.getCanvas(u,f,m),d=h.context,d.clearRect(0,0,f,m),d.drawImage(e,0,0,o,l,0,0,f,m),e=h.canvas,o=f,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:r}=e,s=this.current.fillColor,a=this.current.patternFill,o=Cn(t);let l,u,h,d;if((e.bitmap||e.data)&&e.count>1){const F=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),s]),l=this._cachedBitmapsMap.get(F),l||(l=new Map,this._cachedBitmapsMap.set(F,l));const H=l.get(u);if(H&&!a){const z=Math.round(Math.min(o[0],o[2])+o[4]),te=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:H,offsetX:z,offsetY:te}}h=H}h||(d=this.cachedCanvases.getCanvas("maskCanvas",i,r),Nk(d.context,e));let f=dt.transform(o,[1/i,0,0,-1/r,0,0]);f=dt.transform(f,[1,0,0,1,0,-r]);const[m,b,_,w]=dt.getAxialAlignedBoundingBox([0,0,i,r],f),v=Math.round(_-m)||1,y=Math.round(w-b)||1,E=this.cachedCanvases.getCanvas("fillCanvas",v,y),k=E.context,S=m,D=b;k.translate(-S,-D),k.transform(...f),h||(h=this._scaleImage(d.canvas,La(k)),h=h.img,l&&a&&l.set(u,h)),k.imageSmoothingEnabled=Ik(Cn(k),e.interpolate),ky(k,h,0,0,h.width,h.height,0,0,i,r),k.globalCompositeOperation="source-in";const P=dt.transform(La(k),[1,0,0,1,-S,-D]);return k.fillStyle=a?s.getPattern(t,this,P,or.FILL):s,k.fillRect(0,0,i,r),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,E.canvas)),{canvas:E.canvas,offsetX:Math.round(S),offsetY:Math.round(D)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=y8[e]}setLineJoin(e){this.ctx.lineJoin=b8[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const s=this.ctx;s.setTransform(...Cn(this.suspendedCtx)),Rp(this.suspendedCtx,s),m8(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rp(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,r){const s=r[0],a=r[1],o=r[2]-s,l=r[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,i,o,l,t.subtype,t.backdrop,t.transferMap,s,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,r,s,a,o,l,u,h,d){let f=e.canvas,m=l-h,b=u-d;if(a){const w=dt.makeHexColor(...a);if(m<0||b<0||m+i>f.width||b+r>f.height){const v=this.cachedCanvases.getCanvas("maskExtension",i,r),y=v.context;y.drawImage(f,-m,-b),y.globalCompositeOperation="destination-atop",y.fillStyle=w,y.fillRect(0,0,i,r),y.globalCompositeOperation="source-over",f=v.canvas,m=b=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(m,b,i,r),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=w,e.fillRect(m,b,i,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const _=new Path2D;_.rect(l,u,i,r),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(f,m,b,i,r,l,u,i,r),t.restore()}save(){this.inSMaskMode?(Rp(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Rp(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,r,s,a){this.ctx.transform(e,t,i,r,s,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const r=this.ctx,s=this.current;let a=s.x,o=s.y,l,u;const h=Cn(r),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?i.slice(0):null;for(let m=0,b=0,_=e.length;m<_;m++)switch(e[m]|0){case na.rectangle:a=t[b++],o=t[b++];const w=t[b++],v=t[b++],y=a+w,E=o+v;r.moveTo(a,o),w===0||v===0?r.lineTo(y,E):(r.lineTo(y,o),r.lineTo(y,E),r.lineTo(a,E)),d||s.updateRectMinMax(h,[a,o,y,E]),r.closePath();break;case na.moveTo:a=t[b++],o=t[b++],r.moveTo(a,o),d||s.updatePathMinMax(h,a,o);break;case na.lineTo:a=t[b++],o=t[b++],r.lineTo(a,o),d||s.updatePathMinMax(h,a,o);break;case na.curveTo:l=a,u=o,a=t[b+4],o=t[b+5],r.bezierCurveTo(t[b],t[b+1],t[b+2],t[b+3],a,o),s.updateCurvePathMinMax(h,l,u,t[b],t[b+1],t[b+2],t[b+3],a,o,f),b+=6;break;case na.curveTo2:l=a,u=o,r.bezierCurveTo(a,o,t[b],t[b+1],t[b+2],t[b+3]),s.updateCurvePathMinMax(h,l,u,a,o,t[b],t[b+1],t[b+2],t[b+3],f),a=t[b+2],o=t[b+3],b+=4;break;case na.curveTo3:l=a,u=o,a=t[b+2],o=t[b+3],r.bezierCurveTo(t[b],t[b+1],a,o,a,o),s.updateCurvePathMinMax(h,l,u,t[b],t[b+1],a,o,a,o,f),b+=4;break;case na.closePath:r.closePath();break}d&&s.updateScalingPathMinMax(h,f),s.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&i?.getPattern?(t.save(),t.strokeStyle=i.getPattern(t,this,La(t),or.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let s=!1;r&&(t.save(),t.fillStyle=i.getPattern(t,this,La(t),or.FILL),s=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),s&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=w8}eoClip(){this.pendingClip=Lk}beginText(){this.current.textMatrix=yN,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,r=t.getTransform().invertSelf();for(const{transform:s,x:a,y:o,fontSize:l,path:u}of e)i.addPath(u,new DOMMatrix(s).preMultiplySelf(r).translate(a,o).scale(l,-l));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const i=this.commonObjs.get(e),r=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=i.fontMatrix||E2,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Tt("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const s=i.loadedName||"sans-serif",a=i.systemFontInfo?.css||`"${s}", ${i.fallbackName}`;let o="normal";i.black?o="900":i.bold&&(o="bold");const l=i.italic?"italic":"normal";let u=t;t<Ck?u=Ck:t>kk&&(u=kk),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,r,s,a){this.current.textMatrix=[e,t,i,r,s,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,r,s){const a=this.ctx,o=this.current,l=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=u&er.FILL_STROKE_MASK,f=!!(u&er.ADD_TO_PATH_FLAG),m=o.patternFill&&!l.missingFile,b=o.patternStroke&&!l.missingFile;let _;if((l.disableFontFace||f||m||b)&&(_=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||b){if(a.save(),a.translate(t,i),a.scale(h,-h),d===er.FILL||d===er.FILL_STROKE)if(r){const w=a.getTransform();a.setTransform(...r),a.fill(I(this,Ca,Q2).call(this,_,w,r))}else a.fill(_);if(d===er.STROKE||d===er.FILL_STROKE)if(s){const w=a.getTransform();a.setTransform(...s),a.stroke(I(this,Ca,Q2).call(this,_,w,s))}else a.lineWidth/=h,a.stroke(_);a.restore()}else(d===er.FILL||d===er.FILL_STROKE)&&a.fillText(e,t,i),(d===er.STROKE||d===er.FILL_STROKE)&&a.strokeText(e,t,i);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Cn(a),x:t,y:i,fontSize:h,path:_})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){i=!0;break}return Ft(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const s=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=e.length,f=i.vertical,m=f?1:-1,b=i.defaultVMetrics,_=r*t.fontMatrix[0],w=t.textRenderingMode===er.FILL&&!i.disableFontFace&&!t.patternFill;s.save(),s.transform(...t.textMatrix),s.translate(t.x,t.y+t.textRise),u>0?s.scale(h,-1):s.scale(h,1);let v,y;if(t.patternFill){s.save();const P=t.fillColor.getPattern(s,this,La(s),or.FILL);v=Cn(s),s.restore(),s.fillStyle=P}if(t.patternStroke){s.save();const P=t.strokeColor.getPattern(s,this,La(s),or.STROKE);y=Cn(s),s.restore(),s.strokeStyle=P}let E=t.lineWidth;const k=t.textMatrixScale;if(k===0||E===0){const P=t.textRenderingMode&er.FILL_STROKE_MASK;(P===er.STROKE||P===er.FILL_STROKE)&&(E=this.getSinglePixelWidth())}else E/=k;if(a!==1&&(s.scale(a,a),E/=a),s.lineWidth=E,i.isInvalidPDFjsFont){const P=[];let F=0;for(const H of e)P.push(H.unicode),F+=H.width;s.fillText(P.join(""),0,0),t.x+=F*_*h,s.restore(),this.compose();return}let S=0,D;for(D=0;D<d;++D){const P=e[D];if(typeof P=="number"){S+=m*P*r/1e3;continue}let F=!1;const H=(P.isSpace?l:0)+o,z=P.fontChar,te=P.accent;let de,ke,Me=P.width;if(f){const ve=P.vmetric||b,xe=-(P.vmetric?ve[1]:Me*.5)*_,he=ve[2]*_;Me=ve?-ve[0]:Me,de=xe/a,ke=(S+he)/a}else de=S/a,ke=0;if(i.remeasure&&Me>0){const ve=s.measureText(z).width*1e3/r*a;if(Me<ve&&this.isFontSubpixelAAEnabled){const xe=Me/ve;F=!0,s.save(),s.scale(xe,1),de/=xe}else Me!==ve&&(de+=(Me-ve)/2e3*r/a)}if(this.contentVisible&&(P.isInFont||i.missingFile)){if(w&&!te)s.fillText(z,de,ke);else if(this.paintChar(z,de,ke,v,y),te){const ve=de+r*te.offset.x/a,xe=ke-r*te.offset.y/a;this.paintChar(te.fontChar,ve,xe,v,y)}}const ze=f?Me*_-H*u:Me*_+H*u;S+=ze,F&&s.restore()}f?t.y-=S:t.x+=S*h,s.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,r=i.font,s=i.fontSize,a=i.fontDirection,o=r.vertical?1:-1,l=i.charSpacing,u=i.wordSpacing,h=i.textHScale*a,d=i.fontMatrix||E2,f=e.length,m=i.textRenderingMode===er.INVISIBLE;let b,_,w,v;if(!(m||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(h,a),b=0;b<f;++b){if(_=e[b],typeof _=="number"){v=o*_*s/1e3,this.ctx.translate(v,0),i.x+=v*h;continue}const y=(_.isSpace?u:0)+l,E=r.charProcOperatorList[_.operatorListId];if(!E){Tt(`Type3 character "${_.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=_,this.save(),t.scale(s,s),t.transform(...d),this.executeOperatorList(E),this.restore()),w=dt.applyTransform([_.width,0],d)[0]*s+y,t.translate(w,0),i.x+=w*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,r,s,a){this.ctx.rect(i,r,s-i,a-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],r=this.baseTransform||Cn(this.ctx),s={createCanvasGraphics:a=>new Lx(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new K2(e,i,this.ctx,s,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=dt.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=dt.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=d8(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,La(t),or.SHADING);const r=La(t);if(r){const{width:s,height:a}=t.canvas,[o,l,u,h]=dt.getAxialAlignedBoundingBox([0,0,s,a],r);this.ctx.fillRect(o,l,u-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){pn("Should not call beginInlineImage")}beginImageData(){pn("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Cn(this.ctx),t)){const i=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],i,r),this.current.updateRectMinMax(Cn(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Dw("TODO: Support non-isolated groups."),e.knockout&&Tt("Knockout groups not supported.");const i=Cn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=dt.getAxialAlignedBoundingBox(e.bbox,Cn(t));const s=[0,0,t.canvas.width,t.canvas.height];r=dt.intersect(r,s)||[0,0,0,0];const a=Math.floor(r[0]),o=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),u=Math.max(Math.ceil(r[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,u),f=d.context;f.translate(-a,-o),f.transform(...i),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Rp(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=Cn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const s=dt.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,i,r,s){if(I(this,Ca,X2).call(this),Ty(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(s&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,u]=dt.singularValueDecompose2dScale(Cn(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),f=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:m,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,o*u),Ty(this.ctx)}else Ty(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new Rk(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),I(this,Ca,Y2).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=v8(e)),r.compiled)){r.compiled(i);return}const s=this._createMaskCanvas(e),a=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,s.offsetX,s.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,r=0,s,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Cn(o);o.transform(t,i,r,s,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let h=0,d=a.length;h<d;h+=2){const f=dt.transform(l,[t,i,r,s,a[h],a[h+1]]),[m,b]=dt.applyTransform([0,0],f);o.drawImage(u.canvas,m,b)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(const s of e){const{data:a,width:o,height:l,transform:u}=s,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();const f=this.getObject(a,s);Nk(d,f),d.globalCompositeOperation="source-in",d.fillStyle=r?i.getPattern(d,this,La(t),or.FILL):i,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),ky(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Tt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,r){if(!this.contentVisible)return;const s=this.getObject(e);if(!s){Tt("Dependent image isn't ready yet");return}const a=s.width,o=s.height,l=[];for(let u=0,h=r.length;u<h;u+=2)l.push({transform:[t,0,0,i,r[u],r[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:r}=e,s=this.cachedCanvases.getCanvas("inlineImage",i,r),a=s.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",s.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,r=this.ctx;if(this.save(),!cr){const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none")}r.scale(1/t,-1/i);let s;if(e.bitmap)s=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)s=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,i).context;Pk(l,e),s=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(s,La(r));r.imageSmoothingEnabled=Ik(Cn(r),e.interpolate),ky(r,a.img,0,0,a.paintWidth,a.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const s=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;Pk(l,e),r=this.applyTransferMapsToCanvas(l)}for(const s of t)i.save(),i.transform(...s.transform),i.scale(1,-1),ky(i,r,s.x,s.y,s.w,s.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===Lk?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Cn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:r,d:s}=this.ctx.getTransform();let a,o;if(i===0&&r===0){const l=Math.abs(t),u=Math.abs(s);if(l===u)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/u;else{const h=l*e,d=u*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const l=Math.abs(t*s-i*r),u=Math.hypot(t,i),h=Math.hypot(r,s);if(e===0)a=h/l,o=u/l;else{const d=e*l;a=h>d?h/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[r,s]=this.getScaleForStroking();if(t.lineWidth=i||1,r===1&&s===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(r,s),a.length>0){const o=Math.max(r,s);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ca=new WeakSet,X2=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Y2=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Q2=function(e,t,i){const r=new Path2D;return r.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),r};let Sd=Lx;for(const n in na)Sd.prototype[n]!==void 0&&(Sd.prototype[na[n]]=Sd.prototype[n]);var kg,Tg;class Zo{static get workerPort(){return c(this,kg)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");T(this,kg,e)}static get workerSrc(){return c(this,Tg)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");T(this,Tg,e)}}kg=new WeakMap,Tg=new WeakMap,N(Zo,kg,null),N(Zo,Tg,"");var Fc,Dg;class _8{constructor({parsedData:e,rawData:t}){N(this,Fc);N(this,Dg);T(this,Fc,e),T(this,Dg,t)}getRaw(){return c(this,Dg)}get(e){return c(this,Fc).get(e)??null}getAll(){return mx(c(this,Fc))}has(e){return c(this,Fc).has(e)}}Fc=new WeakMap,Dg=new WeakMap;const Jh=Symbol("INTERNAL");var Rg,Pg,Ng,Zd;class E8{constructor(e,{name:t,intent:i,usage:r,rbGroups:s}){N(this,Rg,!1);N(this,Pg,!1);N(this,Ng,!1);N(this,Zd,!0);T(this,Rg,!!(e&ms.DISPLAY)),T(this,Pg,!!(e&ms.PRINT)),this.name=t,this.intent=i,this.usage=r,this.rbGroups=s}get visible(){if(c(this,Ng))return c(this,Zd);if(!c(this,Zd))return!1;const{print:e,view:t}=this.usage;return c(this,Rg)?t?.viewState!=="OFF":c(this,Pg)?e?.printState!=="OFF":!0}_setVisible(e,t,i=!1){e!==Jh&&pn("Internal method `_setVisible` called."),T(this,Ng,i),T(this,Zd,t)}}Rg=new WeakMap,Pg=new WeakMap,Ng=new WeakMap,Zd=new WeakMap;var eu,sn,Jd,ef,Ig,Z2;class A8{constructor(e,t=ms.DISPLAY){N(this,Ig);N(this,eu,null);N(this,sn,new Map);N(this,Jd,null);N(this,ef,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,T(this,ef,e.order);for(const i of e.groups)c(this,sn).set(i.id,new E8(t,i));if(e.baseState==="OFF")for(const i of c(this,sn).values())i._setVisible(Jh,!1);for(const i of e.on)c(this,sn).get(i)._setVisible(Jh,!0);for(const i of e.off)c(this,sn).get(i)._setVisible(Jh,!1);T(this,Jd,this.getHash())}}isVisible(e){if(c(this,sn).size===0)return!0;if(!e)return Dw("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,sn).has(e.id)?c(this,sn).get(e.id).visible:(Tt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return I(this,Ig,Z2).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,sn).has(t))return Tt(`Optional content group not found: ${t}`),!0;if(c(this,sn).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,sn).has(t))return Tt(`Optional content group not found: ${t}`),!0;if(!c(this,sn).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,sn).has(t))return Tt(`Optional content group not found: ${t}`),!0;if(!c(this,sn).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,sn).has(t))return Tt(`Optional content group not found: ${t}`),!0;if(c(this,sn).get(t).visible)return!1}return!0}return Tt(`Unknown optional content policy ${e.policy}.`),!0}return Tt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){const r=c(this,sn).get(e);if(!r){Tt(`Optional content group not found: ${e}`);return}if(i&&t&&r.rbGroups.length)for(const s of r.rbGroups)for(const a of s)a!==e&&c(this,sn).get(a)?._setVisible(Jh,!1,!0);r._setVisible(Jh,!!t,!0),T(this,eu,null)}setOCGState({state:e,preserveRB:t}){let i;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const s=c(this,sn).get(r);if(s)switch(i){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!s.visible,t);break}}T(this,eu,null)}get hasInitialVisibility(){return c(this,Jd)===null||this.getHash()===c(this,Jd)}getOrder(){return c(this,sn).size?c(this,ef)?c(this,ef).slice():[...c(this,sn).keys()]:null}getGroups(){return c(this,sn).size>0?mx(c(this,sn)):null}getGroup(e){return c(this,sn).get(e)||null}getHash(){if(c(this,eu)!==null)return c(this,eu);const e=new XN;for(const[t,i]of c(this,sn))e.update(`${t}:${i.visible}`);return T(this,eu,e.hexdigest())}}eu=new WeakMap,sn=new WeakMap,Jd=new WeakMap,ef=new WeakMap,Ig=new WeakSet,Z2=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let r=1;r<t;r++){const s=e[r];let a;if(Array.isArray(s))a=I(this,Ig,Z2).call(this,s);else if(c(this,sn).has(s))a=c(this,sn).get(s).visible;else return Tt(`Optional content group not found: ${s}`),!0;switch(i){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return i==="And"};class x8{constructor(e,{disableRange:t=!1,disableStream:i=!1}){ri(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:s,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,s?.length>0){const l=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(s){return s._begin!==e?!1:(s._enqueue(i),!0)});ri(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){ri(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new S8(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new C8(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class S8{constructor(e,t,i=!1,r=null){this._stream=e,this._done=i||!1,this._filename=yx(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class C8{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function k8(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=u(h),s(h)}if(t=a(n),t){const h=u(t);return s(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),s(h)}function i(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function r(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),m=Rw(d);d=f.decode(m),e=!1}catch{}}return d}function s(h){return e&&/[\x80-\xff]/.test(h)&&(h=r("utf-8",h),e&&(h=r("iso-8859-1",h))),h}function a(h){const d=[];let f;const m=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=m.exec(h))!==null;){let[,_,w,v]=f;if(_=parseInt(_,10),_ in d){if(_===0)break;continue}d[_]=[w,v]}const b=[];for(let _=0;_<d.length&&_ in d;++_){let[w,v]=d[_];v=o(v),w&&(v=unescape(v),_===0&&(v=l(v))),b.push(v)}return b.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const m=d[f].indexOf('"');m!==-1&&(d[f]=d[f].slice(0,m),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function l(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),b=h.slice(d+1).replace(/^[^']*'/,"");return r(f,b)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,m,b){if(m==="q"||m==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,w){return String.fromCharCode(parseInt(w,16))}),r(f,b);try{b=atob(b)}catch{}return r(f,b)})}return""}function uI(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const r=e[i];r!==void 0&&t.append(i,r)}return t}function Iw(n){try{return new URL(n).origin}catch{}return null}function cI({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(r.suggestedLength=s,s<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function hI(n){const e=n.get("Content-Disposition");if(e){let t=k8(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(yx(t))return t}return null}function Lw(n,e){return n===404||n===0&&e.startsWith("file:")?new Hm('Missing PDF "'+e+'".'):new yb(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function dI(n){return n===200||n===206}function fI(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function pI(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Tt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class Ok{constructor(e){Ae(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=uI(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ri(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new T8(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new D8(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class T8{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),r=t.url;fetch(r,fI(i,this._withCredentials,this._abortController)).then(s=>{if(e._responseOrigin=Iw(s.url),!dI(s.status))throw Lw(s.status,r);this._reader=s.body.getReader(),this._headersCapability.resolve();const a=s.headers,{allowRangeRequests:o,suggestedLength:l}=cI({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=hI(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Lu("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:pI(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class D8{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const s=new Headers(e.headers);s.append("Range",`bytes=${t}-${i-1}`);const a=r.url;fetch(a,fI(s,this._withCredentials,this._abortController)).then(o=>{const l=Iw(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!dI(o.status))throw Lw(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:pI(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const n_=200,i_=206;function R8(n){const e=n.response;return typeof e!="string"?e:Rw(e).buffer}class P8{constructor({url:e,httpHeaders:t,withCredentials:i}){Ae(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=uI(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[s,a]of this.headers)t.setRequestHeader(s,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=i_):r.expectedStatus=n_,t.responseType="arraybuffer",ri(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){const i=this.pendingRequests[e];i&&i.onProgress?.(t)}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){i.onError(r.status);return}const s=r.status||n_;if(!(s===n_&&i.expectedStatus===i_)&&s!==i.expectedStatus){i.onError(r.status);return}const o=R8(r);if(s===i_){const l=r.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?i.onDone({begin:parseInt(u[1],10),chunk:o}):(Tt('Missing or invalid "Content-Range" header.'),i.onError(0))}else o?i.onDone({begin:0,chunk:o}):i.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class N8{constructor(e){this._source=e,this._manager=new P8(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return ri(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new I8(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new L8(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class I8{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Iw(t.responseURL);const i=t.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:a}=cI({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=hI(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Lw(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L8{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=Iw(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Lw(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const O8=/^[a-z][a-z0-9\-+.]+:/i;function M8(n){if(O8.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class F8{constructor(e){this.source=e,this.url=M8(e.url),ri(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return ri(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new B8(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new j8(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class B8{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new Hm(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Lu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class j8{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const z8=1e5,Mr=30,U8=.8;var tu,zr,Lg,Og,Bc,Mo,Mg,Fg,jc,tf,nf,nu,rf,Bg,sf,zc,jg,zg,Uc,$c,Ug,iu,af,yl,mI,gI,J2,_s,u0,eE,vI,yI;const hi=class hi{constructor({textContentSource:e,container:t,viewport:i}){N(this,yl);N(this,tu,Promise.withResolvers());N(this,zr,null);N(this,Lg,!1);N(this,Og,!!globalThis.FontInspector?.enabled);N(this,Bc,null);N(this,Mo,null);N(this,Mg,0);N(this,Fg,0);N(this,jc,null);N(this,tf,null);N(this,nf,0);N(this,nu,0);N(this,rf,Object.create(null));N(this,Bg,[]);N(this,sf,null);N(this,zc,[]);N(this,jg,new WeakMap);N(this,zg,null);var l;if(e instanceof ReadableStream)T(this,sf,e);else if(typeof e=="object")T(this,sf,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');T(this,zr,T(this,tf,t)),T(this,nu,i.scale*(globalThis.devicePixelRatio||1)),T(this,nf,i.rotation),T(this,Mo,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:s,pageX:a,pageY:o}=i.rawDims;T(this,zg,[1,0,0,-1,-a,o+s]),T(this,Fg,r),T(this,Mg,s),I(l=hi,_s,vI).call(l),Th(t,i),c(this,tu).promise.finally(()=>{c(hi,af).delete(this),T(this,Mo,null),T(this,rf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Tr.platform;return Ft(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,jc).read().then(({value:t,done:i})=>{if(i){c(this,tu).resolve();return}c(this,Bc)??T(this,Bc,t.lang),Object.assign(c(this,rf),t.styles),I(this,yl,mI).call(this,t.items),e()},c(this,tu).reject)};return T(this,jc,c(this,sf).getReader()),c(hi,af).add(this),e(),c(this,tu).promise}update({viewport:e,onBefore:t=null}){var s;const i=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==c(this,nf)&&(t?.(),T(this,nf,r),Th(c(this,tf),{rotation:r})),i!==c(this,nu)){t?.(),T(this,nu,i);const a={div:null,properties:null,ctx:I(s=hi,_s,u0).call(s,c(this,Bc))};for(const o of c(this,zc))a.properties=c(this,jg).get(o),a.div=o,I(this,yl,J2).call(this,a)}}cancel(){const e=new Lu("TextLayer task cancelled.");c(this,jc)?.cancel(e).catch(()=>{}),T(this,jc,null),c(this,tu).reject(e)}get textDivs(){return c(this,zc)}get textContentItemsStr(){return c(this,Bg)}static cleanup(){if(!(c(this,af).size>0)){c(this,Uc).clear();for(const{canvas:e}of c(this,$c).values())e.remove();c(this,$c).clear()}}};tu=new WeakMap,zr=new WeakMap,Lg=new WeakMap,Og=new WeakMap,Bc=new WeakMap,Mo=new WeakMap,Mg=new WeakMap,Fg=new WeakMap,jc=new WeakMap,tf=new WeakMap,nf=new WeakMap,nu=new WeakMap,rf=new WeakMap,Bg=new WeakMap,sf=new WeakMap,zc=new WeakMap,jg=new WeakMap,zg=new WeakMap,Uc=new WeakMap,$c=new WeakMap,Ug=new WeakMap,iu=new WeakMap,af=new WeakMap,yl=new WeakSet,mI=function(e){var r,s;if(c(this,Lg))return;(s=c(this,Mo)).ctx??(s.ctx=I(r=hi,_s,u0).call(r,c(this,Bc)));const t=c(this,zc),i=c(this,Bg);for(const a of e){if(t.length>z8){Tt("Ignoring additional textDivs for performance reasons."),T(this,Lg,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=c(this,zr);T(this,zr,document.createElement("span")),c(this,zr).classList.add("markedContent"),a.id!==null&&c(this,zr).setAttribute("id",`${a.id}`),o.append(c(this,zr))}else a.type==="endMarkedContent"&&T(this,zr,c(this,zr).parentNode);continue}i.push(a.str),I(this,yl,gI).call(this,a)}},gI=function(e){var _;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,zc).push(t);const r=dt.transform(c(this,zg),e.transform);let s=Math.atan2(r[1],r[0]);const a=c(this,rf)[e.fontName];a.vertical&&(s+=Math.PI/2);let o=c(this,Og)&&a.fontSubstitution||a.fontFamily;o=hi.fontFamilyMap.get(o)||o;const l=Math.hypot(r[2],r[3]),u=l*I(_=hi,_s,yI).call(_,o,c(this,Bc));let h,d;s===0?(h=r[4],d=r[5]-u):(h=r[4]+u*Math.sin(s),d=r[5]-u*Math.cos(s));const f="calc(var(--scale-factor)*",m=t.style;c(this,zr)===c(this,tf)?(m.left=`${(100*h/c(this,Fg)).toFixed(2)}%`,m.top=`${(100*d/c(this,Mg)).toFixed(2)}%`):(m.left=`${f}${h.toFixed(2)}px)`,m.top=`${f}${d.toFixed(2)}px)`),m.fontSize=`${f}${(c(hi,iu)*l).toFixed(2)}px)`,m.fontFamily=o,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,Og)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),s!==0&&(i.angle=s*(180/Math.PI));let b=!1;if(e.str.length>1)b=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);w!==v&&Math.max(w,v)/Math.min(w,v)>1.5&&(b=!0)}if(b&&(i.canvasWidth=a.vertical?e.height:e.width),c(this,jg).set(t,i),c(this,Mo).div=t,c(this,Mo).properties=i,I(this,yl,J2).call(this,c(this,Mo)),i.hasText&&c(this,zr).append(t),i.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),c(this,zr).append(w)}},J2=function(e){var o;const{div:t,properties:i,ctx:r}=e,{style:s}=t;let a="";if(c(hi,iu)>1&&(a=`scale(${1/c(hi,iu)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=s,{canvasWidth:u,fontSize:h}=i;I(o=hi,_s,eE).call(o,r,h*c(this,nu),l);const{width:d}=r.measureText(t.textContent);d>0&&(a=`scaleX(${u*c(this,nu)/d}) ${a}`)}i.angle!==0&&(a=`rotate(${i.angle}deg) ${a}`),a.length>0&&(s.transform=a)},_s=new WeakSet,u0=function(e=null){let t=c(this,$c).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,$c).set(e,t),c(this,Ug).set(t,{size:0,family:""})}return t},eE=function(e,t,i){const r=c(this,Ug).get(e);t===r.size&&i===r.family||(e.font=`${t}px ${i}`,r.size=t,r.family=i)},vI=function(){if(c(this,iu)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),T(this,iu,e.getBoundingClientRect().height),e.remove()},yI=function(e,t){const i=c(this,Uc).get(e);if(i)return i;const r=I(this,_s,u0).call(this,t);r.canvas.width=r.canvas.height=Mr,I(this,_s,eE).call(this,r,Mr,e);const s=r.measureText("");let a=s.fontBoundingBoxAscent,o=Math.abs(s.fontBoundingBoxDescent);if(a){const h=a/(a+o);return c(this,Uc).set(e,h),r.canvas.width=r.canvas.height=0,h}r.strokeStyle="red",r.clearRect(0,0,Mr,Mr),r.strokeText("g",0,0);let l=r.getImageData(0,0,Mr,Mr).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/Mr);break}r.clearRect(0,0,Mr,Mr),r.strokeText("A",0,Mr),l=r.getImageData(0,0,Mr,Mr).data,a=0;for(let h=0,d=l.length;h<d;h+=4)if(l[h]>0){a=Mr-Math.floor(h/4/Mr);break}r.canvas.width=r.canvas.height=0;const u=a?a/(a+o):U8;return c(this,Uc).set(e,u),u},N(hi,_s),N(hi,Uc,new Map),N(hi,$c,new Map),N(hi,Ug,new WeakMap),N(hi,iu,null),N(hi,af,new Set);let qm=hi;class Wm{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function r(s){if(!s)return;let a=null;const o=s.name;if(o==="#text")a=s.value;else if(Wm.shouldBuildText(o))s?.attributes?.textContent?a=s.attributes.textContent:s.value&&(a=s.value);else return;if(a!==null&&t.push({str:a}),!!s.children)for(const l of s.children)r(l)}return r(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const $8=65536,H8=100,q8=5e3,W8=cr?s8:n8,V8=cr?a8:iI,G8=cr?r8:i8,K8=cr?o8:oI;function X8(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new tE,{docId:t}=e,i=n.url?Y8(n.url):null,r=n.data?Q8(n.data):null,s=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof bI?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:$8;let h=n.worker instanceof Cd?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!Nw(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,b=n.cMapPacked!==!1,_=n.CMapReaderFactory||V8,w=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||K8,y=n.stopAtErrors!==!0,E=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,S=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!cr,D=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!cr&&(Tr.platform.isFirefox||!globalThis.chrome),P=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,F=typeof n.disableFontFace=="boolean"?n.disableFontFace:cr,H=n.fontExtraProperties===!0,z=n.enableXfa===!0,te=n.ownerDocument||globalThis.document,de=n.disableRange===!0,ke=n.disableStream===!0,Me=n.disableAutoFetch===!0,ze=n.pdfBug===!0,ve=n.CanvasFactory||W8,xe=n.FilterFactory||G8,he=n.enableHWA===!0,ie=l?l.length:n.length??NaN,ae=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!cr&&!F,me=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:_===iI&&v===oI&&m&&w&&jp(m,document.baseURI)&&jp(w,document.baseURI),_e=null;Lz(d);const pe={canvasFactory:new ve({ownerDocument:te,enableHWA:he}),filterFactory:new xe({docId:t,ownerDocument:te}),cMapReaderFactory:me?null:new _({baseUrl:m,isCompressed:b}),standardFontDataFactory:me?null:new v({baseUrl:w})};if(!h){const Xe={verbosity:d,port:Zo.workerPort};h=Xe.port?Cd.fromPort(Xe):new Cd(Xe),e._worker=h}const De={docId:t,apiVersion:"4.10.38",data:r,password:o,disableAutoFetch:Me,rangeChunkSize:u,length:ie,docBaseUrl:f,enableXfa:z,evaluatorOptions:{maxImageSize:E,disableFontFace:F,ignoreErrors:y,isEvalSupported:k,isOffscreenCanvasSupported:S,isImageDecoderSupported:D,canvasMaxAreaInBytes:P,fontExtraProperties:H,useSystemFonts:ae,cMapUrl:me?m:null,standardFontDataUrl:me?w:null}},it={disableFontFace:F,fontExtraProperties:H,ownerDocument:te,pdfBug:ze,styleElement:_e,loadingParams:{disableAutoFetch:Me,enableXfa:z}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Xe=h.messageHandler.sendWithPromise("GetDocRequest",De,r?[r.buffer]:null);let We;if(l)We=new x8(l,{disableRange:de,disableStream:ke});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");let nt;if(cr)if(jp(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");nt=Ok}else nt=F8;else nt=jp(i)?Ok:N8;We=new nt({url:i,length:ie,httpHeaders:s,withCredentials:a,rangeChunkSize:u,disableRange:de,disableStream:ke})}return Xe.then(nt=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ve=new Hp(t,nt,h.port),Bt=new tU(Ve,e,We,it,pe);e._transport=Bt,Ve.send("Ready",null)})}).catch(e._capability.reject),e}function Y8(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(cr&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Q8(n){if(cr&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return Rw(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Mk(n){return typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0}var Bb;const jb=class jb{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${_i(jb,Bb)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}};Bb=new WeakMap,N(jb,Bb,0);let tE=jb;class bI{constructor(e,t,i=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){pn("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Z8{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ft(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ru,Fo,js,ed,c0;class J8{constructor(e,t,i,r=!1){N(this,js);N(this,ru,null);N(this,Fo,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=r?new Ek:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new wI,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}={}){return new jv({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:r,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ft(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:r=Ll.ENABLE,transform:s=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){this._stats?.time("Overall");const f=this._transport.getRenderingIntent(i,r,h,d),{renderingIntent:m,cacheKey:b}=f;T(this,Fo,!1),I(this,js,c0).call(this),o||(o=this._transport.getOptionalContentConfig(m));let _=this._intentStates.get(b);_||(_=Object.create(null),this._intentStates.set(b,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const w=!!(m&ms.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));const v=k=>{_.renderTasks.delete(y),(this._maybeCleanupAfterRender||w)&&T(this,Fo,!0),I(this,js,ed).call(this,!w),k?(y.capability.reject(k),this._abortOperatorList({intentState:_,reason:k instanceof Error?k:new Error(k)})):y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},y=new iE({callback:v,params:{canvasContext:e,viewport:t,transform:s,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:u});(_.renderTasks||(_.renderTasks=new Set)).add(y);const E=y.task;return Promise.all([_.displayReadyCapability.promise,o]).then(([k,S])=>{if(this.destroyed){v();return}if(this._stats?.time("Rendering"),!(S.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");y.initializeGraphics({transparency:k,optionalContentConfig:S}),y.operatorListChanged()}).catch(v),E}getOperatorList({intent:e="display",annotationMode:t=Ll.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function s(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,i,r,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=s,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Wm.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,r){function s(){a.read().then(function({value:l,done:u}){if(u){i(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),s()},r)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),T(this,Fo,!1),I(this,js,c0).call(this),Promise.all(e)}cleanup(e=!1){T(this,Fo,!0);const t=I(this,js,ed).call(this,!1);return e&&t&&this._stats&&(this._stats=new Ek),t}_startRenderPage(e,t){const i=this._intentStates.get(t);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let i=0,r=e.length;i<r;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&I(this,js,ed).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:r}){const{map:s,transfer:a}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:r},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;const h=()=>{l.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();I(this,js,ed).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof vx){let r=H8;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Lu(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,s]of this._intentStates)if(s===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}ru=new WeakMap,Fo=new WeakMap,js=new WeakSet,ed=function(e=!1){if(I(this,js,c0).call(this),!c(this,Fo)||this.destroyed)return!1;if(e)return T(this,ru,setTimeout(()=>{T(this,ru,null),I(this,js,ed).call(this,!1)},q8)),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,Fo,!1),!0},c0=function(){c(this,ru)&&(clearTimeout(c(this,ru)),T(this,ru,null))};var Bo,zb;class eU{constructor(){N(this,Bo,new Map);N(this,zb,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};c(this,zb).then(()=>{for(const[r]of c(this,Bo))r.call(this,i)})}addEventListener(e,t,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:s}=i;if(s.aborted){Tt("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);r=()=>s.removeEventListener("abort",a),s.addEventListener("abort",a)}c(this,Bo).set(t,r)}removeEventListener(e,t){c(this,Bo).get(t)?.(),c(this,Bo).delete(t)}terminate(){for(const[,e]of c(this,Bo))e?.();c(this,Bo).clear()}}Bo=new WeakMap,zb=new WeakMap;var Ub,Hc,qc,of,h0,lf,d0;const Sn=class Sn{constructor({name:e=null,port:t=null,verbosity:i=Oz()}={}){N(this,of);if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if(c(Sn,qc)?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(c(Sn,qc)||T(Sn,qc,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Hp("main","worker",e),this._messageHandler.on("ready",function(){}),I(this,of,h0).call(this)}_initialize(){if(c(Sn,Hc)||c(Sn,lf,d0)){this._setupFakeWorker();return}let{workerSrc:e}=Sn;try{Sn._isSameOrigin(window.location.href,e)||(e=Sn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new Hp("main","worker",t),r=()=>{s.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:s.signal}),i.on("test",o=>{if(s.abort(),this.destroyed||!o){r();return}this._messageHandler=i,this._port=t,this._webWorker=t,I(this,of,h0).call(this)}),i.on("ready",o=>{if(s.abort(),this.destroyed){r();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;i.send("test",o,[o.buffer])};a();return}catch{Dw("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){c(Sn,Hc)||(Tt("Setting up fake worker."),T(Sn,Hc,!0)),Sn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new eU;this._port=t;const i=`fake${_i(Sn,Ub)._++}`,r=new Hp(i+"_worker",i,t);e.setup(r,t),this._messageHandler=new Hp(i,i+"_worker",t),I(this,of,h0).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,c(Sn,qc)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=c(this,qc)?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Sn(e)}static get workerSrc(){if(Zo.workerSrc)return Zo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ft(this,"_setupFakeWorkerGlobal",(async()=>c(this,lf,d0)?c(this,lf,d0):(await import(this.workerSrc)).WorkerMessageHandler)())}};Ub=new WeakMap,Hc=new WeakMap,qc=new WeakMap,of=new WeakSet,h0=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},lf=new WeakSet,d0=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},N(Sn,lf),N(Sn,Ub,0),N(Sn,Hc,!1),N(Sn,qc),cr&&(T(Sn,Hc,!0),Zo.workerSrc||(Zo.workerSrc="./pdf.worker.mjs")),Sn._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const r=new URL(t,i);return i.origin===r.origin},Sn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Cd=Sn;var jo,Qa,uf,cf,zo,Wc,Kp;class tU{constructor(e,t,i,r,s){N(this,Wc);N(this,jo,new Map);N(this,Qa,new Map);N(this,uf,new Map);N(this,cf,new Map);N(this,zo,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new wI,this.fontLoader=new e8({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return Ft(this,"annotationStorage",new _x)}getRenderingIntent(e,t=Ll.ENABLE,i=null,r=!1,s=!1){let a=ms.DISPLAY,o=q2;switch(e){case"any":a=ms.ANY;break;case"display":break;case"print":a=ms.PRINT;break;default:Tt(`getRenderingIntent - invalid intent: ${e}`)}const l=a&ms.PRINT&&i instanceof QN?i:this.annotationStorage;switch(t){case Ll.DISABLE:a+=ms.ANNOTATIONS_DISABLE;break;case Ll.ENABLE:break;case Ll.ENABLE_FORMS:a+=ms.ANNOTATIONS_FORMS;break;case Ll.ENABLE_STORAGE:a+=ms.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Tt(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(a+=ms.IS_EDITING),s&&(a+=ms.OPLIST);const{ids:u,hash:h}=l.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),c(this,zo)?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of c(this,Qa).values())e.push(i._destroy());c(this,Qa).clear(),c(this,uf).clear(),c(this,cf).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),c(this,jo).clear(),this.filterFactory.destroy(),qm.cleanup(),this._networkStream?.cancelAllRequests(new Lu("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,r)=>{ri(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},r.onPull=()=>{this._fullReader.read().then(function({value:s,done:a}){if(a){r.close();return}ri(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{r.error(s)})},r.onCancel=s=>{this._fullReader.cancel(s),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:s,contentLength:a}=this._fullReader;return(!r||!s)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=o=>{t.onProgress?.({loaded:o.loaded,total:o.total})}),{isStreamingSupported:r,isRangeSupported:s,contentLength:a}}),e.on("GetRangeReader",(i,r)=>{ri(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(i.begin,i.end);if(!s){r.close();return}r.onPull=()=>{s.read().then(function({value:a,done:o}){if(o){r.close();return}ri(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{s.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new Z8(i,this))}),e.on("DocException",i=>{t._capability.reject(Fr(i))}),e.on("PasswordRequest",i=>{T(this,zo,Promise.withResolvers());try{if(!t.onPassword)throw Fr(i);const r=s=>{s instanceof Error?c(this,zo).reject(s):c(this,zo).resolve({password:s})};t.onPassword(r,i.code)}catch(r){c(this,zo).reject(r)}return c(this,zo).promise}),e.on("DataLoaded",i=>{t.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;c(this,Qa).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,r,s])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":const{disableFontFace:a,fontExtraProperties:o,pdfBug:l}=this._params;if("error"in s){const f=s.error;Tt(`Error during font loading: ${f}`),this.commonObjs.resolve(i,f);break}const u=l&&globalThis.FontInspector?.enabled?(f,m)=>globalThis.FontInspector.fontAdded(f,m):null,h=new t8(s,{disableFontFace:a,fontExtraProperties:o,inspectFont:u});this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!o&&h.data&&(h.data=null),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:d}=s;ri(d,"The imageRef must be defined.");for(const f of c(this,Qa).values())for(const[,m]of f.objs)if(m?.ref===d)return m.dataLen?(this.commonObjs.resolve(i,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,s);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([i,r,s,a])=>{if(this.destroyed)return;const o=c(this,Qa).get(r);if(!o.objs.has(i)){if(o._intentStates.size===0){a?.bitmap?.close();return}switch(s){case"Image":o.objs.resolve(i,a),a?.dataLen>Rz&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(i,a);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",i=>{this.destroyed||t.onProgress?.({loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Tt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=c(this,uf).get(t);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&c(this,cf).set(s.refStr,e);const a=new J8(t,s,this,this._params.pdfBug);return c(this,Qa).set(t,a),a});return c(this,uf).set(t,r),r}getPageIndex(e){return Mk(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return I(this,Wc,Kp).call(this,"GetFieldObjects")}hasJSActions(){return I(this,Wc,Kp).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return I(this,Wc,Kp).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return I(this,Wc,Kp).call(this,"GetOptionalContentConfig").then(t=>new A8(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,jo).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(r=>({info:r[0],metadata:r[1]?new _8(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return c(this,jo).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,Qa).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,jo).clear(),this.filterFactory.destroy(!0),qm.cleanup()}}cachedPageNumber(e){if(!Mk(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,cf).get(t)??null}}jo=new WeakMap,Qa=new WeakMap,uf=new WeakMap,cf=new WeakMap,zo=new WeakMap,Wc=new WeakSet,Kp=function(e,t=null){const i=c(this,jo).get(e);if(i)return i;const r=this.messageHandler.sendWithPromise(e,t);return c(this,jo).set(e,r),r};const Pp=Symbol("INITIAL_DATA");var as,$g,nE;class wI{constructor(){N(this,$g);N(this,as,Object.create(null))}get(e,t=null){if(t){const r=I(this,$g,nE).call(this,e);return r.promise.then(()=>t(r.data)),null}const i=c(this,as)[e];if(!i||i.data===Pp)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=c(this,as)[e];return!!t&&t.data!==Pp}delete(e){const t=c(this,as)[e];return!t||t.data===Pp?!1:(delete c(this,as)[e],!0)}resolve(e,t=null){const i=I(this,$g,nE).call(this,e);i.data=t,i.resolve()}clear(){for(const e in c(this,as)){const{data:t}=c(this,as)[e];t?.bitmap?.close()}T(this,as,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,as)){const{data:t}=c(this,as)[e];t!==Pp&&(yield[e,t])}}}as=new WeakMap,$g=new WeakSet,nE=function(e){var t;return(t=c(this,as))[e]||(t[e]={...Promise.withResolvers(),data:Pp})};var su;class nU{constructor(e){N(this,su,null);T(this,su,e),this.onContinue=null}get promise(){return c(this,su).capability.promise}cancel(e=0){c(this,su).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,su).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,su);return e.form||e.canvas&&t?.size>0}}su=new WeakMap;var au,Vc;const tc=class tc{constructor({callback:e,params:t,objs:i,commonObjs:r,annotationCanvasMap:s,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){N(this,au,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new nU(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(c(tc,Vc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(tc,Vc).add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:s,background:a}=this.params;this.gfx=new Sd(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:r,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),c(this,au)&&(window.cancelAnimationFrame(c(this,au)),T(this,au,null)),c(tc,Vc).delete(this._canvas),this.callback(e||new vx(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?T(this,au,window.requestAnimationFrame(()=>{T(this,au,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(tc,Vc).delete(this._canvas),this.callback())))}};au=new WeakMap,Vc=new WeakMap,N(tc,Vc,new WeakSet);let iE=tc;const iU="4.10.38",rU="f9bea397f";function Fk(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Np(n){return Math.max(0,Math.min(255,255*n))}class Bk{static CMYK_G([e,t,i,r]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Np(e),[e,e,e]}static G_HTML([e]){const t=Fk(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Np)}static RGB_HTML(e){return`#${e.map(Fk).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,i+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,i,r]){return[Np(1-Math.min(1,e+r)),Np(1-Math.min(1,i+r)),Np(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const r=1-e,s=1-t,a=1-i,o=Math.min(r,s,a);return["CMYK",r,s,a,o]}}class sU{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){pn("Abstract method `_createSVG` called.")}}class Ax extends sU{_createSVG(e){return document.createElementNS(bo,e)}}class _I{static setupStorage(e,t,i,r,s){const a=r.getValue(t,{value:null});switch(i.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),s==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(a.value===i.attributes.xfaOn?e.setAttribute("checked",!0):a.value===i.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",o=>{r.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),s==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of i.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:r,linkService:s}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&s.addLinkAttributes(e,a.href,a.newWindow),i&&a.dataId&&this.setupStorage(e,a.dataId,t,i)}static render(e){const t=e.annotationStorage,i=e.linkService,r=e.xfaHtml,s=e.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:s,linkService:i});const o=s!=="richText",l=e.div;if(l.append(a),e.viewport){const d=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=d}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(r.children.length===0){if(r.value){const d=document.createTextNode(r.value);a.append(d),o&&Wm.shouldBuildText(r.name)&&u.push(d)}return{textDivs:u}}const h=[[r,-1,a]];for(;h.length>0;){const[d,f,m]=h.at(-1);if(f+1===d.children.length){h.pop();continue}const b=d.children[++h.at(-1)[1]];if(b===null)continue;const{name:_}=b;if(_==="#text"){const v=document.createTextNode(b.value);u.push(v),m.append(v);continue}const w=b?.attributes?.xmlns?document.createElementNS(b.attributes.xmlns,_):document.createElement(_);if(m.append(w),b.attributes&&this.setAttributes({html:w,element:b,storage:t,intent:s,linkService:i}),b.children?.length>0)h.push([b,-1,w]);else if(b.value){const v=document.createTextNode(b.value);o&&Wm.shouldBuildText(_)&&u.push(v),w.append(v)}}for(const d of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))d.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Uv=1e3,aU=9,Rh=new WeakSet;function Ru(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class oU{static create(e){switch(e.data.annotationType){case ui.LINK:return new EI(e);case ui.TEXT:return new lU(e);case ui.WIDGET:switch(e.data.fieldType){case"Tx":return new uU(e);case"Btn":return e.data.radioButton?new SI(e):e.data.checkBox?new hU(e):new dU(e);case"Ch":return new fU(e);case"Sig":return new cU(e)}return new Oh(e);case ui.POPUP:return new sE(e);case ui.FREETEXT:return new RI(e);case ui.LINE:return new mU(e);case ui.SQUARE:return new gU(e);case ui.CIRCLE:return new vU(e);case ui.POLYLINE:return new PI(e);case ui.CARET:return new bU(e);case ui.INK:return new xx(e);case ui.POLYGON:return new yU(e);case ui.HIGHLIGHT:return new NI(e);case ui.UNDERLINE:return new wU(e);case ui.SQUIGGLY:return new _U(e);case ui.STRIKEOUT:return new EU(e);case ui.STAMP:return new II(e);case ui.FILEATTACHMENT:return new AU(e);default:return new Jn(e)}}}var Gc,hf,df,Hg,rE;const Ox=class Ox{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){N(this,Hg);N(this,Gc,null);N(this,hf,!1);N(this,df,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e?.str||t?.str||i?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ox._hasPopupData(this.data)}updateEdited(e){if(!this.container)return;c(this,Gc)||T(this,Gc,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&I(this,Hg,rE).call(this,t),c(this,df)?.popup.updateEdited(e)}resetEdited(){c(this,Gc)&&(I(this,Hg,rE).call(this,c(this,Gc).rect),c(this,df)?.popup.resetEdited(),T(this,Gc,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof Oh||(s.tabIndex=Uv);const{style:a}=s;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof sE){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,s),s}const{width:o,height:l}=Ru(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,w=t.borderStyle.verticalCornerRadius;if(_>0||w>0){const y=`calc(${_}px * var(--scale-factor)) / calc(${w}px * var(--scale-factor))`;a.borderRadius=y}else if(this instanceof SI){const y=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=y}switch(t.borderStyle.style){case Dp.SOLID:a.borderStyle="solid";break;case Dp.DASHED:a.borderStyle="dashed";break;case Dp.BEVELED:Tt("Unimplemented border style: beveled");break;case Dp.INSET:Tt("Unimplemented border style: inset");break;case Dp.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(T(this,hf,!0),a.borderColor=dt.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=dt.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:m}=r.rawDims;a.left=`${100*(u[0]-f)/h}%`,a.top=`${100*(u[1]-m)/d}%`;const{rotation:b}=t;return t.hasOwnCanvas||b===0?(a.width=`${100*o/h}%`,a.height=`${100*l/d}%`):this.setRotation(b,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims,{width:s,height:a}=Ru(this.data.rect);let o,l;e%180===0?(o=100*s/i,l=100*a/r):(o=100*a/i,l=100*s/r),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,r)=>{const s=r.detail[t],a=s[0],o=s.slice(1);r.target.style[i]=Bk[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[i]:Bk[`${a}_rgb`](o)})};return Ft(this,"_commonActions",{display:t=>{const{display:i}=t.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const r of Object.keys(t.detail))(e[r]||i[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[r,s]of Object.entries(t)){const a=i[r];if(a){const o={detail:{[r]:s},target:e};a(o),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,r,s]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,w,v,y]=e.subarray(2,6);if(r===_&&s===w&&t===v&&i===y)return}const{style:a}=this.container;let o;if(c(this,hf)){const{borderColor:_,borderWidth:w}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const l=r-t,u=s-i,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const m=h.createElement("clipPath"),b=`clippath_${this.data.id}`;m.setAttribute("id",b),m.setAttribute("clipPathUnits","objectBoundingBox"),f.append(m);for(let _=2,w=e.length;_<w;_+=8){const v=e[_],y=e[_+1],E=e[_+2],k=e[_+3],S=h.createElement("rect"),D=(E-t)/l,P=(s-y)/u,F=(v-E)/l,H=(y-k)/u;S.setAttribute("x",D),S.setAttribute("y",P),S.setAttribute("width",F),S.setAttribute("height",H),m.append(S),o?.push(`<rect vector-effect="non-scaling-stroke" x="${D}" y="${P}" width="${F}" height="${H}"/>`)}c(this,hf)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{data:e}=this,t=T(this,df,new sE({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){pn("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:s,id:a,exportValues:o}of r){if(s===-1||a===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!Rh.has(u)){Tt(`_getElementsByName - element not allowed: ${a}`);continue}i.push({id:a,exportValue:l,domElement:u})}return i}for(const r of document.getElementsByName(e)){const{exportValue:s}=r,a=r.getAttribute("data-element-id");a!==t&&Rh.has(r)&&i.push({id:a,exportValue:s,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Gc=new WeakMap,hf=new WeakMap,df=new WeakMap,Hg=new WeakSet,rE=function(e){const{container:{style:t},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}}}=this;i?.splice(0,4,...e);const{width:u,height:h}=Ru(e);t.left=`${100*(e[0]-o)/s}%`,t.top=`${100*(a-e[3]+l)/a}%`,r===0?(t.width=`${100*u/s}%`,t.height=`${100*h/a}%`):this.setRotation(r)};let Jn=Ox;var vs,Qu,AI,xI;class EI extends Jn{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!i?.ignoreBorder,createQuadrilaterals:!0});N(this,vs);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let s=!1;return t.url?(i.addLinkAttributes(r,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(r,t.action),s=!0):t.attachment?(I(this,vs,AI).call(this,r,t.attachment,t.attachmentDest),s=!0):t.setOCGState?(I(this,vs,xI).call(this,r,t.setOCGState),s=!0):t.dest?(this._bindLink(r,t.dest),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),s=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(r,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(r),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&I(this,vs,Qu).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),I(this,vs,Qu).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(i.actions)){const a=r.get(s);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:s}}),!1))}t.onclick||(t.onclick=()=>!1),I(this,vs,Qu).call(this)}_bindResetFormAction(t,i){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),I(this,vs,Qu).call(this),!this._fieldObjects){Tt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{r?.();const{fields:s,refs:a,include:o}=i,l=[];if(s.length!==0||a.length!==0){const d=new Set(a);for(const f of s){const m=this._fieldObjects[f]||[];for(const{id:b}of m)d.add(b)}for(const f of Object.values(this._fieldObjects))for(const m of f)d.has(m.id)===o&&l.push(m)}else for(const d of Object.values(this._fieldObjects))l.push(...d);const u=this.annotationStorage,h=[];for(const d of l){const{id:f}=d;switch(h.push(f),d.type){case"text":{const b=d.defaultValue||"";u.setValue(f,{value:b});break}case"checkbox":case"radiobutton":{const b=d.defaultValue===d.exportValues;u.setValue(f,{value:b});break}case"combobox":case"listbox":{const b=d.defaultValue||"";u.setValue(f,{value:b});break}default:continue}const m=document.querySelector(`[data-element-id="${f}"]`);if(m){if(!Rh.has(m)){Tt(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}}),!1}}}vs=new WeakSet,Qu=function(){this.container.setAttribute("data-internal-link","")},AI=function(t,i,r=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(i.content,i.filename,r),!1),I(this,vs,Qu).call(this)},xI=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),I(this,vs,Qu).call(this)};class lU extends Jn{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Oh extends Jn{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Tr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,r,s){i.includes("mouse")?e.addEventListener(i,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(i,a=>{if(i==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:s(a)}})})}_setEventListeners(e,t,i,r){for(const[s,a]of i)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,s,a,r),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":dt.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||aU,s=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(Q1*r))||1,d=u/h;a=Math.min(r,l(d/Q1))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(r,l(u/Q1))}s.fontSize=`calc(${a}px * var(--scale-factor))`,s.color=dt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class uU extends Oh{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,r){const s=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=i),s.setValue(a.id,{[r]:i})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=e.getValue(t,{value:this.data.fieldValue});let s=r.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&s.length>a&&(s=s.slice(0,a));let o=r.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const l={userValue:s,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=o??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",o??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Rh.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Uv,this._setRequired(i,this.data.required),a&&(i.maxLength=a),i.addEventListener("input",h=>{e.setValue(t,{value:h.target.value}),this.setPropertyOnSiblings(i,"value",h.target.value,"value"),l.formattedValue=null}),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue??"";i.value=l.userValue=d,l.formattedValue=null});let u=h=>{const{formattedValue:d}=l;d!=null&&(h.target.value=d),h.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",d=>{if(l.focused)return;const{target:f}=d;l.userValue&&(f.value=l.userValue),l.lastCommittedValue=f.value,l.commitKey=1,this.data.actions?.Focus||(l.focused=!0)}),i.addEventListener("updatefromsandbox",d=>{this.showElementAndHideCanvas(d.target);const f={value(m){l.userValue=m.detail.value??"",e.setValue(t,{value:l.userValue.toString()}),m.target.value=l.userValue},formattedValue(m){const{formattedValue:b}=m.detail;l.formattedValue=b,b!=null&&m.target!==document.activeElement&&(m.target.value=b),e.setValue(t,{formattedValue:b})},selRange(m){m.target.setSelectionRange(...m.detail.selRange)},charLimit:m=>{const{charLimit:b}=m.detail,{target:_}=m;if(b===0){_.removeAttribute("maxLength");return}_.setAttribute("maxLength",b);let w=l.userValue;!w||w.length<=b||(w=w.slice(0,b),_.value=l.userValue=w,e.setValue(t,{value:w}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:_.selectionStart,selEnd:_.selectionEnd}}))}};this._dispatchEventFromSandbox(f,d)}),i.addEventListener("keydown",d=>{l.commitKey=1;let f=-1;if(d.key==="Escape"?f=0:d.key==="Enter"&&!this.data.multiLine?f=2:d.key==="Tab"&&(l.commitKey=3),f===-1)return;const{value:m}=d.target;l.lastCommittedValue!==m&&(l.lastCommittedValue=m,l.userValue=m,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:f,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}))});const h=u;u=null,i.addEventListener("blur",d=>{if(!l.focused||!d.relatedTarget)return;this.data.actions?.Blur||(l.focused=!1);const{value:f}=d.target;l.userValue=f,l.lastCommittedValue!==f&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:f,willCommit:!0,commitKey:l.commitKey,selStart:d.target.selectionStart,selEnd:d.target.selectionEnd}}),h(d)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",d=>{l.lastCommittedValue=null;const{data:f,target:m}=d,{value:b,selectionStart:_,selectionEnd:w}=m;let v=_,y=w;switch(d.inputType){case"deleteWordBackward":{const E=b.substring(0,_).match(/\w*[^\w]*$/);E&&(v-=E[0].length);break}case"deleteWordForward":{const E=b.substring(_).match(/^[^\w]*\w*/);E&&(y+=E[0].length);break}case"deleteContentBackward":_===w&&(v-=1);break;case"deleteContentForward":_===w&&(y+=1);break}d.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,change:f||"",willCommit:!1,selStart:v,selEnd:y}})}),this._setEventListeners(i,l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],d=>d.target.value)}if(u&&i.addEventListener("blur",u),this.data.comb){const d=(this.data.rect[2]-this.data.rect[0])/a;i.classList.add("comb"),i.style.letterSpacing=`calc(${d}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class cU extends Oh{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class hU extends Oh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Rh.add(s),s.setAttribute("data-element-id",i),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=Uv,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,i)){const h=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class SI extends Oh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let r=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(i,{value:r})),r)for(const a of this._getElementsByName(t.fieldName,i))e.setValue(a.id,{value:!1});const s=document.createElement("input");if(Rh.add(s),s.setAttribute("data-element-id",i),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,r&&s.setAttribute("checked",!0),s.tabIndex=Uv,s.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,i))e.setValue(u.id,{value:!1});e.setValue(i,{value:l})}),s.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;s.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const h=a===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===i;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class dU extends EI{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class fU extends Oh{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");Rh.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=Uv;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of r.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,i.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),s=!1),r.append(d)}let a=null;if(s){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),r.prepend(h),a=()=>{h.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:f,multiple:m}=r;return m?Array.prototype.filter.call(f,b=>b.selected).map(b=>b[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let l=o(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",h=>{const d={value(f){a?.();const m=f.detail.value,b=new Set(Array.isArray(m)?m:[m]);for(const _ of r.options)_.selected=b.has(_.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(f){r.multiple=!0},remove(f){const m=r.options,b=f.detail.remove;m[b].selected=!1,r.remove(b),m.length>0&&Array.prototype.findIndex.call(m,w=>w.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},clear(f){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(f){const{index:m,displayValue:b,exportValue:_}=f.detail.insert,w=r.children[m],v=document.createElement("option");v.textContent=b,v.value=_,w?w.before(v):r.append(v),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},items(f){const{items:m}=f.detail;for(;r.length!==0;)r.remove(0);for(const b of m){const{displayValue:_,exportValue:w}=b,v=document.createElement("option");v.textContent=_,v.value=w,r.append(v)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),l=o(!1)},indices(f){const m=new Set(f.detail.indices);for(const b of f.target.options)b.selected=m.has(b.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),r.addEventListener("input",h=>{const d=o(!0),f=o(!1);e.setValue(t,{value:d}),h.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):r.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class sE extends Jn{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:Jn._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new pU({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${gx}${i}`).join(",")),this.container}}var ff,$b,Hb,pf,Kc,$n,Uo,mf,qg,Wg,gf,$o,ua,Ho,Vg,qo,Gg,Xc,Yc,hn,f0,aE,CI,kI,TI,DI,p0,m0,oE;class pU{constructor({container:e,color:t,elements:i,titleObj:r,modificationDate:s,contentsObj:a,richText:o,parent:l,rect:u,parentRect:h,open:d}){N(this,hn);N(this,ff,I(this,hn,TI).bind(this));N(this,$b,I(this,hn,oE).bind(this));N(this,Hb,I(this,hn,m0).bind(this));N(this,pf,I(this,hn,p0).bind(this));N(this,Kc,null);N(this,$n,null);N(this,Uo,null);N(this,mf,null);N(this,qg,null);N(this,Wg,null);N(this,gf,null);N(this,$o,!1);N(this,ua,null);N(this,Ho,null);N(this,Vg,null);N(this,qo,null);N(this,Gg,null);N(this,Xc,null);N(this,Yc,!1);T(this,$n,e),T(this,Gg,r),T(this,Uo,a),T(this,qo,o),T(this,Wg,l),T(this,Kc,t),T(this,Vg,u),T(this,gf,h),T(this,qg,i),T(this,mf,bx.toDateObject(s)),this.trigger=i.flatMap(f=>f.getElementsToTriggerPopup());for(const f of this.trigger)f.addEventListener("click",c(this,pf)),f.addEventListener("mouseenter",c(this,Hb)),f.addEventListener("mouseleave",c(this,$b)),f.classList.add("popupTriggerArea");for(const f of i)f.container?.addEventListener("keydown",c(this,ff));c(this,$n).hidden=!0,d&&I(this,hn,p0).call(this)}render(){if(c(this,ua))return;const e=T(this,ua,document.createElement("div"));if(e.className="popup",c(this,Kc)){const s=e.style.outlineColor=dt.makeHexColor(...c(this,Kc));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:e.style.backgroundColor=dt.makeHexColor(...c(this,Kc).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=c(this,Gg),e.append(t),c(this,mf)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,mf).valueOf()})),t.append(s)}const r=c(this,hn,f0);if(r)_I.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(c(this,Uo));e.append(s)}c(this,$n).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let s=0,a=r.length;s<a;++s){const o=r[s];i.append(document.createTextNode(o)),s<a-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){c(this,Xc)||T(this,Xc,{contentsObj:c(this,Uo),richText:c(this,qo)}),e&&T(this,Ho,null),t&&(T(this,qo,I(this,hn,kI).call(this,t)),T(this,Uo,null)),c(this,ua)?.remove(),T(this,ua,null)}resetEdited(){c(this,Xc)&&({contentsObj:_i(this,Uo)._,richText:_i(this,qo)._}=c(this,Xc),T(this,Xc,null),c(this,ua)?.remove(),T(this,ua,null),T(this,Ho,null))}forceHide(){T(this,Yc,this.isVisible),c(this,Yc)&&(c(this,$n).hidden=!0)}maybeShow(){c(this,Yc)&&(c(this,ua)||I(this,hn,m0).call(this),T(this,Yc,!1),c(this,$n).hidden=!1)}get isVisible(){return c(this,$n).hidden===!1}}ff=new WeakMap,$b=new WeakMap,Hb=new WeakMap,pf=new WeakMap,Kc=new WeakMap,$n=new WeakMap,Uo=new WeakMap,mf=new WeakMap,qg=new WeakMap,Wg=new WeakMap,gf=new WeakMap,$o=new WeakMap,ua=new WeakMap,Ho=new WeakMap,Vg=new WeakMap,qo=new WeakMap,Gg=new WeakMap,Xc=new WeakMap,Yc=new WeakMap,hn=new WeakSet,f0=function(){const e=c(this,qo),t=c(this,Uo);return e?.str&&(!t?.str||t.str===e.str)&&c(this,qo).html||null},aE=function(){return c(this,hn,f0)?.attributes?.style?.fontSize||0},CI=function(){return c(this,hn,f0)?.attributes?.style?.color||null},kI=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:c(this,hn,CI),fontSize:c(this,hn,aE)?`calc(${c(this,hn,aE)}px * var(--scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:r});return i},TI=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,$o))&&I(this,hn,p0).call(this)},DI=function(){if(c(this,Ho)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:r,pageY:s}}}=c(this,Wg);let a=!!c(this,gf),o=a?c(this,gf):c(this,Vg);for(const b of c(this,qg))if(!o||dt.intersect(b.data.rect,o)!==null){o=b.data.rect,a=!0;break}const l=dt.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=l[0]+h,f=l[1];T(this,Ho,[100*(d-r)/t,100*(f-s)/i]);const{style:m}=c(this,$n);m.left=`${c(this,Ho)[0]}%`,m.top=`${c(this,Ho)[1]}%`},p0=function(){T(this,$o,!c(this,$o)),c(this,$o)?(I(this,hn,m0).call(this),c(this,$n).addEventListener("click",c(this,pf)),c(this,$n).addEventListener("keydown",c(this,ff))):(I(this,hn,oE).call(this),c(this,$n).removeEventListener("click",c(this,pf)),c(this,$n).removeEventListener("keydown",c(this,ff)))},m0=function(){c(this,ua)||this.render(),this.isVisible?c(this,$o)&&c(this,$n).classList.add("focused"):(I(this,hn,DI).call(this),c(this,$n).hidden=!1,c(this,$n).style.zIndex=parseInt(c(this,$n).style.zIndex)+1e3)},oE=function(){c(this,$n).classList.remove("focused"),!(c(this,$o)||!this.isVisible)&&(c(this,$n).hidden=!0,c(this,$n).style.zIndex=parseInt(c(this,$n).style.zIndex)-1e3)};class RI extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Ct.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Kg;class mU extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,Kg,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:i,height:r}=Ru(t.rect),s=this.svgFactory.create(i,r,!0),a=T(this,Kg,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Kg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kg=new WeakMap;var Xg;class gU extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,Xg,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:i,height:r}=Ru(t.rect),s=this.svgFactory.create(i,r,!0),a=t.borderStyle.width,o=T(this,Xg,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",i-a),o.setAttribute("height",r-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Xg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xg=new WeakMap;var Yg;class vU extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,Yg,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:i,height:r}=Ru(t.rect),s=this.svgFactory.create(i,r,!0),a=t.borderStyle.width,o=T(this,Yg,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",i/2),o.setAttribute("cy",r/2),o.setAttribute("rx",i/2-a/2),o.setAttribute("ry",r/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Yg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yg=new WeakMap;var Qg;class PI extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,Qg,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:r,popupRef:s}}=this;if(!i)return this.container;const{width:a,height:o}=Ru(t),l=this.svgFactory.create(a,o,!0);let u=[];for(let d=0,f=i.length;d<f;d+=2){const m=i[d]-t[0],b=t[3]-i[d+1];u.push(`${m},${b}`)}u=u.join(" ");const h=T(this,Qg,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",r.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Qg)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qg=new WeakMap;class yU extends PI{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class bU extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Zg,Qc,Jg,lE;class xx extends Jn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});N(this,Jg);N(this,Zg,null);N(this,Qc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Ct.HIGHLIGHT:Ct.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:r,borderStyle:s,popupRef:a}}=this,{transform:o,width:l,height:u}=I(this,Jg,lE).call(this,i,t),h=this.svgFactory.create(l,u,!0),d=T(this,Zg,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",s.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let f=0,m=r.length;f<m;f++){const b=this.svgFactory.createElement(this.svgElementName);c(this,Qc).push(b),b.setAttribute("points",r[f].join(",")),d.append(b)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:r,rect:s}=t,a=c(this,Zg);if(i>=0&&a.setAttribute("stroke-width",i||1),r)for(let o=0,l=c(this,Qc).length;o<l;o++)c(this,Qc)[o].setAttribute("points",r[o].join(","));if(s){const{transform:o,width:l,height:u}=I(this,Jg,lE).call(this,this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return c(this,Qc)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zg=new WeakMap,Qc=new WeakMap,Jg=new WeakSet,lE=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class NI extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Ct.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class wU extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class _U extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class EU extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class II extends Jn{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Ct.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ev,tv,uE;class AU extends Jn{constructor(t){super(t,{isRenderable:!0});N(this,tv);N(this,ev,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let r;i.hasAppearance||i.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),r.addEventListener("dblclick",I(this,tv,uE).bind(this)),T(this,ev,r);const{isMac:s}=Tr.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&I(this,tv,uE).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return c(this,ev)}addHighlightArea(){this.container.classList.add("highlightArea")}}ev=new WeakMap,tv=new WeakSet,uE=function(){this.downloadManager?.openOrDownloadData(this.content,this.filename)};var nv,Zc,Jc,iv,Ph,LI,cE;class xU{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:r,page:s,viewport:a,structTreeLayer:o}){N(this,Ph);N(this,nv,null);N(this,Zc,null);N(this,Jc,new Map);N(this,iv,null);this.div=e,T(this,nv,t),T(this,Zc,i),T(this,iv,o||null),this.page=s,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return c(this,Jc).size>0}async render(e){const{annotations:t}=e,i=this.div;Th(i,this.viewport);const r=new Map,s={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Ax,annotationStorage:e.annotationStorage||new _x,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const o=a.annotationType===ui.POPUP;if(o){const h=r.get(a.id);if(!h)continue;s.elements=h}else{const{width:h,height:d}=Ru(a.rect);if(h<=0||d<=0)continue}s.data=a;const l=oU.create(s);if(!l.isRenderable)continue;if(!o&&a.popupRef){const h=r.get(a.popupRef);h?h.push(l):r.set(a.popupRef,[l])}const u=l.render();a.hidden&&(u.style.visibility="hidden"),await I(this,Ph,LI).call(this,u,a.id),l._isEditable&&(c(this,Jc).set(l.data.id,l),this._annotationEditorUIManager?.renderAnnotationElement(l))}I(this,Ph,cE).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,Th(t,{rotation:e.rotation}),I(this,Ph,cE).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,Jc).values())}getEditableAnnotation(e){return c(this,Jc).get(e)}}nv=new WeakMap,Zc=new WeakMap,Jc=new WeakMap,iv=new WeakMap,Ph=new WeakSet,LI=async function(e,t){const i=e.firstChild||e,r=i.id=`${gx}${t}`,s=await c(this,iv)?.getAriaAttributes(r);if(s)for(const[a,o]of s)i.setAttribute(a,o);this.div.append(e),c(this,nv)?.moveElementInDOM(this.div,e,i,!1)},cE=function(){if(!c(this,Zc))return;const e=this.div;for(const[t,i]of c(this,Zc)){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:s}=r;s?s.nodeName==="CANVAS"?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):r.append(i)}c(this,Zc).clear()};const Dy=/\r\n?|\n/g;var ca,os,rv,eh,ls,si,OI,MI,FI,g0,ol,v0,y0,BI,dE,jI;const mn=class mn extends Fn{constructor(t){super({...t,name:"freeTextEditor"});N(this,si);N(this,ca);N(this,os,"");N(this,rv,`${this.id}-editor`);N(this,eh,null);N(this,ls);T(this,ca,t.color||mn._defaultColor||Fn._defaultLineColor),T(this,ls,t.fontSize||mn._defaultFontSize)}static get _keyboardManager(){const t=mn.prototype,i=a=>a.isEmpty(),r=Dh.TRANSLATE_SMALL,s=Dh.TRANSLATE_BIG;return Ft(this,"_keyboardManager",new zv([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}]]))}static initialize(t,i){Fn.initialize(t,i);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case $t.FREETEXT_SIZE:mn._defaultFontSize=i;break;case $t.FREETEXT_COLOR:mn._defaultColor=i;break}}updateParams(t,i){switch(t){case $t.FREETEXT_SIZE:I(this,si,OI).call(this,i);break;case $t.FREETEXT_COLOR:I(this,si,MI).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[$t.FREETEXT_SIZE,mn._defaultFontSize],[$t.FREETEXT_COLOR,mn._defaultColor||Fn._defaultLineColor]]}get propertiesToUpdate(){return[[$t.FREETEXT_SIZE,c(this,ls)],[$t.FREETEXT_COLOR,c(this,ca)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-mn._internalPadding*t,-(mn._internalPadding+c(this,ls))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Ct.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),T(this,eh,new AbortController);const t=this._uiManager.combinedSignal(c(this,eh));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,rv)),this._isDraggable=!0,c(this,eh)?.abort(),T(this,eh,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,os),i=T(this,os,I(this,si,FI).call(this).trimEnd());if(t===i)return;const r=s=>{if(T(this,os,s),!s){this.remove();return}I(this,si,y0).call(this),this._uiManager.rebuild(this),I(this,si,g0).call(this)};this.addCommands({cmd:()=>{r(i)},undo:()=>{r(t)},mustExec:!1}),I(this,si,g0).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){mn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,rv)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${c(this,ls)}px * var(--scale-factor))`,r.color=c(this,ca),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),bb(this,this.div,["dblclick","keydown"]),this.width){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,d]=this.pageDimensions,[f,m]=this.pageTranslation;let b,_;switch(this.rotation){case 0:b=t+(o[0]-f)/h,_=i+this.height-(o[1]-m)/d;break;case 90:b=t+(o[0]-f)/h,_=i-(o[1]-m)/d,[l,u]=[u,-l];break;case 180:b=t-this.width+(o[0]-f)/h,_=i-(o[1]-m)/d,[l,u]=[-l,-u];break;case 270:b=t+(o[0]-f-this.height*d)/h,_=i+(o[1]-m-this.width*h)/d,[l,u]=[-u,l];break}this.setAt(b*s,_*a,l,u)}else this.setAt(t*s,i*a,this.width*s,this.height*a);I(this,si,y0).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var b,_,w;const i=t.clipboardData||window.clipboardData,{types:r}=i;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const s=I(b=mn,ol,dE).call(b,i.getData("text")||"").replaceAll(Dy,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,h=[],d=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(d.push(l.nodeValue.slice(u).replaceAll(Dy,"")),v!==this.editorDiv){let y=h;for(const E of this.editorDiv.childNodes){if(E===v){y=d;continue}y.push(I(_=mn,ol,v0).call(_,E))}}h.push(l.nodeValue.slice(0,u).replaceAll(Dy,""))}else if(l===this.editorDiv){let v=h,y=0;for(const E of this.editorDiv.childNodes)y++===u&&(v=d),v.push(I(w=mn,ol,v0).call(w,E))}T(this,os,`${h.join(`
`)}${s}${d.join(`
`)}`),I(this,si,y0).call(this);const f=new Range;let m=h.reduce((v,y)=>v+y.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const y=v.nodeValue.length;if(m<=y){f.setStart(v,m),f.setEnd(v,m);break}m-=y}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,r){var o;let s=null;if(t instanceof RI){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:d,id:f,popupRef:m},textContent:b,textPosition:_,parent:{page:{pageNumber:w}}}=t;if(!b||b.length===0)return null;s=t={annotationType:Ct.FREETEXT,color:Array.from(u),fontSize:l,value:b.join(`
`),position:_,pageIndex:w-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:m}}const a=await super.deserialize(t,i,r);return T(a,ls,t.fontSize),T(a,ca,dt.makeHexColor(...t.color)),T(a,os,I(o=mn,ol,dE).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=s,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=mn._internalPadding*this.parentScale,r=this.getRect(i,i),s=Fn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:c(this,ca)),a={annotationType:Ct.FREETEXT,color:s,fontSize:c(this,ls),value:I(this,si,BI).call(this),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!I(this,si,jI).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:r}=i;r.fontSize=`calc(${c(this,ls)}px * var(--scale-factor))`,r.color=c(this,ca),i.replaceChildren();for(const a of c(this,os).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),i.append(o)}const s=mn._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(s,s),popupContent:c(this,os)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ca=new WeakMap,os=new WeakMap,rv=new WeakMap,eh=new WeakMap,ls=new WeakMap,si=new WeakSet,OI=function(t){const i=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-c(this,ls))*this.parentScale),T(this,ls,s),I(this,si,g0).call(this)},r=c(this,ls);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},MI=function(t){const i=s=>{T(this,ca,this.editorDiv.style.color=s)},r=c(this,ca);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},FI=function(){var r;const t=[];this.editorDiv.normalize();let i=null;for(const s of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(I(r=mn,ol,v0).call(r,s)),i=s);return t.join(`
`)},g0=function(){const[t,i]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),r=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/i):(this.width=r.height/t,this.height=r.width/i),this.fixAndSetPosition()},ol=new WeakSet,v0=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Dy,"")},y0=function(){if(this.editorDiv.replaceChildren(),!!c(this,os))for(const t of c(this,os).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},BI=function(){return c(this,os).replaceAll(" "," ")},dE=function(t){return t.replaceAll(" "," ")},jI=function(t){const{value:i,fontSize:r,color:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==r||t.color.some((o,l)=>o!==s[l])||t.pageIndex!==a},N(mn,ol),Ae(mn,"_freeTextDefaultContent",""),Ae(mn,"_internalPadding",0),Ae(mn,"_defaultColor",null),Ae(mn,"_defaultFontSize",10),Ae(mn,"_type","freetext"),Ae(mn,"_editorType",Ct.FREETEXT);let hE=mn;class at{toSVGPath(){pn("Abstract method `toSVGPath` must be implemented.")}get box(){pn("Abstract getter `box` must be implemented.")}serialize(e,t){pn("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,r,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*r,a[o+1]=i+e[o+1]*s;return a}static _rescaleAndSwap(e,t,i,r,s,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*r,a[o+1]=i+e[o]*s;return a}static _translate(e,t,i,r){r||(r=new Float32Array(e.length));for(let s=0,a=e.length;s<a;s+=2)r[s]=t+e[s],r[s+1]=i+e[s+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,r,s){switch(s){case 90:return[1-t/i,e/r];case 180:return[1-e/i,1-t/r];case 270:return[t/i,1-e/r];default:return[e/i,t/r]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,r,s,a){return[(e+5*i)/6,(t+5*r)/6,(5*i+s)/6,(5*r+a)/6,(i+s)/2,(r+a)/2]}}Ae(at,"PRECISION",1e-4);var us,ha,vf,yf,Za,Mt,th,nh,sv,av,bf,wf,ou,ov,qb,Wb,gi,Xp,zI,UI,$I,HI,qI,WI;const xo=class xo{constructor({x:e,y:t},i,r,s,a,o=0){N(this,gi);N(this,us);N(this,ha,[]);N(this,vf);N(this,yf);N(this,Za,[]);N(this,Mt,new Float32Array(18));N(this,th);N(this,nh);N(this,sv);N(this,av);N(this,bf);N(this,wf);N(this,ou,[]);T(this,us,i),T(this,wf,s*r),T(this,yf,a),c(this,Mt).set([NaN,NaN,NaN,NaN,e,t],6),T(this,vf,o),T(this,av,c(xo,ov)*r),T(this,sv,c(xo,Wb)*r),T(this,bf,r),c(this,ou).push(e,t)}isEmpty(){return isNaN(c(this,Mt)[8])}add({x:e,y:t}){T(this,th,e),T(this,nh,t);const[i,r,s,a]=c(this,us);let[o,l,u,h]=c(this,Mt).subarray(8,12);const d=e-u,f=t-h,m=Math.hypot(d,f);if(m<c(this,sv))return!1;const b=m-c(this,av),_=b/m,w=_*d,v=_*f;let y=o,E=l;o=u,l=h,u+=w,h+=v,c(this,ou)?.push(e,t);const k=-v/b,S=w/b,D=k*c(this,wf),P=S*c(this,wf);return c(this,Mt).set(c(this,Mt).subarray(2,8),0),c(this,Mt).set([u+D,h+P],4),c(this,Mt).set(c(this,Mt).subarray(14,18),12),c(this,Mt).set([u-D,h-P],16),isNaN(c(this,Mt)[6])?(c(this,Za).length===0&&(c(this,Mt).set([o+D,l+P],2),c(this,Za).push(NaN,NaN,NaN,NaN,(o+D-i)/s,(l+P-r)/a),c(this,Mt).set([o-D,l-P],14),c(this,ha).push(NaN,NaN,NaN,NaN,(o-D-i)/s,(l-P-r)/a)),c(this,Mt).set([y,E,o,l,u,h],6),!this.isEmpty()):(c(this,Mt).set([y,E,o,l,u,h],6),Math.abs(Math.atan2(E-l,y-o)-Math.atan2(v,w))<Math.PI/2?([o,l,u,h]=c(this,Mt).subarray(2,6),c(this,Za).push(NaN,NaN,NaN,NaN,((o+u)/2-i)/s,((l+h)/2-r)/a),[o,l,y,E]=c(this,Mt).subarray(14,18),c(this,ha).push(NaN,NaN,NaN,NaN,((y+o)/2-i)/s,((E+l)/2-r)/a),!0):([y,E,o,l,u,h]=c(this,Mt).subarray(0,6),c(this,Za).push(((y+5*o)/6-i)/s,((E+5*l)/6-r)/a,((5*o+u)/6-i)/s,((5*l+h)/6-r)/a,((o+u)/2-i)/s,((l+h)/2-r)/a),[u,h,o,l,y,E]=c(this,Mt).subarray(12,18),c(this,ha).push(((y+5*o)/6-i)/s,((E+5*l)/6-r)/a,((5*o+u)/6-i)/s,((5*l+h)/6-r)/a,((o+u)/2-i)/s,((l+h)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,Za),t=c(this,ha);if(isNaN(c(this,Mt)[6])&&!this.isEmpty())return I(this,gi,zI).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);I(this,gi,$I).call(this,i);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return I(this,gi,UI).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,r,s,a){return new VI(e,t,i,r,s,a)}getOutlines(){const e=c(this,Za),t=c(this,ha),i=c(this,Mt),[r,s,a,o]=c(this,us),l=new Float32Array((c(this,ou)?.length??0)+2);for(let d=0,f=l.length-2;d<f;d+=2)l[d]=(c(this,ou)[d]-r)/a,l[d+1]=(c(this,ou)[d+1]-s)/o;if(l[l.length-2]=(c(this,th)-r)/a,l[l.length-1]=(c(this,nh)-s)/o,isNaN(i[6])&&!this.isEmpty())return I(this,gi,HI).call(this,l);const u=new Float32Array(c(this,Za).length+24+c(this,ha).length);let h=e.length;for(let d=0;d<h;d+=2){if(isNaN(e[d])){u[d]=u[d+1]=NaN;continue}u[d]=e[d],u[d+1]=e[d+1]}h=I(this,gi,WI).call(this,u,h);for(let d=t.length-6;d>=6;d-=6)for(let f=0;f<6;f+=2){if(isNaN(t[d+f])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[d+f],u[h+1]=t[d+f+1],h+=2}return I(this,gi,qI).call(this,u,h),this.newFreeDrawOutline(u,l,c(this,us),c(this,bf),c(this,vf),c(this,yf))}};us=new WeakMap,ha=new WeakMap,vf=new WeakMap,yf=new WeakMap,Za=new WeakMap,Mt=new WeakMap,th=new WeakMap,nh=new WeakMap,sv=new WeakMap,av=new WeakMap,bf=new WeakMap,wf=new WeakMap,ou=new WeakMap,ov=new WeakMap,qb=new WeakMap,Wb=new WeakMap,gi=new WeakSet,Xp=function(){const e=c(this,Mt).subarray(4,6),t=c(this,Mt).subarray(16,18),[i,r,s,a]=c(this,us);return[(c(this,th)+(e[0]-t[0])/2-i)/s,(c(this,nh)+(e[1]-t[1])/2-r)/a,(c(this,th)+(t[0]-e[0])/2-i)/s,(c(this,nh)+(t[1]-e[1])/2-r)/a]},zI=function(){const[e,t,i,r]=c(this,us),[s,a,o,l]=I(this,gi,Xp).call(this);return`M${(c(this,Mt)[2]-e)/i} ${(c(this,Mt)[3]-t)/r} L${(c(this,Mt)[4]-e)/i} ${(c(this,Mt)[5]-t)/r} L${s} ${a} L${o} ${l} L${(c(this,Mt)[16]-e)/i} ${(c(this,Mt)[17]-t)/r} L${(c(this,Mt)[14]-e)/i} ${(c(this,Mt)[15]-t)/r} Z`},UI=function(e){const t=c(this,ha);e.push(`L${t[4]} ${t[5]} Z`)},$I=function(e){const[t,i,r,s]=c(this,us),a=c(this,Mt).subarray(4,6),o=c(this,Mt).subarray(16,18),[l,u,h,d]=I(this,gi,Xp).call(this);e.push(`L${(a[0]-t)/r} ${(a[1]-i)/s} L${l} ${u} L${h} ${d} L${(o[0]-t)/r} ${(o[1]-i)/s}`)},HI=function(e){const t=c(this,Mt),[i,r,s,a]=c(this,us),[o,l,u,h]=I(this,gi,Xp).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-i)/s,(t[3]-r)/a,NaN,NaN,NaN,NaN,(t[4]-i)/s,(t[5]-r)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-i)/s,(t[17]-r)/a,NaN,NaN,NaN,NaN,(t[14]-i)/s,(t[15]-r)/a],0),this.newFreeDrawOutline(d,e,c(this,us),c(this,bf),c(this,vf),c(this,yf))},qI=function(e,t){const i=c(this,ha);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},WI=function(e,t){const i=c(this,Mt).subarray(4,6),r=c(this,Mt).subarray(16,18),[s,a,o,l]=c(this,us),[u,h,d,f]=I(this,gi,Xp).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-s)/o,(i[1]-a)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(r[0]-s)/o,(r[1]-a)/l],t),t+=24},N(xo,ov,8),N(xo,qb,2),N(xo,Wb,c(xo,ov)+c(xo,qb));let Eb=xo;var _f,ih,Wo,lv,cs,uv,Kn,Vb,GI;class VI extends at{constructor(t,i,r,s,a,o){super();N(this,Vb);N(this,_f);N(this,ih,new Float32Array(4));N(this,Wo);N(this,lv);N(this,cs);N(this,uv);N(this,Kn);T(this,Kn,t),T(this,cs,i),T(this,_f,r),T(this,uv,s),T(this,Wo,a),T(this,lv,o),this.lastPoint=[NaN,NaN],I(this,Vb,GI).call(this,o);const[l,u,h,d]=c(this,ih);for(let f=0,m=t.length;f<m;f+=2)t[f]=(t[f]-l)/h,t[f+1]=(t[f+1]-u)/d;for(let f=0,m=i.length;f<m;f+=2)i[f]=(i[f]-l)/h,i[f+1]=(i[f+1]-u)/d}toSVGPath(){const t=[`M${c(this,Kn)[4]} ${c(this,Kn)[5]}`];for(let i=6,r=c(this,Kn).length;i<r;i+=6){if(isNaN(c(this,Kn)[i])){t.push(`L${c(this,Kn)[i+4]} ${c(this,Kn)[i+5]}`);continue}t.push(`C${c(this,Kn)[i]} ${c(this,Kn)[i+1]} ${c(this,Kn)[i+2]} ${c(this,Kn)[i+3]} ${c(this,Kn)[i+4]} ${c(this,Kn)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,r,s],a){const o=r-t,l=s-i;let u,h;switch(a){case 0:u=at._rescale(c(this,Kn),t,s,o,-l),h=at._rescale(c(this,cs),t,s,o,-l);break;case 90:u=at._rescaleAndSwap(c(this,Kn),t,i,o,l),h=at._rescaleAndSwap(c(this,cs),t,i,o,l);break;case 180:u=at._rescale(c(this,Kn),r,i,-o,l),h=at._rescale(c(this,cs),r,i,-o,l);break;case 270:u=at._rescaleAndSwap(c(this,Kn),r,s,-o,-l),h=at._rescaleAndSwap(c(this,cs),r,s,-o,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return c(this,ih)}newOutliner(t,i,r,s,a,o=0){return new Eb(t,i,r,s,a,o)}getNewOutline(t,i){const[r,s,a,o]=c(this,ih),[l,u,h,d]=c(this,_f),f=a*h,m=o*d,b=r*h+l,_=s*d+u,w=this.newOutliner({x:c(this,cs)[0]*f+b,y:c(this,cs)[1]*m+_},c(this,_f),c(this,uv),t,c(this,lv),i??c(this,Wo));for(let v=2;v<c(this,cs).length;v+=2)w.add({x:c(this,cs)[v]*f+b,y:c(this,cs)[v+1]*m+_});return w.getOutlines()}}_f=new WeakMap,ih=new WeakMap,Wo=new WeakMap,lv=new WeakMap,cs=new WeakMap,uv=new WeakMap,Kn=new WeakMap,Vb=new WeakSet,GI=function(t){const i=c(this,Kn);let r=i[4],s=i[5],a=r,o=s,l=r,u=s,h=r,d=s;const f=t?Math.max:Math.min;for(let b=6,_=i.length;b<_;b+=6){if(isNaN(i[b]))a=Math.min(a,i[b+4]),o=Math.min(o,i[b+5]),l=Math.max(l,i[b+4]),u=Math.max(u,i[b+5]),d<i[b+5]?(h=i[b+4],d=i[b+5]):d===i[b+5]&&(h=f(h,i[b+4]));else{const w=dt.bezierBoundingBox(r,s,...i.slice(b,b+6));a=Math.min(a,w[0]),o=Math.min(o,w[1]),l=Math.max(l,w[2]),u=Math.max(u,w[3]),d<w[3]?(h=w[2],d=w[3]):d===w[3]&&(h=f(h,w[2]))}r=i[b+4],s=i[b+5]}const m=c(this,ih);m[0]=a-c(this,Wo),m[1]=o-c(this,Wo),m[2]=l-a+2*c(this,Wo),m[3]=u-o+2*c(this,Wo),this.lastPoint=[h,d]};var cv,hv,lu,da,Rr,KI,b0,XI,YI,pE;class fE{constructor(e,t=0,i=0,r=!0){N(this,Rr);N(this,cv);N(this,hv);N(this,lu,[]);N(this,da,[]);let s=1/0,a=-1/0,o=1/0,l=-1/0;const u=10**-4;for(const{x:w,y:v,width:y,height:E}of e){const k=Math.floor((w-t)/u)*u,S=Math.ceil((w+y+t)/u)*u,D=Math.floor((v-t)/u)*u,P=Math.ceil((v+E+t)/u)*u,F=[k,D,P,!0],H=[S,D,P,!1];c(this,lu).push(F,H),s=Math.min(s,k),a=Math.max(a,S),o=Math.min(o,D),l=Math.max(l,P)}const h=a-s+2*i,d=l-o+2*i,f=s-i,m=o-i,b=c(this,lu).at(r?-1:-2),_=[b[0],b[2]];for(const w of c(this,lu)){const[v,y,E]=w;w[0]=(v-f)/h,w[1]=(y-m)/d,w[2]=(E-m)/d}T(this,cv,new Float32Array([f,m,h,d])),T(this,hv,_)}getOutlines(){c(this,lu).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of c(this,lu))t[3]?(e.push(...I(this,Rr,pE).call(this,t)),I(this,Rr,XI).call(this,t)):(I(this,Rr,YI).call(this,t),e.push(...I(this,Rr,pE).call(this,t)));return I(this,Rr,KI).call(this,e)}}cv=new WeakMap,hv=new WeakMap,lu=new WeakMap,da=new WeakMap,Rr=new WeakSet,KI=function(e){const t=[],i=new Set;for(const a of e){const[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),i.add(l),i.add(u)}const r=[];let s;for(;i.size>0;){const a=i.values().next().value;let[o,l,u,h,d]=a;i.delete(a);let f=o,m=l;for(s=[o,u],r.push(s);;){let b;if(i.has(h))b=h;else if(i.has(d))b=d;else break;i.delete(b),[o,l,u,h,d]=b,f!==o&&(s.push(f,m,o,m===l?l:u),f=o),m=m===l?u:l}s.push(f,m)}return new SU(r,c(this,cv),c(this,hv))},b0=function(e){const t=c(this,da);let i=0,r=t.length-1;for(;i<=r;){const s=i+r>>1,a=t[s][0];if(a===e)return s;a<e?i=s+1:r=s-1}return r+1},XI=function([,e,t]){const i=I(this,Rr,b0).call(this,e);c(this,da).splice(i,0,[e,t])},YI=function([,e,t]){const i=I(this,Rr,b0).call(this,e);for(let r=i;r<c(this,da).length;r++){const[s,a]=c(this,da)[r];if(s!==e)break;if(s===e&&a===t){c(this,da).splice(r,1);return}}for(let r=i-1;r>=0;r--){const[s,a]=c(this,da)[r];if(s!==e)break;if(s===e&&a===t){c(this,da).splice(r,1);return}}},pE=function(e){const[t,i,r]=e,s=[[t,i,r]],a=I(this,Rr,b0).call(this,r);for(let o=0;o<a;o++){const[l,u]=c(this,da)[o];for(let h=0,d=s.length;h<d;h++){const[,f,m]=s[h];if(!(u<=f||m<=l)){if(f>=l){if(m>u)s[h][1]=u;else{if(d===1)return[];s.splice(h,1),h--,d--}continue}s[h][2]=l,m>u&&s.push([t,u,m])}}}return s};var dv,Ef;class SU extends at{constructor(t,i,r){super();N(this,dv);N(this,Ef);T(this,Ef,t),T(this,dv,i),this.lastPoint=r}toSVGPath(){const t=[];for(const i of c(this,Ef)){let[r,s]=i;t.push(`M${r} ${s}`);for(let a=2;a<i.length;a+=2){const o=i[a],l=i[a+1];o===r?(t.push(`V${l}`),s=l):l===s&&(t.push(`H${o}`),r=o)}t.push("Z")}return t.join(" ")}serialize([t,i,r,s],a){const o=[],l=r-t,u=s-i;for(const h of c(this,Ef)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*l,d[f+1]=s-h[f+1]*u;o.push(d)}return o}get box(){return c(this,dv)}get classNamesForOutlining(){return["highlightOutline"]}}dv=new WeakMap,Ef=new WeakMap;class mE extends Eb{newFreeDrawOutline(e,t,i,r,s,a){return new CU(e,t,i,r,s,a)}}class CU extends VI{newOutliner(e,t,i,r,s,a=0){return new mE(e,t,i,r,s,a)}}var fa,rh,Af,fi,fv,xf,pv,mv,uu,pa,Sf,gv,cn,gE,vE,yE,Zu,QI,Dl;const Br=class Br{constructor({editor:e=null,uiManager:t=null}){N(this,cn);N(this,fa,null);N(this,rh,null);N(this,Af);N(this,fi,null);N(this,fv,!1);N(this,xf,!1);N(this,pv,null);N(this,mv);N(this,uu,null);N(this,pa,null);N(this,Sf);e?(T(this,xf,!1),T(this,Sf,$t.HIGHLIGHT_COLOR),T(this,pv,e)):(T(this,xf,!0),T(this,Sf,$t.HIGHLIGHT_DEFAULT_COLOR)),T(this,pa,e?._uiManager||t),T(this,mv,c(this,pa)._eventBus),T(this,Af,e?.color||c(this,pa)?.highlightColors.values().next().value||"#FFFF98"),c(Br,gv)||T(Br,gv,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ft(this,"_keyboardManager",new zv([[["Escape","mac+Escape"],Br.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Br.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Br.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Br.prototype._moveToPrevious],[["Home","mac+Home"],Br.prototype._moveToBeginning],[["End","mac+End"],Br.prototype._moveToEnd]]))}renderButton(){const e=T(this,fa,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=c(this,pa)._signal;e.addEventListener("click",I(this,cn,Zu).bind(this),{signal:t}),e.addEventListener("keydown",I(this,cn,yE).bind(this),{signal:t});const i=T(this,rh,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=c(this,Af),e.append(i),e}renderMainDropdown(){const e=T(this,fi,I(this,cn,gE).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===c(this,fa)){I(this,cn,Zu).call(this,e);return}const t=e.target.getAttribute("data-color");t&&I(this,cn,vE).call(this,t,e)}_moveToNext(e){if(!c(this,cn,Dl)){I(this,cn,Zu).call(this,e);return}if(e.target===c(this,fa)){c(this,fi).firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===c(this,fi)?.firstChild||e.target===c(this,fa)){c(this,cn,Dl)&&this._hideDropdownFromKeyboard();return}c(this,cn,Dl)||I(this,cn,Zu).call(this,e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!c(this,cn,Dl)){I(this,cn,Zu).call(this,e);return}c(this,fi).firstChild?.focus()}_moveToEnd(e){if(!c(this,cn,Dl)){I(this,cn,Zu).call(this,e);return}c(this,fi).lastChild?.focus()}hideDropdown(){c(this,fi)?.classList.add("hidden"),c(this,uu)?.abort(),T(this,uu,null)}_hideDropdownFromKeyboard(){if(!c(this,xf)){if(!c(this,cn,Dl)){c(this,pv)?.unselect();return}this.hideDropdown(),c(this,fa).focus({preventScroll:!0,focusVisible:c(this,fv)})}}updateColor(e){if(c(this,rh)&&(c(this,rh).style.backgroundColor=e),!c(this,fi))return;const t=c(this,pa).highlightColors.values();for(const i of c(this,fi).children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){c(this,fa)?.remove(),T(this,fa,null),T(this,rh,null),c(this,fi)?.remove(),T(this,fi,null)}};fa=new WeakMap,rh=new WeakMap,Af=new WeakMap,fi=new WeakMap,fv=new WeakMap,xf=new WeakMap,pv=new WeakMap,mv=new WeakMap,uu=new WeakMap,pa=new WeakMap,Sf=new WeakMap,gv=new WeakMap,cn=new WeakSet,gE=function(){const e=document.createElement("div"),t=c(this,pa)._signal;e.addEventListener("contextmenu",Sa,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,r]of c(this,pa).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",r),s.title=i,s.setAttribute("data-l10n-id",c(Br,gv)[i]);const a=document.createElement("span");s.append(a),a.className="swatch",a.style.backgroundColor=r,s.setAttribute("aria-selected",r===c(this,Af)),s.addEventListener("click",I(this,cn,vE).bind(this,r),{signal:t}),e.append(s)}return e.addEventListener("keydown",I(this,cn,yE).bind(this),{signal:t}),e},vE=function(e,t){t.stopPropagation(),c(this,mv).dispatch("switchannotationeditorparams",{source:this,type:c(this,Sf),value:e})},yE=function(e){Br._keyboardManager.exec(this,e)},Zu=function(e){if(c(this,cn,Dl)){this.hideDropdown();return}if(T(this,fv,e.detail===0),c(this,uu)||(T(this,uu,new AbortController),window.addEventListener("pointerdown",I(this,cn,QI).bind(this),{signal:c(this,pa).combinedSignal(c(this,uu))})),c(this,fi)){c(this,fi).classList.remove("hidden");return}const t=T(this,fi,I(this,cn,gE).call(this));c(this,fa).append(t)},QI=function(e){c(this,fi)?.contains(e.target)||this.hideDropdown()},Dl=function(){return c(this,fi)&&!c(this,fi).classList.contains("hidden")},N(Br,gv,null);let Ab=Br;var Cf,vv,Vo,sh,kf,Ur,yv,bv,ah,Is,hs,Fi,Tf,Go,sr,Df,Ls,wv,St,bE,w0,ZI,JI,eL,wE,Ju,zs,td,tL,_0,Yp,nL,iL,rL,sL,aL;const Zt=class Zt extends Fn{constructor(t){super({...t,name:"highlightEditor"});N(this,St);N(this,Cf,null);N(this,vv,0);N(this,Vo);N(this,sh,null);N(this,kf,null);N(this,Ur,null);N(this,yv,null);N(this,bv,0);N(this,ah,null);N(this,Is,null);N(this,hs,null);N(this,Fi,!1);N(this,Tf,null);N(this,Go);N(this,sr,null);N(this,Df,"");N(this,Ls);N(this,wv,"");this.color=t.color||Zt._defaultColor,T(this,Ls,t.thickness||Zt._defaultThickness),T(this,Go,t.opacity||Zt._defaultOpacity),T(this,Vo,t.boxes||null),T(this,wv,t.methodOfCreation||""),T(this,Df,t.text||""),this._isDraggable=!1,t.highlightId>-1?(T(this,Fi,!0),I(this,St,w0).call(this,t),I(this,St,Ju).call(this)):c(this,Vo)&&(T(this,Cf,t.anchorNode),T(this,vv,t.anchorOffset),T(this,yv,t.focusNode),T(this,bv,t.focusOffset),I(this,St,bE).call(this),I(this,St,Ju).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=Zt.prototype;return Ft(this,"_keyboardManager",new zv([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,Fi)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:c(this,Ls),methodOfCreation:c(this,wv)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){Fn.initialize(t,i),Zt._defaultColor||(Zt._defaultColor=i.highlightColors?.values().next().value||"#fff066")}static updateDefaultParams(t,i){switch(t){case $t.HIGHLIGHT_DEFAULT_COLOR:Zt._defaultColor=i;break;case $t.HIGHLIGHT_THICKNESS:Zt._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return c(this,Tf)}updateParams(t,i){switch(t){case $t.HIGHLIGHT_COLOR:I(this,St,ZI).call(this,i);break;case $t.HIGHLIGHT_THICKNESS:I(this,St,JI).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[$t.HIGHLIGHT_DEFAULT_COLOR,Zt._defaultColor],[$t.HIGHLIGHT_THICKNESS,Zt._defaultThickness]]}get propertiesToUpdate(){return[[$t.HIGHLIGHT_COLOR,this.color||Zt._defaultColor],[$t.HIGHLIGHT_THICKNESS,c(this,Ls)||Zt._defaultThickness],[$t.HIGHLIGHT_FREE,c(this,Fi)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(T(this,kf,new Ab({editor:this})),t.addColorPicker(c(this,kf))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(I(this,St,Yp).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,I(this,St,Yp).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){I(this,St,wE).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(I(this,St,Ju).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?I(this,St,wE).call(this):t&&(I(this,St,Ju).call(this,t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var s,a,o;const{drawLayer:i}=this.parent;let r;c(this,Fi)?(t=(t-this.rotation+360)%360,r=I(s=Zt,zs,td).call(s,c(this,Is).box,t)):r=I(a=Zt,zs,td).call(a,[this.x,this.y,this.width,this.height],t),i.updateProperties(c(this,hs),{bbox:r,root:{"data-main-rotation":t}}),i.updateProperties(c(this,sr),{bbox:I(o=Zt,zs,td).call(o,c(this,Ur).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Df)&&(t.setAttribute("aria-label",c(this,Df)),t.setAttribute("role","mark")),c(this,Fi)?t.classList.add("free"):this.div.addEventListener("keydown",I(this,St,tL).bind(this),{signal:this._uiManager._signal});const i=T(this,ah,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=c(this,sh);const[r,s]=this.parentDimensions;return this.setDims(this.width*r,this.height*s),bb(this,c(this,ah),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(c(this,sr),{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(c(this,sr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:I(this,St,_0).call(this,!0);break;case 1:case 3:I(this,St,_0).call(this,!1);break}}select(){super.select(),c(this,sr)&&this.parent?.drawLayer.updateProperties(c(this,sr),{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),c(this,sr)&&(this.parent?.drawLayer.updateProperties(c(this,sr),{rootClass:{selected:!1}}),c(this,Fi)||I(this,St,_0).call(this,!1))}get _mustFixPosition(){return!c(this,Fi)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,hs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,sr),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:r,x:s,y:a}){const{x:o,y:l,width:u,height:h}=r.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),m=b=>{d.abort(),I(this,zs,sL).call(this,t,b)};window.addEventListener("blur",m,{signal:f}),window.addEventListener("pointerup",m,{signal:f}),window.addEventListener("pointerdown",ys,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",Sa,{signal:f}),r.addEventListener("pointermove",I(this,zs,rL).bind(this,t),{signal:f}),this._freeHighlight=new mE({x:s,y:a},[o,l,u,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,r){var _,w,v,y;let s=null;if(t instanceof NI){const{data:{quadPoints:E,rect:k,rotation:S,id:D,color:P,opacity:F,popupRef:H},parent:{page:{pageNumber:z}}}=t;s=t={annotationType:Ct.HIGHLIGHT,color:Array.from(P),opacity:F,quadPoints:E,boxes:null,pageIndex:z-1,rect:k.slice(0),rotation:S,id:D,deleted:!1,popupRef:H}}else if(t instanceof xx){const{data:{inkLists:E,rect:k,rotation:S,id:D,color:P,borderStyle:{rawWidth:F},popupRef:H},parent:{page:{pageNumber:z}}}=t;s=t={annotationType:Ct.HIGHLIGHT,color:Array.from(P),thickness:F,inkLists:E,boxes:null,pageIndex:z-1,rect:k.slice(0),rotation:S,id:D,deleted:!1,popupRef:H}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=t,h=await super.deserialize(t,i,r);h.color=dt.makeHexColor(...a),T(h,Go,u||1),l&&T(h,Ls,t.thickness),h.annotationElementId=t.id||null,h._initialData=s;const[d,f]=h.pageDimensions,[m,b]=h.pageTranslation;if(o){const E=T(h,Vo,[]);for(let k=0;k<o.length;k+=8)E.push({x:(o[k]-m)/d,y:1-(o[k+1]-b)/f,width:(o[k+2]-o[k])/d,height:(o[k+1]-o[k+5])/f});I(_=h,St,bE).call(_),I(w=h,St,Ju).call(w),h.rotate(h.rotation)}else if(l){T(h,Fi,!0);const E=l[0],k={x:E[0]-m,y:f-(E[1]-b)},S=new mE(k,[0,0,d,f],1,c(h,Ls)/2,!0,.001);for(let F=0,H=E.length;F<H;F+=2)k.x=E[F]-m,k.y=f-(E[F+1]-b),S.add(k);const{id:D,clipPathId:P}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);I(v=h,St,w0).call(v,{highlightOutlines:S.getOutlines(),highlightId:D,clipPathId:P}),I(y=h,St,Ju).call(y)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),r=Fn._colorManager.convert(this.color),s={annotationType:Ct.HIGHLIGHT,color:r,opacity:c(this,Go),thickness:c(this,Ls),quadPoints:I(this,St,nL).call(this),outlines:I(this,St,iL).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:I(this,St,Yp).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!I(this,St,aL).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Cf=new WeakMap,vv=new WeakMap,Vo=new WeakMap,sh=new WeakMap,kf=new WeakMap,Ur=new WeakMap,yv=new WeakMap,bv=new WeakMap,ah=new WeakMap,Is=new WeakMap,hs=new WeakMap,Fi=new WeakMap,Tf=new WeakMap,Go=new WeakMap,sr=new WeakMap,Df=new WeakMap,Ls=new WeakMap,wv=new WeakMap,St=new WeakSet,bE=function(){const t=new fE(c(this,Vo),.001);T(this,Is,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Is).box;const i=new fE(c(this,Vo),.0025,.001,this._uiManager.direction==="ltr");T(this,Ur,i.getOutlines());const{lastPoint:r}=c(this,Ur);T(this,Tf,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},w0=function({highlightOutlines:t,highlightId:i,clipPathId:r}){var d,f;if(T(this,Is,t),T(this,Ur,t.getNewOutline(c(this,Ls)/2+1.5,.0025)),i>=0)T(this,hs,i),T(this,sh,r),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),T(this,sr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,Ur).box,path:{d:c(this,Ur).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,hs),{bbox:I(d=Zt,zs,td).call(d,c(this,Is).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,sr),{bbox:I(f=Zt,zs,td).call(f,c(this,Ur).box,m),path:{d:c(this,Ur).toSVGPath()}})}const[a,o,l,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[m,b]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*b/m,this.height=u*m/b;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[m,b]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*b/m,this.height=u*m/b;break}}const{lastPoint:h}=c(this,Ur);T(this,Tf,[(h[0]-a)/l,(h[1]-o)/u])},ZI=function(t){const i=(a,o)=>{this.color=a,T(this,Go,o),this.parent?.drawLayer.updateProperties(c(this,hs),{root:{fill:a,"fill-opacity":o}}),c(this,kf)?.updateColor(a)},r=this.color,s=c(this,Go);this.addCommands({cmd:i.bind(this,t,Zt._defaultOpacity),undo:i.bind(this,r,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},JI=function(t){const i=c(this,Ls),r=s=>{T(this,Ls,s),I(this,St,eL).call(this,s)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:$t.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},eL=function(t){if(!c(this,Fi))return;I(this,St,w0).call(this,{highlightOutlines:c(this,Is).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,r]=this.parentDimensions;this.setDims(this.width*i,this.height*r)},wE=function(){c(this,hs)===null||!this.parent||(this.parent.drawLayer.remove(c(this,hs)),T(this,hs,null),this.parent.drawLayer.remove(c(this,sr)),T(this,sr,null))},Ju=function(t=this.parent){c(this,hs)===null&&({id:_i(this,hs)._,clipPathId:_i(this,sh)._}=t.drawLayer.draw({bbox:c(this,Is).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":c(this,Go)},rootClass:{highlight:!0,free:c(this,Fi)},path:{d:c(this,Is).toSVGPath()}},!1,!0),T(this,sr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,Fi)},bbox:c(this,Ur).box,path:{d:c(this,Ur).toSVGPath()}},c(this,Fi))),c(this,ah)&&(c(this,ah).style.clipPath=c(this,sh)))},zs=new WeakSet,td=function([t,i,r,s],a){switch(a){case 90:return[1-i-s,t,s,r];case 180:return[1-t-r,1-i-s,r,s];case 270:return[i,1-t-r,s,r]}return[t,i,r,s]},tL=function(t){Zt._keyboardManager.exec(this,t)},_0=function(t){if(!c(this,Cf))return;const i=window.getSelection();t?i.setPosition(c(this,Cf),c(this,vv)):i.setPosition(c(this,yv),c(this,bv))},Yp=function(){return c(this,Fi)?this.rotation:0},nL=function(){if(c(this,Fi))return null;const[t,i]=this.pageDimensions,[r,s]=this.pageTranslation,a=c(this,Vo),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:h,width:d,height:f}of a){const m=u*t+r,b=(1-h)*i+s;o[l]=o[l+4]=m,o[l+1]=o[l+3]=b,o[l+2]=o[l+6]=m+d*t,o[l+5]=o[l+7]=b-f*i,l+=8}return o},iL=function(t){return c(this,Is).serialize(t,I(this,St,Yp).call(this))},rL=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},sL=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},aL=function(t){const{color:i}=this._initialData;return t.color.some((r,s)=>r!==i[s])},N(Zt,zs),Ae(Zt,"_defaultColor",null),Ae(Zt,"_defaultOpacity",1),Ae(Zt,"_defaultThickness",12),Ae(Zt,"_type","highlight"),Ae(Zt,"_editorType",Ct.HIGHLIGHT),Ae(Zt,"_freeHighlightId",-1),Ae(Zt,"_freeHighlight",null),Ae(Zt,"_freeHighlightClipId","");let xb=Zt;var oh;class kU{constructor(){N(this,oh,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){c(this,oh)[e]=t}toSVGProperties(){const e=c(this,oh);return T(this,oh,Object.create(null)),{root:e}}reset(){T(this,oh,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){pn("Not implemented")}}oh=new WeakMap;var ds,Rf,Ci,lh,uh,cu,hu,du,ch,Kt,EE,AE,xE,Qp,oL,E0,Zp,nd;const ut=class ut extends Fn{constructor(t){super(t);N(this,Kt);N(this,ds,null);N(this,Rf);Ae(this,"_drawId",null);T(this,Rf,t.mustBeCommitted||!1),t.drawOutlines&&(I(this,Kt,EE).call(this,t),I(this,Kt,Qp).call(this))}static _mergeSVGProperties(t,i){const r=new Set(Object.keys(t));for(const[s,a]of Object.entries(i))r.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){pn("Not implemented")}static get typesMap(){pn("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,i),this._currentParent&&(c(ut,Ci).updateProperty(r,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[r,s]of this.typesMap)t.push([r,i[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[r,s]of this.constructor.typesMap)t.push([r,i[s]]);return t}_updateProperty(t,i,r){const s=this._drawingOptions,a=s[i],o=l=>{s.updateProperty(i,l);const u=c(this,ds).updateProperty(i,l);u&&I(this,Kt,Zp).call(this,u),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:o.bind(this,r),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,ut._mergeSVGProperties(c(this,ds).getPathResizingSVGProperties(I(this,Kt,E0).call(this)),{bbox:I(this,Kt,nd).call(this)}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,ut._mergeSVGProperties(c(this,ds).getPathResizedSVGProperties(I(this,Kt,E0).call(this)),{bbox:I(this,Kt,nd).call(this)}))}_onTranslating(t,i){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:I(this,Kt,nd).call(this,t,i)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,ut._mergeSVGProperties(c(this,ds).getPathTranslatedSVGProperties(I(this,Kt,E0).call(this),this.parentDimensions),{bbox:I(this,Kt,nd).call(this)}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,Rf)&&(T(this,Rf,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){I(this,Kt,xE).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(I(this,Kt,Qp).call(this),I(this,Kt,Zp).call(this,c(this,ds).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),I(this,Kt,xE).call(this)):t&&(this._uiManager.addShouldRescale(this),I(this,Kt,Qp).call(this,t),i=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,ut._mergeSVGProperties({bbox:I(this,Kt,nd).call(this)},c(this,ds).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&I(this,Kt,Zp).call(this,c(this,ds).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const i=document.createElement("div");t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[r,s]=this.parentDimensions;return this.setDims(this.width*r,this.height*s),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,i,r,s,a){pn("Not implemented")}static startDrawing(t,i,r,s){const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:h}=s;if(c(ut,hu)&&c(ut,hu)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:m}=a.getBoundingClientRect(),b=T(ut,lh,new AbortController),_=t.combinedSignal(b);if(c(ut,cu)||T(ut,cu,u),c(ut,hu)??T(ut,hu,h),window.addEventListener("pointerup",w=>{c(ut,cu)===w.pointerId?this._endDraw(w):c(ut,du)?.delete(w.pointerId)},{signal:_}),window.addEventListener("pointercancel",w=>{c(ut,cu)===w.pointerId?this._currentParent.endDrawingSession():c(ut,du)?.delete(w.pointerId)},{signal:_}),window.addEventListener("pointerdown",w=>{c(ut,hu)===w.pointerType&&((c(ut,du)||T(ut,du,new Set)).add(w.pointerId),c(ut,Ci).isCancellable()&&(c(ut,Ci).removeLastElement(),c(ut,Ci).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Sa,{signal:_}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),a.addEventListener("touchmove",w=>{w.timeStamp===c(ut,ch)&&ys(w)},{signal:_}),t.toggleDrawing(),i._editorUndoBar?.hide(),c(ut,Ci)){t.drawLayer.updateProperties(this._currentDrawId,c(ut,Ci).startNew(o,l,f,m,d));return}i.updateUIForDefaultProperties(this),T(ut,Ci,this.createDrawerInstance(o,l,f,m,d)),T(ut,uh,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(ut,uh).toSVGProperties(),c(ut,Ci).defaultSVGProperties),!0,!1)}static _drawMove(t){if(T(ut,ch,-1),!c(ut,Ci))return;const{offsetX:i,offsetY:r,pointerId:s}=t;if(c(ut,cu)===s){if(c(ut,du)?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(ut,Ci).add(i,r)),T(ut,ch,t.timeStamp),ys(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,T(ut,Ci,null),T(ut,uh,null),T(ut,hu,null),T(ut,ch,NaN)),c(ut,lh)&&(c(ut,lh).abort(),T(ut,lh,null),T(ut,cu,NaN),T(ut,du,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t&&i.drawLayer.updateProperties(this._currentDrawId,c(ut,Ci).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=c(ut,Ci),s=this._currentDrawId,a=r.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(s,r.setLastElement(a))},undo:()=>{i.drawLayer.updateProperties(s,r.removeLastElement())},mustExec:!1,type:$t.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack($t.DRAW_STEP),!c(ut,Ci).isEmpty()){const{pageDimensions:[r,s],scale:a}=i,o=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(ut,Ci).getOutlines(r*a,s*a,a,this._INNER_MARGIN),drawingOptions:c(ut,uh),mustBeCommitted:!t});return this._cleanup(!0),o}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,r,s,a,o){pn("Not implemented")}static async deserialize(t,i,r){var d,f;const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:l}}=i.viewport,u=this.deserializeDraw(o,l,s,a,this._INNER_MARGIN,t),h=await super.deserialize(t,i,r);return h.createDrawingOptions(t),I(d=h,Kt,EE).call(d,{drawOutlines:u}),I(f=h,Kt,Qp).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,r]=this.pageTranslation,[s,a]=this.pageDimensions;return c(this,ds).serialize([i,r,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ds=new WeakMap,Rf=new WeakMap,Ci=new WeakMap,lh=new WeakMap,uh=new WeakMap,cu=new WeakMap,hu=new WeakMap,du=new WeakMap,ch=new WeakMap,Kt=new WeakSet,EE=function({drawOutlines:t,drawId:i,drawingOptions:r}){T(this,ds,t),this._drawingOptions||(this._drawingOptions=r),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=I(this,Kt,AE).call(this,t,this.parent),I(this,Kt,Zp).call(this,t.box)},AE=function(t,i){const{id:r}=i.drawLayer.draw(ut._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},xE=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Qp=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=I(this,Kt,AE).call(this,c(this,ds),t)}},oL=function([t,i,r,s]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[i,1-t,r*(o/a),s*(a/o)];case 180:return[1-t,1-i,r,s];case 270:return[1-i,t,r*(o/a),s*(a/o)];default:return[t,i,r,s]}},E0=function(){const{x:t,y:i,width:r,height:s,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-i,t,r*(a/o),s*(o/a)];case 180:return[1-t,1-i,r,s];case 270:return[i,1-t,r*(a/o),s*(o/a)];default:return[t,i,r,s]}},Zp=function(t){if([this.x,this.y,this.width,this.height]=I(this,Kt,oL).call(this,t),this.div){this.fixAndSetPosition();const[i,r]=this.parentDimensions;this.setDims(this.width*i,this.height*r)}this._onResized()},nd=function(){const{x:t,y:i,width:r,height:s,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-i-s,t,s,r];case 2:return[1-t-r,1-i-s,r,s];case 3:return[i,1-t-r,s,r];case 4:return[t,i-r*(l/u),s*(u/l),r*(l/u)];case 5:return[1-i,t,r*(l/u),s*(u/l)];case 6:return[1-t-s*(u/l),1-i,s*(u/l),r*(l/u)];case 7:return[i-r*(l/u),1-t-s*(u/l),r*(l/u),s*(u/l)];case 8:return[t-r,i-s,r,s];case 9:return[1-i,t-r,s,r];case 10:return[1-t,1-i,r,s];case 11:return[i-s,1-t,s,r];case 12:return[t-s*(u/l),i,s*(u/l),r*(l/u)];case 13:return[1-i-r*(l/u),t-s*(u/l),r*(l/u),s*(u/l)];case 14:return[1-t,1-i-r*(l/u),s*(u/l),r*(l/u)];case 15:return[i,1-t,r*(l/u),s*(u/l)];default:return[t,i,r,s]}},Ae(ut,"_currentDrawId",-1),Ae(ut,"_currentParent",null),N(ut,Ci,null),N(ut,lh,null),N(ut,uh,null),N(ut,cu,NaN),N(ut,hu,null),N(ut,du,null),N(ut,ch,NaN),Ae(ut,"_INNER_MARGIN",3);let _E=ut;var Ja,ki,Ti,hh,Pf,_r,Bi,Os,dh,fh,ph,Nf,A0;class TU{constructor(e,t,i,r,s,a){N(this,Nf);N(this,Ja,new Float64Array(6));N(this,ki);N(this,Ti);N(this,hh);N(this,Pf);N(this,_r);N(this,Bi,"");N(this,Os,0);N(this,dh,new Sb);N(this,fh);N(this,ph);T(this,fh,i),T(this,ph,r),T(this,hh,s),T(this,Pf,a),[e,t]=I(this,Nf,A0).call(this,e,t);const o=T(this,ki,[NaN,NaN,NaN,NaN,e,t]);T(this,_r,[e,t]),T(this,Ti,[{line:o,points:c(this,_r)}]),c(this,Ja).set(o,0)}updateProperty(e,t){e==="stroke-width"&&T(this,Pf,t)}isEmpty(){return!c(this,Ti)||c(this,Ti).length===0}isCancellable(){return c(this,_r).length<=10}add(e,t){[e,t]=I(this,Nf,A0).call(this,e,t);const[i,r,s,a]=c(this,Ja).subarray(2,6),o=e-s,l=t-a;return Math.hypot(c(this,fh)*o,c(this,ph)*l)<=2?null:(c(this,_r).push(e,t),isNaN(i)?(c(this,Ja).set([s,a,e,t],2),c(this,ki).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,Ja)[0])&&c(this,ki).splice(6,6),c(this,Ja).set([i,r,s,a,e,t],0),c(this,ki).push(...at.createBezierPoints(i,r,s,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(c(this,_r).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,r,s){T(this,fh,i),T(this,ph,r),T(this,hh,s),[e,t]=I(this,Nf,A0).call(this,e,t);const a=T(this,ki,[NaN,NaN,NaN,NaN,e,t]);T(this,_r,[e,t]);const o=c(this,Ti).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),c(this,Ti).push({line:a,points:c(this,_r)}),c(this,Ja).set(a,0),T(this,Os,0),this.toSVGPath(),null}getLastElement(){return c(this,Ti).at(-1)}setLastElement(e){return c(this,Ti)?(c(this,Ti).push(e),T(this,ki,e.line),T(this,_r,e.points),T(this,Os,0),{path:{d:this.toSVGPath()}}):c(this,dh).setLastElement(e)}removeLastElement(){if(!c(this,Ti))return c(this,dh).removeLastElement();c(this,Ti).pop(),T(this,Bi,"");for(let e=0,t=c(this,Ti).length;e<t;e++){const{line:i,points:r}=c(this,Ti)[e];T(this,ki,i),T(this,_r,r),T(this,Os,0),this.toSVGPath()}return{path:{d:c(this,Bi)}}}toSVGPath(){const e=at.svgRound(c(this,ki)[4]),t=at.svgRound(c(this,ki)[5]);if(c(this,_r).length===2)return T(this,Bi,`${c(this,Bi)} M ${e} ${t} Z`),c(this,Bi);if(c(this,_r).length<=6){const r=c(this,Bi).lastIndexOf("M");T(this,Bi,`${c(this,Bi).slice(0,r)} M ${e} ${t}`),T(this,Os,6)}if(c(this,_r).length===4){const r=at.svgRound(c(this,ki)[10]),s=at.svgRound(c(this,ki)[11]);return T(this,Bi,`${c(this,Bi)} L ${r} ${s}`),T(this,Os,12),c(this,Bi)}const i=[];c(this,Os)===0&&(i.push(`M ${e} ${t}`),T(this,Os,6));for(let r=c(this,Os),s=c(this,ki).length;r<s;r+=6){const[a,o,l,u,h,d]=c(this,ki).slice(r,r+6).map(at.svgRound);i.push(`C${a} ${o} ${l} ${u} ${h} ${d}`)}return T(this,Bi,c(this,Bi)+i.join(" ")),T(this,Os,c(this,ki).length),c(this,Bi)}getOutlines(e,t,i,r){const s=c(this,Ti).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),c(this,dh).build(c(this,Ti),e,t,i,c(this,hh),c(this,Pf),r),T(this,Ja,null),T(this,ki,null),T(this,Ti,null),T(this,Bi,null),c(this,dh)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Ja=new WeakMap,ki=new WeakMap,Ti=new WeakMap,hh=new WeakMap,Pf=new WeakMap,_r=new WeakMap,Bi=new WeakMap,Os=new WeakMap,dh=new WeakMap,fh=new WeakMap,ph=new WeakMap,Nf=new WeakSet,A0=function(e,t){return at._normalizePoint(e,t,c(this,fh),c(this,ph),c(this,hh))};var Er,_v,Ev,fs,eo,to,If,Lf,Of,Ui,_o,lL,uL,cL;const Mx=class Mx extends at{constructor(){super(...arguments);N(this,Ui);N(this,Er);N(this,_v,0);N(this,Ev);N(this,fs);N(this,eo);N(this,to);N(this,If);N(this,Lf);N(this,Of)}build(t,i,r,s,a,o,l){T(this,eo,i),T(this,to,r),T(this,If,s),T(this,Lf,a),T(this,Of,o),T(this,Ev,l??0),T(this,fs,t),I(this,Ui,uL).call(this)}setLastElement(t){return c(this,fs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,fs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of c(this,fs)){if(t.push(`M${at.svgRound(i[4])} ${at.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12){t.push(`L${at.svgRound(i[10])} ${at.svgRound(i[11])}`);continue}for(let r=6,s=i.length;r<s;r+=6){const[a,o,l,u,h,d]=i.subarray(r,r+6).map(at.svgRound);t.push(`C${a} ${o} ${l} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,i,r,s],a){const o=[],l=[],[u,h,d,f]=I(this,Ui,lL).call(this);let m,b,_,w,v,y,E,k,S;switch(c(this,Lf)){case 0:S=at._rescale,m=t,b=i+s,_=r,w=-s,v=t+u*r,y=i+(1-h-f)*s,E=t+(u+d)*r,k=i+(1-h)*s;break;case 90:S=at._rescaleAndSwap,m=t,b=i,_=r,w=s,v=t+h*r,y=i+u*s,E=t+(h+f)*r,k=i+(u+d)*s;break;case 180:S=at._rescale,m=t+r,b=i,_=-r,w=s,v=t+(1-u-d)*r,y=i+h*s,E=t+(1-u)*r,k=i+(h+f)*s;break;case 270:S=at._rescaleAndSwap,m=t+r,b=i+s,_=-r,w=-s,v=t+(1-h-f)*r,y=i+(1-u-d)*s,E=t+(1-h)*r,k=i+(1-u)*s;break}for(const{line:D,points:P}of c(this,fs))o.push(S(D,m,b,_,w,a?new Array(D.length):null)),l.push(S(P,m,b,_,w,a?new Array(P.length):null));return{lines:o,points:l,rect:[v,y,E,k]}}static deserialize(t,i,r,s,a,{paths:{lines:o,points:l},rotation:u,thickness:h}){const d=[];let f,m,b,_,w;switch(u){case 0:w=at._rescale,f=-t/r,m=i/s+1,b=1/r,_=-1/s;break;case 90:w=at._rescaleAndSwap,f=-i/s,m=-t/r,b=1/s,_=1/r;break;case 180:w=at._rescale,f=t/r+1,m=-i/s,b=-1/r,_=1/s;break;case 270:w=at._rescaleAndSwap,f=i/s+1,m=t/r+1,b=-1/s,_=-1/r;break}if(!o){o=[];for(const y of l){const E=y.length;if(E===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1]]));continue}if(E===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,y[0],y[1],NaN,NaN,NaN,NaN,y[2],y[3]]));continue}const k=new Float32Array(3*(E-2));o.push(k);let[S,D,P,F]=y.subarray(0,4);k.set([NaN,NaN,NaN,NaN,S,D],0);for(let H=4;H<E;H+=2){const z=y[H],te=y[H+1];k.set(at.createBezierPoints(S,D,P,F,z,te),(H-2)*3),[S,D,P,F]=[P,F,z,te]}}}for(let y=0,E=o.length;y<E;y++)d.push({line:w(o[y].map(k=>k??NaN),f,m,b,_),points:w(l[y].map(k=>k??NaN),f,m,b,_)});const v=new Mx;return v.build(d,r,s,1,u,h,a),v}get box(){return c(this,Er)}updateProperty(t,i){return t==="stroke-width"?I(this,Ui,cL).call(this,i):null}updateParentDimensions([t,i],r){const[s,a]=I(this,Ui,_o).call(this);T(this,eo,t),T(this,to,i),T(this,If,r);const[o,l]=I(this,Ui,_o).call(this),u=o-s,h=l-a,d=c(this,Er);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return T(this,_v,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Er).map(at.svgRound).join(" ")}get defaultProperties(){const[t,i]=c(this,Er);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=c(this,Er);let r=0,s=0,a=0,o=0,l=0,u=0;switch(c(this,_v)){case 90:s=i/t,a=-t/i,l=t;break;case 180:r=-1,o=-1,l=t,u=i;break;case 270:s=-i/t,a=t/i,u=i;break;default:return""}return`matrix(${r} ${s} ${a} ${o} ${at.svgRound(l)} ${at.svgRound(u)})`}getPathResizingSVGProperties([t,i,r,s]){const[a,o]=I(this,Ui,_o).call(this),[l,u,h,d]=c(this,Er);if(Math.abs(h-a)<=at.PRECISION||Math.abs(d-o)<=at.PRECISION){const w=t+r/2-(l+h/2),v=i+s/2-(u+d/2);return{path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:`${this.rotationTransform} translate(${w} ${v})`}}}const f=(r-2*a)/(h-2*a),m=(s-2*o)/(d-2*o),b=h/r,_=d/s;return{path:{"transform-origin":`${at.svgRound(l)} ${at.svgRound(u)}`,transform:`${this.rotationTransform} scale(${b} ${_}) translate(${at.svgRound(a)} ${at.svgRound(o)}) scale(${f} ${m}) translate(${at.svgRound(-a)} ${at.svgRound(-o)})`}}}getPathResizedSVGProperties([t,i,r,s]){const[a,o]=I(this,Ui,_o).call(this),l=c(this,Er),[u,h,d,f]=l;if(l[0]=t,l[1]=i,l[2]=r,l[3]=s,Math.abs(d-a)<=at.PRECISION||Math.abs(f-o)<=at.PRECISION){const v=t+r/2-(u+d/2),y=i+s/2-(h+f/2);for(const{line:E,points:k}of c(this,fs))at._translate(E,v,y,E),at._translate(k,v,y,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(r-2*a)/(d-2*a),b=(s-2*o)/(f-2*o),_=-m*(u+a)+t+a,w=-b*(h+o)+i+o;if(m!==1||b!==1||_!==0||w!==0)for(const{line:v,points:y}of c(this,fs))at._rescale(v,_,w,m,b,v),at._rescale(y,_,w,m,b,y);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],r){const[s,a]=r,o=c(this,Er),l=t-o[0],u=i-o[1];if(c(this,eo)===s&&c(this,to)===a)for(const{line:h,points:d}of c(this,fs))at._translate(h,l,u,h),at._translate(d,l,u,d);else{const h=c(this,eo)/s,d=c(this,to)/a;T(this,eo,s),T(this,to,a);for(const{line:f,points:m}of c(this,fs))at._rescale(f,l,u,h,d,f),at._rescale(m,l,u,h,d,m);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t)} ${at.svgRound(i)}`}}}get defaultSVGProperties(){const t=c(this,Er);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${at.svgRound(t[0])} ${at.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Er=new WeakMap,_v=new WeakMap,Ev=new WeakMap,fs=new WeakMap,eo=new WeakMap,to=new WeakMap,If=new WeakMap,Lf=new WeakMap,Of=new WeakMap,Ui=new WeakSet,_o=function(t=c(this,Of)){const i=c(this,Ev)+t/2*c(this,If);return c(this,Lf)%180===0?[i/c(this,eo),i/c(this,to)]:[i/c(this,to),i/c(this,eo)]},lL=function(){const[t,i,r,s]=c(this,Er),[a,o]=I(this,Ui,_o).call(this,0);return[t+a,i+o,r-2*a,s-2*o]},uL=function(){const t=T(this,Er,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of c(this,fs)){if(s.length<=12){for(let l=4,u=s.length;l<u;l+=6){const[h,d]=s.subarray(l,l+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],d)}continue}let a=s[4],o=s[5];for(let l=6,u=s.length;l<u;l+=6){const[h,d,f,m,b,_]=s.subarray(l,l+6);dt.bezierBoundingBox(a,o,h,d,f,m,b,_,t),a=b,o=_}}const[i,r]=I(this,Ui,_o).call(this);t[0]=Math.min(1,Math.max(0,t[0]-i)),t[1]=Math.min(1,Math.max(0,t[1]-r)),t[2]=Math.min(1,Math.max(0,t[2]+i)),t[3]=Math.min(1,Math.max(0,t[3]+r)),t[2]-=t[0],t[3]-=t[1]},cL=function(t){const[i,r]=I(this,Ui,_o).call(this);T(this,Of,t);const[s,a]=I(this,Ui,_o).call(this),[o,l]=[s-i,a-r],u=c(this,Er);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};let Sb=Mx;var Mf;const Fx=class Fx extends kU{constructor(t){super();N(this,Mf);T(this,Mf,t),super.updateProperties({fill:"none",stroke:Fn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??(i=this["stroke-width"]),i*=c(this,Mf).realScale),super.updateSVGProperty(t,i)}clone(){const t=new Fx(c(this,Mf));return t.updateAll(this),t}};Mf=new WeakMap;let SE=Fx;var Gb,hL;const vd=class vd extends _E{constructor(t){super({...t,name:"inkEditor"});N(this,Gb);this._willKeepAspectRatio=!0}static initialize(t,i){Fn.initialize(t,i),this._defaultDrawingOptions=new SE(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ft(this,"typesMap",new Map([[$t.INK_THICKNESS,"stroke-width"],[$t.INK_COLOR,"stroke"],[$t.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,r,s,a){return new TU(t,i,r,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,r,s,a,o){return Sb.deserialize(t,i,r,s,a,o)}static async deserialize(t,i,r){let s=null;if(t instanceof xx){const{data:{inkLists:o,rect:l,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:m},popupRef:b},parent:{page:{pageNumber:_}}}=t;s=t={annotationType:Ct.INK,color:Array.from(d),thickness:m,opacity:f,paths:{points:o},boxes:null,pageIndex:_-1,rect:l.slice(0),rotation:u,id:h,deleted:!1,popupRef:b}}const a=await super.deserialize(t,i,r);return a.annotationElementId=t.id||null,a._initialData=s,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:r}=this;i.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:r}){this._drawingOptions=vd.getDefaultDrawingOptions({stroke:dt.makeHexColor(...t),"stroke-width":i,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:r,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u={annotationType:Ct.INK,color:Fn._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:i,points:r},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!I(this,Gb,hL).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:i,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:i}),null}};Gb=new WeakSet,hL=function(t){const{color:i,thickness:r,opacity:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==i[l])||t.thickness!==r||t.opacity!==s||t.pageIndex!==a},Ae(vd,"_type","ink"),Ae(vd,"_editorType",Ct.INK),Ae(vd,"_defaultDrawingOptions",null);let CE=vd;var On,ji,fu,Ko,pu,Ff,no,io,ps,Bf,Qt,Jp,em,x0,TE,S0,DE,C0,dL;const mm=class mm extends Fn{constructor(t){super({...t,name:"stampEditor"});N(this,Qt);N(this,On,null);N(this,ji,null);N(this,fu,null);N(this,Ko,null);N(this,pu,null);N(this,Ff,"");N(this,no,null);N(this,io,null);N(this,ps,!1);N(this,Bf,!1);T(this,Ko,t.bitmapUrl),T(this,pu,t.bitmapFile)}static initialize(t,i){Fn.initialize(t,i)}static get supportedTypes(){return Ft(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return Ft(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,i){i.pasteEditor(Ct.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await r.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),i&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){c(this,ji)&&(T(this,On,null),this._uiManager.imageManager.deleteId(c(this,ji)),c(this,no)?.remove(),T(this,no,null),c(this,io)&&(clearTimeout(c(this,io)),T(this,io,null))),super.remove()}rebuild(){if(!this.parent){c(this,ji)&&I(this,Qt,x0).call(this);return}super.rebuild(),this.div!==null&&(c(this,ji)&&c(this,no)===null&&I(this,Qt,x0).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,fu)||c(this,On)||c(this,Ko)||c(this,pu)||c(this,ji))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;if(this.width&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),c(this,On)?I(this,Qt,TE).call(this):I(this,Qt,x0).call(this),this.width&&!this.annotationElementId){const[r,s]=this.parentDimensions;this.setAt(t*r,i*s,this.width*r,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,io)!==null&&clearTimeout(c(this,io)),T(this,io,setTimeout(()=>{T(this,io,null),I(this,Qt,DE).call(this)},200))}copyCanvas(t,i,r=!1){t||(t=224);const{width:s,height:a}=c(this,On),o=new S2;let l=c(this,On),u=s,h=a,d=null;if(i){if(s>i||a>i){const P=Math.min(i/s,i/a);u=Math.floor(s*P),h=Math.floor(a*P)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*o.sx),b=d.height=Math.ceil(h*o.sy);c(this,ps)||(l=I(this,Qt,S0).call(this,m,b));const _=d.getContext("2d");_.filter=this._uiManager.hcmFilter;let w="white",v="#cfcfd8";this._uiManager.hcmFilter!=="none"?v="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",v="#42414d");const y=15,E=y*o.sx,k=y*o.sy,S=new OffscreenCanvas(E*2,k*2),D=S.getContext("2d");D.fillStyle=w,D.fillRect(0,0,E*2,k*2),D.fillStyle=v,D.fillRect(0,0,E,k),D.fillRect(E,k,E,k),_.fillStyle=_.createPattern(S,"repeat"),_.fillRect(0,0,m,b),_.drawImage(l,0,0,l.width,l.height,0,0,m,b)}let f=null;if(r){let m,b;if(o.symmetric&&l.width<t&&l.height<t)m=l.width,b=l.height;else if(l=c(this,On),s>t||a>t){const v=Math.min(t/s,t/a);m=Math.floor(s*v),b=Math.floor(a*v),c(this,ps)||(l=I(this,Qt,S0).call(this,m,b))}const w=new OffscreenCanvas(m,b).getContext("2d",{willReadFrequently:!0});w.drawImage(l,0,0,l.width,l.height,0,0,m,b),f={width:m,height:b,data:w.getImageData(0,0,m,b).data}}return{canvas:d,width:u,height:h,imageData:f}}getImageForAltText(){return c(this,no)}static async deserialize(t,i,r){let s=null;if(t instanceof II){const{data:{rect:_,rotation:w,id:v,structParent:y,popupRef:E},container:k,parent:{page:{pageNumber:S}}}=t,D=k.querySelector("canvas"),P=r.imageManager.getFromCanvas(k.id,D);D.remove();const F=(await i._structTree.getAriaAttributes(`${gx}${v}`))?.get("aria-label")||"";s=t={annotationType:Ct.STAMP,bitmapId:P.id,bitmap:P.bitmap,pageIndex:S-1,rect:_.slice(0),rotation:w,id:v,deleted:!1,accessibilityData:{decorative:!1,altText:F},isSvg:!1,structParent:y,popupRef:E}}const a=await super.deserialize(t,i,r),{rect:o,bitmap:l,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:f}=t;h&&r.imageManager.isValidId(h)?(T(a,ji,h),l&&T(a,On,l)):T(a,Ko,u),T(a,ps,d);const[m,b]=a.pageDimensions;return a.width=(o[2]-o[0])/m,a.height=(o[3]-o[1])/b,a.annotationElementId=t.id||null,f&&(a.altTextData=f),a._initialData=s,T(a,Bf,!!s),a}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:Ct.STAMP,bitmapId:c(this,ji),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:c(this,ps),structTreeParentId:this._structTreeParentId};if(t)return r.bitmapUrl=I(this,Qt,C0).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(r.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=I(this,Qt,dL).call(this,r);if(l.isSame)return null;l.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,i===null)return r;i.stamps||(i.stamps=new Map);const o=c(this,ps)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!i.stamps.has(c(this,ji)))i.stamps.set(c(this,ji),{area:o,serialized:r}),r.bitmap=I(this,Qt,C0).call(this,!1);else if(c(this,ps)){const l=i.stamps.get(c(this,ji));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=I(this,Qt,C0).call(this,!1))}return r}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};On=new WeakMap,ji=new WeakMap,fu=new WeakMap,Ko=new WeakMap,pu=new WeakMap,Ff=new WeakMap,no=new WeakMap,io=new WeakMap,ps=new WeakMap,Bf=new WeakMap,Qt=new WeakSet,Jp=function(t,i=!1){if(!t){this.remove();return}T(this,On,t.bitmap),i||(T(this,ji,t.id),T(this,ps,t.isSvg)),t.file&&T(this,Ff,t.file.name),I(this,Qt,TE).call(this)},em=function(){if(T(this,fu,null),this._uiManager.enableWaiting(!1),!!c(this,no)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,On)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,On)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},x0=function(){if(c(this,ji)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,ji)).then(r=>I(this,Qt,Jp).call(this,r,!0)).finally(()=>I(this,Qt,em).call(this));return}if(c(this,Ko)){const r=c(this,Ko);T(this,Ko,null),this._uiManager.enableWaiting(!0),T(this,fu,this._uiManager.imageManager.getFromUrl(r).then(s=>I(this,Qt,Jp).call(this,s)).finally(()=>I(this,Qt,em).call(this)));return}if(c(this,pu)){const r=c(this,pu);T(this,pu,null),this._uiManager.enableWaiting(!0),T(this,fu,this._uiManager.imageManager.getFromFile(r).then(s=>I(this,Qt,Jp).call(this,s)).finally(()=>I(this,Qt,em).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=mm.supportedTypesStr;const i=this._uiManager._signal;T(this,fu,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),I(this,Qt,Jp).call(this,s)}r()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:i})}).finally(()=>I(this,Qt,em).call(this))),t.click()},TE=function(){const{div:t}=this;let{width:i,height:r}=c(this,On);const[s,a]=this.pageDimensions,o=.75;if(this.width)i=this.width*s,r=this.height*a;else if(i>o*s||r>o*a){const d=Math.min(o*s/i,o*a/r);i*=d,r*=d}const[l,u]=this.parentDimensions;this.setDims(i*l/s,r*u/a),this._uiManager.enableWaiting(!1);const h=T(this,no,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/s,this.height=r/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),I(this,Qt,DE).call(this),c(this,Bf)||(this.parent.addUndoableEditor(this),T(this,Bf,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,Ff)&&h.setAttribute("aria-label",c(this,Ff))},S0=function(t,i){const{width:r,height:s}=c(this,On);let a=r,o=s,l=c(this,On);for(;a>2*t||o>2*i;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*i&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(l,0,0,u,h,0,0,a,o),l=d.transferToImageBitmap()}return l},DE=function(){const[t,i]=this.parentDimensions,{width:r,height:s}=this,a=new S2,o=Math.ceil(r*t*a.sx),l=Math.ceil(s*i*a.sy),u=c(this,no);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const h=c(this,ps)?c(this,On):I(this,Qt,S0).call(this,o,l),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,l)},C0=function(t){if(t){if(c(this,ps)){const s=this._uiManager.imageManager.getSvgUrl(c(this,ji));if(s)return s}const i=document.createElement("canvas");return{width:i.width,height:i.height}=c(this,On),i.getContext("2d").drawImage(c(this,On),0,0),i.toDataURL()}if(c(this,ps)){const[i,r]=this.pageDimensions,s=Math.round(this.width*i*Ou.PDF_TO_CSS_UNITS),a=Math.round(this.height*r*Ou.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(c(this,On),0,0,c(this,On).width,c(this,On).height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(c(this,On))},dL=function(t){const{pageIndex:i,accessibilityData:{altText:r}}=this._initialData,s=t.pageIndex===i,a=(t.accessibilityData?.alt||"")===r;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}},Ae(mm,"_type","stamp"),Ae(mm,"_editorType",Ct.STAMP);let kE=mm;var mh,jf,ro,mu,Xo,Ms,gu,zf,gh,ma,Yo,ar,Qo,ht,vu,kn,fL,Ma,PE,NE,k0;const Zs=class Zs{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:r,accessibilityManager:s,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:h}){N(this,kn);N(this,mh);N(this,jf,!1);N(this,ro,null);N(this,mu,null);N(this,Xo,null);N(this,Ms,new Map);N(this,gu,!1);N(this,zf,!1);N(this,gh,!1);N(this,ma,null);N(this,Yo,null);N(this,ar,null);N(this,Qo,null);N(this,ht);const d=[...c(Zs,vu).values()];if(!Zs._initialized){Zs._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),T(this,ht,e),this.pageIndex=t,this.div=i,T(this,mh,s),T(this,ro,a),this.viewport=u,T(this,ar,l),this.drawLayer=o,this._structTree=r,c(this,ht).addLayer(this)}get isEmpty(){return c(this,Ms).size===0}get isInvisible(){return this.isEmpty&&c(this,ht).getMode()===Ct.NONE}updateToolbar(e){c(this,ht).updateToolbar(e)}updateMode(e=c(this,ht).getMode()){switch(I(this,kn,k0).call(this),e){case Ct.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Ct.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Ct.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of c(Zs,vu).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){return e===c(this,ar)?.div}setEditingState(e){c(this,ht).setEditingState(e)}addCommands(e){c(this,ht).addCommands(e)}cleanUndoStack(e){c(this,ht).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){c(this,ro)?.div.classList.toggle("disabled",!e)}async enable(){T(this,gh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of c(this,Ms).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(c(this,ht).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!c(this,ro)){T(this,gh,!1);return}const t=c(this,ro).getEditableAnnotations();for(const i of t){if(i.hide(),c(this,ht).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}T(this,gh,!1)}disable(){T(this,zf,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of c(this,Ms).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(c(this,ro)){const r=c(this,ro).getEditableAnnotations();for(const s of r){const{id:a}=s.data;if(c(this,ht).isDeletedAnnotationElement(a))continue;let o=t.get(a);if(o){o.resetAnnotationElement(s),o.show(!1),s.show();continue}o=e.get(a),o&&(c(this,ht).addChangedExistingAnnotation(o),o.renderAnnotationElement(s)&&o.show(!1)),s.show()}}I(this,kn,k0).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of c(Zs,vu).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),T(this,zf,!1)}getEditableAnnotation(e){return c(this,ro)?.getEditableAnnotation(e)||null}setActiveEditor(e){c(this,ht).getActive()!==e&&c(this,ht).setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,c(this,ar)?.div&&!c(this,Qo)){T(this,Qo,new AbortController);const e=c(this,ht).combinedSignal(c(this,Qo));c(this,ar).div.addEventListener("pointerdown",I(this,kn,fL).bind(this),{signal:e}),c(this,ar).div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,c(this,ar)?.div&&c(this,Qo)&&(c(this,Qo).abort(),T(this,Qo,null),c(this,ar).div.classList.remove("highlighting"))}enableClick(){if(c(this,mu))return;T(this,mu,new AbortController);const e=c(this,ht).combinedSignal(c(this,mu));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){c(this,mu)?.abort(),T(this,mu,null)}attach(e){c(this,Ms).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,ht).isDeletedAnnotationElement(t)&&c(this,ht).removeDeletedAnnotationElement(e)}detach(e){c(this,Ms).delete(e.id),c(this,mh)?.removePointerInTextLayer(e.contentDiv),!c(this,zf)&&e.annotationElementId&&c(this,ht).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,ht).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,ht).addDeletedAnnotationElement(e.annotationElementId),Fn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,ht).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,gh)),c(this,ht).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,Xo)&&(e._focusEventsAllowed=!1,T(this,Xo,setTimeout(()=>{T(this,Xo,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,ht)._signal}),t.focus())},0))),e._structTreeParentId=c(this,mh)?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return c(this,ht).getId()}combinedSignal(e){return c(this,ht).combinedSignal(e)}canCreateNewEmptyEditor(){return c(this,kn,Ma)?.canCreateNewEmptyEditor()}pasteEditor(e,t){c(this,ht).updateToolbar(e),c(this,ht).updateMode(e);const{offsetX:i,offsetY:r}=I(this,kn,NE).call(this),s=this.getNextId(),a=I(this,kn,PE).call(this,{parent:this,id:s,x:i,y:r,uiManager:c(this,ht),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await c(Zs,vu).get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,c(this,ht))||null}createAndAddNewEditor(e,t,i={}){const r=this.getNextId(),s=I(this,kn,PE).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:c(this,ht),isCentered:t,...i});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(I(this,kn,NE).call(this),!0)}setSelected(e){c(this,ht).setSelected(e)}toggleSelected(e){c(this,ht).toggleSelected(e)}unselect(e){c(this,ht).unselect(e)}pointerup(e){const{isMac:t}=Tr.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&c(this,gu)&&(T(this,gu,!1),!(c(this,kn,Ma)?.isDrawer&&c(this,kn,Ma).supportMultipleDrawings))){if(!c(this,jf)){T(this,jf,!0);return}if(c(this,ht).getMode()===Ct.STAMP){c(this,ht).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){if(c(this,ht).getMode()===Ct.HIGHLIGHT&&this.enableTextSelection(),c(this,gu)){T(this,gu,!1);return}const{isMac:t}=Tr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(T(this,gu,!0),c(this,kn,Ma)?.isDrawer){this.startDrawingSession(e);return}const i=c(this,ht).getActive();T(this,jf,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus(),c(this,ma)){c(this,kn,Ma).startDrawing(this,c(this,ht),!1,e);return}c(this,ht).setCurrentDrawingSession(this),T(this,ma,new AbortController);const t=c(this,ht).combinedSignal(c(this,ma));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(T(this,Yo,null),this.commitOrRemove())},{signal:t}),c(this,kn,Ma).startDrawing(this,c(this,ht),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&T(this,Yo,t);return}c(this,Yo)&&setTimeout(()=>{c(this,Yo)?.focus(),T(this,Yo,null)},0)}endDrawingSession(e=!1){return c(this,ma)?(c(this,ht).setCurrentDrawingSession(null),c(this,ma).abort(),T(this,ma,null),T(this,Yo,null),c(this,kn,Ma).endDrawing(e)):null}findNewParent(e,t,i){const r=c(this,ht).findParent(t,i);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return c(this,ma)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,ma)&&c(this,kn,Ma).onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),c(this,ht).getActive()?.parent===this&&(c(this,ht).commitOrRemove(),c(this,ht).setActiveEditor(null)),c(this,Xo)&&(clearTimeout(c(this,Xo)),T(this,Xo,null));for(const e of c(this,Ms).values())c(this,mh)?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,c(this,Ms).clear(),c(this,ht).removeLayer(this)}render({viewport:e}){this.viewport=e,Th(this.div,e);for(const t of c(this,ht).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,ht).commitOrRemove(),I(this,kn,k0).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,Th(this.div,{rotation:i}),t!==i)for(const r of c(this,Ms).values())r.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,ht).viewParameters.realScale}};mh=new WeakMap,jf=new WeakMap,ro=new WeakMap,mu=new WeakMap,Xo=new WeakMap,Ms=new WeakMap,gu=new WeakMap,zf=new WeakMap,gh=new WeakMap,ma=new WeakMap,Yo=new WeakMap,ar=new WeakMap,Qo=new WeakMap,ht=new WeakMap,vu=new WeakMap,kn=new WeakSet,fL=function(e){c(this,ht).unselectAll();const{target:t}=e;if(t===c(this,ar).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,ar).div.contains(t)){const{isMac:i}=Tr.platform;if(e.button!==0||e.ctrlKey&&i)return;c(this,ht).showAllEditors("highlight",!0,!0),c(this,ar).div.classList.add("free"),this.toggleDrawing(),xb.startHighlighting(this,c(this,ht).direction==="ltr",{target:c(this,ar).div,x:e.x,y:e.y}),c(this,ar).div.addEventListener("pointerup",()=>{c(this,ar).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,ht)._signal}),e.preventDefault()}},Ma=function(){return c(Zs,vu).get(c(this,ht).getMode())},PE=function(e){const t=c(this,kn,Ma);return t?new t.prototype.constructor(e):null},NE=function(){const{x:e,y:t,width:i,height:r}=this.div.getBoundingClientRect(),s=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+r),u=(s+o)/2-e,h=(a+l)/2-t,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},k0=function(){for(const e of c(this,Ms).values())e.isEmpty()&&e.remove()},Ae(Zs,"_initialized",!1),N(Zs,vu,new Map([hE,CE,kE,xb].map(e=>[e._editorType,e])));let RE=Zs;var ga,Av,Ar,vh,Kb,pL,fo,LE,mL,OE;const nr=class nr{constructor({pageIndex:e}){N(this,fo);N(this,ga,null);N(this,Av,0);N(this,Ar,new Map);N(this,vh,new Map);this.pageIndex=e}setParent(e){if(!c(this,ga)){T(this,ga,e);return}if(c(this,ga)!==e){if(c(this,Ar).size>0)for(const t of c(this,Ar).values())t.remove(),e.append(t);T(this,ga,e)}}static get _svgFactory(){return Ft(this,"_svgFactory",new Ax)}draw(e,t=!1,i=!1){const r=_i(this,Av)._++,s=I(this,fo,LE).call(this),a=nr._svgFactory.createElement("defs");s.append(a);const o=nr._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,vh).set(r,o);const u=i?I(this,fo,mL).call(this,a,l):null,h=nr._svgFactory.createElement("use");return s.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(s,e),c(this,Ar).set(r,s),{id:r,clipPathId:`url(#${u})`}}drawOutline(e,t){const i=_i(this,Av)._++,r=I(this,fo,LE).call(this),s=nr._svgFactory.createElement("defs");r.append(s);const a=nr._svgFactory.createElement("path");s.append(a);const o=`path_p${this.pageIndex}_${i}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=nr._svgFactory.createElement("mask");s.append(d),l=`mask_p${this.pageIndex}_${i}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const f=nr._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const m=nr._svgFactory.createElement("use");d.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=nr._svgFactory.createElement("use");r.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const h=u.cloneNode();return r.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(r,e),c(this,Ar).set(i,r),i}finalizeDraw(e,t){c(this,vh).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:r,rootClass:s,path:a}=t,o=typeof e=="number"?c(this,Ar).get(e):e;if(o){if(i&&I(this,fo,OE).call(this,o,i),r&&I(l=nr,Kb,pL).call(l,o,r),s){const{classList:u}=o;for(const[h,d]of Object.entries(s))u.toggle(h,d)}if(a){const h=o.firstChild.firstChild;I(this,fo,OE).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const i=c(this,Ar).get(e);i&&(c(t,ga).append(i),c(this,Ar).delete(e),c(t,Ar).set(e,i))}remove(e){c(this,vh).delete(e),c(this,ga)!==null&&(c(this,Ar).get(e).remove(),c(this,Ar).delete(e))}destroy(){T(this,ga,null);for(const e of c(this,Ar).values())e.remove();c(this,Ar).clear(),c(this,vh).clear()}};ga=new WeakMap,Av=new WeakMap,Ar=new WeakMap,vh=new WeakMap,Kb=new WeakSet,pL=function(e,[t,i,r,s]){const{style:a}=e;a.top=`${100*i}%`,a.left=`${100*t}%`,a.width=`${100*r}%`,a.height=`${100*s}%`},fo=new WeakSet,LE=function(){const e=nr._svgFactory.create(1,1,!0);return c(this,ga).append(e),e.setAttribute("aria-hidden",!0),e},mL=function(e,t){const i=nr._svgFactory.createElement("clipPath");e.append(i);const r=`clip_${t}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const s=nr._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),r},OE=function(e,t){for(const[i,r]of Object.entries(t))r===null?e.removeAttribute(i):e.setAttribute(i,r)},N(nr,Kb);let IE=nr;globalThis.pdfjsTestingUtils={HighlightOutliner:fE};bt.AbortException;bt.AnnotationEditorLayer;bt.AnnotationEditorParamsType;bt.AnnotationEditorType;bt.AnnotationEditorUIManager;bt.AnnotationLayer;bt.AnnotationMode;bt.ColorPicker;bt.DOMSVGFactory;bt.DrawLayer;bt.FeatureTest;var DU=bt.GlobalWorkerOptions;bt.ImageKind;bt.InvalidPDFException;bt.MissingPDFException;bt.OPS;bt.OutputScale;bt.PDFDataRangeTransport;bt.PDFDateString;bt.PDFWorker;bt.PasswordResponses;bt.PermissionFlag;bt.PixelsPerInch;bt.RenderingCancelledException;bt.TextLayer;bt.TouchManager;bt.UnexpectedResponseException;bt.Util;bt.VerbosityLevel;bt.XfaLayer;bt.build;bt.createValidAbsoluteUrl;bt.fetchData;var RU=bt.getDocument;bt.getFilenameFromUrl;bt.getPdfFilenameFromUrl;bt.getXfaPageViewport;bt.isDataScheme;bt.isPdfFile;bt.noContextMenu;bt.normalizeUnicode;bt.setLayerDimensions;bt.shadow;bt.stopEvent;bt.version;const r_=_w(n=>({currentPDF:null,isLoading:!1,error:null,loadPDF:async e=>{n({isLoading:!0,error:null});try{const t=await e.arrayBuffer(),i=ux(e.name);n({currentPDF:{id:i,file:t,name:e.name},isLoading:!1})}catch(t){n({error:t instanceof Error?t.message:"Failed to load PDF",isLoading:!1})}},saveProgress:async(e,t)=>{try{await Iu.mangaProgress.put({id:e,mangaId:e,currentPage:t.currentPage,totalPages:t.totalPages,lastRead:new Date})}catch(i){console.error("Failed to save manga progress:",i)}},loadProgress:async e=>{try{const t=await Iu.mangaProgress.get(e);return t?{currentPage:t.currentPage,totalPages:t.totalPages}:null}catch(t){return console.error("Failed to load manga progress:",t),null}},clearCurrentPDF:()=>n({currentPDF:null}),setError:e=>n({error:e})}));var PU={exports:{}};(function(n){var e=function(t){var i=Object.prototype,r=i.hasOwnProperty,s=Object.defineProperty||function(ie,ae,me){ie[ae]=me.value},a,o=typeof Symbol=="function"?Symbol:{},l=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",h=o.toStringTag||"@@toStringTag";function d(ie,ae,me){return Object.defineProperty(ie,ae,{value:me,enumerable:!0,configurable:!0,writable:!0}),ie[ae]}try{d({},"")}catch{d=function(ae,me,_e){return ae[me]=_e}}function f(ie,ae,me,_e){var pe=ae&&ae.prototype instanceof E?ae:E,De=Object.create(pe.prototype),it=new ve(_e||[]);return s(De,"_invoke",{value:de(ie,me,it)}),De}t.wrap=f;function m(ie,ae,me){try{return{type:"normal",arg:ie.call(ae,me)}}catch(_e){return{type:"throw",arg:_e}}}var b="suspendedStart",_="suspendedYield",w="executing",v="completed",y={};function E(){}function k(){}function S(){}var D={};d(D,l,function(){return this});var P=Object.getPrototypeOf,F=P&&P(P(xe([])));F&&F!==i&&r.call(F,l)&&(D=F);var H=S.prototype=E.prototype=Object.create(D);k.prototype=S,s(H,"constructor",{value:S,configurable:!0}),s(S,"constructor",{value:k,configurable:!0}),k.displayName=d(S,h,"GeneratorFunction");function z(ie){["next","throw","return"].forEach(function(ae){d(ie,ae,function(me){return this._invoke(ae,me)})})}t.isGeneratorFunction=function(ie){var ae=typeof ie=="function"&&ie.constructor;return ae?ae===k||(ae.displayName||ae.name)==="GeneratorFunction":!1},t.mark=function(ie){return Object.setPrototypeOf?Object.setPrototypeOf(ie,S):(ie.__proto__=S,d(ie,h,"GeneratorFunction")),ie.prototype=Object.create(H),ie},t.awrap=function(ie){return{__await:ie}};function te(ie,ae){function me(De,it,Xe,We){var nt=m(ie[De],ie,it);if(nt.type==="throw")We(nt.arg);else{var Ve=nt.arg,Bt=Ve.value;return Bt&&typeof Bt=="object"&&r.call(Bt,"__await")?ae.resolve(Bt.__await).then(function(wt){me("next",wt,Xe,We)},function(wt){me("throw",wt,Xe,We)}):ae.resolve(Bt).then(function(wt){Ve.value=wt,Xe(Ve)},function(wt){return me("throw",wt,Xe,We)})}}var _e;function pe(De,it){function Xe(){return new ae(function(We,nt){me(De,it,We,nt)})}return _e=_e?_e.then(Xe,Xe):Xe()}s(this,"_invoke",{value:pe})}z(te.prototype),d(te.prototype,u,function(){return this}),t.AsyncIterator=te,t.async=function(ie,ae,me,_e,pe){pe===void 0&&(pe=Promise);var De=new te(f(ie,ae,me,_e),pe);return t.isGeneratorFunction(ae)?De:De.next().then(function(it){return it.done?it.value:De.next()})};function de(ie,ae,me){var _e=b;return function(De,it){if(_e===w)throw new Error("Generator is already running");if(_e===v){if(De==="throw")throw it;return he()}for(me.method=De,me.arg=it;;){var Xe=me.delegate;if(Xe){var We=ke(Xe,me);if(We){if(We===y)continue;return We}}if(me.method==="next")me.sent=me._sent=me.arg;else if(me.method==="throw"){if(_e===b)throw _e=v,me.arg;me.dispatchException(me.arg)}else me.method==="return"&&me.abrupt("return",me.arg);_e=w;var nt=m(ie,ae,me);if(nt.type==="normal"){if(_e=me.done?v:_,nt.arg===y)continue;return{value:nt.arg,done:me.done}}else nt.type==="throw"&&(_e=v,me.method="throw",me.arg=nt.arg)}}}function ke(ie,ae){var me=ae.method,_e=ie.iterator[me];if(_e===a)return ae.delegate=null,me==="throw"&&ie.iterator.return&&(ae.method="return",ae.arg=a,ke(ie,ae),ae.method==="throw")||me!=="return"&&(ae.method="throw",ae.arg=new TypeError("The iterator does not provide a '"+me+"' method")),y;var pe=m(_e,ie.iterator,ae.arg);if(pe.type==="throw")return ae.method="throw",ae.arg=pe.arg,ae.delegate=null,y;var De=pe.arg;if(!De)return ae.method="throw",ae.arg=new TypeError("iterator result is not an object"),ae.delegate=null,y;if(De.done)ae[ie.resultName]=De.value,ae.next=ie.nextLoc,ae.method!=="return"&&(ae.method="next",ae.arg=a);else return De;return ae.delegate=null,y}z(H),d(H,h,"Generator"),d(H,l,function(){return this}),d(H,"toString",function(){return"[object Generator]"});function Me(ie){var ae={tryLoc:ie[0]};1 in ie&&(ae.catchLoc=ie[1]),2 in ie&&(ae.finallyLoc=ie[2],ae.afterLoc=ie[3]),this.tryEntries.push(ae)}function ze(ie){var ae=ie.completion||{};ae.type="normal",delete ae.arg,ie.completion=ae}function ve(ie){this.tryEntries=[{tryLoc:"root"}],ie.forEach(Me,this),this.reset(!0)}t.keys=function(ie){var ae=Object(ie),me=[];for(var _e in ae)me.push(_e);return me.reverse(),function pe(){for(;me.length;){var De=me.pop();if(De in ae)return pe.value=De,pe.done=!1,pe}return pe.done=!0,pe}};function xe(ie){if(ie){var ae=ie[l];if(ae)return ae.call(ie);if(typeof ie.next=="function")return ie;if(!isNaN(ie.length)){var me=-1,_e=function pe(){for(;++me<ie.length;)if(r.call(ie,me))return pe.value=ie[me],pe.done=!1,pe;return pe.value=a,pe.done=!0,pe};return _e.next=_e}}return{next:he}}t.values=xe;function he(){return{value:a,done:!0}}return ve.prototype={constructor:ve,reset:function(ie){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(ze),!ie)for(var ae in this)ae.charAt(0)==="t"&&r.call(this,ae)&&!isNaN(+ae.slice(1))&&(this[ae]=a)},stop:function(){this.done=!0;var ie=this.tryEntries[0],ae=ie.completion;if(ae.type==="throw")throw ae.arg;return this.rval},dispatchException:function(ie){if(this.done)throw ie;var ae=this;function me(We,nt){return De.type="throw",De.arg=ie,ae.next=We,nt&&(ae.method="next",ae.arg=a),!!nt}for(var _e=this.tryEntries.length-1;_e>=0;--_e){var pe=this.tryEntries[_e],De=pe.completion;if(pe.tryLoc==="root")return me("end");if(pe.tryLoc<=this.prev){var it=r.call(pe,"catchLoc"),Xe=r.call(pe,"finallyLoc");if(it&&Xe){if(this.prev<pe.catchLoc)return me(pe.catchLoc,!0);if(this.prev<pe.finallyLoc)return me(pe.finallyLoc)}else if(it){if(this.prev<pe.catchLoc)return me(pe.catchLoc,!0)}else if(Xe){if(this.prev<pe.finallyLoc)return me(pe.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(ie,ae){for(var me=this.tryEntries.length-1;me>=0;--me){var _e=this.tryEntries[me];if(_e.tryLoc<=this.prev&&r.call(_e,"finallyLoc")&&this.prev<_e.finallyLoc){var pe=_e;break}}pe&&(ie==="break"||ie==="continue")&&pe.tryLoc<=ae&&ae<=pe.finallyLoc&&(pe=null);var De=pe?pe.completion:{};return De.type=ie,De.arg=ae,pe?(this.method="next",this.next=pe.finallyLoc,y):this.complete(De)},complete:function(ie,ae){if(ie.type==="throw")throw ie.arg;return ie.type==="break"||ie.type==="continue"?this.next=ie.arg:ie.type==="return"?(this.rval=this.arg=ie.arg,this.method="return",this.next="end"):ie.type==="normal"&&ae&&(this.next=ae),y},finish:function(ie){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var me=this.tryEntries[ae];if(me.finallyLoc===ie)return this.complete(me.completion,me.afterLoc),ze(me),y}},catch:function(ie){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var me=this.tryEntries[ae];if(me.tryLoc===ie){var _e=me.completion;if(_e.type==="throw"){var pe=_e.arg;ze(me)}return pe}}throw new Error("illegal catch attempt")},delegateYield:function(ie,ae,me){return this.delegate={iterator:xe(ie),resultName:ae,nextLoc:me},this.method==="next"&&(this.arg=a),y}},t}(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(PU);var Sx=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`;const NU=Sx;let jk=0;var gL=({id:n,action:e,payload:t={}})=>{let i=n;return typeof i>"u"&&(i=NU("Job",jk),jk+=1),{id:i,action:e,payload:t}},ap={};let Cx=!1;ap.logging=Cx;ap.setLogging=n=>{Cx=n};ap.log=(...n)=>Cx?console.log.apply(void 0,n):null;const IU=gL,{log:Ry}=ap,LU=Sx;let zk=0;var OU=()=>{const n=LU("Scheduler",zk),e={},t={};let i=[];zk+=1;const r=()=>i.length,s=()=>Object.keys(e).length,a=()=>{if(i.length!==0){const d=Object.keys(e);for(let f=0;f<d.length;f+=1)if(typeof t[d[f]]>"u"){i[0](e[d[f]]);break}}},o=(d,f)=>new Promise((m,b)=>{const _=IU({action:d,payload:f});i.push(async w=>{i.shift(),t[w.id]=_;try{m(await w[d].apply(void 0,[...f,_.id]))}catch(v){b(v)}finally{delete t[w.id],a()}}),Ry(`[${n}]: Add ${_.id} to JobQueue`),Ry(`[${n}]: JobQueue length=${i.length}`),a()});return{addWorker:d=>(e[d.id]=d,Ry(`[${n}]: Add ${d.id}`),Ry(`[${n}]: Number of workers=${s()}`),a(),d.id),addJob:async(d,...f)=>{if(s()===0)throw Error(`[${n}]: You need to have at least one worker before adding jobs`);return o(d,f)},terminate:async()=>{Object.keys(e).forEach(async d=>{await e[d].terminate()}),i=[]},getQueueLen:r,getNumWorkers:s}};function MU(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var FU=MU;const BU=FU;var jU=n=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":BU()?e.type="electron":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof nl=="function"&&(e.type="node"),typeof n>"u"?e:e[n]};const zU=jU("type")==="browser",UU=zU?n=>new URL(n,window.location.href).href:n=>n;var $U=n=>{const e={...n};return["corePath","workerPath","langPath"].forEach(t=>{n[t]&&(e[t]=UU(e[t]))}),e},HU=n=>{const e=[],t=[],i=[],r=[],s=[];return n.blocks&&n.blocks.forEach(a=>{a.paragraphs.forEach(o=>{o.lines.forEach(l=>{l.words.forEach(u=>{u.symbols.forEach(h=>{s.push({...h,page:n,block:a,paragraph:o,line:l,word:u})}),r.push({...u,page:n,block:a,paragraph:o,line:l})}),i.push({...l,page:n,block:a,paragraph:o})}),t.push({...o,page:n,block:a})}),e.push({...a,page:n})}),{...n,blocks:e,paragraphs:t,lines:i,words:r,symbols:s}},vL={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const qU="5.1.1",WU={version:qU};var VU={workerBlobURL:!0,logger:()=>{}};const GU=WU.version,KU=VU;var XU={...KU,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${GU}/dist/worker.min.js`},YU=({workerPath:n,workerBlobURL:e})=>{let t;if(Blob&&URL&&e){const i=new Blob([`importScripts("${n}");`],{type:"application/javascript"});t=new Worker(URL.createObjectURL(i))}else t=new Worker(n);return t},QU=n=>{n.terminate()},ZU=(n,e)=>{n.onmessage=({data:t})=>{e(t)}},JU=async(n,e)=>{n.postMessage(e)};const s_=n=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{e(i.result)},i.onerror=({target:{error:{code:r}}})=>{t(Error(`File could not be read! Code=${r}`))},i.readAsArrayBuffer(n)}),ME=async n=>{let e=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?e=atob(n.split(",")[1]).split("").map(t=>t.charCodeAt(0)):e=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(e=await ME(n.src)),n.tagName==="VIDEO"&&(e=await ME(n.poster)),n.tagName==="CANVAS"&&await new Promise(t=>{n.toBlob(async i=>{e=await s_(i),t()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const t=await n.convertToBlob();e=await s_(t)}else(n instanceof File||n instanceof Blob)&&(e=await s_(n));return new Uint8Array(e)};var e6=ME;const t6=XU,n6=YU,i6=QU,r6=ZU,s6=JU,a6=e6;var o6={defaultOptions:t6,spawnWorker:n6,terminateWorker:i6,onMessage:r6,send:s6,loadImage:a6};const l6=$U,u6=HU,Ys=gL,{log:Uk}=ap,c6=Sx,Gu=vL,{defaultOptions:h6,spawnWorker:d6,terminateWorker:f6,onMessage:p6,loadImage:$k,send:m6}=o6;let Hk=0;var yL=async(n="eng",e=Gu.LSTM_ONLY,t={},i={})=>{const r=c6("Worker",Hk),{logger:s,errorHandler:a,...o}=l6({...h6,...t}),l={},u={},h=typeof n=="string"?n.split("+"):n;let d=e,f=i;const m=[Gu.DEFAULT,Gu.LSTM_ONLY].includes(e)&&!o.legacyCore;let b,_;const w=new Promise((pe,De)=>{_=pe,b=De}),v=pe=>{b(pe.message)};let y=d6(o);y.onerror=v,Hk+=1;const E=(pe,De)=>{l[pe]=De},k=(pe,De)=>{u[pe]=De},S=({id:pe,action:De,payload:it})=>new Promise((Xe,We)=>{Uk(`[${r}]: Start ${pe}, action=${De}`);const nt=`${De}-${pe}`;E(nt,Xe),k(nt,We),m6(y,{workerId:r,jobId:pe,action:De,payload:it})}),D=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),P=pe=>S(Ys({id:pe,action:"load",payload:{options:{lstmOnly:m,corePath:o.corePath,logging:o.logging}}})),F=(pe,De,it)=>S(Ys({id:it,action:"FS",payload:{method:"writeFile",args:[pe,De]}})),H=(pe,De)=>S(Ys({id:De,action:"FS",payload:{method:"readFile",args:[pe,{encoding:"utf8"}]}})),z=(pe,De)=>S(Ys({id:De,action:"FS",payload:{method:"unlink",args:[pe]}})),te=(pe,De,it)=>S(Ys({id:it,action:"FS",payload:{method:pe,args:De}})),de=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),ke=(pe,De)=>S(Ys({id:De,action:"loadLanguage",payload:{langs:pe,options:{langPath:o.langPath,dataPath:o.dataPath,cachePath:o.cachePath,cacheMethod:o.cacheMethod,gzip:o.gzip,lstmOnly:[Gu.DEFAULT,Gu.LSTM_ONLY].includes(d)&&!o.legacyLang}}})),Me=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),ze=(pe,De,it,Xe)=>S(Ys({id:Xe,action:"initialize",payload:{langs:pe,oem:De,config:it}})),ve=(pe="eng",De,it,Xe)=>{if(m&&[Gu.TESSERACT_ONLY,Gu.TESSERACT_LSTM_COMBINED].includes(De))throw Error("Legacy model requested but code missing.");const We=De||d;d=We;const nt=it||f;f=nt;const Bt=(typeof pe=="string"?pe.split("+"):pe).filter(wt=>!h.includes(wt));return h.push(...Bt),Bt.length>0?ke(Bt,Xe).then(()=>ze(pe,We,nt,Xe)):ze(pe,We,nt,Xe)},xe=(pe={},De)=>S(Ys({id:De,action:"setParameters",payload:{params:pe}})),he=async(pe,De={},it={blocks:!0,text:!0,hocr:!0,tsv:!0},Xe)=>S(Ys({id:Xe,action:"recognize",payload:{image:await $k(pe),options:De,output:it}})),ie=(pe="Tesseract OCR Result",De=!1,it)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),S(Ys({id:it,action:"getPDF",payload:{title:pe,textonly:De}}))),ae=async(pe,De)=>{if(m)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return S(Ys({id:De,action:"detect",payload:{image:await $k(pe)}}))},me=async()=>(y!==null&&(f6(y),y=null),Promise.resolve());p6(y,({workerId:pe,jobId:De,status:it,action:Xe,data:We})=>{const nt=`${Xe}-${De}`;if(it==="resolve"){Uk(`[${pe}]: Complete ${De}`);let Ve=We;Xe==="recognize"?Ve=u6(We):Xe==="getPDF"&&(Ve=Array.from({...We,length:Object.keys(We).length})),l[nt]({jobId:De,data:Ve})}else if(it==="reject")if(u[nt](We),Xe==="load"&&b(We),a)a(We);else throw Error(We);else it==="progress"&&s({...We,userJobId:De})});const _e={id:r,worker:y,setResolve:E,setReject:k,load:D,writeText:F,readText:H,removeFile:z,FS:te,loadLanguage:de,initialize:Me,reinitialize:ve,setParameters:xe,recognize:he,getPDF:ie,detect:ae,terminate:me};return P().then(()=>ke(n)).then(()=>ze(n,e,i)).then(()=>_(_e)).catch(()=>{}),w};const bL=yL,g6=async(n,e,t)=>{const i=await bL(e,1,t);return i.recognize(n).finally(async()=>{await i.terminate()})},v6=async(n,e)=>{const t=await bL("osd",0,e);return t.detect(n).finally(async()=>{await t.terminate()})};var y6={recognize:g6,detect:v6},b6={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},w6={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const _6=OU,E6=yL,A6=y6,x6=b6,S6=vL,C6=w6,{setLogging:k6}=ap;var T6={languages:x6,OEM:S6,PSM:C6,createScheduler:_6,createWorker:E6,setLogging:k6,...A6};let fm=null;async function D6(){if(!fm)try{fm=await T6.createWorker("jpn",1,{workerPath:"https://unpkg.com/tesseract.js@5.0.4/dist/worker.min.js",langPath:"https://tessdata.projectnaptha.com/4.0.0",corePath:"https://unpkg.com/tesseract.js-core@5.0.0/tesseract-core-simd.wasm.js"})}catch(n){throw console.error("Failed to initialize OCR worker:",n),new Error("Failed to initialize OCR. Please check your internet connection.")}}async function R6(n){if(fm||await D6(),!fm)throw new Error("OCR worker not initialized");try{const{data:e}=await fm.recognize(n);return{text:e.text,words:e.words.map(t=>({text:t.text,bbox:{x0:t.bbox.x0,y0:t.bbox.y0,x1:t.bbox.x1,y1:t.bbox.y1}}))}}catch(e){throw console.error("OCR processing failed:",e),new Error("Failed to process image with OCR")}}function P6(n){return n.toDataURL("image/png")}function N6(n){const e=n.getContext("2d");if(!e)return n;const t=e.getImageData(0,0,n.width,n.height),i=t.data;for(let r=0;r<i.length;r+=4){const a=i[r]*.299+i[r+1]*.587+i[r+2]*.114>128?255:0;i[r]=a,i[r+1]=a,i[r+2]=a}return e.putImageData(t,0,0),n}DU.workerSrc="https://unpkg.com/pdfjs-dist@4.0.379/build/pdf.worker.js";const I6=()=>{const n=kt.useRef(null),[e,t]=kt.useState(null),[i,r]=kt.useState(1),[s,a]=kt.useState(0),[o,l]=kt.useState(!1),[u,h]=kt.useState(null),[d,f]=kt.useState(null),[m,b]=kt.useState([]),{currentPDF:_,saveProgress:w,loadProgress:v,isLoading:y,error:E}=r_();kt.useEffect(()=>{_&&k()},[_]);const k=async()=>{if(_)try{const te=await RU(_.file).promise;t(te),a(te.numPages);const de=await v(_.id);de&&r(de.currentPage),await S(de?.currentPage||1)}catch(z){console.error("Failed to load PDF:",z)}},S=async z=>{if(!(!e||!n.current))try{const te=await e.getPage(z),de=te.getViewport({scale:2}),ke=n.current,Me=ke.getContext("2d");if(!Me)return;ke.height=de.height,ke.width=de.width,await te.render({canvasContext:Me,viewport:de}).promise,_&&await w(_.id,{currentPage:z,totalPages:s}),b([]),h(null)}catch(te){console.error("Failed to render page:",te)}},D=async()=>{if(n.current){l(!0);try{const z=N6(n.current),te=P6(z),de=await R6(te);h(de);const ke=await fx.parseText(de.text),Me=de.words.filter(ze=>ke.some(ve=>ve.word===ze.text)).map(ze=>{const ve=ke.find(xe=>xe.word===ze.text);return ve?{word:ze.text,bbox:ze.bbox,vocab:ve}:null}).filter(Boolean);b(Me)}catch(z){console.error("OCR failed:",z)}finally{l(!1)}}},P=async z=>{z.type==="pdf"&&await r_.getState().loadPDF(z.file)},F=async z=>{console.log("Adding vocabulary to deck:",z)},H=z=>{z>=1&&z<=s&&(r(z),S(z))};return y?Q.jsx(vb,{className:"h-full"}):E?Q.jsx("div",{className:"flex items-center justify-center h-full",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("p",{className:"text-destructive mb-4",children:E}),Q.jsx("button",{onClick:()=>r_.getState().setError(null),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md",children:"Try Again"})]})}):_?Q.jsxs("div",{className:"manga-reader h-full flex flex-col",children:[Q.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[Q.jsx("h2",{className:"text-lg font-semibold text-foreground",children:_.name}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("button",{onClick:()=>H(i-1),disabled:i<=1,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80 disabled:opacity-50",children:"← Previous"}),Q.jsxs("span",{className:"text-sm text-muted-foreground",children:[i," / ",s]}),Q.jsx("button",{onClick:()=>H(i+1),disabled:i>=s,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80 disabled:opacity-50",children:"Next →"}),Q.jsx("button",{onClick:D,disabled:o,className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 disabled:opacity-50",children:o?"Processing OCR...":"🔍 OCR"})]})]}),Q.jsxs("div",{className:"flex-1 relative overflow-auto",children:[Q.jsx("canvas",{ref:n,className:"pdf-canvas max-w-full h-auto mx-auto"}),m.map((z,te)=>Q.jsx("div",{className:"absolute border-2 border-primary cursor-pointer hover:bg-primary/20",style:{left:`${z.bbox.x0}px`,top:`${z.bbox.y0}px`,width:`${z.bbox.x1-z.bbox.x0}px`,height:`${z.bbox.y1-z.bbox.y0}px`},onClick:()=>f(z.vocab)},te))]}),u&&Q.jsxs("div",{className:"border-t border-border p-4 bg-card",children:[Q.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2",children:"OCR Results"}),Q.jsx("div",{className:"text-sm text-foreground max-h-32 overflow-y-auto",children:u.text})]}),d&&Q.jsx(px,{vocabulary:d,onClose:()=>f(null),onAddToDeck:F})]}):Q.jsx("div",{className:"p-4",children:Q.jsx(hm,{onFileSelect:P,acceptedTypes:["pdf"],maxSize:100,className:"h-full"})})};function L6(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function qk(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function O6(n,e,t){return e&&qk(n.prototype,e),t&&qk(n,t),n}function M6(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Wk(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Vk(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Wk(Object(t),!0).forEach(function(i){M6(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Wk(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}var Gk={addCSS:!0,thumbWidth:15,watch:!0};function F6(n,e){return function(){return Array.from(document.querySelectorAll(e)).includes(this)}.call(n,e)}function B6(n,e){if(n&&e){var t=new Event(e,{bubbles:!0});n.dispatchEvent(t)}}var $v=function(n){return n!=null?n.constructor:null},kx=function(n,e){return!!(n&&e&&n instanceof e)},wL=function(n){return n==null},_L=function(n){return $v(n)===Object},j6=function(n){return $v(n)===Number&&!Number.isNaN(n)},EL=function(n){return $v(n)===String},z6=function(n){return $v(n)===Boolean},U6=function(n){return $v(n)===Function},AL=function(n){return Array.isArray(n)},xL=function(n){return kx(n,NodeList)},$6=function(n){return kx(n,Element)},H6=function(n){return kx(n,Event)},q6=function(n){return wL(n)||(EL(n)||AL(n)||xL(n))&&!n.length||_L(n)&&!Object.keys(n).length},Ji={nullOrUndefined:wL,object:_L,number:j6,string:EL,boolean:z6,function:U6,array:AL,nodeList:xL,element:$6,event:H6,empty:q6};function W6(n){var e="".concat(n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}function V6(n,e){if(1>e){var t=W6(e);return parseFloat(n.toFixed(t))}return Math.round(n/e)*e}var G6=function(){function n(e,t){L6(this,n),Ji.element(e)?this.element=e:Ji.string(e)&&(this.element=document.querySelector(e)),Ji.element(this.element)&&Ji.empty(this.element.rangeTouch)&&(this.config=Vk({},Gk,{},t),this.init())}return O6(n,[{key:"init",value:function(){n.enabled&&(this.config.addCSS&&(this.element.style.userSelect="none",this.element.style.webKitUserSelect="none",this.element.style.touchAction="manipulation"),this.listeners(!0),this.element.rangeTouch=this)}},{key:"destroy",value:function(){n.enabled&&(this.config.addCSS&&(this.element.style.userSelect="",this.element.style.webKitUserSelect="",this.element.style.touchAction=""),this.listeners(!1),this.element.rangeTouch=null)}},{key:"listeners",value:function(e){var t=this,i=e?"addEventListener":"removeEventListener";["touchstart","touchmove","touchend"].forEach(function(r){t.element[i](r,function(s){return t.set(s)},!1)})}},{key:"get",value:function(e){if(!n.enabled||!Ji.event(e))return null;var t,i=e.target,r=e.changedTouches[0],s=parseFloat(i.getAttribute("min"))||0,a=parseFloat(i.getAttribute("max"))||100,o=parseFloat(i.getAttribute("step"))||1,l=i.getBoundingClientRect(),u=100/l.width*(this.config.thumbWidth/2)/100;return 0>(t=100/l.width*(r.clientX-l.left))?t=0:100<t&&(t=100),50>t?t-=(100-2*t)*u:50<t&&(t+=2*(t-50)*u),s+V6(t/100*(a-s),o)}},{key:"set",value:function(e){n.enabled&&Ji.event(e)&&!e.target.disabled&&(e.preventDefault(),e.target.value=this.get(e),B6(e.target,e.type==="touchend"?"change":"input"))}}],[{key:"setup",value:function(e){var t=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},i=null;if(Ji.empty(e)||Ji.string(e)?i=Array.from(document.querySelectorAll(Ji.string(e)?e:'input[type="range"]')):Ji.element(e)?i=[e]:Ji.nodeList(e)?i=Array.from(e):Ji.array(e)&&(i=e.filter(Ji.element)),Ji.empty(i))return null;var r=Vk({},Gk,{},t);if(Ji.string(e)&&r.watch){var s=new MutationObserver(function(a){Array.from(a).forEach(function(o){Array.from(o.addedNodes).forEach(function(l){Ji.element(l)&&F6(l,e)&&new n(l,r)})})});s.observe(document.body,{childList:!0,subtree:!0})}return i.map(function(a){return new n(a,t)})}},{key:"enabled",get:function(){return"ontouchstart"in document.documentElement}}]),n}();const Hv=n=>n!==null&&typeof n<"u"?n.constructor:null,gl=(n,e)=>!!(n&&e&&n instanceof e),Tx=n=>n===null||typeof n>"u",SL=n=>Hv(n)===Object,K6=n=>Hv(n)===Number&&!Number.isNaN(n),Ow=n=>Hv(n)===String,X6=n=>Hv(n)===Boolean,CL=n=>typeof n=="function",kL=n=>Array.isArray(n),Y6=n=>gl(n,WeakMap),TL=n=>gl(n,NodeList),Q6=n=>Hv(n)===Text,Z6=n=>gl(n,Event),J6=n=>gl(n,KeyboardEvent),e$=n=>gl(n,window.TextTrackCue)||gl(n,window.VTTCue),t$=n=>gl(n,TextTrack)||!Tx(n)&&Ow(n.kind),n$=n=>gl(n,Promise)&&CL(n.then);function i$(n){return n!==null&&typeof n=="object"&&n.nodeType===1&&typeof n.style=="object"&&typeof n.ownerDocument=="object"}function DL(n){return Tx(n)||(Ow(n)||kL(n)||TL(n))&&!n.length||SL(n)&&!Object.keys(n).length}function r$(n){if(gl(n,window.URL))return!0;if(!Ow(n))return!1;let e=n;(!n.startsWith("http://")||!n.startsWith("https://"))&&(e=`http://${n}`);try{return!DL(new URL(e).hostname)}catch{return!1}}const W={nullOrUndefined:Tx,object:SL,number:K6,string:Ow,boolean:X6,function:CL,array:kL,weakMap:Y6,nodeList:TL,element:i$,textNode:Q6,event:Z6,keyboardEvent:J6,cue:e$,track:t$,promise:n$,url:r$,empty:DL},FE=(()=>{const n=document.createElement("span"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},t=Object.keys(e).find(i=>n.style[i]!==void 0);return W.string(t)?e[t]:!1})();function RL(n,e){setTimeout(()=>{try{n.hidden=!0,n.offsetHeight,n.hidden=!1}catch{}},e)}function s$(n){return JSON.parse(JSON.stringify(n))}function PL(n,e){return e.split(".").reduce((t,i)=>t&&t[i],n)}function Xn(n={},...e){if(!e.length)return n;const t=e.shift();return W.object(t)?(Object.keys(t).forEach(i=>{W.object(t[i])?(Object.keys(n).includes(i)||Object.assign(n,{[i]:{}}),Xn(n[i],t[i])):Object.assign(n,{[i]:t[i]})}),Xn(n,...e)):n}function NL(n,e){const t=n.length?n:[n];Array.from(t).reverse().forEach((i,r)=>{const s=r>0?e.cloneNode(!0):e,a=i.parentNode,o=i.nextSibling;s.appendChild(i),o?a.insertBefore(s,o):a.appendChild(s)})}function BE(n,e){!W.element(n)||W.empty(e)||Object.entries(e).filter(([,t])=>!W.nullOrUndefined(t)).forEach(([t,i])=>n.setAttribute(t,i))}function gt(n,e,t){const i=document.createElement(n);return W.object(e)&&BE(i,e),W.string(t)&&(i.textContent=t),i}function a$(n,e){!W.element(n)||!W.element(e)||e.parentNode.insertBefore(n,e.nextSibling)}function Kk(n,e,t,i){W.element(e)&&e.appendChild(gt(n,t,i))}function il(n){if(W.nodeList(n)||W.array(n)){Array.from(n).forEach(il);return}!W.element(n)||!W.element(n.parentNode)||n.parentNode.removeChild(n)}function T0(n){if(!W.element(n))return;let{length:e}=n.childNodes;for(;e>0;)n.removeChild(n.lastChild),e-=1}function Cb(n,e){return!W.element(e)||!W.element(e.parentNode)||!W.element(n)?null:(e.parentNode.replaceChild(n,e),n)}function Ba(n,e){if(!W.string(n)||W.empty(n))return{};const t={},i=Xn({},e);return n.split(",").forEach(r=>{const s=r.trim(),a=s.replace(".",""),l=s.replace(/[[\]]/g,"").split("="),[u]=l,h=l.length>1?l[1].replace(/["']/g,""):"";switch(s.charAt(0)){case".":W.string(i.class)?t.class=`${i.class} ${a}`:t.class=a;break;case"#":t.id=s.replace("#","");break;case"[":t[u]=h;break}}),Xn(i,t)}function Ku(n,e){if(!W.element(n))return;let t=e;W.boolean(t)||(t=!n.hidden),n.hidden=t}function Jt(n,e,t){if(W.nodeList(n))return Array.from(n).map(i=>Jt(i,e,t));if(W.element(n)){let i="toggle";return typeof t<"u"&&(i=t?"add":"remove"),n.classList[i](e),n.classList.contains(e)}return!1}function kb(n,e){return W.element(n)&&n.classList.contains(e)}function oc(n,e){const{prototype:t}=Element;function i(){return Array.from(document.querySelectorAll(e)).includes(this)}return(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||i).call(n,e)}function o$(n,e){const{prototype:t}=Element;function i(){let s=this;do{if(oc.matches(s,e))return s;s=s.parentElement||s.parentNode}while(s!==null&&s.nodeType===1);return null}return(t.closest||i).call(n,e)}function Vm(n){return this.elements.container.querySelectorAll(n)}function ci(n){return this.elements.container.querySelector(n)}function a_(n=null,e=!1){W.element(n)&&n.focus({preventScroll:!0,focusVisible:e})}const Xk={"audio/ogg":"vorbis","audio/wav":"1","video/webm":"vp8, vorbis","video/mp4":"avc1.42E01E, mp4a.40.2","video/ogg":"theora"},Yn={audio:"canPlayType"in document.createElement("audio"),video:"canPlayType"in document.createElement("video"),check(n,e){const t=Yn[n]||e!=="html5",i=t&&Yn.rangeInput;return{api:t,ui:i}},pip:document.pictureInPictureEnabled&&!gt("video").disablePictureInPicture,airplay:W.function(window.WebKitPlaybackTargetAvailabilityEvent),playsinline:"playsInline"in document.createElement("video"),mime(n){if(W.empty(n))return!1;const[e]=n.split("/");let t=n;if(!this.isHTML5||e!==this.type)return!1;Object.keys(Xk).includes(t)&&(t+=`; codecs="${Xk[n]}"`);try{return!!(t&&this.media.canPlayType(t).replace(/no/,""))}catch{return!1}},textTracks:"textTracks"in document.createElement("video"),rangeInput:(()=>{const n=document.createElement("input");return n.type="range",n.type==="range"})(),touch:"ontouchstart"in document.documentElement,transitions:FE!==!1,reducedMotion:"matchMedia"in window&&window.matchMedia("(prefers-reduced-motion)").matches},l$=(()=>{let n=!1;try{const e=Object.defineProperty({},"passive",{get(){return n=!0,null}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n})();function Gm(n,e,t,i=!1,r=!0,s=!1){if(!n||!("addEventListener"in n)||W.empty(e)||!W.function(t))return;const a=e.split(" ");let o=s;l$&&(o={passive:r,capture:s}),a.forEach(l=>{this&&this.eventListeners&&i&&this.eventListeners.push({element:n,type:l,callback:t,options:o}),n[i?"addEventListener":"removeEventListener"](l,t,o)})}function Vt(n,e="",t,i=!0,r=!1){Gm.call(this,n,e,t,!0,i,r)}function Mw(n,e="",t,i=!0,r=!1){Gm.call(this,n,e,t,!1,i,r)}function Dx(n,e="",t,i=!0,r=!1){const s=(...a)=>{Mw(n,e,s,i,r),t.apply(this,a)};Gm.call(this,n,e,s,!0,i,r)}function vt(n,e="",t=!1,i={}){if(!W.element(n)||W.empty(e))return;const r=new CustomEvent(e,{bubbles:t,detail:{...i,plyr:this}});n.dispatchEvent(r)}function u$(){this&&this.eventListeners&&(this.eventListeners.forEach(n=>{const{element:e,type:t,callback:i,options:r}=n;e.removeEventListener(t,i,r)}),this.eventListeners=[])}function c$(){return new Promise(n=>this.ready?setTimeout(n,0):Vt.call(this,this.elements.container,"ready",n)).then(()=>{})}function ao(n){W.promise(n)&&n.then(null,()=>{})}function jE(n){return W.array(n)?n.filter((e,t)=>n.indexOf(e)===t):n}function IL(n,e){return!W.array(n)||!n.length?null:n.reduce((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t)}function LL(n){return!window||!window.CSS?!1:window.CSS.supports(n)}const Yk=[[1,1],[4,3],[3,4],[5,4],[4,5],[3,2],[2,3],[16,10],[10,16],[16,9],[9,16],[21,9],[9,21],[32,9],[9,32]].reduce((n,[e,t])=>({...n,[e/t]:[e,t]}),{});function OL(n){return!W.array(n)&&(!W.string(n)||!n.includes(":"))?!1:(W.array(n)?n:n.split(":")).map(Number).every(W.number)}function Tb(n){if(!W.array(n)||!n.every(W.number))return null;const[e,t]=n,i=(s,a)=>a===0?s:i(a,s%a),r=i(e,t);return[e/r,t/r]}function Rx(n){const e=i=>OL(i)?i.split(":").map(Number):null;let t=e(n);if(t===null&&(t=e(this.config.ratio)),t===null&&!W.empty(this.embed)&&W.array(this.embed.ratio)&&({ratio:t}=this.embed),t===null&&this.isHTML5){const{videoWidth:i,videoHeight:r}=this.media;t=[i,r]}return Tb(t)}function ep(n){if(!this.isVideo)return{};const{wrapper:e}=this.elements,t=Rx.call(this,n);if(!W.array(t))return{};const[i,r]=Tb(t),s=LL(`aspect-ratio: ${i}/${r}`),a=100/i*r;if(s?e.style.aspectRatio=`${i}/${r}`:e.style.paddingBottom=`${a}%`,this.isVimeo&&!this.config.vimeo.premium&&this.supported.ui){const o=100/this.media.offsetWidth*Number.parseInt(window.getComputedStyle(this.media).paddingBottom,10),l=(o-a)/(o/50);this.fullscreen.active?e.style.paddingBottom=null:this.media.style.transform=`translateY(-${l}%)`}else this.isHTML5&&e.classList.add(this.config.classNames.videoFixedRatio);return{padding:a,ratio:t}}function ML(n,e,t=.05){const i=n/e,r=IL(Object.keys(Yk),i);return Math.abs(r-i)<=t?Yk[r]:[n,e]}function h$(){const n=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),e=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);return[n,e]}const _u={getSources(){return this.isHTML5?Array.from(this.media.querySelectorAll("source")).filter(e=>{const t=e.getAttribute("type");return W.empty(t)?!0:Yn.mime.call(this,t)}):[]},getQualityOptions(){return this.config.quality.forced?this.config.quality.options:_u.getSources.call(this).map(n=>Number(n.getAttribute("size"))).filter(Boolean)},setup(){if(!this.isHTML5)return;const n=this;n.options.speed=n.config.speed.options,W.empty(this.config.ratio)||ep.call(n),Object.defineProperty(n.media,"quality",{get(){const t=_u.getSources.call(n).find(i=>i.getAttribute("src")===n.source);return t&&Number(t.getAttribute("size"))},set(e){if(n.quality!==e){if(n.config.quality.forced&&W.function(n.config.quality.onChange))n.config.quality.onChange(e);else{const i=_u.getSources.call(n).find(u=>Number(u.getAttribute("size"))===e);if(!i)return;const{currentTime:r,paused:s,preload:a,readyState:o,playbackRate:l}=n.media;n.media.src=i.getAttribute("src"),(a!=="none"||o)&&(n.once("loadedmetadata",()=>{n.speed=l,n.currentTime=r,s||ao(n.play())}),n.media.load())}vt.call(n,n.media,"qualitychange",!1,{quality:e})}}})},cancelRequests(){this.isHTML5&&(il(_u.getSources.call(this)),this.media.setAttribute("src",this.config.blankVideo),this.media.load(),this.debug.log("Cancelled network requests"))}},d$=!!window.document.documentMode,f$=/Edge/.test(navigator.userAgent),p$="WebkitAppearance"in document.documentElement.style&&!/Edge/.test(navigator.userAgent),m$=navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,g$=/iPad|iPhone|iPod/i.test(navigator.userAgent)&&navigator.maxTouchPoints>1,$i={isIE:d$,isEdge:f$,isWebKit:p$,isIPadOS:m$,isIos:g$};function v$(n){return`${n}-${Math.floor(Math.random()*1e4)}`}function zE(n,...e){return W.empty(n)?n:n.toString().replace(/\{(\d+)\}/g,(t,i)=>e[i].toString())}function y$(n,e){return n===0||e===0||Number.isNaN(n)||Number.isNaN(e)?0:(n/e*100).toFixed(2)}function pm(n="",e="",t=""){return n.replace(new RegExp(e.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),"g"),t.toString())}function FL(n=""){return n.toString().replace(/\w\S*/g,e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())}function b$(n=""){let e=n.toString();return e=pm(e,"-"," "),e=pm(e,"_"," "),e=FL(e),pm(e," ","")}function w$(n=""){let e=n.toString();return e=b$(e),e.charAt(0).toLowerCase()+e.slice(1)}function _$(n){const e=document.createDocumentFragment(),t=document.createElement("div");return e.appendChild(t),t.innerHTML=n,e.firstChild.textContent}function E$(n){const e=document.createElement("div");return e.appendChild(n),e.innerHTML}const Qk={pip:"PIP",airplay:"AirPlay",html5:"HTML5",vimeo:"Vimeo",youtube:"YouTube"},Di={get(n="",e={}){if(W.empty(n)||W.empty(e))return"";let t=PL(e.i18n,n);if(W.empty(t))return Object.keys(Qk).includes(n)?Qk[n]:"";const i={"{seektime}":e.seekTime,"{title}":e.title};return Object.entries(i).forEach(([r,s])=>{t=pm(t,r,s)}),t}};class Km{constructor(e){Ae(this,"get",e=>{if(!Km.supported||!this.enabled)return null;const t=window.localStorage.getItem(this.key);if(W.empty(t))return null;const i=JSON.parse(t);return W.string(e)&&e.length?i[e]:i});Ae(this,"set",e=>{if(!Km.supported||!this.enabled||!W.object(e))return;let t=this.get();W.empty(t)&&(t={}),Xn(t,e);try{window.localStorage.setItem(this.key,JSON.stringify(t))}catch{}});this.enabled=e.config.storage.enabled,this.key=e.config.storage.key}static get supported(){try{if(!("localStorage"in window))return!1;const e="___test";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch{return!1}}}function qv(n,e="text",t=!1){return new Promise((i,r)=>{try{const s=new XMLHttpRequest;if(!("withCredentials"in s))return;t&&(s.withCredentials=!0),s.addEventListener("load",()=>{if(e==="text")try{i(JSON.parse(s.responseText))}catch{i(s.responseText)}else i(s.response)}),s.addEventListener("error",()=>{throw new Error(s.status)}),s.open("GET",n,!0),s.responseType=e,s.send()}catch(s){r(s)}})}function BL(n,e){if(!W.string(n))return;const t="cache",i=W.string(e);let r=!1;const s=()=>document.getElementById(e)!==null,a=(o,l)=>{o.innerHTML=l,!(i&&s())&&document.body.insertAdjacentElement("afterbegin",o)};if(!i||!s()){const o=Km.supported,l=document.createElement("div");if(l.setAttribute("hidden",""),i&&l.setAttribute("id",e),o){const u=window.localStorage.getItem(`${t}-${e}`);if(r=u!==null,r){const h=JSON.parse(u);a(l,h.content)}}qv(n).then(u=>{if(!W.empty(u)){if(o)try{window.localStorage.setItem(`${t}-${e}`,JSON.stringify({content:u}))}catch{}a(l,u)}}).catch(()=>{})}}const jL=n=>Math.trunc(n/60/60%60,10),A$=n=>Math.trunc(n/60%60,10),x$=n=>Math.trunc(n%60,10);function Fw(n=0,e=!1,t=!1){if(!W.number(n))return Fw(void 0,e,t);const i=o=>`0${o}`.slice(-2);let r=jL(n);const s=A$(n),a=x$(n);return e||r>0?r=`${r}:`:r="",`${t&&n>0?"-":""}${r}${i(s)}:${i(a)}`}const Ze={getIconUrl(){const n=new URL(this.config.iconUrl,window.location),e=window.location.host?window.location.host:window.top.location.host,t=n.host!==e||$i.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:t}},findElements(){try{return this.elements.controls=ci.call(this,this.config.selectors.controls.wrapper),this.elements.buttons={play:Vm.call(this,this.config.selectors.buttons.play),pause:ci.call(this,this.config.selectors.buttons.pause),restart:ci.call(this,this.config.selectors.buttons.restart),rewind:ci.call(this,this.config.selectors.buttons.rewind),fastForward:ci.call(this,this.config.selectors.buttons.fastForward),mute:ci.call(this,this.config.selectors.buttons.mute),pip:ci.call(this,this.config.selectors.buttons.pip),airplay:ci.call(this,this.config.selectors.buttons.airplay),settings:ci.call(this,this.config.selectors.buttons.settings),captions:ci.call(this,this.config.selectors.buttons.captions),fullscreen:ci.call(this,this.config.selectors.buttons.fullscreen)},this.elements.progress=ci.call(this,this.config.selectors.progress),this.elements.inputs={seek:ci.call(this,this.config.selectors.inputs.seek),volume:ci.call(this,this.config.selectors.inputs.volume)},this.elements.display={buffer:ci.call(this,this.config.selectors.display.buffer),currentTime:ci.call(this,this.config.selectors.display.currentTime),duration:ci.call(this,this.config.selectors.display.duration)},W.element(this.elements.progress)&&(this.elements.display.seekTooltip=this.elements.progress.querySelector(`.${this.config.classNames.tooltip}`)),!0}catch(n){return this.debug.warn("It looks like there is a problem with your custom controls HTML",n),this.toggleNativeControls(!0),!1}},createIcon(n,e){const t="http://www.w3.org/2000/svg",i=Ze.getIconUrl.call(this),r=`${i.cors?"":i.url}#${this.config.iconPrefix}`,s=document.createElementNS(t,"svg");BE(s,Xn(e,{"aria-hidden":"true",focusable:"false"}));const a=document.createElementNS(t,"use"),o=`${r}-${n}`;return"href"in a&&a.setAttributeNS("http://www.w3.org/1999/xlink","href",o),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o),s.appendChild(a),s},createLabel(n,e={}){const t=Di.get(n,this.config),i={...e,class:[e.class,this.config.classNames.hidden].filter(Boolean).join(" ")};return gt("span",i,t)},createBadge(n){if(W.empty(n))return null;const e=gt("span",{class:this.config.classNames.menu.value});return e.appendChild(gt("span",{class:this.config.classNames.menu.badge},n)),e},createButton(n,e){const t=Xn({},e);let i=w$(n);const r={element:"button",toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};switch(["element","icon","label"].forEach(a=>{Object.keys(t).includes(a)&&(r[a]=t[a],delete t[a])}),r.element==="button"&&!Object.keys(t).includes("type")&&(t.type="button"),Object.keys(t).includes("class")?t.class.split(" ").includes(this.config.classNames.control)||Xn(t,{class:`${t.class} ${this.config.classNames.control}`}):t.class=this.config.classNames.control,n){case"play":r.toggle=!0,r.label="play",r.labelPressed="pause",r.icon="play",r.iconPressed="pause";break;case"mute":r.toggle=!0,r.label="mute",r.labelPressed="unmute",r.icon="volume",r.iconPressed="muted";break;case"captions":r.toggle=!0,r.label="enableCaptions",r.labelPressed="disableCaptions",r.icon="captions-off",r.iconPressed="captions-on";break;case"fullscreen":r.toggle=!0,r.label="enterFullscreen",r.labelPressed="exitFullscreen",r.icon="enter-fullscreen",r.iconPressed="exit-fullscreen";break;case"play-large":t.class+=` ${this.config.classNames.control}--overlaid`,i="play",r.label="play",r.icon="play";break;default:W.empty(r.label)&&(r.label=i),W.empty(r.icon)&&(r.icon=n)}const s=gt(r.element);return r.toggle?(s.appendChild(Ze.createIcon.call(this,r.iconPressed,{class:"icon--pressed"})),s.appendChild(Ze.createIcon.call(this,r.icon,{class:"icon--not-pressed"})),s.appendChild(Ze.createLabel.call(this,r.labelPressed,{class:"label--pressed"})),s.appendChild(Ze.createLabel.call(this,r.label,{class:"label--not-pressed"}))):(s.appendChild(Ze.createIcon.call(this,r.icon)),s.appendChild(Ze.createLabel.call(this,r.label))),Xn(t,Ba(this.config.selectors.buttons[i],t)),BE(s,t),i==="play"?(W.array(this.elements.buttons[i])||(this.elements.buttons[i]=[]),this.elements.buttons[i].push(s)):this.elements.buttons[i]=s,s},createRange(n,e){const t=gt("input",Xn(Ba(this.config.selectors.inputs[n]),{type:"range",min:0,max:100,step:.01,value:0,autocomplete:"off",role:"slider","aria-label":Di.get(n,this.config),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":0},e));return this.elements.inputs[n]=t,Ze.updateRangeFill.call(this,t),G6.setup(t),t},createProgress(n,e){const t=gt("progress",Xn(Ba(this.config.selectors.display[n]),{min:0,max:100,value:0,role:"progressbar","aria-hidden":!0},e));if(n!=="volume"){t.appendChild(gt("span",null,"0"));const i={played:"played",buffer:"buffered"}[n],r=i?Di.get(i,this.config):"";t.textContent=`% ${r.toLowerCase()}`}return this.elements.display[n]=t,t},createTime(n,e){const t=Ba(this.config.selectors.display[n],e),i=gt("div",Xn(t,{class:`${t.class?t.class:""} ${this.config.classNames.display.time} `.trim(),"aria-label":Di.get(n,this.config),role:"timer"}),"00:00");return this.elements.display[n]=i,i},bindMenuItemShortcuts(n,e){Vt.call(this,n,"keydown keyup",t=>{if(![" ","ArrowUp","ArrowDown","ArrowRight"].includes(t.key)||(t.preventDefault(),t.stopPropagation(),t.type==="keydown"))return;const i=oc(n,'[role="menuitemradio"]');if(!i&&[" ","ArrowRight"].includes(t.key))Ze.showMenuPanel.call(this,e,!0);else{let r;t.key!==" "&&(t.key==="ArrowDown"||i&&t.key==="ArrowRight"?(r=n.nextElementSibling,W.element(r)||(r=n.parentNode.firstElementChild)):(r=n.previousElementSibling,W.element(r)||(r=n.parentNode.lastElementChild)),a_.call(this,r,!0))}},!1),Vt.call(this,n,"keyup",t=>{t.key==="Return"&&Ze.focusFirstMenuItem.call(this,null,!0)})},createMenuItem({value:n,list:e,type:t,title:i,badge:r=null,checked:s=!1}){const a=Ba(this.config.selectors.inputs[t]),o=gt("button",Xn(a,{type:"button",role:"menuitemradio",class:`${this.config.classNames.control} ${a.class?a.class:""}`.trim(),"aria-checked":s,value:n})),l=gt("span");l.innerHTML=i,W.element(r)&&l.appendChild(r),o.appendChild(l),Object.defineProperty(o,"checked",{enumerable:!0,get(){return o.getAttribute("aria-checked")==="true"},set(u){u&&Array.from(o.parentNode.children).filter(h=>oc(h,'[role="menuitemradio"]')).forEach(h=>h.setAttribute("aria-checked","false")),o.setAttribute("aria-checked",u?"true":"false")}}),this.listeners.bind(o,"click keyup",u=>{if(!(W.keyboardEvent(u)&&u.key!==" ")){switch(u.preventDefault(),u.stopPropagation(),o.checked=!0,t){case"language":this.currentTrack=Number(n);break;case"quality":this.quality=n;break;case"speed":this.speed=Number.parseFloat(n);break}Ze.showMenuPanel.call(this,"home",W.keyboardEvent(u))}},t,!1),Ze.bindMenuItemShortcuts.call(this,o,t),e.appendChild(o)},formatTime(n=0,e=!1){if(!W.number(n))return n;const t=jL(this.duration)>0;return Fw(n,t,e)},updateTimeDisplay(n=null,e=0,t=!1){!W.element(n)||!W.number(e)||(n.textContent=Ze.formatTime(e,t))},updateVolume(){this.supported.ui&&(W.element(this.elements.inputs.volume)&&Ze.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume),W.element(this.elements.buttons.mute)&&(this.elements.buttons.mute.pressed=this.muted||this.volume===0))},setRange(n,e=0){W.element(n)&&(n.value=e,Ze.updateRangeFill.call(this,n))},updateProgress(n){if(!this.supported.ui||!W.event(n))return;let e=0;const t=(i,r)=>{const s=W.number(r)?r:0,a=W.element(i)?i:this.elements.display.buffer;if(W.element(a)){a.value=s;const o=a.getElementsByTagName("span")[0];W.element(o)&&(o.childNodes[0].nodeValue=s)}};if(n)switch(n.type){case"timeupdate":case"seeking":case"seeked":e=y$(this.currentTime,this.duration),n.type==="timeupdate"&&Ze.setRange.call(this,this.elements.inputs.seek,e);break;case"playing":case"progress":t(this.elements.display.buffer,this.buffered*100);break}},updateRangeFill(n){const e=W.event(n)?n.target:n;if(!(!W.element(e)||e.getAttribute("type")!=="range")){if(oc(e,this.config.selectors.inputs.seek)){e.setAttribute("aria-valuenow",this.currentTime);const t=Ze.formatTime(this.currentTime),i=Ze.formatTime(this.duration),r=Di.get("seekLabel",this.config);e.setAttribute("aria-valuetext",r.replace("{currentTime}",t).replace("{duration}",i))}else if(oc(e,this.config.selectors.inputs.volume)){const t=e.value*100;e.setAttribute("aria-valuenow",t),e.setAttribute("aria-valuetext",`${t.toFixed(1)}%`)}else e.setAttribute("aria-valuenow",e.value);!$i.isWebKit&&!$i.isIPadOS||e.style.setProperty("--value",`${e.value/e.max*100}%`)}},updateSeekTooltip(n){if(!this.config.tooltips.seek||!W.element(this.elements.inputs.seek)||!W.element(this.elements.display.seekTooltip)||this.duration===0)return;const e=this.elements.display.seekTooltip,t=`${this.config.classNames.tooltip}--visible`,i=l=>Jt(e,t,l);if(this.touch){i(!1);return}let r=0;const s=this.elements.progress.getBoundingClientRect();if(W.event(n)){const l=n.pageX-n.clientX;r=100/s.width*(n.pageX-s.left-l)}else if(kb(e,t))r=Number.parseFloat(e.style.left,10);else return;r<0?r=0:r>100&&(r=100);const a=this.duration/100*r;e.textContent=Ze.formatTime(a);const o=this.config.markers?.points?.find(({time:l})=>l===Math.round(a));o&&e.insertAdjacentHTML("afterbegin",`${o.label}<br>`),e.style.left=`${r}%`,W.event(n)&&["mouseenter","mouseleave"].includes(n.type)&&i(n.type==="mouseenter")},timeUpdate(n){const e=!W.element(this.elements.display.duration)&&this.config.invertTime;Ze.updateTimeDisplay.call(this,this.elements.display.currentTime,e?this.duration-this.currentTime:this.currentTime,e),!(n&&n.type==="timeupdate"&&this.media.seeking)&&Ze.updateProgress.call(this,n)},durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime)return;if(this.duration>=2**32){Ku(this.elements.display.currentTime,!0),Ku(this.elements.progress,!0);return}W.element(this.elements.inputs.seek)&&this.elements.inputs.seek.setAttribute("aria-valuemax",this.duration);const n=W.element(this.elements.display.duration);!n&&this.config.displayDuration&&this.paused&&Ze.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration),n&&Ze.updateTimeDisplay.call(this,this.elements.display.duration,this.duration),this.config.markers.enabled&&Ze.setMarkers.call(this),Ze.updateSeekTooltip.call(this)},toggleMenuButton(n,e){Ku(this.elements.settings.buttons[n],!e)},updateSetting(n,e,t){const i=this.elements.settings.panels[n];let r=null,s=e;if(n==="captions")r=this.currentTrack;else{if(r=W.empty(t)?this[n]:t,W.empty(r)&&(r=this.config[n].default),!W.empty(this.options[n])&&!this.options[n].includes(r)){this.debug.warn(`Unsupported value of '${r}' for ${n}`);return}if(!this.config[n].options.includes(r)){this.debug.warn(`Disabled value of '${r}' for ${n}`);return}}if(W.element(s)||(s=i&&i.querySelector('[role="menu"]')),!W.element(s))return;const a=this.elements.settings.buttons[n].querySelector(`.${this.config.classNames.menu.value}`);a.innerHTML=Ze.getLabel.call(this,n,r);const o=s&&s.querySelector(`[value="${r}"]`);W.element(o)&&(o.checked=!0)},getLabel(n,e){switch(n){case"speed":return e===1?Di.get("normal",this.config):`${e}&times;`;case"quality":if(W.number(e)){const t=Di.get(`qualityLabel.${e}`,this.config);return t.length?t:`${e}p`}return FL(e);case"captions":return Yt.getLabel.call(this);default:return null}},setQualityMenu(n){if(!W.element(this.elements.settings.panels.quality))return;const e="quality",t=this.elements.settings.panels.quality.querySelector('[role="menu"]');W.array(n)&&(this.options.quality=jE(n).filter(s=>this.config.quality.options.includes(s)));const i=!W.empty(this.options.quality)&&this.options.quality.length>1;if(Ze.toggleMenuButton.call(this,e,i),T0(t),Ze.checkMenu.call(this),!i)return;const r=s=>{const a=Di.get(`qualityBadge.${s}`,this.config);return a.length?Ze.createBadge.call(this,a):null};this.options.quality.sort((s,a)=>{const o=this.config.quality.options;return o.indexOf(s)>o.indexOf(a)?1:-1}).forEach(s=>{Ze.createMenuItem.call(this,{value:s,list:t,type:e,title:Ze.getLabel.call(this,"quality",s),badge:r(s)})}),Ze.updateSetting.call(this,e,t)},setCaptionsMenu(){if(!W.element(this.elements.settings.panels.captions))return;const n="captions",e=this.elements.settings.panels.captions.querySelector('[role="menu"]'),t=Yt.getTracks.call(this),i=!!t.length;if(Ze.toggleMenuButton.call(this,n,i),T0(e),Ze.checkMenu.call(this),!i)return;const r=t.map((s,a)=>({value:a,checked:this.captions.toggled&&this.currentTrack===a,title:Yt.getLabel.call(this,s),badge:s.language&&Ze.createBadge.call(this,s.language.toUpperCase()),list:e,type:"language"}));r.unshift({value:-1,checked:!this.captions.toggled,title:Di.get("disabled",this.config),list:e,type:"language"}),r.forEach(Ze.createMenuItem.bind(this)),Ze.updateSetting.call(this,n,e)},setSpeedMenu(){if(!W.element(this.elements.settings.panels.speed))return;const n="speed",e=this.elements.settings.panels.speed.querySelector('[role="menu"]');this.options.speed=this.options.speed.filter(i=>i>=this.minimumSpeed&&i<=this.maximumSpeed);const t=!W.empty(this.options.speed)&&this.options.speed.length>1;Ze.toggleMenuButton.call(this,n,t),T0(e),Ze.checkMenu.call(this),t&&(this.options.speed.forEach(i=>{Ze.createMenuItem.call(this,{value:i,list:e,type:n,title:Ze.getLabel.call(this,"speed",i)})}),Ze.updateSetting.call(this,n,e))},checkMenu(){const{buttons:n}=this.elements.settings,e=!W.empty(n)&&Object.values(n).some(t=>!t.hidden);Ku(this.elements.settings.menu,!e)},focusFirstMenuItem(n,e=!1){if(this.elements.settings.popup.hidden)return;let t=n;W.element(t)||(t=Object.values(this.elements.settings.panels).find(r=>!r.hidden));const i=t.querySelector('[role^="menuitem"]');a_.call(this,i,e)},toggleMenu(n){const{popup:e}=this.elements.settings,t=this.elements.buttons.settings;if(!W.element(e)||!W.element(t))return;const{hidden:i}=e;let r=i;if(W.boolean(n))r=n;else if(W.keyboardEvent(n)&&n.key==="Escape")r=!1;else if(W.event(n)){const s=W.function(n.composedPath)?n.composedPath()[0]:n.target,a=e.contains(s);if(a||!a&&n.target!==t&&r)return}t.setAttribute("aria-expanded",r),Ku(e,!r),Jt(this.elements.container,this.config.classNames.menu.open,r),r&&W.keyboardEvent(n)?Ze.focusFirstMenuItem.call(this,null,!0):!r&&!i&&a_.call(this,t,W.keyboardEvent(n))},getMenuSize(n){const e=n.cloneNode(!0);e.style.position="absolute",e.style.opacity=0,e.removeAttribute("hidden"),n.parentNode.appendChild(e);const t=e.scrollWidth,i=e.scrollHeight;return il(e),{width:t,height:i}},showMenuPanel(n="",e=!1){const t=this.elements.container.querySelector(`#plyr-settings-${this.id}-${n}`);if(!W.element(t))return;const i=t.parentNode,r=Array.from(i.children).find(s=>!s.hidden);if(Yn.transitions&&!Yn.reducedMotion){i.style.width=`${r.scrollWidth}px`,i.style.height=`${r.scrollHeight}px`;const s=Ze.getMenuSize.call(this,t),a=o=>{o.target!==i||!["width","height"].includes(o.propertyName)||(i.style.width="",i.style.height="",Mw.call(this,i,FE,a))};Vt.call(this,i,FE,a),i.style.width=`${s.width}px`,i.style.height=`${s.height}px`}Ku(r,!0),Ku(t,!1),Ze.focusFirstMenuItem.call(this,t,e)},setDownloadUrl(){const n=this.elements.buttons.download;W.element(n)&&n.setAttribute("href",this.download)},create(n){const{bindMenuItemShortcuts:e,createButton:t,createProgress:i,createRange:r,createTime:s,setQualityMenu:a,setSpeedMenu:o,showMenuPanel:l}=Ze;this.elements.controls=null,W.array(this.config.controls)&&this.config.controls.includes("play-large")&&this.elements.container.appendChild(t.call(this,"play-large"));const u=gt("div",Ba(this.config.selectors.controls.wrapper));this.elements.controls=u;const h={class:"plyr__controls__item"};return jE(W.array(this.config.controls)?this.config.controls:[]).forEach(d=>{if(d==="restart"&&u.appendChild(t.call(this,"restart",h)),d==="rewind"&&u.appendChild(t.call(this,"rewind",h)),d==="play"&&u.appendChild(t.call(this,"play",h)),d==="fast-forward"&&u.appendChild(t.call(this,"fast-forward",h)),d==="progress"){const f=gt("div",{class:`${h.class} plyr__progress__container`}),m=gt("div",Ba(this.config.selectors.progress));if(m.appendChild(r.call(this,"seek",{id:`plyr-seek-${n.id}`})),m.appendChild(i.call(this,"buffer")),this.config.tooltips.seek){const b=gt("span",{class:this.config.classNames.tooltip},"00:00");m.appendChild(b),this.elements.display.seekTooltip=b}this.elements.progress=m,f.appendChild(this.elements.progress),u.appendChild(f)}if(d==="current-time"&&u.appendChild(s.call(this,"currentTime",h)),d==="duration"&&u.appendChild(s.call(this,"duration",h)),d==="mute"||d==="volume"){let{volume:f}=this.elements;if((!W.element(f)||!u.contains(f))&&(f=gt("div",Xn({},h,{class:`${h.class} plyr__volume`.trim()})),this.elements.volume=f,u.appendChild(f)),d==="mute"&&f.appendChild(t.call(this,"mute")),d==="volume"&&!$i.isIos&&!$i.isIPadOS){const m={max:1,step:.05,value:this.config.volume};f.appendChild(r.call(this,"volume",Xn(m,{id:`plyr-volume-${n.id}`})))}}if(d==="captions"&&u.appendChild(t.call(this,"captions",h)),d==="settings"&&!W.empty(this.config.settings)){const f=gt("div",Xn({},h,{class:`${h.class} plyr__menu`.trim(),hidden:""}));f.appendChild(t.call(this,"settings",{"aria-haspopup":!0,"aria-controls":`plyr-settings-${n.id}`,"aria-expanded":!1}));const m=gt("div",{class:"plyr__menu__container",id:`plyr-settings-${n.id}`,hidden:""}),b=gt("div"),_=gt("div",{id:`plyr-settings-${n.id}-home`}),w=gt("div",{role:"menu"});_.appendChild(w),b.appendChild(_),this.elements.settings.panels.home=_,this.config.settings.forEach(v=>{const y=gt("button",Xn(Ba(this.config.selectors.buttons.settings),{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--forward`,role:"menuitem","aria-haspopup":!0,hidden:""}));e.call(this,y,v),Vt.call(this,y,"click",()=>{l.call(this,v,!1)});const E=gt("span",null,Di.get(v,this.config)),k=gt("span",{class:this.config.classNames.menu.value});k.innerHTML=n[v],E.appendChild(k),y.appendChild(E),w.appendChild(y);const S=gt("div",{id:`plyr-settings-${n.id}-${v}`,hidden:""}),D=gt("button",{type:"button",class:`${this.config.classNames.control} ${this.config.classNames.control}--back`});D.appendChild(gt("span",{"aria-hidden":!0},Di.get(v,this.config))),D.appendChild(gt("span",{class:this.config.classNames.hidden},Di.get("menuBack",this.config))),Vt.call(this,S,"keydown",P=>{P.key==="ArrowLeft"&&(P.preventDefault(),P.stopPropagation(),l.call(this,"home",!0))},!1),Vt.call(this,D,"click",()=>{l.call(this,"home",!1)}),S.appendChild(D),S.appendChild(gt("div",{role:"menu"})),b.appendChild(S),this.elements.settings.buttons[v]=y,this.elements.settings.panels[v]=S}),m.appendChild(b),f.appendChild(m),u.appendChild(f),this.elements.settings.popup=m,this.elements.settings.menu=f}if(d==="pip"&&Yn.pip&&u.appendChild(t.call(this,"pip",h)),d==="airplay"&&Yn.airplay&&u.appendChild(t.call(this,"airplay",h)),d==="download"){const f=Xn({},h,{element:"a",href:this.download,target:"_blank"});this.isHTML5&&(f.download="");const{download:m}=this.config.urls;!W.url(m)&&this.isEmbed&&Xn(f,{icon:`logo-${this.provider}`,label:this.provider}),u.appendChild(t.call(this,"download",f))}d==="fullscreen"&&u.appendChild(t.call(this,"fullscreen",h))}),this.isHTML5&&a.call(this,_u.getQualityOptions.call(this)),o.call(this),u},inject(){if(this.config.loadSprite){const a=Ze.getIconUrl.call(this);a.cors&&BL(a.url,"sprite-plyr")}this.id=Math.floor(Math.random()*1e4);let n=null;this.elements.controls=null;const e={id:this.id,seektime:this.config.seekTime,title:this.config.title};let t=!0;W.function(this.config.controls)&&(this.config.controls=this.config.controls.call(this,e)),this.config.controls||(this.config.controls=[]),W.element(this.config.controls)||W.string(this.config.controls)?n=this.config.controls:(n=Ze.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:Yt.getLabel.call(this)}),t=!1);const i=a=>{let o=a;return Object.entries(e).forEach(([l,u])=>{o=pm(o,`{${l}}`,u)}),o};t&&W.string(this.config.controls)&&(n=i(n));let r;W.string(this.config.selectors.controls.container)&&(r=document.querySelector(this.config.selectors.controls.container)),W.element(r)||(r=this.elements.container);const s=W.element(n)?"insertAdjacentElement":"insertAdjacentHTML";if(r[s]("afterbegin",n),W.element(this.elements.controls)||Ze.findElements.call(this),!W.empty(this.elements.buttons)){const a=o=>{const l=this.config.classNames.controlPressed;o.setAttribute("aria-pressed","false"),Object.defineProperty(o,"pressed",{configurable:!0,enumerable:!0,get(){return kb(o,l)},set(u=!1){Jt(o,l,u),o.setAttribute("aria-pressed",u?"true":"false")}})};Object.values(this.elements.buttons).filter(Boolean).forEach(o=>{W.array(o)||W.nodeList(o)?Array.from(o).filter(Boolean).forEach(a):a(o)})}if($i.isEdge&&RL(r),this.config.tooltips.controls){const{classNames:a,selectors:o}=this.config,l=`${o.controls.wrapper} ${o.labels} .${a.hidden}`,u=Vm.call(this,l);Array.from(u).forEach(h=>{Jt(h,this.config.classNames.hidden,!1),Jt(h,this.config.classNames.tooltip,!0)})}},setMediaMetadata(){try{"mediaSession"in navigator&&(navigator.mediaSession.metadata=new window.MediaMetadata({title:this.config.mediaMetadata.title,artist:this.config.mediaMetadata.artist,album:this.config.mediaMetadata.album,artwork:this.config.mediaMetadata.artwork}))}catch{}},setMarkers(){if(!this.duration||this.elements.markers)return;const n=this.config.markers?.points?.filter(({time:a})=>a>0&&a<this.duration);if(!n?.length)return;const e=document.createDocumentFragment(),t=document.createDocumentFragment();let i=null;const r=`${this.config.classNames.tooltip}--visible`,s=a=>Jt(i,r,a);n.forEach(a=>{const o=gt("span",{class:this.config.classNames.marker},""),l=`${a.time/this.duration*100}%`;i&&(o.addEventListener("mouseenter",()=>{a.label||(i.style.left=l,i.innerHTML=a.label,s(!0))}),o.addEventListener("mouseleave",()=>{s(!1)})),o.addEventListener("click",()=>{this.currentTime=a.time}),o.style.left=l,t.appendChild(o)}),e.appendChild(t),this.config.tooltips.seek||(i=gt("span",{class:this.config.classNames.tooltip},""),e.appendChild(i)),this.elements.markers={points:t,tip:i},this.elements.progress.appendChild(e)}};function zL(n,e=!0){let t=n;if(e){const i=document.createElement("a");i.href=t,t=i.href}try{return new URL(t)}catch{return null}}function UL(n){const e=new URLSearchParams;return W.object(n)&&Object.entries(n).forEach(([t,i])=>{e.set(t,i)}),e}const Yt={setup(){if(!this.supported.ui)return;if(!this.isVideo||this.isYouTube||this.isHTML5&&!Yn.textTracks){W.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ze.setCaptionsMenu.call(this);return}if(W.element(this.elements.captions)||(this.elements.captions=gt("div",Ba(this.config.selectors.captions)),this.elements.captions.setAttribute("dir","auto"),a$(this.elements.captions,this.elements.wrapper)),$i.isIE&&window.URL){const r=this.media.querySelectorAll("track");Array.from(r).forEach(s=>{const a=s.getAttribute("src"),o=zL(a);o!==null&&o.hostname!==window.location.href.hostname&&["http:","https:"].includes(o.protocol)&&qv(a,"blob").then(l=>{s.setAttribute("src",window.URL.createObjectURL(l))}).catch(()=>{il(s)})})}const n=navigator.languages||[navigator.language||navigator.userLanguage||"en"],e=jE(n.map(r=>r.split("-")[0]));let t=(this.storage.get("language")||this.captions.language||this.config.captions.language||"auto").toLowerCase();t==="auto"&&([t]=e);let i=this.storage.get("captions")||this.captions.active;if(W.boolean(i)||({active:i}=this.config.captions),Object.assign(this.captions,{toggled:!1,active:i,language:t,languages:e}),this.isHTML5){const r=this.config.captions.update?"addtrack removetrack":"removetrack";Vt.call(this,this.media.textTracks,r,Yt.update.bind(this))}setTimeout(Yt.update.bind(this),0)},update(){const n=Yt.getTracks.call(this,!0),{active:e,language:t,meta:i,currentTrackNode:r}=this.captions,s=!!n.find(a=>a.language===t);this.isHTML5&&this.isVideo&&n.filter(a=>!i.get(a)).forEach(a=>{this.debug.log("Track added",a),i.set(a,{default:a.mode==="showing"}),a.mode==="showing"&&(a.mode="hidden"),Vt.call(this,a,"cuechange",()=>Yt.updateCues.call(this))}),(s&&this.language!==t||!n.includes(r))&&(Yt.setLanguage.call(this,t),Yt.toggle.call(this,e&&s)),this.elements&&Jt(this.elements.container,this.config.classNames.captions.enabled,!W.empty(n)),W.array(this.config.controls)&&this.config.controls.includes("settings")&&this.config.settings.includes("captions")&&Ze.setCaptionsMenu.call(this)},toggle(n,e=!0){if(!this.supported.ui)return;const{toggled:t}=this.captions,i=this.config.classNames.captions.active,r=W.nullOrUndefined(n)?!t:n;if(r!==t){if(e||(this.captions.active=r,this.storage.set({captions:r})),!this.language&&r&&!e){const s=Yt.getTracks.call(this),a=Yt.findTrack.call(this,[this.captions.language,...this.captions.languages],!0);this.captions.language=a.language,Yt.set.call(this,s.indexOf(a));return}this.elements.buttons.captions&&(this.elements.buttons.captions.pressed=r),Jt(this.elements.container,i,r),this.captions.toggled=r,Ze.updateSetting.call(this,"captions"),vt.call(this,this.media,r?"captionsenabled":"captionsdisabled")}setTimeout(()=>{r&&this.captions.toggled&&(this.captions.currentTrackNode.mode="hidden")})},set(n,e=!0){const t=Yt.getTracks.call(this);if(n===-1){Yt.toggle.call(this,!1,e);return}if(!W.number(n)){this.debug.warn("Invalid caption argument",n);return}if(!(n in t)){this.debug.warn("Track not found",n);return}if(this.captions.currentTrack!==n){this.captions.currentTrack=n;const i=t[n],{language:r}=i||{};this.captions.currentTrackNode=i,Ze.updateSetting.call(this,"captions"),e||(this.captions.language=r,this.storage.set({language:r})),this.isVimeo&&this.embed.enableTextTrack(r),vt.call(this,this.media,"languagechange")}Yt.toggle.call(this,!0,e),this.isHTML5&&this.isVideo&&Yt.updateCues.call(this)},setLanguage(n,e=!0){if(!W.string(n)){this.debug.warn("Invalid language argument",n);return}const t=n.toLowerCase();this.captions.language=t;const i=Yt.getTracks.call(this),r=Yt.findTrack.call(this,[t]);Yt.set.call(this,i.indexOf(r),e)},getTracks(n=!1){return Array.from((this.media||{}).textTracks||[]).filter(t=>!this.isHTML5||n||this.captions.meta.has(t)).filter(t=>["captions","subtitles"].includes(t.kind))},findTrack(n,e=!1){const t=Yt.getTracks.call(this),i=a=>Number((this.captions.meta.get(a)||{}).default),r=Array.from(t).sort((a,o)=>i(o)-i(a));let s;return n.every(a=>(s=r.find(o=>o.language===a),!s)),s||(e?r[0]:void 0)},getCurrentTrack(){return Yt.getTracks.call(this)[this.currentTrack]},getLabel(n){let e=n;return!W.track(e)&&Yn.textTracks&&this.captions.toggled&&(e=Yt.getCurrentTrack.call(this)),W.track(e)?W.empty(e.label)?W.empty(e.language)?Di.get("enabled",this.config):n.language.toUpperCase():e.label:Di.get("disabled",this.config)},updateCues(n){if(!this.supported.ui)return;if(!W.element(this.elements.captions)){this.debug.warn("No captions element to render to");return}if(!W.nullOrUndefined(n)&&!Array.isArray(n)){this.debug.warn("updateCues: Invalid input",n);return}let e=n;if(!e){const r=Yt.getCurrentTrack.call(this);e=Array.from((r||{}).activeCues||[]).map(s=>s.getCueAsHTML()).map(E$)}const t=e.map(r=>r.trim()).join(`
`);if(t!==this.elements.captions.innerHTML){T0(this.elements.captions);const r=gt("span",Ba(this.config.selectors.caption));r.innerHTML=t,this.elements.captions.appendChild(r),vt.call(this,this.media,"cuechange")}}},$L={enabled:!0,title:"",debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:null,clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:"plyr",iconUrl:"https://cdn.plyr.io/3.8.3/plyr.svg",blankVideo:"https://cdn.plyr.io/static/blank.mp4",quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240],forced:!1,onChange:null},loop:{active:!1},speed:{selected:1,options:[.5,.75,1,1.25,1.5,1.75,2,4]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:"auto",update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:"plyr"},controls:["play-large","play","progress","current-time","mute","volume","captions","settings","pip","airplay","fullscreen"],settings:["captions","quality","speed"],i18n:{restart:"Restart",rewind:"Rewind {seektime}s",play:"Play",pause:"Pause",fastForward:"Forward {seektime}s",seek:"Seek",seekLabel:"{currentTime} of {duration}",played:"Played",buffered:"Buffered",currentTime:"Current time",duration:"Duration",volume:"Volume",mute:"Mute",unmute:"Unmute",enableCaptions:"Enable captions",disableCaptions:"Disable captions",download:"Download",enterFullscreen:"Enter fullscreen",exitFullscreen:"Exit fullscreen",frameTitle:"Player for {title}",captions:"Captions",settings:"Settings",pip:"PIP",menuBack:"Go back to previous menu",speed:"Speed",normal:"Normal",quality:"Quality",loop:"Loop",start:"Start",end:"End",all:"All",reset:"Reset",disabled:"Disabled",enabled:"Enabled",advertisement:"Ad",qualityBadge:{2160:"4K",1440:"HD",1080:"HD",720:"HD",576:"SD",480:"SD"}},urls:{download:null,vimeo:{sdk:"https://player.vimeo.com/api/player.js",iframe:"https://player.vimeo.com/video/{0}?{1}",api:"https://vimeo.com/api/oembed.json?url={0}"},youtube:{sdk:"https://www.youtube.com/iframe_api",api:"https://noembed.com/embed?url=https://www.youtube.com/watch?v={0}"},googleIMA:{sdk:"https://imasdk.googleapis.com/js/sdkloader/ima3.js"}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,download:null,fullscreen:null,pip:null,airplay:null,speed:null,quality:null,loop:null,language:null},events:["ended","progress","stalled","playing","waiting","canplay","canplaythrough","loadstart","loadeddata","loadedmetadata","timeupdate","volumechange","play","pause","error","seeking","seeked","emptied","ratechange","cuechange","download","enterfullscreen","exitfullscreen","captionsenabled","captionsdisabled","languagechange","controlshidden","controlsshown","ready","statechange","qualitychange","adsloaded","adscontentpause","adscontentresume","adstarted","adsmidpoint","adscomplete","adsallcomplete","adsimpression","adsclick"],selectors:{editable:"input, textarea, select, [contenteditable]",container:".plyr",controls:{container:null,wrapper:".plyr__controls"},labels:"[data-plyr]",buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',download:'[data-plyr="download"]',fullscreen:'[data-plyr="fullscreen"]',pip:'[data-plyr="pip"]',airplay:'[data-plyr="airplay"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:".plyr__time--current",duration:".plyr__time--duration",buffer:".plyr__progress__buffer",loop:".plyr__progress__loop",volume:".plyr__volume--display"},progress:".plyr__progress",captions:".plyr__captions",caption:".plyr__caption"},classNames:{type:"plyr--{0}",provider:"plyr--{0}",video:"plyr__video-wrapper",embed:"plyr__video-embed",videoFixedRatio:"plyr__video-wrapper--fixed-ratio",embedContainer:"plyr__video-embed__container",poster:"plyr__poster",posterEnabled:"plyr__poster-enabled",ads:"plyr__ads",control:"plyr__control",controlPressed:"plyr__control--pressed",playing:"plyr--playing",paused:"plyr--paused",stopped:"plyr--stopped",loading:"plyr--loading",hover:"plyr--hover",tooltip:"plyr__tooltip",cues:"plyr__cues",marker:"plyr__progress__marker",hidden:"plyr__sr-only",hideControls:"plyr--hide-controls",isTouch:"plyr--is-touch",uiSupported:"plyr--full-ui",noTransition:"plyr--no-transition",display:{time:"plyr__time"},menu:{value:"plyr__menu__value",badge:"plyr__badge",open:"plyr--menu-open"},captions:{enabled:"plyr--captions-enabled",active:"plyr--captions-active"},fullscreen:{enabled:"plyr--fullscreen-enabled",fallback:"plyr--fullscreen-fallback"},pip:{supported:"plyr--pip-supported",active:"plyr--pip-active"},airplay:{supported:"plyr--airplay-supported",active:"plyr--airplay-active"},previewThumbnails:{thumbContainer:"plyr__preview-thumb",thumbContainerShown:"plyr__preview-thumb--is-shown",imageContainer:"plyr__preview-thumb__image-container",timeContainer:"plyr__preview-thumb__time-container",scrubbingContainer:"plyr__preview-scrubbing",scrubbingContainerShown:"plyr__preview-scrubbing--is-shown"}},attributes:{embed:{provider:"data-plyr-provider",id:"data-plyr-embed-id",hash:"data-plyr-embed-hash"}},ads:{enabled:!1,publisherId:"",tagUrl:""},previewThumbnails:{enabled:!1,src:"",withCredentials:!1},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1,customControls:!0,referrerPolicy:null,premium:!1},youtube:{rel:0,showinfo:0,iv_load_policy:3,modestbranding:1,customControls:!0,noCookie:!1},mediaMetadata:{title:"",artist:"",album:"",artwork:[]},markers:{enabled:!1,points:[]}},o_={active:"picture-in-picture",inactive:"inline"},Ol={html5:"html5",youtube:"youtube",vimeo:"vimeo"},l_={audio:"audio",video:"video"};function S$(n){return/^(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(n)?Ol.youtube:/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(n)?Ol.vimeo:null}function u_(){}class C${constructor(e=!1){this.enabled=window.console&&e,this.enabled&&this.log("Debugging enabled")}get log(){return this.enabled?Function.prototype.bind.call(console.log,console):u_}get warn(){return this.enabled?Function.prototype.bind.call(console.warn,console):u_}get error(){return this.enabled?Function.prototype.bind.call(console.error,console):u_}}class Qs{constructor(e){Ae(this,"onChange",()=>{if(!this.supported)return;const e=this.player.elements.buttons.fullscreen;W.element(e)&&(e.pressed=this.active);const t=this.target===this.player.media?this.target:this.player.elements.container;vt.call(this.player,t,this.active?"enterfullscreen":"exitfullscreen",!0)});Ae(this,"toggleFallback",(e=!1)=>{if(e?this.scrollPosition={x:window.scrollX??0,y:window.scrollY??0}:window.scrollTo(this.scrollPosition.x,this.scrollPosition.y),document.body.style.overflow=e?"hidden":"",Jt(this.target,this.player.config.classNames.fullscreen.fallback,e),$i.isIos){let t=document.head.querySelector('meta[name="viewport"]');const i="viewport-fit=cover";t||(t=document.createElement("meta"),t.setAttribute("name","viewport"));const r=W.string(t.content)&&t.content.includes(i);e?(this.cleanupViewport=!r,r||(t.content+=`,${i}`)):this.cleanupViewport&&(t.content=t.content.split(",").filter(s=>s.trim()!==i).join(","))}this.onChange()});Ae(this,"trapFocus",e=>{if($i.isIos||$i.isIPadOS||!this.active||e.key!=="Tab")return;const t=document.activeElement,i=Vm.call(this.player,"a[href], button:not(:disabled), input:not(:disabled), [tabindex]"),[r]=i,s=i[i.length-1];t===s&&!e.shiftKey?(r.focus(),e.preventDefault()):t===r&&e.shiftKey&&(s.focus(),e.preventDefault())});Ae(this,"update",()=>{if(this.supported){let e;this.forceFallback?e="Fallback (forced)":Qs.nativeSupported?e="Native":e="Fallback",this.player.debug.log(`${e} fullscreen enabled`)}else this.player.debug.log("Fullscreen not supported and fallback disabled");Jt(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.supported)});Ae(this,"enter",()=>{this.supported&&($i.isIos&&this.player.config.fullscreen.iosNative?this.player.isVimeo?this.player.embed.requestFullscreen():this.target.webkitEnterFullscreen():!Qs.nativeSupported||this.forceFallback?this.toggleFallback(!0):this.prefix?W.empty(this.prefix)||this.target[`${this.prefix}Request${this.property}`]():this.target.requestFullscreen({navigationUI:"hide"}))});Ae(this,"exit",()=>{if(this.supported){if($i.isIos&&this.player.config.fullscreen.iosNative)this.player.isVimeo?this.player.embed.exitFullscreen():this.target.webkitEnterFullscreen(),ao(this.player.play());else if(!Qs.nativeSupported||this.forceFallback)this.toggleFallback(!1);else if(!this.prefix)(document.cancelFullScreen||document.exitFullscreen).call(document);else if(!W.empty(this.prefix)){const e=this.prefix==="moz"?"Cancel":"Exit";document[`${this.prefix}${e}${this.property}`]()}}});Ae(this,"toggle",()=>{this.active?this.exit():this.enter()});this.player=e,this.prefix=Qs.prefix,this.property=Qs.property,this.scrollPosition={x:0,y:0},this.forceFallback=e.config.fullscreen.fallback==="force",this.player.elements.fullscreen=e.config.fullscreen.container&&o$(this.player.elements.container,e.config.fullscreen.container),Vt.call(this.player,document,this.prefix==="ms"?"MSFullscreenChange":`${this.prefix}fullscreenchange`,()=>{this.onChange()}),Vt.call(this.player,this.player.elements.container,"dblclick",t=>{W.element(this.player.elements.controls)&&this.player.elements.controls.contains(t.target)||this.player.listeners.proxy(t,this.toggle,"fullscreen")}),Vt.call(this,this.player.elements.container,"keydown",t=>this.trapFocus(t)),this.update()}static get nativeSupported(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}get useNative(){return Qs.nativeSupported&&!this.forceFallback}static get prefix(){if(W.function(document.exitFullscreen))return"";let e="";return["webkit","moz","ms"].some(i=>W.function(document[`${i}ExitFullscreen`])||W.function(document[`${i}CancelFullScreen`])?(e=i,!0):!1),e}static get property(){return this.prefix==="moz"?"FullScreen":"Fullscreen"}get supported(){return[this.player.config.fullscreen.enabled,this.player.isVideo,Qs.nativeSupported||this.player.config.fullscreen.fallback,!this.player.isYouTube||Qs.nativeSupported||!$i.isIos||this.player.config.playsinline&&!this.player.config.fullscreen.iosNative].every(Boolean)}get active(){if(!this.supported)return!1;if(!Qs.nativeSupported||this.forceFallback)return kb(this.target,this.player.config.classNames.fullscreen.fallback);const e=this.prefix?this.target.getRootNode()[`${this.prefix}${this.property}Element`]:this.target.getRootNode().fullscreenElement;return e&&e.shadowRoot?e===this.target.getRootNode().host:e===this.target}get target(){return $i.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.fullscreen??this.player.elements.container}}function D0(n,e=1){return new Promise((t,i)=>{const r=new Image,s=()=>{delete r.onload,delete r.onerror,(r.naturalWidth>=e?t:i)(r)};Object.assign(r,{onload:s,onerror:s,src:n})})}const un={addStyleHook(){Jt(this.elements.container,this.config.selectors.container.replace(".",""),!0),Jt(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls(n=!1){n&&this.isHTML5?this.media.setAttribute("controls",""):this.media.removeAttribute("controls")},build(){if(this.listeners.media(),!this.supported.ui){this.debug.warn(`Basic support only for ${this.provider} ${this.type}`),un.toggleNativeControls.call(this,!0);return}W.element(this.elements.controls)||(Ze.inject.call(this),this.listeners.controls()),un.toggleNativeControls.call(this),this.isHTML5&&Yt.setup.call(this),this.volume=null,this.muted=null,this.loop=null,this.quality=null,this.speed=null,Ze.updateVolume.call(this),Ze.timeUpdate.call(this),Ze.durationUpdate.call(this),un.checkPlaying.call(this),Jt(this.elements.container,this.config.classNames.pip.supported,Yn.pip&&this.isHTML5&&this.isVideo),Jt(this.elements.container,this.config.classNames.airplay.supported,Yn.airplay&&this.isHTML5),Jt(this.elements.container,this.config.classNames.isTouch,this.touch),this.ready=!0,setTimeout(()=>{vt.call(this,this.media,"ready")},0),un.setTitle.call(this),this.poster&&un.setPoster.call(this,this.poster,!1).catch(()=>{}),this.config.duration&&Ze.durationUpdate.call(this),this.config.mediaMetadata&&Ze.setMediaMetadata.call(this)},setTitle(){let n=Di.get("play",this.config);if(W.string(this.config.title)&&!W.empty(this.config.title)&&(n+=`, ${this.config.title}`),Array.from(this.elements.buttons.play||[]).forEach(e=>{e.setAttribute("aria-label",n)}),this.isEmbed){const e=ci.call(this,"iframe");if(!W.element(e))return;const t=W.empty(this.config.title)?"video":this.config.title,i=Di.get("frameTitle",this.config);e.setAttribute("title",i.replace("{title}",t))}},togglePoster(n){Jt(this.elements.container,this.config.classNames.posterEnabled,n)},setPoster(n,e=!0){return e&&this.poster?Promise.reject(new Error("Poster already set")):(this.media.setAttribute("data-poster",n),this.elements.poster.removeAttribute("hidden"),c$.call(this).then(()=>D0(n)).catch(t=>{throw n===this.poster&&un.togglePoster.call(this,!1),t}).then(()=>{if(n!==this.poster)throw new Error("setPoster cancelled by later call to setPoster")}).then(()=>(Object.assign(this.elements.poster.style,{backgroundImage:`url('${n}')`,backgroundSize:""}),un.togglePoster.call(this,!0),n)))},checkPlaying(n){Jt(this.elements.container,this.config.classNames.playing,this.playing),Jt(this.elements.container,this.config.classNames.paused,this.paused),Jt(this.elements.container,this.config.classNames.stopped,this.stopped),Array.from(this.elements.buttons.play||[]).forEach(e=>{Object.assign(e,{pressed:this.playing}),e.setAttribute("aria-label",Di.get(this.playing?"pause":"play",this.config))}),!(W.event(n)&&n.type==="timeupdate")&&un.toggleControls.call(this)},checkLoading(n){this.loading=["stalled","waiting"].includes(n.type),clearTimeout(this.timers.loading),this.timers.loading=setTimeout(()=>{Jt(this.elements.container,this.config.classNames.loading,this.loading),un.toggleControls.call(this)},this.loading?250:0)},toggleControls(n){const{controls:e}=this.elements;if(e&&this.config.hideControls){const t=this.touch&&this.lastSeekTime+2e3>Date.now();this.toggleControls(!!(n||this.loading||this.paused||e.pressed||e.hover||t))}},migrateStyles(){Object.values({...this.media.style}).filter(n=>!W.empty(n)&&W.string(n)&&n.startsWith("--plyr")).forEach(n=>{this.elements.container.style.setProperty(n,this.media.style.getPropertyValue(n)),this.media.style.removeProperty(n)}),W.empty(this.media.style)&&this.media.removeAttribute("style")}};class k${constructor(e){Ae(this,"firstTouch",()=>{const{player:e}=this,{elements:t}=e;e.touch=!0,Jt(t.container,e.config.classNames.isTouch,!0)});Ae(this,"global",(e=!0)=>{const{player:t}=this;t.config.keyboard.global&&Gm.call(t,window,"keydown keyup",this.handleKey,e,!1),Gm.call(t,document.body,"click",this.toggleMenu,e),Dx.call(t,document.body,"touchstart",this.firstTouch)});Ae(this,"container",()=>{const{player:e}=this,{config:t,elements:i,timers:r}=e;!t.keyboard.global&&t.keyboard.focused&&Vt.call(e,i.container,"keydown keyup",this.handleKey,!1),Vt.call(e,i.container,"mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen",o=>{const{controls:l}=i;l&&o.type==="enterfullscreen"&&(l.pressed=!1,l.hover=!1);const u=["touchstart","touchmove","mousemove"].includes(o.type);let h=0;u&&(un.toggleControls.call(e,!0),h=e.touch?3e3:2e3),clearTimeout(r.controls),r.controls=setTimeout(()=>un.toggleControls.call(e,!1),h)});const s=()=>{if(!e.isVimeo||e.config.vimeo.premium)return;const o=i.wrapper,{active:l}=e.fullscreen,[u,h]=Rx.call(e),d=LL(`aspect-ratio: ${u} / ${h}`);if(!l){d?(o.style.width=null,o.style.height=null):(o.style.maxWidth=null,o.style.margin=null);return}const[f,m]=h$(),b=f/m>u/h;d?(o.style.width=b?"auto":"100%",o.style.height=b?"100%":"auto"):(o.style.maxWidth=b?`${m/h*u}px`:null,o.style.margin=b?"0 auto":null)},a=()=>{clearTimeout(r.resized),r.resized=setTimeout(s,50)};Vt.call(e,i.container,"enterfullscreen exitfullscreen",o=>{const{target:l}=e.fullscreen;if(l!==i.container||!e.isEmbed&&W.empty(e.config.ratio))return;s(),(o.type==="enterfullscreen"?Vt:Mw).call(e,window,"resize",a)})});Ae(this,"media",()=>{const{player:e}=this,{elements:t}=e;if(Vt.call(e,e.media,"timeupdate seeking seeked",r=>Ze.timeUpdate.call(e,r)),Vt.call(e,e.media,"durationchange loadeddata loadedmetadata",r=>Ze.durationUpdate.call(e,r)),Vt.call(e,e.media,"ended",()=>{e.isHTML5&&e.isVideo&&e.config.resetOnEnd&&(e.restart(),e.pause())}),Vt.call(e,e.media,"progress playing seeking seeked",r=>Ze.updateProgress.call(e,r)),Vt.call(e,e.media,"volumechange",r=>Ze.updateVolume.call(e,r)),Vt.call(e,e.media,"playing play pause ended emptied timeupdate",r=>un.checkPlaying.call(e,r)),Vt.call(e,e.media,"waiting canplay seeked playing",r=>un.checkLoading.call(e,r)),e.supported.ui&&e.config.clickToPlay&&!e.isAudio){const r=ci.call(e,`.${e.config.classNames.video}`);if(!W.element(r))return;Vt.call(e,t.container,"click",s=>{![t.container,r].includes(s.target)&&!r.contains(s.target)||e.touch&&e.config.hideControls||(e.ended?(this.proxy(s,e.restart,"restart"),this.proxy(s,()=>{ao(e.play())},"play")):this.proxy(s,()=>{ao(e.togglePlay())},"play"))})}e.supported.ui&&e.config.disableContextMenu&&Vt.call(e,t.wrapper,"contextmenu",r=>{r.preventDefault()},!1),Vt.call(e,e.media,"volumechange",()=>{e.storage.set({volume:e.volume,muted:e.muted})}),Vt.call(e,e.media,"ratechange",()=>{Ze.updateSetting.call(e,"speed"),e.storage.set({speed:e.speed})}),Vt.call(e,e.media,"qualitychange",r=>{Ze.updateSetting.call(e,"quality",null,r.detail.quality)}),Vt.call(e,e.media,"ready qualitychange",()=>{Ze.setDownloadUrl.call(e)});const i=e.config.events.concat(["keyup","keydown"]).join(" ");Vt.call(e,e.media,i,r=>{let{detail:s={}}=r;r.type==="error"&&(s=e.media.error),vt.call(e,t.container,r.type,!0,s)})});Ae(this,"proxy",(e,t,i)=>{const{player:r}=this,s=r.config.listeners[i],a=W.function(s);let o=!0;a&&(o=s.call(r,e)),o!==!1&&W.function(t)&&t.call(r,e)});Ae(this,"bind",(e,t,i,r,s=!0)=>{const{player:a}=this,o=a.config.listeners[r],l=W.function(o);Vt.call(a,e,t,u=>this.proxy(u,i,r),s&&!l)});Ae(this,"controls",()=>{const{player:e}=this,{elements:t}=e,i=$i.isIE?"change":"input";if(t.buttons.play&&Array.from(t.buttons.play).forEach(r=>{this.bind(r,"click",()=>{ao(e.togglePlay())},"play")}),this.bind(t.buttons.restart,"click",e.restart,"restart"),this.bind(t.buttons.rewind,"click",()=>{e.lastSeekTime=Date.now(),e.rewind()},"rewind"),this.bind(t.buttons.fastForward,"click",()=>{e.lastSeekTime=Date.now(),e.forward()},"fastForward"),this.bind(t.buttons.mute,"click",()=>{e.muted=!e.muted},"mute"),this.bind(t.buttons.captions,"click",()=>e.toggleCaptions()),this.bind(t.buttons.download,"click",()=>{vt.call(e,e.media,"download")},"download"),this.bind(t.buttons.fullscreen,"click",()=>{e.fullscreen.toggle()},"fullscreen"),this.bind(t.buttons.pip,"click",()=>{e.pip="toggle"},"pip"),this.bind(t.buttons.airplay,"click",e.airplay,"airplay"),this.bind(t.buttons.settings,"click",r=>{r.stopPropagation(),r.preventDefault(),Ze.toggleMenu.call(e,r)},null,!1),this.bind(t.buttons.settings,"keyup",r=>{if([" ","Enter"].includes(r.key)){if(r.key==="Enter"){Ze.focusFirstMenuItem.call(e,null,!0);return}r.preventDefault(),r.stopPropagation(),Ze.toggleMenu.call(e,r)}},null,!1),this.bind(t.settings.menu,"keydown",r=>{r.key==="Escape"&&Ze.toggleMenu.call(e,r)}),this.bind(t.inputs.seek,"mousedown mousemove",r=>{const s=t.progress.getBoundingClientRect(),a=r.pageX-r.clientX,o=100/s.width*(r.pageX-s.left-a);r.currentTarget.setAttribute("seek-value",o)}),this.bind(t.inputs.seek,"mousedown mouseup keydown keyup touchstart touchend",r=>{const s=r.currentTarget,a="play-on-seeked";if(W.keyboardEvent(r)&&!["ArrowLeft","ArrowRight"].includes(r.key))return;e.lastSeekTime=Date.now();const o=s.hasAttribute(a),l=["mouseup","touchend","keyup"].includes(r.type);o&&l?(s.removeAttribute(a),ao(e.play())):!l&&e.playing&&(s.setAttribute(a,""),e.pause())}),$i.isIos){const r=Vm.call(e,'input[type="range"]');Array.from(r).forEach(s=>this.bind(s,i,a=>RL(a.target)))}this.bind(t.inputs.seek,i,r=>{const s=r.currentTarget;let a=s.getAttribute("seek-value");W.empty(a)&&(a=s.value),s.removeAttribute("seek-value"),e.currentTime=a/s.max*e.duration},"seek"),this.bind(t.progress,"mouseenter mouseleave mousemove",r=>Ze.updateSeekTooltip.call(e,r)),this.bind(t.progress,"mousemove touchmove",r=>{const{previewThumbnails:s}=e;s&&s.loaded&&s.startMove(r)}),this.bind(t.progress,"mouseleave touchend click",()=>{const{previewThumbnails:r}=e;r&&r.loaded&&r.endMove(!1,!0)}),this.bind(t.progress,"mousedown touchstart",r=>{const{previewThumbnails:s}=e;s&&s.loaded&&s.startScrubbing(r)}),this.bind(t.progress,"mouseup touchend",r=>{const{previewThumbnails:s}=e;s&&s.loaded&&s.endScrubbing(r)}),$i.isWebKit&&Array.from(Vm.call(e,'input[type="range"]')).forEach(r=>{this.bind(r,"input",s=>Ze.updateRangeFill.call(e,s.target))}),e.config.toggleInvert&&!W.element(t.display.duration)&&this.bind(t.display.currentTime,"click",()=>{e.currentTime!==0&&(e.config.invertTime=!e.config.invertTime,Ze.timeUpdate.call(e))}),this.bind(t.inputs.volume,i,r=>{e.volume=r.target.value},"volume"),this.bind(t.controls,"mouseenter mouseleave",r=>{t.controls.hover=!e.touch&&r.type==="mouseenter"}),t.fullscreen&&Array.from(t.fullscreen.children).filter(r=>!r.contains(t.container)).forEach(r=>{this.bind(r,"mouseenter mouseleave",s=>{t.controls&&(t.controls.hover=!e.touch&&s.type==="mouseenter")})}),this.bind(t.controls,"mousedown mouseup touchstart touchend touchcancel",r=>{t.controls.pressed=["mousedown","touchstart"].includes(r.type)}),this.bind(t.controls,"focusin",()=>{const{config:r,timers:s}=e;Jt(t.controls,r.classNames.noTransition,!0),un.toggleControls.call(e,!0),setTimeout(()=>{Jt(t.controls,r.classNames.noTransition,!1)},0);const a=this.touch?3e3:4e3;clearTimeout(s.controls),s.controls=setTimeout(()=>un.toggleControls.call(e,!1),a)}),this.bind(t.inputs.volume,"wheel",r=>{const s=r.webkitDirectionInvertedFromDevice,[a,o]=[r.deltaX,-r.deltaY].map(h=>s?-h:h),l=Math.sign(Math.abs(a)>Math.abs(o)?a:o);e.increaseVolume(l/50);const{volume:u}=e.media;(l===1&&u<1||l===-1&&u>0)&&r.preventDefault()},"volume",!1)});this.player=e,this.lastKey=null,this.focusTimer=null,this.lastKeyDown=null,this.handleKey=this.handleKey.bind(this),this.toggleMenu=this.toggleMenu.bind(this),this.firstTouch=this.firstTouch.bind(this)}handleKey(e){const{player:t}=this,{elements:i}=t,{key:r,type:s,altKey:a,ctrlKey:o,metaKey:l,shiftKey:u}=e,h=s==="keydown",d=h&&r===this.lastKey;if(a||o||l||u||!r)return;const f=m=>{t.currentTime=t.duration/10*m};if(h){const m=document.activeElement;if(W.element(m)){const{editable:_}=t.config.selectors,{seek:w}=i.inputs;if(m!==w&&oc(m,_)||e.key===" "&&oc(m,'button, [role^="menuitem"]'))return}switch([" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","0","1","2","3","4","5","6","7","8","9","c","f","k","l","m"].includes(r)&&(e.preventDefault(),e.stopPropagation()),r){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":d||f(Number.parseInt(r,10));break;case" ":case"k":d||ao(t.togglePlay());break;case"ArrowUp":t.increaseVolume(.1);break;case"ArrowDown":t.decreaseVolume(.1);break;case"m":d||(t.muted=!t.muted);break;case"ArrowRight":t.forward();break;case"ArrowLeft":t.rewind();break;case"f":t.fullscreen.toggle();break;case"c":d||t.toggleCaptions();break;case"l":t.loop=!t.loop;break}r==="Escape"&&!t.fullscreen.usingNative&&t.fullscreen.active&&t.fullscreen.toggle(),this.lastKey=r}else this.lastKey=null}toggleMenu(e){Ze.toggleMenu.call(this.player,e)}}var HL={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(Cr,function(){var t=function(){},i={},r={},s={};function a(f,m){f=f.push?f:[f];var b=[],_=f.length,w=_,v,y,E,k;for(v=function(S,D){D.length&&b.push(S),w--,w||m(b)};_--;){if(y=f[_],E=r[y],E){v(y,E);continue}k=s[y]=s[y]||[],k.push(v)}}function o(f,m){if(f){var b=s[f];if(r[f]=m,!!b)for(;b.length;)b[0](f,m),b.splice(0,1)}}function l(f,m){f.call&&(f={success:f}),m.length?(f.error||t)(m):(f.success||t)(f)}function u(f,m,b,_){var w=document,v=b.async,y=(b.numRetries||0)+1,E=b.before||t,k=f.replace(/[\?|#].*$/,""),S=f.replace(/^(css|img|module|nomodule)!/,""),D,P,F;if(_=_||0,/(^css!|\.css$)/.test(k))F=w.createElement("link"),F.rel="stylesheet",F.href=S,D="hideFocus"in F,D&&F.relList&&(D=0,F.rel="preload",F.as="style");else if(/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(k))F=w.createElement("img"),F.src=S;else if(F=w.createElement("script"),F.src=S,F.async=v===void 0?!0:v,P="noModule"in F,/^module!/.test(k)){if(!P)return m(f,"l");F.type="module"}else if(/^nomodule!/.test(k)&&P)return m(f,"l");F.onload=F.onerror=F.onbeforeload=function(H){var z=H.type[0];if(D)try{F.sheet.cssText.length||(z="e")}catch(te){te.code!=18&&(z="e")}if(z=="e"){if(_+=1,_<y)return u(f,m,b,_)}else if(F.rel=="preload"&&F.as=="style")return F.rel="stylesheet";m(f,z,H.defaultPrevented)},E(f,F)!==!1&&w.head.appendChild(F)}function h(f,m,b){f=f.push?f:[f];var _=f.length,w=_,v=[],y,E;for(y=function(k,S,D){if(S=="e"&&v.push(k),S=="b")if(D)v.push(k);else return;_--,_||m(v)},E=0;E<w;E++)u(f[E],y,b)}function d(f,m,b){var _,w;if(m&&m.trim&&(_=m),w=(_?b:m)||{},_){if(_ in i)throw"LoadJS";i[_]=!0}function v(y,E){h(f,function(k){l(w,k),y&&l({success:y,error:E},k),o(_,k)},w)}if(w.returnPromise)return new Promise(v);v()}return d.ready=function(m,b){return a(m,function(_){l(b,_)}),d},d.done=function(m){o(m,[])},d.reset=function(){i={},r={},s={}},d.isDefined=function(m){return m in i},d})})(HL);var T$=HL.exports;const D$=po(T$);function Px(n){return new Promise((e,t)=>{D$(n,{success:e,error:t})})}function R$(n){if(W.empty(n))return null;if(W.number(Number(n)))return n;const e=/^.*(vimeo.com\/|video\/)(\d+).*/,t=n.match(e);return t?t[2]:n}function P$(n){const e=/^.*(vimeo.com\/|video\/)(\d+)(\?.*h=|\/)+([\d,a-f]+)/,t=n.match(e);return t&&t.length===5?t[4]:null}function Ip(n){n&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===n&&(this.media.paused=!n,vt.call(this,this.media,n?"play":"pause"))}const UE={setup(){const n=this;Jt(n.elements.wrapper,n.config.classNames.embed,!0),n.options.speed=n.config.speed.options,ep.call(n),W.object(window.Vimeo)?UE.ready.call(n):Px(n.config.urls.vimeo.sdk).then(()=>{UE.ready.call(n)}).catch(e=>{n.debug.warn("Vimeo SDK (player.js) failed to load",e)})},ready(){const n=this,e=n.config.vimeo,{premium:t,referrerPolicy:i,...r}=e;let s=n.media.getAttribute("src"),a="";W.empty(s)?(s=n.media.getAttribute(n.config.attributes.embed.id),a=n.media.getAttribute(n.config.attributes.embed.hash)):a=P$(s);const o=a?{h:a}:{};t&&Object.assign(r,{controls:!1,sidedock:!1});const l=UL({loop:n.config.loop.active,autoplay:n.autoplay,muted:n.muted,gesture:"media",playsinline:n.config.playsinline,...o,...r}),u=R$(s),h=gt("iframe"),d=zE(n.config.urls.vimeo.iframe,u,l);if(h.setAttribute("src",d),h.setAttribute("allowfullscreen",""),h.setAttribute("allow",["autoplay","fullscreen","picture-in-picture","encrypted-media","accelerometer","gyroscope"].join("; ")),W.empty(i)||h.setAttribute("referrerPolicy",i),t||!e.customControls)h.setAttribute("data-poster",n.poster),n.media=Cb(h,n.media);else{const y=gt("div",{class:n.config.classNames.embedContainer,"data-poster":n.poster});y.appendChild(h),n.media=Cb(y,n.media)}e.customControls||qv(zE(n.config.urls.vimeo.api,d)).then(y=>{W.empty(y)||!y.thumbnail_url||un.setPoster.call(n,y.thumbnail_url).catch(()=>{})}),n.embed=new window.Vimeo.Player(h,{autopause:n.config.autopause,muted:n.muted}),n.media.paused=!0,n.media.currentTime=0,n.supported.ui&&n.embed.disableTextTrack(),n.media.play=()=>(Ip.call(n,!0),n.embed.play()),n.media.pause=()=>(Ip.call(n,!1),n.embed.pause()),n.media.stop=()=>{n.pause(),n.currentTime=0};let{currentTime:f}=n.media;Object.defineProperty(n.media,"currentTime",{get(){return f},set(y){const{embed:E,media:k,paused:S,volume:D}=n,P=S&&!E.hasPlayed;k.seeking=!0,vt.call(n,k,"seeking"),Promise.resolve(P&&E.setVolume(0)).then(()=>E.setCurrentTime(y)).then(()=>P&&E.pause()).then(()=>P&&E.setVolume(D)).catch(()=>{})}});let m=n.config.speed.selected;Object.defineProperty(n.media,"playbackRate",{get(){return m},set(y){n.embed.setPlaybackRate(y).then(()=>{m=y,vt.call(n,n.media,"ratechange")}).catch(()=>{n.options.speed=[1]})}});let{volume:b}=n.config;Object.defineProperty(n.media,"volume",{get(){return b},set(y){n.embed.setVolume(y).then(()=>{b=y,vt.call(n,n.media,"volumechange")})}});let{muted:_}=n.config;Object.defineProperty(n.media,"muted",{get(){return _},set(y){const E=W.boolean(y)?y:!1;n.embed.setMuted(E?!0:n.config.muted).then(()=>{_=E,vt.call(n,n.media,"volumechange")})}});let{loop:w}=n.config;Object.defineProperty(n.media,"loop",{get(){return w},set(y){const E=W.boolean(y)?y:n.config.loop.active;n.embed.setLoop(E).then(()=>{w=E})}});let v;n.embed.getVideoUrl().then(y=>{v=y,Ze.setDownloadUrl.call(n)}).catch(y=>{this.debug.warn(y)}),Object.defineProperty(n.media,"currentSrc",{get(){return v}}),Object.defineProperty(n.media,"ended",{get(){return n.currentTime===n.duration}}),Promise.all([n.embed.getVideoWidth(),n.embed.getVideoHeight()]).then(y=>{const[E,k]=y;n.embed.ratio=ML(E,k),ep.call(this)}),n.embed.setAutopause(n.config.autopause).then(y=>{n.config.autopause=y}),n.embed.getVideoTitle().then(y=>{n.config.title=y,un.setTitle.call(this)}),n.embed.getCurrentTime().then(y=>{f=y,vt.call(n,n.media,"timeupdate")}),n.embed.getDuration().then(y=>{n.media.duration=y,vt.call(n,n.media,"durationchange")}),n.embed.getTextTracks().then(y=>{n.media.textTracks=y,Yt.setup.call(n)}),n.embed.on("cuechange",({cues:y=[]})=>{const E=y.map(k=>_$(k.text));Yt.updateCues.call(n,E)}),n.embed.on("loaded",()=>{n.embed.getPaused().then(y=>{Ip.call(n,!y),y||vt.call(n,n.media,"playing")}),W.element(n.embed.element)&&n.supported.ui&&n.embed.element.setAttribute("tabindex",-1)}),n.embed.on("bufferstart",()=>{vt.call(n,n.media,"waiting")}),n.embed.on("bufferend",()=>{vt.call(n,n.media,"playing")}),n.embed.on("play",()=>{Ip.call(n,!0),vt.call(n,n.media,"playing")}),n.embed.on("pause",()=>{Ip.call(n,!1)}),n.embed.on("timeupdate",y=>{n.media.seeking=!1,f=y.seconds,vt.call(n,n.media,"timeupdate")}),n.embed.on("progress",y=>{n.media.buffered=y.percent,vt.call(n,n.media,"progress"),Number.parseInt(y.percent,10)===1&&vt.call(n,n.media,"canplaythrough"),n.embed.getDuration().then(E=>{E!==n.media.duration&&(n.media.duration=E,vt.call(n,n.media,"durationchange"))})}),n.embed.on("seeked",()=>{n.media.seeking=!1,vt.call(n,n.media,"seeked")}),n.embed.on("ended",()=>{n.media.paused=!0,vt.call(n,n.media,"ended")}),n.embed.on("error",y=>{n.media.error=y,vt.call(n,n.media,"error")}),e.customControls&&setTimeout(()=>un.build.call(n),0)}};function N$(n){if(W.empty(n))return null;const e=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/,t=n.match(e);return t&&t[2]?t[2]:n}function Lp(n){n&&!this.embed.hasPlayed&&(this.embed.hasPlayed=!0),this.media.paused===n&&(this.media.paused=!n,vt.call(this,this.media,n?"play":"pause"))}function I$(n){if(n.noCookie)return"https://www.youtube-nocookie.com";if(window.location.protocol==="http:")return"http://www.youtube.com"}const R0={setup(){if(Jt(this.elements.wrapper,this.config.classNames.embed,!0),W.object(window.YT)&&W.function(window.YT.Player))R0.ready.call(this);else{const n=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{W.function(n)&&n(),R0.ready.call(this)},Px(this.config.urls.youtube.sdk).catch(e=>{this.debug.warn("YouTube API failed to load",e)})}},getTitle(n){const e=zE(this.config.urls.youtube.api,n);qv(e).then(t=>{if(W.object(t)){const{title:i,height:r,width:s}=t;this.config.title=i,un.setTitle.call(this),this.embed.ratio=ML(s,r)}ep.call(this)}).catch(()=>{ep.call(this)})},ready(){const n=this,e=n.config.youtube,t=n.media&&n.media.getAttribute("id");if(!W.empty(t)&&t.startsWith("youtube-"))return;let i=n.media.getAttribute("src");W.empty(i)&&(i=n.media.getAttribute(this.config.attributes.embed.id));const r=N$(i),s=v$(n.provider),a=gt("div",{id:s,"data-poster":e.customControls?n.poster:void 0});if(n.media=Cb(a,n.media),e.customControls){const o=l=>`https://i.ytimg.com/vi/${r}/${l}default.jpg`;D0(o("maxres"),121).catch(()=>D0(o("sd"),121)).catch(()=>D0(o("hq"))).then(l=>un.setPoster.call(n,l.src)).then(l=>{l.includes("maxres")||(n.elements.poster.style.backgroundSize="cover")}).catch(()=>{})}n.embed=new window.YT.Player(n.media,{videoId:r,host:I$(e),playerVars:Xn({},{autoplay:n.config.autoplay?1:0,hl:n.config.hl,controls:n.supported.ui&&e.customControls?0:1,disablekb:1,playsinline:n.config.playsinline&&!n.config.fullscreen.iosNative?1:0,cc_load_policy:n.captions.active?1:0,cc_lang_pref:n.config.captions.language,widget_referrer:window?window.location.href:null},e),events:{onError(o){if(!n.media.error){const l=o.data,u={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."}[l]||"An unknown error occurred";n.media.error={code:l,message:u},vt.call(n,n.media,"error")}},onPlaybackRateChange(o){const l=o.target;n.media.playbackRate=l.getPlaybackRate(),vt.call(n,n.media,"ratechange")},onReady(o){if(W.function(n.media.play))return;const l=o.target;R0.getTitle.call(n,r),n.media.play=()=>{Lp.call(n,!0),l.playVideo()},n.media.pause=()=>{Lp.call(n,!1),l.pauseVideo()},n.media.stop=()=>{l.stopVideo()},n.media.duration=l.getDuration(),n.media.paused=!0,n.media.currentTime=0,Object.defineProperty(n.media,"currentTime",{get(){return Number(l.getCurrentTime())},set(f){n.paused&&!n.embed.hasPlayed&&n.embed.mute(),n.media.seeking=!0,vt.call(n,n.media,"seeking"),l.seekTo(f)}}),Object.defineProperty(n.media,"playbackRate",{get(){return l.getPlaybackRate()},set(f){l.setPlaybackRate(f)}});let{volume:u}=n.config;Object.defineProperty(n.media,"volume",{get(){return u},set(f){u=f,l.setVolume(u*100),vt.call(n,n.media,"volumechange")}});let{muted:h}=n.config;Object.defineProperty(n.media,"muted",{get(){return h},set(f){const m=W.boolean(f)?f:h;h=m,l[m?"mute":"unMute"](),l.setVolume(u*100),vt.call(n,n.media,"volumechange")}}),Object.defineProperty(n.media,"currentSrc",{get(){return l.getVideoUrl()}}),Object.defineProperty(n.media,"ended",{get(){return n.currentTime===n.duration}});const d=l.getAvailablePlaybackRates();n.options.speed=d.filter(f=>n.config.speed.options.includes(f)),n.supported.ui&&e.customControls&&n.media.setAttribute("tabindex",-1),vt.call(n,n.media,"timeupdate"),vt.call(n,n.media,"durationchange"),clearInterval(n.timers.buffering),n.timers.buffering=setInterval(()=>{n.media.buffered=l.getVideoLoadedFraction(),(n.media.lastBuffered===null||n.media.lastBuffered<n.media.buffered)&&vt.call(n,n.media,"progress"),n.media.lastBuffered=n.media.buffered,n.media.buffered===1&&(clearInterval(n.timers.buffering),vt.call(n,n.media,"canplaythrough"))},200),e.customControls&&setTimeout(()=>un.build.call(n),50)},onStateChange(o){const l=o.target;switch(clearInterval(n.timers.playing),n.media.seeking&&[1,2].includes(o.data)&&(n.media.seeking=!1,vt.call(n,n.media,"seeked")),o.data){case-1:vt.call(n,n.media,"timeupdate"),n.media.buffered=l.getVideoLoadedFraction(),vt.call(n,n.media,"progress");break;case 0:Lp.call(n,!1),n.media.loop?(l.stopVideo(),l.playVideo()):vt.call(n,n.media,"ended");break;case 1:e.customControls&&!n.config.autoplay&&n.media.paused&&!n.embed.hasPlayed?n.media.pause():(Lp.call(n,!0),vt.call(n,n.media,"playing"),n.timers.playing=setInterval(()=>{vt.call(n,n.media,"timeupdate")},50),n.media.duration!==l.getDuration()&&(n.media.duration=l.getDuration(),vt.call(n,n.media,"durationchange")));break;case 2:n.muted||n.embed.unMute(),Lp.call(n,!1);break;case 3:vt.call(n,n.media,"waiting");break}vt.call(n,n.elements.container,"statechange",!1,{code:o.data})}}})}},qL={setup(){if(!this.media){this.debug.warn("No media element found!");return}Jt(this.elements.container,this.config.classNames.type.replace("{0}",this.type),!0),Jt(this.elements.container,this.config.classNames.provider.replace("{0}",this.provider),!0),this.isEmbed&&Jt(this.elements.container,this.config.classNames.type.replace("{0}","video"),!0),this.isVideo&&(this.elements.wrapper=gt("div",{class:this.config.classNames.video}),NL(this.media,this.elements.wrapper),this.elements.poster=gt("div",{class:this.config.classNames.poster}),this.elements.wrapper.appendChild(this.elements.poster)),this.isHTML5?_u.setup.call(this):this.isYouTube?R0.setup.call(this):this.isVimeo&&UE.setup.call(this)}};function L$(n){n.manager&&n.manager.destroy(),n.elements.displayContainer&&n.elements.displayContainer.destroy(),n.elements.container.remove()}class O${constructor(e){Ae(this,"load",()=>{this.enabled&&(!W.object(window.google)||!W.object(window.google.ima)?Px(this.player.config.urls.googleIMA.sdk).then(()=>{this.ready()}).catch(()=>{this.trigger("error",new Error("Google IMA SDK failed to load"))}):this.ready())});Ae(this,"ready",()=>{this.enabled||L$(this),this.startSafetyTimer(12e3,"ready()"),this.managerPromise.then(()=>{this.clearSafetyTimer("onAdsManagerLoaded()")}),this.listeners(),this.setupIMA()});Ae(this,"setupIMA",()=>{this.elements.container=gt("div",{class:this.player.config.classNames.ads}),this.player.elements.container.appendChild(this.elements.container),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),google.ima.settings.setLocale(this.player.config.ads.language),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline),this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media),this.loader=new google.ima.AdsLoader(this.elements.displayContainer),this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e=>this.onAdsManagerLoaded(e),!1),this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,e=>this.onAdError(e),!1),this.requestAds()});Ae(this,"requestAds",()=>{const{container:e}=this.player.elements;try{const t=new google.ima.AdsRequest;t.adTagUrl=this.tagUrl,t.linearAdSlotWidth=e.offsetWidth,t.linearAdSlotHeight=e.offsetHeight,t.nonLinearAdSlotWidth=e.offsetWidth,t.nonLinearAdSlotHeight=e.offsetHeight,t.forceNonLinearFullSlot=!1,t.setAdWillPlayMuted(!this.player.muted),this.loader.requestAds(t)}catch(t){this.onAdError(t)}});Ae(this,"pollCountdown",(e=!1)=>{if(!e){clearInterval(this.countdownTimer),this.elements.container.removeAttribute("data-badge-text");return}const t=()=>{const i=Fw(Math.max(this.manager.getRemainingTime(),0)),r=`${Di.get("advertisement",this.player.config)} - ${i}`;this.elements.container.setAttribute("data-badge-text",r)};this.countdownTimer=setInterval(t,100)});Ae(this,"onAdsManagerLoaded",e=>{if(!this.enabled)return;const t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.manager=e.getAdsManager(this.player,t),this.cuePoints=this.manager.getCuePoints(),this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,i=>this.onAdError(i)),Object.keys(google.ima.AdEvent.Type).forEach(i=>{this.manager.addEventListener(google.ima.AdEvent.Type[i],r=>this.onAdEvent(r))}),this.trigger("loaded")});Ae(this,"addCuePoints",()=>{W.empty(this.cuePoints)||this.cuePoints.forEach(e=>{if(e!==0&&e!==-1&&e<this.player.duration){const t=this.player.elements.progress;if(W.element(t)){const i=100/this.player.duration*e,r=gt("span",{class:this.player.config.classNames.cues});r.style.left=`${i.toString()}%`,t.appendChild(r)}}})});Ae(this,"onAdEvent",e=>{const{container:t}=this.player.elements,i=e.getAd(),r=e.getAdData();switch((a=>{vt.call(this.player,this.player.media,`ads${a.replace(/_/g,"").toLowerCase()}`)})(e.type),e.type){case google.ima.AdEvent.Type.LOADED:this.trigger("loaded"),this.pollCountdown(!0),i.isLinear()||(i.width=t.offsetWidth,i.height=t.offsetHeight);break;case google.ima.AdEvent.Type.STARTED:this.manager.setVolume(this.player.volume);break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:this.player.ended?this.loadAds():this.loader.contentComplete();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this.pollCountdown(),this.resumeContent();break;case google.ima.AdEvent.Type.LOG:r.adError&&this.player.debug.warn(`Non-fatal ad error: ${r.adError.getMessage()}`);break}});Ae(this,"onAdError",e=>{this.cancel(),this.player.debug.warn("Ads error",e)});Ae(this,"listeners",()=>{const{container:e}=this.player.elements;let t;this.player.on("canplay",()=>{this.addCuePoints()}),this.player.on("ended",()=>{this.loader.contentComplete()}),this.player.on("timeupdate",()=>{t=this.player.currentTime}),this.player.on("seeked",()=>{const i=this.player.currentTime;W.empty(this.cuePoints)||this.cuePoints.forEach((r,s)=>{t<r&&r<i&&(this.manager.discardAdBreak(),this.cuePoints.splice(s,1))})}),window.addEventListener("resize",()=>{this.manager&&this.manager.resize(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL)})});Ae(this,"play",()=>{const{container:e}=this.player.elements;this.managerPromise||this.resumeContent(),this.managerPromise.then(()=>{this.manager.setVolume(this.player.volume),this.elements.displayContainer.initialize();try{this.initialized||(this.manager.init(e.offsetWidth,e.offsetHeight,google.ima.ViewMode.NORMAL),this.manager.start()),this.initialized=!0}catch(t){this.onAdError(t)}}).catch(()=>{})});Ae(this,"resumeContent",()=>{this.elements.container.style.zIndex="",this.playing=!1,ao(this.player.media.play())});Ae(this,"pauseContent",()=>{this.elements.container.style.zIndex=3,this.playing=!0,this.player.media.pause()});Ae(this,"cancel",()=>{this.initialized&&this.resumeContent(),this.trigger("error"),this.loadAds()});Ae(this,"loadAds",()=>{this.managerPromise.then(()=>{this.manager&&this.manager.destroy(),this.managerPromise=new Promise(e=>{this.on("loaded",e),this.player.debug.log(this.manager)}),this.initialized=!1,this.requestAds()}).catch(()=>{})});Ae(this,"trigger",(e,...t)=>{const i=this.events[e];W.array(i)&&i.forEach(r=>{W.function(r)&&r.apply(this,t)})});Ae(this,"on",(e,t)=>(W.array(this.events[e])||(this.events[e]=[]),this.events[e].push(t),this));Ae(this,"startSafetyTimer",(e,t)=>{this.player.debug.log(`Safety timer invoked from: ${t}`),this.safetyTimer=setTimeout(()=>{this.cancel(),this.clearSafetyTimer("startSafetyTimer()")},e)});Ae(this,"clearSafetyTimer",e=>{W.nullOrUndefined(this.safetyTimer)||(this.player.debug.log(`Safety timer cleared from: ${e}`),clearTimeout(this.safetyTimer),this.safetyTimer=null)});this.player=e,this.config=e.config.ads,this.playing=!1,this.initialized=!1,this.elements={container:null,displayContainer:null},this.manager=null,this.loader=null,this.cuePoints=null,this.events={},this.safetyTimer=null,this.countdownTimer=null,this.managerPromise=new Promise((t,i)=>{this.on("loaded",t),this.on("error",i)}),this.load()}get enabled(){const{config:e}=this;return this.player.isHTML5&&this.player.isVideo&&e.enabled&&(!W.empty(e.publisherId)||W.url(e.tagUrl))}get tagUrl(){const{config:e}=this;if(W.url(e.tagUrl))return e.tagUrl;const t={AV_PUBLISHERID:"58c25bb0073ef448b1087ad6",AV_CHANNELID:"5a0458dc28a06145e4519d21",AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:e.publisherId};return`https://go.aniview.com/api/adserver6/vast/?${UL(t)}`}}function WL(n=0,e=0,t=255){return Math.min(Math.max(n,e),t)}function M$(n){const e=[];return n.split(/\r\n\r\n|\n\n|\r\r/).forEach(i=>{const r={};i.split(/\r\n|\n|\r/).forEach(a=>{if(W.number(r.startTime)){if(!W.empty(a.trim())&&W.empty(r.text)){const o=a.trim().split("#xywh=");[r.text]=o,o[1]&&([r.x,r.y,r.w,r.h]=o[1].split(","))}}else{const o=a.match(/(\d{2})?:?(\d{2}):(\d{2}).(\d{2,3})( ?--> ?)(\d{2})?:?(\d{2}):(\d{2}).(\d{2,3})/);o&&(r.startTime=Number(o[1]||0)*60*60+Number(o[2])*60+Number(o[3])+ +`0.${o[4]}`,r.endTime=Number(o[6]||0)*60*60+Number(o[7])*60+Number(o[8])+ +`0.${o[9]}`)}}),r.text&&e.push(r)}),e}function Zk(n,e){const t=e.width/e.height,i={};return n>t?(i.width=e.width,i.height=1/n*e.width):(i.height=e.height,i.width=n*e.height),i}class $E{constructor(e){Ae(this,"load",()=>{this.player.elements.display.seekTooltip&&(this.player.elements.display.seekTooltip.hidden=this.enabled),this.enabled&&this.getThumbnails().then(()=>{this.enabled&&(this.render(),this.determineContainerAutoSizing(),this.listeners(),this.loaded=!0)})});Ae(this,"getThumbnails",()=>new Promise(e=>{const{src:t}=this.player.config.previewThumbnails;if(W.empty(t))throw new Error("Missing previewThumbnails.src config attribute");const i=()=>{this.thumbnails.sort((r,s)=>r.height-s.height),this.player.debug.log("Preview thumbnails",this.thumbnails),e()};if(W.function(t))t(r=>{this.thumbnails=r,i()});else{const s=(W.string(t)?[t]:t).map(a=>this.getThumbnail(a));Promise.all(s).then(i)}}));Ae(this,"getThumbnail",e=>new Promise(t=>{qv(e,void 0,this.player.config.previewThumbnails.withCredentials).then(i=>{const r={frames:M$(i),height:null,urlPrefix:""};!r.frames[0].text.startsWith("/")&&!r.frames[0].text.startsWith("http://")&&!r.frames[0].text.startsWith("https://")&&(r.urlPrefix=e.substring(0,e.lastIndexOf("/")+1));const s=new Image;s.onload=()=>{r.height=s.naturalHeight,r.width=s.naturalWidth,this.thumbnails.push(r),t()},s.src=r.urlPrefix+r.frames[0].text})}));Ae(this,"startMove",e=>{if(this.loaded&&!(!W.event(e)||!["touchmove","mousemove"].includes(e.type))&&this.player.media.duration){if(e.type==="touchmove")this.seekTime=this.player.media.duration*(this.player.elements.inputs.seek.value/100);else{const t=this.player.elements.progress.getBoundingClientRect(),i=100/t.width*(e.pageX-t.left);this.seekTime=this.player.media.duration*(i/100),this.seekTime<0&&(this.seekTime=0),this.seekTime>this.player.media.duration-1&&(this.seekTime=this.player.media.duration-1),this.mousePosX=e.pageX,this.elements.thumb.time.textContent=Fw(this.seekTime);const r=this.player.config.markers?.points?.find(({time:s})=>s===Math.round(this.seekTime));r&&this.elements.thumb.time.insertAdjacentHTML("afterbegin",`${r.label}<br>`)}this.showImageAtCurrentTime()}});Ae(this,"endMove",()=>{this.toggleThumbContainer(!1,!0)});Ae(this,"startScrubbing",e=>{(W.nullOrUndefined(e.button)||e.button===!1||e.button===0)&&(this.mouseDown=!0,this.player.media.duration&&(this.toggleScrubbingContainer(!0),this.toggleThumbContainer(!1,!0),this.showImageAtCurrentTime()))});Ae(this,"endScrubbing",()=>{this.mouseDown=!1,Math.ceil(this.lastTime)===Math.ceil(this.player.media.currentTime)?this.toggleScrubbingContainer(!1):Dx.call(this.player,this.player.media,"timeupdate",()=>{this.mouseDown||this.toggleScrubbingContainer(!1)})});Ae(this,"listeners",()=>{this.player.on("play",()=>{this.toggleThumbContainer(!1,!0)}),this.player.on("seeked",()=>{this.toggleThumbContainer(!1)}),this.player.on("timeupdate",()=>{this.lastTime=this.player.media.currentTime})});Ae(this,"render",()=>{this.elements.thumb.container=gt("div",{class:this.player.config.classNames.previewThumbnails.thumbContainer}),this.elements.thumb.imageContainer=gt("div",{class:this.player.config.classNames.previewThumbnails.imageContainer}),this.elements.thumb.container.appendChild(this.elements.thumb.imageContainer);const e=gt("div",{class:this.player.config.classNames.previewThumbnails.timeContainer});this.elements.thumb.time=gt("span",{},"00:00"),e.appendChild(this.elements.thumb.time),this.elements.thumb.imageContainer.appendChild(e),W.element(this.player.elements.progress)&&this.player.elements.progress.appendChild(this.elements.thumb.container),this.elements.scrubbing.container=gt("div",{class:this.player.config.classNames.previewThumbnails.scrubbingContainer}),this.player.elements.wrapper.appendChild(this.elements.scrubbing.container)});Ae(this,"destroy",()=>{this.elements.thumb.container&&this.elements.thumb.container.remove(),this.elements.scrubbing.container&&this.elements.scrubbing.container.remove()});Ae(this,"showImageAtCurrentTime",()=>{this.mouseDown?this.setScrubbingContainerSize():this.setThumbContainerSizeAndPos();const e=this.thumbnails[0].frames.findIndex(r=>this.seekTime>=r.startTime&&this.seekTime<=r.endTime),t=e>=0;let i=0;this.mouseDown||this.toggleThumbContainer(t),t&&(this.thumbnails.forEach((r,s)=>{this.loadedImages.includes(r.frames[e].text)&&(i=s)}),e!==this.showingThumb&&(this.showingThumb=e,this.loadImage(i)))});Ae(this,"loadImage",(e=0)=>{const t=this.showingThumb,i=this.thumbnails[e],{urlPrefix:r}=i,s=i.frames[t],a=i.frames[t].text,o=r+a;if(!this.currentImageElement||this.currentImageElement.dataset.filename!==a){this.loadingImage&&this.usingSprites&&(this.loadingImage.onload=null);const l=new Image;l.src=o,l.dataset.index=t,l.dataset.filename=a,this.showingThumbFilename=a,this.player.debug.log(`Loading image: ${o}`),l.onload=()=>this.showImage(l,s,e,t,a,!0),this.loadingImage=l,this.removeOldImages(l)}else this.showImage(this.currentImageElement,s,e,t,a,!1),this.currentImageElement.dataset.index=t,this.removeOldImages(this.currentImageElement)});Ae(this,"showImage",(e,t,i,r,s,a=!0)=>{this.player.debug.log(`Showing thumb: ${s}. num: ${r}. qual: ${i}. newimg: ${a}`),this.setImageSizeAndOffset(e,t),a&&(this.currentImageContainer.appendChild(e),this.currentImageElement=e,this.loadedImages.includes(s)||this.loadedImages.push(s)),this.preloadNearby(r,!0).then(this.preloadNearby(r,!1)).then(this.getHigherQuality(i,e,t,s))});Ae(this,"removeOldImages",e=>{Array.from(this.currentImageContainer.children).forEach(t=>{if(t.tagName.toLowerCase()!=="img")return;const i=this.usingSprites?500:1e3;if(t.dataset.index!==e.dataset.index&&!t.dataset.deleting){t.dataset.deleting=!0;const{currentImageContainer:r}=this;setTimeout(()=>{r.removeChild(t),this.player.debug.log(`Removing thumb: ${t.dataset.filename}`)},i)}})});Ae(this,"preloadNearby",(e,t=!0)=>new Promise(i=>{setTimeout(()=>{const r=this.thumbnails[0].frames[e].text;if(this.showingThumbFilename===r){let s;t?s=this.thumbnails[0].frames.slice(e):s=this.thumbnails[0].frames.slice(0,e).reverse();let a=!1;s.forEach(o=>{const l=o.text;if(l!==r&&!this.loadedImages.includes(l)){a=!0,this.player.debug.log(`Preloading thumb filename: ${l}`);const{urlPrefix:u}=this.thumbnails[0],h=u+l,d=new Image;d.src=h,d.onload=()=>{this.player.debug.log(`Preloaded thumb filename: ${l}`),this.loadedImages.includes(l)||this.loadedImages.push(l),i()}}}),a||i()}},300)}));Ae(this,"getHigherQuality",(e,t,i,r)=>{if(e<this.thumbnails.length-1){let s=t.naturalHeight;this.usingSprites&&(s=i.h),s<this.thumbContainerHeight&&setTimeout(()=>{this.showingThumbFilename===r&&(this.player.debug.log(`Showing higher quality thumb for: ${r}`),this.loadImage(e+1))},300)}});Ae(this,"toggleThumbContainer",(e=!1,t=!1)=>{const i=this.player.config.classNames.previewThumbnails.thumbContainerShown;this.elements.thumb.container.classList.toggle(i,e),!e&&t&&(this.showingThumb=null,this.showingThumbFilename=null)});Ae(this,"toggleScrubbingContainer",(e=!1)=>{const t=this.player.config.classNames.previewThumbnails.scrubbingContainerShown;this.elements.scrubbing.container.classList.toggle(t,e),e||(this.showingThumb=null,this.showingThumbFilename=null)});Ae(this,"determineContainerAutoSizing",()=>{(this.elements.thumb.imageContainer.clientHeight>20||this.elements.thumb.imageContainer.clientWidth>20)&&(this.sizeSpecifiedInCSS=!0)});Ae(this,"setThumbContainerSizeAndPos",()=>{const{imageContainer:e}=this.elements.thumb;if(this.sizeSpecifiedInCSS){if(e.clientHeight>20&&e.clientWidth<20){const t=Math.floor(e.clientHeight*this.thumbAspectRatio);e.style.width=`${t}px`}else if(e.clientHeight<20&&e.clientWidth>20){const t=Math.floor(e.clientWidth/this.thumbAspectRatio);e.style.height=`${t}px`}}else{const t=Math.floor(this.thumbContainerHeight*this.thumbAspectRatio);e.style.height=`${this.thumbContainerHeight}px`,e.style.width=`${t}px`}this.setThumbContainerPos()});Ae(this,"setThumbContainerPos",()=>{const e=this.player.elements.progress.getBoundingClientRect(),t=this.player.elements.container.getBoundingClientRect(),{container:i}=this.elements.thumb,r=t.left-e.left+10,s=t.right-e.left-i.clientWidth-10,a=this.mousePosX-e.left-i.clientWidth/2,o=WL(a,r,s);i.style.left=`${o}px`,i.style.setProperty("--preview-arrow-offset",`${a-o}px`)});Ae(this,"setScrubbingContainerSize",()=>{const{width:e,height:t}=Zk(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});this.elements.scrubbing.container.style.width=`${e}px`,this.elements.scrubbing.container.style.height=`${t}px`});Ae(this,"setImageSizeAndOffset",(e,t)=>{if(!this.usingSprites)return;const i=this.thumbContainerHeight/t.h;e.style.height=`${e.naturalHeight*i}px`,e.style.width=`${e.naturalWidth*i}px`,e.style.left=`-${t.x*i}px`,e.style.top=`-${t.y*i}px`});this.player=e,this.thumbnails=[],this.loaded=!1,this.lastMouseMoveTime=Date.now(),this.mouseDown=!1,this.loadedImages=[],this.elements={thumb:{},scrubbing:{}},this.load()}get enabled(){return this.player.isHTML5&&this.player.isVideo&&this.player.config.previewThumbnails.enabled}get currentImageContainer(){return this.mouseDown?this.elements.scrubbing.container:this.elements.thumb.imageContainer}get usingSprites(){return Object.keys(this.thumbnails[0].frames[0]).includes("w")}get thumbAspectRatio(){return this.usingSprites?this.thumbnails[0].frames[0].w/this.thumbnails[0].frames[0].h:this.thumbnails[0].width/this.thumbnails[0].height}get thumbContainerHeight(){if(this.mouseDown){const{height:e}=Zk(this.thumbAspectRatio,{width:this.player.media.clientWidth,height:this.player.media.clientHeight});return e}return this.sizeSpecifiedInCSS?this.elements.thumb.imageContainer.clientHeight:Math.floor(this.player.media.clientWidth/this.thumbAspectRatio/4)}get currentImageElement(){return this.mouseDown?this.currentScrubbingImageElement:this.currentThumbnailImageElement}set currentImageElement(e){this.mouseDown?this.currentScrubbingImageElement=e:this.currentThumbnailImageElement=e}}const HE={insertElements(n,e){W.string(e)?Kk(n,this.media,{src:e}):W.array(e)&&e.forEach(t=>{Kk(n,this.media,t)})},change(n){if(!PL(n,"sources.length")){this.debug.warn("Invalid source format");return}_u.cancelRequests.call(this),this.destroy(()=>{this.options.quality=[],il(this.media),this.media=null,W.element(this.elements.container)&&this.elements.container.removeAttribute("class");const{sources:e,type:t}=n,[{provider:i=Ol.html5,src:r}]=e,s=i==="html5"?t:"div",a=i==="html5"?{}:{src:r};Object.assign(this,{provider:i,type:t,supported:Yn.check(t,i,this.config.playsinline),media:gt(s,a)}),this.elements.container.appendChild(this.media),W.boolean(n.autoplay)&&(this.config.autoplay=n.autoplay),this.isHTML5&&(this.config.crossorigin&&this.media.setAttribute("crossorigin",""),this.config.autoplay&&this.media.setAttribute("autoplay",""),W.empty(n.poster)||(this.poster=n.poster),this.config.loop.active&&this.media.setAttribute("loop",""),this.config.muted&&this.media.setAttribute("muted",""),this.config.playsinline&&this.media.setAttribute("playsinline","")),un.addStyleHook.call(this),this.isHTML5&&HE.insertElements.call(this,"source",e),this.config.title=n.title,qL.setup.call(this),this.isHTML5&&Object.keys(n).includes("tracks")&&HE.insertElements.call(this,"track",n.tracks),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&un.build.call(this),this.isHTML5&&this.media.load(),W.empty(n.previewThumbnails)||(Object.assign(this.config.previewThumbnails,n.previewThumbnails),this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new $E(this))),this.fullscreen.update()},!0)}};class Xm{constructor(e,t){Ae(this,"play",()=>W.function(this.media.play)?(this.ads&&this.ads.enabled&&this.ads.managerPromise.then(()=>this.ads.play()).catch(()=>ao(this.media.play())),this.media.play()):null);Ae(this,"pause",()=>!this.playing||!W.function(this.media.pause)?null:this.media.pause());Ae(this,"togglePlay",e=>(W.boolean(e)?e:!this.playing)?this.play():this.pause());Ae(this,"stop",()=>{this.isHTML5?(this.pause(),this.restart()):W.function(this.media.stop)&&this.media.stop()});Ae(this,"restart",()=>{this.currentTime=0});Ae(this,"rewind",e=>{this.currentTime-=W.number(e)?e:this.config.seekTime});Ae(this,"forward",e=>{this.currentTime+=W.number(e)?e:this.config.seekTime});Ae(this,"increaseVolume",e=>{const t=this.media.muted?0:this.volume;this.volume=t+(W.number(e)?e:0)});Ae(this,"decreaseVolume",e=>{this.increaseVolume(-e)});Ae(this,"airplay",()=>{Yn.airplay&&this.media.webkitShowPlaybackTargetPicker()});Ae(this,"toggleControls",e=>{if(this.supported.ui&&!this.isAudio){const t=kb(this.elements.container,this.config.classNames.hideControls),i=typeof e>"u"?void 0:!e,r=Jt(this.elements.container,this.config.classNames.hideControls,i);if(r&&W.array(this.config.controls)&&this.config.controls.includes("settings")&&!W.empty(this.config.settings)&&Ze.toggleMenu.call(this,!1),r!==t){const s=r?"controlshidden":"controlsshown";vt.call(this,this.media,s)}return!r}return!1});Ae(this,"on",(e,t)=>{Vt.call(this,this.elements.container,e,t)});Ae(this,"once",(e,t)=>{Dx.call(this,this.elements.container,e,t)});Ae(this,"off",(e,t)=>{Mw(this.elements.container,e,t)});Ae(this,"destroy",(e,t=!1)=>{if(!this.ready)return;const i=()=>{document.body.style.overflow="",this.embed=null,t?(Object.keys(this.elements).length&&(il(this.elements.buttons.play),il(this.elements.captions),il(this.elements.controls),il(this.elements.wrapper),this.elements.buttons.play=null,this.elements.captions=null,this.elements.controls=null,this.elements.wrapper=null),W.function(e)&&e()):(u$.call(this),_u.cancelRequests.call(this),Cb(this.elements.original,this.elements.container),vt.call(this,this.elements.original,"destroyed",!0),W.function(e)&&e.call(this.elements.original),this.ready=!1,setTimeout(()=>{this.elements=null,this.media=null},200))};this.stop(),clearTimeout(this.timers.loading),clearTimeout(this.timers.controls),clearTimeout(this.timers.resized),this.isHTML5?(un.toggleNativeControls.call(this,!0),i()):this.isYouTube?(clearInterval(this.timers.buffering),clearInterval(this.timers.playing),this.embed!==null&&W.function(this.embed.destroy)&&this.embed.destroy(),i()):this.isVimeo&&(this.embed!==null&&this.embed.unload().then(i),setTimeout(i,200))});Ae(this,"supports",e=>Yn.mime.call(this,e));if(this.timers={},this.ready=!1,this.loading=!1,this.failed=!1,this.touch=Yn.touch,this.media=e,W.string(this.media)&&(this.media=document.querySelectorAll(this.media)),(window.jQuery&&this.media instanceof jQuery||W.nodeList(this.media)||W.array(this.media))&&(this.media=this.media[0]),this.config=Xn({},$L,Xm.defaults,t||{},(()=>{try{return JSON.parse(this.media.getAttribute("data-plyr-config"))}catch{return{}}})()),this.elements={container:null,fullscreen:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}},this.captions={active:null,currentTrack:-1,meta:new WeakMap},this.fullscreen={active:!1},this.options={speed:[],quality:[]},this.debug=new C$(this.config.debug),this.debug.log("Config",this.config),this.debug.log("Support",Yn),W.nullOrUndefined(this.media)||!W.element(this.media)){this.debug.error("Setup failed: no suitable element passed");return}if(this.media.plyr){this.debug.warn("Target already setup");return}if(!this.config.enabled){this.debug.error("Setup failed: disabled by config");return}if(!Yn.check().api){this.debug.error("Setup failed: no support");return}const i=this.media.cloneNode(!0);i.autoplay=!1,this.elements.original=i;const r=this.media.tagName.toLowerCase();let s=null,a=null;switch(r){case"div":if(s=this.media.querySelector("iframe"),W.element(s)){if(a=zL(s.getAttribute("src")),this.provider=S$(a.toString()),this.elements.container=this.media,this.media=s,this.elements.container.className="",a.search.length){const o=["1","true"];o.includes(a.searchParams.get("autoplay"))&&(this.config.autoplay=!0),o.includes(a.searchParams.get("loop"))&&(this.config.loop.active=!0),this.isYouTube?(this.config.playsinline=o.includes(a.searchParams.get("playsinline")),this.config.youtube.hl=a.searchParams.get("hl")):this.config.playsinline=!0}}else this.provider=this.media.getAttribute(this.config.attributes.embed.provider),this.media.removeAttribute(this.config.attributes.embed.provider);if(W.empty(this.provider)||!Object.values(Ol).includes(this.provider)){this.debug.error("Setup failed: Invalid provider");return}this.type=l_.video;break;case"video":case"audio":this.type=r,this.provider=Ol.html5,this.media.hasAttribute("crossorigin")&&(this.config.crossorigin=!0),this.media.hasAttribute("autoplay")&&(this.config.autoplay=!0),(this.media.hasAttribute("playsinline")||this.media.hasAttribute("webkit-playsinline"))&&(this.config.playsinline=!0),this.media.hasAttribute("muted")&&(this.config.muted=!0),this.media.hasAttribute("loop")&&(this.config.loop.active=!0);break;default:this.debug.error("Setup failed: unsupported type");return}if(this.supported=Yn.check(this.type,this.provider),!this.supported.api){this.debug.error("Setup failed: no support");return}this.eventListeners=[],this.listeners=new k$(this),this.storage=new Km(this),this.media.plyr=this,W.element(this.elements.container)||(this.elements.container=gt("div"),NL(this.media,this.elements.container)),un.migrateStyles.call(this),un.addStyleHook.call(this),qL.setup.call(this),this.config.debug&&Vt.call(this,this.elements.container,this.config.events.join(" "),o=>{this.debug.log(`event: ${o.type}`)}),this.fullscreen=new Qs(this),(this.isHTML5||this.isEmbed&&!this.supported.ui)&&un.build.call(this),this.listeners.container(),this.listeners.global(),this.config.ads.enabled&&(this.ads=new O$(this)),this.isHTML5&&this.config.autoplay&&this.once("canplay",()=>ao(this.play())),this.lastSeekTime=0,this.config.previewThumbnails.enabled&&(this.previewThumbnails=new $E(this))}get isHTML5(){return this.provider===Ol.html5}get isEmbed(){return this.isYouTube||this.isVimeo}get isYouTube(){return this.provider===Ol.youtube}get isVimeo(){return this.provider===Ol.vimeo}get isVideo(){return this.type===l_.video}get isAudio(){return this.type===l_.audio}get playing(){return!!(this.ready&&!this.paused&&!this.ended)}get paused(){return!!this.media.paused}get stopped(){return!!(this.paused&&this.currentTime===0)}get ended(){return!!this.media.ended}set currentTime(e){if(!this.duration)return;const t=W.number(e)&&e>0;this.media.currentTime=t?Math.min(e,this.duration):0,this.debug.log(`Seeking to ${this.currentTime} seconds`)}get currentTime(){return Number(this.media.currentTime)}get buffered(){const{buffered:e}=this.media;return W.number(e)?e:e&&e.length&&this.duration>0?e.end(0)/this.duration:0}get seeking(){return!!this.media.seeking}get duration(){const e=Number.parseFloat(this.config.duration),t=(this.media||{}).duration,i=!W.number(t)||t===1/0?0:t;return e||i}set volume(e){let t=e;const i=1,r=0;W.string(t)&&(t=Number(t)),W.number(t)||(t=this.storage.get("volume")),W.number(t)||({volume:t}=this.config),t>i&&(t=i),t<r&&(t=r),this.config.volume=t,this.media.volume=t,!W.empty(e)&&this.muted&&t>0&&(this.muted=!1)}get volume(){return Number(this.media.volume)}set muted(e){let t=e;W.boolean(t)||(t=this.storage.get("muted")),W.boolean(t)||(t=this.config.muted),this.config.muted=t,this.media.muted=t}get muted(){return!!this.media.muted}get hasAudio(){return!this.isHTML5||this.isAudio?!0:!!this.media.mozHasAudio||!!this.media.webkitAudioDecodedByteCount||!!(this.media.audioTracks&&this.media.audioTracks.length)}set speed(e){let t=null;W.number(e)&&(t=e),W.number(t)||(t=this.storage.get("speed")),W.number(t)||(t=this.config.speed.selected);const{minimumSpeed:i,maximumSpeed:r}=this;t=WL(t,i,r),this.config.speed.selected=t,setTimeout(()=>{this.media&&(this.media.playbackRate=t)},0)}get speed(){return Number(this.media.playbackRate)}get minimumSpeed(){return this.isYouTube?Math.min(...this.options.speed):this.isVimeo?.5:.0625}get maximumSpeed(){return this.isYouTube?Math.max(...this.options.speed):this.isVimeo?2:16}set quality(e){const t=this.config.quality,i=this.options.quality;if(!i.length)return;let r=[!W.empty(e)&&Number(e),this.storage.get("quality"),t.selected,t.default].find(W.number),s=!0;if(!i.includes(r)){const a=IL(i,r);this.debug.warn(`Unsupported quality option: ${r}, using ${a} instead`),r=a,s=!1}t.selected=r,this.media.quality=r,s&&this.storage.set({quality:r})}get quality(){return this.media.quality}set loop(e){const t=W.boolean(e)?e:this.config.loop.active;this.config.loop.active=t,this.media.loop=t}get loop(){return!!this.media.loop}set source(e){HE.change.call(this,e)}get source(){return this.media.currentSrc}get download(){const{download:e}=this.config.urls;return W.url(e)?e:this.source}set download(e){W.url(e)&&(this.config.urls.download=e,Ze.setDownloadUrl.call(this))}set poster(e){if(!this.isVideo){this.debug.warn("Poster can only be set for video");return}un.setPoster.call(this,e,!1).catch(()=>{})}get poster(){return this.isVideo?this.media.getAttribute("poster")||this.media.getAttribute("data-poster"):null}get ratio(){if(!this.isVideo)return null;const e=Tb(Rx.call(this));return W.array(e)?e.join(":"):e}set ratio(e){if(!this.isVideo){this.debug.warn("Aspect ratio can only be set for video");return}if(!W.string(e)||!OL(e)){this.debug.error(`Invalid aspect ratio specified (${e})`);return}this.config.ratio=Tb(e),ep.call(this)}set autoplay(e){this.config.autoplay=W.boolean(e)?e:this.config.autoplay}get autoplay(){return!!this.config.autoplay}toggleCaptions(e){Yt.toggle.call(this,e,!1)}set currentTrack(e){Yt.set.call(this,e,!1),Yt.setup.call(this)}get currentTrack(){const{toggled:e,currentTrack:t}=this.captions;return e?t:-1}set language(e){Yt.setLanguage.call(this,e,!1)}get language(){return(Yt.getCurrentTrack.call(this)||{}).language}set pip(e){if(!Yn.pip)return;const t=W.boolean(e)?e:!this.pip;W.function(this.media.webkitSetPresentationMode)&&this.media.webkitSetPresentationMode(t?o_.active:o_.inactive),W.function(this.media.requestPictureInPicture)&&(!this.pip&&t?this.media.requestPictureInPicture():this.pip&&!t&&document.exitPictureInPicture())}get pip(){return Yn.pip?W.empty(this.media.webkitPresentationMode)?this.media===document.pictureInPictureElement:this.media.webkitPresentationMode===o_.active:null}setPreviewThumbnails(e){this.previewThumbnails&&this.previewThumbnails.loaded&&(this.previewThumbnails.destroy(),this.previewThumbnails=null),Object.assign(this.config.previewThumbnails,e),this.config.previewThumbnails.enabled&&(this.previewThumbnails=new $E(this))}static supported(e,t){return Yn.check(e,t)}static loadSprite(e,t){return BL(e,t)}static setup(e,t={}){let i=null;return W.string(e)?i=Array.from(document.querySelectorAll(e)):W.nodeList(e)?i=Array.from(e):W.array(e)&&(i=e.filter(W.element)),W.empty(i)?null:i.map(r=>new Xm(r,t))}}Xm.defaults=s$($L);const Py=_w(n=>({currentVideo:null,subtitles:[],isLoading:!1,error:null,loadVideo:async e=>{n({isLoading:!0,error:null});try{const t=URL.createObjectURL(e),i=ux(e.name);n({currentVideo:{id:i,url:t,name:e.name},isLoading:!1})}catch(t){n({error:t instanceof Error?t.message:"Failed to load video",isLoading:!1})}},loadSubtitles:async e=>{n({isLoading:!0,error:null});try{const t=await e.text(),i=F$(t,e.name.endsWith(".vtt")?"vtt":"srt");n({subtitles:i,isLoading:!1})}catch(t){n({error:t instanceof Error?t.message:"Failed to load subtitles",isLoading:!1})}},saveProgress:async(e,t)=>{try{await Iu.videoProgress.put({id:e,videoId:e,timestamp:t.timestamp,duration:t.duration,lastWatched:new Date})}catch(i){console.error("Failed to save video progress:",i)}},loadProgress:async e=>{try{const t=await Iu.videoProgress.get(e);return t?{timestamp:t.timestamp,duration:t.duration}:null}catch(t){return console.error("Failed to load video progress:",t),null}},clearCurrentVideo:()=>n({currentVideo:null,subtitles:[]}),setError:e=>n({error:e})}));function F$(n,e){return e==="srt"?B$(n):j$(n)}function B$(n){const e=[];return n.trim().split(`

`).forEach(i=>{const r=i.split(`
`);if(r.length<3)return;const s=parseInt(r[0]),a=r[1],o=r.slice(2).join(`
`),l=a.match(/(\d{2}):(\d{2}):(\d{2}),(\d{3})\s+-->\s+(\d{2}):(\d{2}):(\d{2}),(\d{3})/);if(!l)return;const u=Db(l[1],l[2],l[3],l[4]),h=Db(l[5],l[6],l[7],l[8]);e.push({index:s,startTime:u,endTime:h,text:o})}),e}function j$(n){const e=n.replace(/^WEBVTT.*\n\n/,""),t=[];return e.trim().split(`

`).forEach((r,s)=>{const a=r.split(`
`);if(a.length<2)return;const o=a[0],l=a.slice(1).join(`
`),u=o.match(/(\d{2}):(\d{2}):(\d{2})\.(\d{3})\s+-->\s+(\d{2}):(\d{2}):(\d{2})\.(\d{3})/);if(!u)return;const h=Db(u[1],u[2],u[3],u[4]),d=Db(u[5],u[6],u[7],u[8]);t.push({index:s+1,startTime:h,endTime:d,text:l})}),t}function Db(n,e,t,i){return parseInt(n)*3600+parseInt(e)*60+parseInt(t)+parseInt(i)/1e3}const z$=({subtitle:n,onVocabClick:e})=>{const t=()=>{if(!n.vocabulary||n.vocabulary.length===0)return Q.jsx("p",{className:"text-white",children:n.text});const i=[...n.vocabulary].sort((a,o)=>n.text.indexOf(a.word)-n.text.indexOf(o.word)),r=[];let s=0;return i.forEach((a,o)=>{const l=n.text.indexOf(a.word,s);l!==-1&&(l>s&&r.push(Q.jsx("span",{className:"text-white",children:n.text.slice(s,l)},`text-${o}`)),r.push(Q.jsx("span",{className:`vocab-${a.state} cursor-pointer hover:opacity-80`,style:{backgroundColor:a.color},onClick:()=>e(a),children:a.word},`vocab-${o}`)),s=l+a.word.length)}),s<n.text.length&&r.push(Q.jsx("span",{className:"text-white",children:n.text.slice(s)},"text-end")),Q.jsx("p",{children:r})};return Q.jsx("div",{className:"subtitle-display",children:t()})},U$=({subtitles:n,currentIndex:e,onSubtitleClick:t,onVocabClick:i})=>{const r=kt.useRef(null);kt.useEffect(()=>{r.current&&r.current.scrollIntoView({behavior:"smooth",block:"center"})},[e]);const s=o=>{const l=Math.floor(o/60),u=Math.floor(o%60);return`${l}:${u.toString().padStart(2,"0")}`},a=o=>{if(!o.vocabulary||o.vocabulary.length===0)return Q.jsx("span",{className:"text-foreground",children:o.text});const l=[...o.vocabulary].sort((d,f)=>o.text.indexOf(d.word)-o.text.indexOf(f.word)),u=[];let h=0;return l.forEach((d,f)=>{const m=o.text.indexOf(d.word,h);m!==-1&&(m>h&&u.push(Q.jsx("span",{className:"text-foreground",children:o.text.slice(h,m)},`text-${f}`)),u.push(Q.jsx("span",{className:`vocab-${d.state} cursor-pointer hover:opacity-80`,style:{backgroundColor:d.color},onClick:()=>i(d),children:d.word},`vocab-${f}`)),h=m+d.word.length)}),h<o.text.length&&u.push(Q.jsx("span",{className:"text-foreground",children:o.text.slice(h)},"text-end")),Q.jsx("span",{children:u})};return Q.jsx("div",{className:"transcript-list",children:n.map((o,l)=>Q.jsxs("div",{ref:l===e?r:null,className:`transcript-item ${l===e?"active":""}`,onClick:()=>t(o),children:[Q.jsx("span",{className:"timestamp",children:s(o.startTime)}),Q.jsx("div",{className:"flex-1",children:a(o)})]},o.index))})},$$=()=>{const n=kt.useRef(null),[e,t]=kt.useState(null),[i,r]=kt.useState([]),[s,a]=kt.useState(0),[o,l]=kt.useState(null),[u,h]=kt.useState(null),[d,f]=kt.useState(!1),{currentVideo:m,subtitles:b,saveProgress:_,loadProgress:w,isLoading:v,error:y}=Py();kt.useEffect(()=>{if(!n.current)return;const H=new Xm(n.current,{controls:["play-large","play","progress","current-time","mute","volume","fullscreen"],settings:["speed"],speed:{selected:1,options:[.5,.75,1,1.25,1.5,2]}});return t(H),H.on("timeupdate",()=>{const z=H.currentTime;D(z),o&&_(o,{timestamp:z,duration:H.duration})}),()=>{H.destroy()}},[n.current]),kt.useEffect(()=>{o&&e&&w(o).then(H=>{H&&H.timestamp>0&&(e.currentTime=H.timestamp)})},[o,e]),kt.useEffect(()=>{r(b)},[b]);const E=async H=>{H.type==="video"&&(await Py.getState().loadVideo(H.file),l(H.file.name))},k=async H=>{if(H.type==="subtitle"){f(!0);try{await Py.getState().loadSubtitles(H.file);const z=await fx.parseSubtitles(b);r(z)}catch(z){console.error("Failed to process subtitles:",z)}finally{f(!1)}}},S=async H=>{H.type==="video"?await E(H):H.type==="subtitle"&&await k(H)},D=H=>{const z=i.findIndex(te=>H>=te.startTime&&H<=te.endTime);z!==-1&&z!==s&&a(z)},P=H=>{e&&(e.currentTime=H.startTime)},F=async H=>{console.log("Adding vocabulary to deck:",H)};return v?Q.jsx(vb,{className:"h-full"}):y?Q.jsx("div",{className:"flex items-center justify-center h-full",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("p",{className:"text-destructive mb-4",children:y}),Q.jsx("button",{onClick:()=>Py.getState().setError(null),className:"px-4 py-2 bg-primary text-primary-foreground rounded-md",children:"Try Again"})]})}):m?Q.jsxs("div",{className:"video-player-container h-full flex flex-col",children:[Q.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[Q.jsx("h2",{className:"text-lg font-semibold text-foreground",children:m.name}),Q.jsx("div",{className:"flex space-x-2",children:Q.jsx(hm,{onFileSelect:S,acceptedTypes:["subtitle"],maxSize:10,className:"h-16"})})]}),Q.jsxs("div",{className:"video-section flex-1 relative",children:[Q.jsx("video",{ref:n,className:"w-full h-full",children:Q.jsx("source",{src:m.url,type:"video/mp4"})}),Q.jsx("div",{className:"subtitle-overlay",children:i[s]&&Q.jsx(z$,{subtitle:i[s],onVocabClick:h})}),d&&Q.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:Q.jsxs("div",{className:"bg-card rounded-lg p-4 flex items-center space-x-2",children:[Q.jsx(vb,{size:20}),Q.jsx("span",{className:"text-foreground",children:"Processing subtitles..."})]})})]}),Q.jsxs("div",{className:"transcript-panel",children:[Q.jsx("h3",{className:"p-4 text-sm font-medium text-muted-foreground border-b border-border",children:"Transcript"}),Q.jsx(U$,{subtitles:i,currentIndex:s,onSubtitleClick:P,onVocabClick:h})]}),u&&Q.jsx(px,{vocabulary:u,onClose:()=>h(null),onAddToDeck:F})]}):Q.jsxs("div",{className:"p-4 space-y-4",children:[Q.jsx(hm,{onFileSelect:S,acceptedTypes:["video"],maxSize:500,className:"h-48"}),Q.jsx(hm,{onFileSelect:S,acceptedTypes:["subtitle"],maxSize:10,className:"h-32"})]})},H$=()=>{const{apiKey:n,isConnected:e,selectedDeckId:t,decks:i,colorNew:r,colorLearning:s,colorKnown:a,setAPIKey:o,updateDecks:l,updateColors:u}=ac(),[h,d]=kt.useState(n),[f,m]=kt.useState(!1),[b,_]=kt.useState("idle");kt.useEffect(()=>{n&&w()},[n]);const w=async()=>{if(n)try{const k=await new _2(n).getUserDecks();l(k)}catch(E){console.error("Failed to load user decks:",E)}},v=async()=>{m(!0),_("idle");try{await new _2(h).verifyConnection()?(_("success"),o(h),await w()):_("error")}catch{_("error")}finally{m(!1)}},y=(E,k)=>{const S={new:r,learning:s,known:a,[E]:k};u(S)};return Q.jsxs("div",{className:"p-4 space-y-6 max-w-2xl mx-auto",children:[Q.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Settings"}),Q.jsxs("div",{className:"bg-card rounded-lg p-4 border border-border",children:[Q.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Q.jsx(xz,{size:20,className:"text-primary"}),Q.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"JPDB API Configuration"})]}),Q.jsxs("div",{className:"space-y-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"API Key"}),Q.jsxs("div",{className:"flex space-x-2",children:[Q.jsx("input",{type:"password",value:h,onChange:E=>d(E.target.value),placeholder:"Enter your JPDB API key",className:"flex-1 px-3 py-2 border border-input rounded-md bg-background text-foreground"}),Q.jsx("button",{onClick:v,disabled:f||!h,className:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 disabled:opacity-50 flex items-center space-x-2",children:f?Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),Q.jsx("span",{children:"Testing..."})]}):Q.jsxs(Q.Fragment,{children:[Q.jsx(Qy,{size:16}),Q.jsx("span",{children:"Test"})]})})]})]}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[b==="success"&&Q.jsxs(Q.Fragment,{children:[Q.jsx(Qy,{size:16,className:"text-green-500"}),Q.jsx("span",{className:"text-green-500 text-sm",children:"Connected successfully!"})]}),b==="error"&&Q.jsxs(Q.Fragment,{children:[Q.jsx(vN,{size:16,className:"text-red-500"}),Q.jsx("span",{className:"text-red-500 text-sm",children:"Connection failed. Please check your API key."})]}),e&&b==="idle"&&Q.jsxs(Q.Fragment,{children:[Q.jsx(Qy,{size:16,className:"text-green-500"}),Q.jsx("span",{className:"text-green-500 text-sm",children:"Connected"})]})]}),i.length>0&&Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Default Deck"}),Q.jsxs("select",{value:t,onChange:E=>ac.getState().setSelectedDeck(E.target.value),className:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground",children:[Q.jsx("option",{value:"",children:"Select a deck"}),i.map(E=>Q.jsxs("option",{value:E.id,children:[E.name," (",E.vocabularyCount," words)"]},E.id))]})]})]})]}),Q.jsxs("div",{className:"bg-card rounded-lg p-4 border border-border",children:[Q.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Q.jsx(Cz,{size:20,className:"text-primary"}),Q.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Highlighting Colors"})]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"New Vocabulary"}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"color",value:r,onChange:E=>y("new",E.target.value),className:"w-12 h-8 border border-input rounded"}),Q.jsx("span",{className:"text-sm text-foreground",children:"New words"})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Learning Vocabulary"}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"color",value:s,onChange:E=>y("learning",E.target.value),className:"w-12 h-8 border border-input rounded"}),Q.jsx("span",{className:"text-sm text-foreground",children:"In your deck"})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Known Vocabulary"}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"color",value:a,onChange:E=>y("known",E.target.value),className:"w-12 h-8 border border-input rounded"}),Q.jsx("span",{className:"text-sm text-foreground",children:"Marked as known"})]})]})]})]}),Q.jsxs("div",{className:"bg-card rounded-lg p-4 border border-border",children:[Q.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Q.jsx(Ez,{size:20,className:"text-primary"}),Q.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Data Management"})]}),Q.jsxs("div",{className:"space-y-2",children:[Q.jsx("button",{onClick:()=>{confirm("This will clear all cached vocabulary data. Continue?")&&console.log("Clearing vocabulary cache...")},className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80",children:"Clear Vocabulary Cache"}),Q.jsx("button",{onClick:()=>{confirm("This will clear all reading progress. Continue?")&&console.log("Clearing progress data...")},className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-md hover:bg-secondary/80",children:"Clear Reading Progress"})]})]}),Q.jsxs("div",{className:"bg-card rounded-lg p-4 border border-border",children:[Q.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"About"}),Q.jsx("p",{className:"text-sm text-muted-foreground",children:"JPDB Japanese Reader v1.0.0"}),Q.jsx("p",{className:"text-sm text-muted-foreground",children:"A client-side Japanese reading tool with JPDB.io integration."})]})]})},q$=()=>{const[n,e]=kt.useState("epub"),t=[{id:"epub",label:"EPUB",icon:_z,component:bk},{id:"manga",label:"Manga",icon:mN,component:I6},{id:"video",label:"Video",icon:gN,component:$$},{id:"settings",label:"Settings",icon:Tz,component:H$}],i=t.find(r=>r.id===n)?.component||bk;return Q.jsxs("div",{className:"flex flex-col h-screen bg-background text-foreground",children:[Q.jsxs("header",{className:"bg-card border-b border-border p-4 shadow-sm",children:[Q.jsx("h1",{className:"text-2xl font-bold text-center text-primary",children:"🎌 JPDB Japanese Reader"}),Q.jsx("p",{className:"text-center text-muted-foreground text-sm mt-1",children:"Interactive Japanese Learning"})]}),Q.jsx("main",{className:"flex-1 overflow-hidden",children:gm.createElement(i)}),Q.jsx("nav",{className:"flex bg-card border-t border-border shadow-lg",children:t.map(({id:r,label:s,icon:a})=>Q.jsxs("button",{onClick:()=>e(r),className:`flex-1 flex flex-col items-center justify-center py-3 px-2 min-h-[70px] transition-all duration-200 ${n===r?"text-primary bg-primary/10 border-t-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted/50"}`,children:[Q.jsx(a,{size:24,className:"mb-1"}),Q.jsx("span",{className:"text-xs font-medium",children:s})]},r))})]})},W$=new kR({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3}}});function V$(){return Q.jsx(TR,{client:W$,children:Q.jsx("div",{className:"min-h-screen bg-background text-foreground",children:Q.jsx(q$,{})})})}const G$=new kR({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3}}}),VL=document.getElementById("root");if(!VL)throw new Error("Root element not found");const K$=wR(VL);K$.render(Q.jsx(TR,{client:G$,children:Q.jsx(V$,{})}));
